<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>programming-microsoft-dynamics-365-business-central compress</title></head><body><div class="calibre" id="calibre_link-0">
<p class="calibre1"><a id="calibre_link-410"></a><img src="images/000172.png" alt="Image 1" class="calibre2" /></p>
<p class="calibre1"><a id="calibre_link-411"></a><img src="images/000282.jpg" alt="Image 2" class="calibre2" /></p>
<p class="calibre1"><b class="calibre3">Programming Microsoft</b></p>
<p class="calibre1"><b class="calibre3">Dynamics 365 Business Central</b></p>
<p class="calibre1"> <i class="calibre4"><b class="calibre3">Sixth Edition</b></i></p>
<p class="calibre1">Build customized business applications with the latest tools<br>in Dynamics 365 Business Central</p>
<p class="calibre1"><b class="calibre3">Mark Brummel</b></p>
<p class="calibre1"><b class="calibre3">David Studebaker</b></p>
<p class="calibre1"><b class="calibre3">Chris Studebaker</b></p>
<p class="calibre1"><b class="calibre3">BIRMINGHAM - MUMBAI</b></p>
<p class="calibre1"><a id="calibre_link-412"></a><b class="calibre3">Programming Microsoft Dynamics 365</b></p>
<p class="calibre1"><b class="calibre3">Business Central</b></p>
<p class="calibre1">Sixth Edition</p>
<p class="calibre1">Copyright © 2019 Packt Publishing</p>
<p class="calibre1">All rights reserved. No part of this book may be reproduced, stored in a retrieval system, or transmitted in any form or by any means, without the prior written permission of the publisher, except in the case of brief quotations embedded in critical articles or reviews. </p>
<p class="calibre1">Every effort has been made in the preparation of this book to ensure the accuracy of the information presented. </p>
<p class="calibre1">However, the information contained in this book is sold without warranty, either express or implied. Neither the authors, nor Packt Publishing or its dealers and distributors, will be held liable for any damages caused or alleged to have been caused directly or indirectly by this book. </p>
<p class="calibre1">Packt Publishing has endeavored to provide trademark information about all of the companies and products mentioned in this book by the appropriate use of capitals. However, Packt Publishing cannot guarantee the accuracy of this information. </p>
<p class="calibre1"><b class="calibre3">Commissioning Editor:</b> Richa Tripathi</p>
<p class="calibre1"><b class="calibre3">Acquisition Editor:</b> Chaitanya Nair</p>
<p class="calibre1"><b class="calibre3">Content Development Editor:</b> Rohit Singh</p>
<p class="calibre1"><b class="calibre3">Technical Editor:</b> Romy Dias</p>
<p class="calibre1"><b class="calibre3">Copy Editor:</b> Safis Editing</p>
<p class="calibre1"><b class="calibre3">Project Coordinator:</b> Vaidehi Sawant</p>
<p class="calibre1"><b class="calibre3">Proofreader:</b> Safis Editing</p>
<p class="calibre1"><b class="calibre3">Indexer: </b>Priyanka Dhadke</p>
<p class="calibre1"><b class="calibre3">Graphics:</b> Alishon Mendonsa</p>
<p class="calibre1"><b class="calibre3">Production Coordinator:</b> Aparna Bhagat</p>
<p class="calibre1">First published: October 2007</p>
<p class="calibre1">Second edition: November 2009</p>
<p class="calibre1">Third edition: February 2013</p>
<p class="calibre1">Fourth edition: July 2015</p>
<p class="calibre1">Fifth edition: April 2017</p>
<p class="calibre1">Sixth edition: April 2019</p>
<p class="calibre1">Production reference: 1300419</p>
<p class="calibre1">Published by Packt Publishing Ltd. </p>
<p class="calibre1">Livery Place</p>
<p class="calibre1">35 Livery Street</p>
<p class="calibre1">Birmingham</p>
<p class="calibre1">B3 2PB, UK. </p>
<p class="calibre1">ISBN 978-1-78913-779-8</p>
<p class="calibre1"><a href="http://www.packtpub.com">www.packtpub.com</a></p>
<p class="calibre1"><a id="calibre_link-413"></a><img src="images/000305.jpg" alt="Image 3" class="calibre2" /></p>
<p class="calibre1"></p>
<p class="calibre1"><a href="https://mapt.io/">mapt.io</a></p>
<p class="calibre1">Mapt is an online digital library that gives you full access to over 5,000 books and videos, as well as industry leading tools to help you plan your personal development and advance your career. For more information, please visit our website. </p>
<p class="calibre1"><b class="calibre3">Why subscribe? </b></p>
<p class="calibre1">Spend less time learning and more time coding with practical eBooks and Videos<br>from over 4,000 industry professionals</p>
<p class="calibre1">Improve your learning with Skill Plans built especially for you</p>
<p class="calibre1">Get a free eBook or video every month</p>
<p class="calibre1">Mapt is fully searchable</p>
<p class="calibre1">Copy and paste, print, and bookmark content</p>
<p class="calibre1"><b class="calibre3">PacktPub.com</b></p>
<p class="calibre1">Did you know that Packt offers eBook versions of every book published, with PDF and ePub files available? You can upgrade to the eBook version at <a href="http://www.PacktPub.com">www.PacktPub.com</a> and as a print book customer, you are entitled to a discount on the eBook copy. Get in touch with us at service@packtpub.com for more details. </p>
<p class="calibre1"><a href="http://www.packtpub.com">At www.PacktPub.com, you can also read a collection of free technical articles, sign up for a</a></p>
<p class="calibre1">range of free newsletters, and receive exclusive discounts and offers on Packt books and eBooks. </p>
<p class="calibre1"><a id="calibre_link-414"></a>Contributors</p>
<p class="calibre1"><b class="calibre3">About the authors</b></p>
<p class="calibre1"><b class="calibre3">Mark Brummel</b> started working with Navision in 1997 as an end user. He started working for a Navision solution center in 1999 and witnessed the evolution of the product. In 2006, he received the MVP award from Microsoft and started a journey of close involvement in the product. After the migration to Microsoft Dynamics NAV, the three-tier architecture and role-tailored user interface, he became a trusted consultant, frequently visiting the Microsoft Development Center in Copenhagen and speaking at events. Mark was very closely involved in the early ideas of implementing modern programming concepts that are now known as events and extensions. He is currently senior product specialist at ForNAV</p>
<p class="calibre1">and a freelance software architect. </p>
<p class="calibre1"> <i class="calibre4">Working on this book with Dave and Chris has been amazing. I have been involved since</i> <i class="calibre4">the first edition and to see this book stay strong throughout the changes of the product says</i> <i class="calibre4">something about it. It has been a pleasure updating the content to the latest version of the</i> <i class="calibre4">product. I would like to thank Dave and his wife Karen for all the opportunities our</i> <i class="calibre4">friendship has brought and the lessons in life we have been able to share. Of course, I’d like</i> <i class="calibre4">to thank my wife, Dionel, and my kids for giving me the time to work on the book. </i></p>
<p class="calibre1"><a id="calibre_link-416"></a><b class="calibre3">David Studebaker</b> has been designing and developing software since 1962 as a developer, consultant, manager, and business owner. In 1967, David coauthored the first general-purpose SPOOL system, an AT&amp;T / IBM joint project. He has been a founding partner in several firms, most recently Studebaker Technology and Liberty Grove Software. David’s publications include a decade of technical reviews for  <i class="calibre4">ACM Computing Reviews</i> and a number of articles on shop floor data collection. David originated the Packt series of books on programming Dynamics Business Central (aka Dynamics NAV). He has a BS in<br>mechanical engineering from Purdue University and an MBA from the University of</p>
<p class="calibre1">Chicago. He is a life member of the Association for Computing Machinery. </p>
<p class="calibre1"> <i class="calibre4">I am grateful for the joy of working with Mark and Christopher, my coauthors. I want to</i> <i class="calibre4">thank the many special people who have provided guidance and assistance throughout my</i> <i class="calibre4">life, especially my parents. I am thankful for the love and support of my children, Becky</i> <i class="calibre4">and Chris, their spouses and children. Most of all, I am deeply grateful to Karen, my</i> <i class="calibre4">lifelong partner in marriage, family, business, and love, for her unwavering support in all</i> <i class="calibre4">things. </i></p>
<p class="calibre1"><b class="calibre3">Chris Studebaker</b> was a certified environmental consultant working with manufacturing facilities to meet national and state regulations before he started working with Navision in 1999. After working on regulatory reporting, data analysis, project management, and subcontractor oversight, Chris has used those skills to sell, develop, and implement NAV</p>
<p class="calibre1">for the past 20 years. He has specialized in retail, manufacturing, job shop, and distribution implementations, mostly in high-user-count, high-data-volume applications. Chris acts in a consulting and training role for customers and for peer NAV professionals. He has a Bachelor of Science degree from Northern Illinois University and has done graduate work at Denmark Technical University. </p>
<p class="calibre1"> <i class="calibre4">This book would not have been possible without Mark and David, and I am extremely</i> <i class="calibre4">grateful for all their work. I would like to thank the many people who have mentored me</i> <i class="calibre4">through the years and am thankful for the many friendships that I’ve formed, both with</i> <i class="calibre4">team members and customers. The NAV world is full of supportive people, and I am</i> <i class="calibre4">thankful to my parents for introducing me to it. I would like to thank my wife, Beth, and</i> <i class="calibre4">son, Cole, for supporting my writing. </i></p>
<p class="calibre1"><a id="calibre_link-417"></a><b class="calibre3">About the reviewers</b></p>
<p class="calibre1"><b class="calibre3">Ronald E. Oates</b> switched university majors from theatre to computer science when he discovered he had a “knack” for programming. It was a good move&mdash;in 1979, he got his first programming job as a contract programmer, developing software in COBOL, RPG II, and DEC/VAX BASIC on mainframe and mini computers. In 1986, with the advent of micro-computers, he started Productive Systems, Inc. to focus on bringing software solutions to small and mid-size businesses. </p>
<p class="calibre1">Productive Systems, Inc. became a Microsoft Partner in 1997 when the program was started. In 1999, PSI became a Navision Solution Center. Navision perfectly fit Ron’s vision of solutions with existing base functionality that could be rapidly and securely modified to fit individual customer needs. Once Navision was discovered, the focus of the business was entirely Navision, then Microsoft Dynamics NAV, and now Microsoft Business Central 365. </p>
<p class="calibre1"><b class="calibre3">Roberto Stefanetti</b> is a functional and technical consultant who has worked on education and training for companies, partners, and clients. He currently works on Microsoft systems, especially ERP and related environments. </p>
<p class="calibre1">He started working on Navision in 2004, both as a developer and as a functional consultant, and he is now more involved in consulting and managing projects than in development. He has been an MVP in business application since 2016 and a Microsoft Education Influencer since 2017. </p>
<p class="calibre1">Roberto’s blog is one of the most widely read in the world (with more than 1 million page visits). He has also published articles on many digital publications (such as</p>
<p class="calibre1">MSDynamicsWorld, NAVUG Magazine, and others) and reviewed a number of books. </p>
<p class="calibre1"><b class="calibre3">Packt is searching for authors like you</b></p>
<p class="calibre1"><a href="http://authors.packtpub.com">If you’re interested in becoming an author for Packt, please visit authors.packtpub.com</a></p>
<p class="calibre1">and apply today. We have worked with thousands of developers and tech professionals, just like you, to help them share their insight with the global tech community. You can make a general application, apply for a specific hot topic that we are recruiting an author for, or submit your own idea. </p>
<p class="calibre1"><a id="calibre_link-415"></a>Table of Contents</p>
<p class="calibre1"><a href="#calibre_link-1"><b class="calibre3">Preface</b></a></p>
<p class="calibre1"><a href="#calibre_link-1">1</a></p>
<p class="calibre1"><a href="#calibre_link-2"><b class="calibre3">Chapter 1: Introduction to Business Central</b></a></p>
<p class="calibre1"><a href="#calibre_link-2">13</a></p>
<p class="calibre1"><a href="#calibre_link-3"><b class="calibre3">Business Central &ndash; an ERP system</b></a></p>
<p class="calibre1"><a href="#calibre_link-3">14</a></p>
<p class="calibre1"><a href="#calibre_link-4">Financial management</a></p>
<p class="calibre1"><a href="#calibre_link-4">16</a></p>
<p class="calibre1"><a href="#calibre_link-4">Manufacturing</a></p>
<p class="calibre1"><a href="#calibre_link-4">16</a></p>
<p class="calibre1"><a href="#calibre_link-5">Supply chain management</a></p>
<p class="calibre1"><a href="#calibre_link-5">17</a></p>
<p class="calibre1"><a href="#calibre_link-5">Business intelligence and reporting</a></p>
<p class="calibre1"><a href="#calibre_link-5">17</a></p>
<p class="calibre1"><a href="#calibre_link-6">Relationship management</a></p>
<p class="calibre1"><a href="#calibre_link-6">18</a></p>
<p class="calibre1"><a href="#calibre_link-6">Human resource management</a></p>
<p class="calibre1"><a href="#calibre_link-6">18</a></p>
<p class="calibre1"><a href="#calibre_link-7">Project management</a></p>
<p class="calibre1"><a href="#calibre_link-7">19</a></p>
<p class="calibre1"><a href="#calibre_link-7"><b class="calibre3">A developer’s overview of Business Central</b></a></p>
<p class="calibre1"><a href="#calibre_link-7">19</a></p>
<p class="calibre1"><a href="#calibre_link-7">Business Central object types</a></p>
<p class="calibre1"><a href="#calibre_link-7">19</a></p>
<p class="calibre1"><a href="#calibre_link-8">The Visual Studio Code integrated development environment</a></p>
<p class="calibre1"><a href="#calibre_link-8">20</a></p>
<p class="calibre1"><a href="#calibre_link-9">Visual Studio Code icons</a></p>
<p class="calibre1"><a href="#calibre_link-9">21</a></p>
<p class="calibre1"><a href="#calibre_link-10">Explorer</a></p>
<p class="calibre1"><a href="#calibre_link-10">22</a></p>
<p class="calibre1"><a href="#calibre_link-10">Search</a></p>
<p class="calibre1"><a href="#calibre_link-10">22</a></p>
<p class="calibre1"><a href="#calibre_link-11">Source control</a></p>
<p class="calibre1"><a href="#calibre_link-11">23</a></p>
<p class="calibre1"><a href="#calibre_link-12">Debugger</a></p>
<p class="calibre1"><a href="#calibre_link-12">24</a></p>
<p class="calibre1"><a href="#calibre_link-12">Extensions</a></p>
<p class="calibre1"><a href="#calibre_link-12">24</a></p>
<p class="calibre1"><a href="#calibre_link-13">AL programming language</a></p>
<p class="calibre1"><a href="#calibre_link-13">25</a></p>
<p class="calibre1"><a href="#calibre_link-14">Business Central object and system elements</a></p>
<p class="calibre1"><a href="#calibre_link-14">27</a></p>
<p class="calibre1"><a href="#calibre_link-15">Business Central functional terminology</a></p>
<p class="calibre1"><a href="#calibre_link-15">30</a></p>
<p class="calibre1"><a href="#calibre_link-15">User interface</a></p>
<p class="calibre1"><a href="#calibre_link-15">30</a></p>
<p class="calibre1"><a href="#calibre_link-16"><b class="calibre3">Hands-on development in Business Central</b></a></p>
<p class="calibre1"><a href="#calibre_link-16">32</a></p>
<p class="calibre1"><a href="#calibre_link-16">Business Central development exercise scenario</a></p>
<p class="calibre1"><a href="#calibre_link-16">32</a></p>
<p class="calibre1"><a href="#calibre_link-17">Getting started with application design</a></p>
<p class="calibre1"><a href="#calibre_link-17">33</a></p>
<p class="calibre1"><a href="#calibre_link-18">Folder structure</a></p>
<p class="calibre1"><a href="#calibre_link-18">34</a></p>
<p class="calibre1"><a href="#calibre_link-18">launch.json</a></p>
<p class="calibre1"><a href="#calibre_link-18">34</a></p>
<p class="calibre1"><a href="#calibre_link-19">app.json</a></p>
<p class="calibre1"><a href="#calibre_link-19">35</a></p>
<p class="calibre1"><a href="#calibre_link-19">Symbol files</a></p>
<p class="calibre1"><a href="#calibre_link-19">35</a></p>
<p class="calibre1"><a href="#calibre_link-20">Application tables</a></p>
<p class="calibre1"><a href="#calibre_link-20">36</a></p>
<p class="calibre1"><a href="#calibre_link-21">Designing a simple table</a></p>
<p class="calibre1"><a href="#calibre_link-21">37</a></p>
<p class="calibre1"><a href="#calibre_link-22">Creating a simple table</a></p>
<p class="calibre1"><a href="#calibre_link-22">38</a></p>
<p class="calibre1"><a href="#calibre_link-23">Pages</a></p>
<p class="calibre1"><a href="#calibre_link-23">41</a></p>
<p class="calibre1"><a href="#calibre_link-23">Standard elements of pages</a></p>
<p class="calibre1"><a href="#calibre_link-23">41</a></p>
<p class="calibre1"><a href="#calibre_link-24">List pages</a></p>
<p class="calibre1"><a href="#calibre_link-24">42</a></p>
<p class="calibre1"><a href="#calibre_link-24">Card pages</a></p>
<p class="calibre1"><a href="#calibre_link-24">42</a></p>
<p class="calibre1"><a href="#calibre_link-25">Document pages</a></p>
<p class="calibre1"><a href="#calibre_link-25">43</a></p>
<p class="calibre1"><a href="#calibre_link-26">Journal/worksheet pages</a></p>
<p class="calibre1"><a href="#calibre_link-26">44</a></p>
<p class="calibre1"><a href="#calibre_link-27">Creating a list page</a></p>
<p class="calibre1"><a href="#calibre_link-27">45</a></p>
<p class="calibre1"><a id="calibre_link-418"></a> <i class="calibre4">Table of Contents</i></p>
<p class="calibre1"><a href="#calibre_link-28">Creating a card page</a></p>
<p class="calibre1"><a href="#calibre_link-28">49</a></p>
<p class="calibre1"><a href="#calibre_link-29">Creating some sample data</a></p>
<p class="calibre1"><a href="#calibre_link-29">50</a></p>
<p class="calibre1"><a href="#calibre_link-30">Creating a list report</a></p>
<p class="calibre1"><a href="#calibre_link-30">51</a></p>
<p class="calibre1"><a href="#calibre_link-31">Generating the layout</a></p>
<p class="calibre1"><a href="#calibre_link-31">53</a></p>
<p class="calibre1"><a href="#calibre_link-32">Designing the layout</a></p>
<p class="calibre1"><a href="#calibre_link-32">56</a></p>
<p class="calibre1"><a href="#calibre_link-33"><b class="calibre3">Other Business Central object types</b></a></p>
<p class="calibre1"><a href="#calibre_link-33">59</a></p>
<p class="calibre1"><a href="#calibre_link-33">TableExtension and PageExtension</a></p>
<p class="calibre1"><a href="#calibre_link-33">59</a></p>
<p class="calibre1"><a href="#calibre_link-34">Codeunits</a></p>
<p class="calibre1"><a href="#calibre_link-34">60</a></p>
<p class="calibre1"><a href="#calibre_link-35">Queries</a></p>
<p class="calibre1"><a href="#calibre_link-35">61</a></p>
<p class="calibre1"><a href="#calibre_link-35">XMLports</a></p>
<p class="calibre1"><a href="#calibre_link-35">61</a></p>
<p class="calibre1"><a href="#calibre_link-36">Control add-ins</a></p>
<p class="calibre1"><a href="#calibre_link-36">62</a></p>
<p class="calibre1"><a href="#calibre_link-36"><b class="calibre3">Development backups and documentation</b></a></p>
<p class="calibre1"><a href="#calibre_link-36">62</a></p>
<p class="calibre1"><a href="#calibre_link-37"><b class="calibre3">Summary</b></a></p>
<p class="calibre1"><a href="#calibre_link-37">63</a></p>
<p class="calibre1"><a href="#calibre_link-37"><b class="calibre3">Questions</b></a></p>
<p class="calibre1"><a href="#calibre_link-37">63</a></p>
<p class="calibre1"><a href="#calibre_link-38"><b class="calibre3">Chapter 2: Tables</b></a></p>
<p class="calibre1"><a href="#calibre_link-38">66</a></p>
<p class="calibre1"><a href="#calibre_link-39"><b class="calibre3">An overview of tables</b></a></p>
<p class="calibre1"><a href="#calibre_link-39">67</a></p>
<p class="calibre1"><a href="#calibre_link-40">Components of a table</a></p>
<p class="calibre1"><a href="#calibre_link-40">68</a></p>
<p class="calibre1"><a href="#calibre_link-41">Naming tables</a></p>
<p class="calibre1"><a href="#calibre_link-41">69</a></p>
<p class="calibre1"><a href="#calibre_link-41">Table numbering</a></p>
<p class="calibre1"><a href="#calibre_link-41">69</a></p>
<p class="calibre1"><a href="#calibre_link-42">Table properties</a></p>
<p class="calibre1"><a href="#calibre_link-42">70</a></p>
<p class="calibre1"><a href="#calibre_link-43">Table triggers</a></p>
<p class="calibre1"><a href="#calibre_link-43">73</a></p>
<p class="calibre1"><a href="#calibre_link-44">Keys</a></p>
<p class="calibre1"><a href="#calibre_link-44">75</a></p>
<p class="calibre1"><a href="#calibre_link-45">SumIndexFields</a></p>
<p class="calibre1"><a href="#calibre_link-45">78</a></p>
<p class="calibre1"><a href="#calibre_link-46">Field groups</a></p>
<p class="calibre1"><a href="#calibre_link-46">79</a></p>
<p class="calibre1"><a href="#calibre_link-47">Bricks</a></p>
<p class="calibre1"><a href="#calibre_link-47">81</a></p>
<p class="calibre1"><a href="#calibre_link-48"><b class="calibre3">Enhancing our sample application</b></a></p>
<p class="calibre1"><a href="#calibre_link-48">82</a></p>
<p class="calibre1"><a href="#calibre_link-48">Creating and modifying tables</a></p>
<p class="calibre1"><a href="#calibre_link-48">82</a></p>
<p class="calibre1"><a href="#calibre_link-49">Assigning a table relation property</a></p>
<p class="calibre1"><a href="#calibre_link-49">87</a></p>
<p class="calibre1"><a href="#calibre_link-50">Assigning an InitValue property</a></p>
<p class="calibre1"><a href="#calibre_link-50">89</a></p>
<p class="calibre1"><a href="#calibre_link-50">Adding a few activity-tracking tables</a></p>
<p class="calibre1"><a href="#calibre_link-50">89</a></p>
<p class="calibre1"><a href="#calibre_link-51">New tables for our WDTU project</a></p>
<p class="calibre1"><a href="#calibre_link-51">91</a></p>
<p class="calibre1"><a href="#calibre_link-52">New list pages for our WDTU project</a></p>
<p class="calibre1"><a href="#calibre_link-52">95</a></p>
<p class="calibre1"><a href="#calibre_link-52">Keys, SumIndexFields, and table relations in our examples</a></p>
<p class="calibre1"><a href="#calibre_link-52">95</a></p>
<p class="calibre1"><a href="#calibre_link-52">Secondary keys and SumIndexFields</a></p>
<p class="calibre1"><a href="#calibre_link-52">95</a></p>
<p class="calibre1"><a href="#calibre_link-53">Table relations</a></p>
<p class="calibre1"><a href="#calibre_link-53">96</a></p>
<p class="calibre1"><a href="#calibre_link-54">Modifying an original Business Central table</a></p>
<p class="calibre1"><a href="#calibre_link-54">97</a></p>
<p class="calibre1"><a href="#calibre_link-55"><b class="calibre3">Types of table</b></a></p>
<p class="calibre1"><a href="#calibre_link-55">98</a></p>
<p class="calibre1"><a href="#calibre_link-56">Fully modifiable tables</a></p>
<p class="calibre1"><a href="#calibre_link-56">99</a></p>
<p class="calibre1"><a href="#calibre_link-56">Master data</a></p>
<p class="calibre1"><a href="#calibre_link-56">99</a></p>
<p class="calibre1"><a href="#calibre_link-57">Journal</a></p>
<p class="calibre1"><a href="#calibre_link-57">100</a></p>
<p class="calibre1"><a href="#calibre_link-58">Template</a></p>
<p class="calibre1"><a href="#calibre_link-58">101</a></p>
<p class="calibre1"><a href="#calibre_link-59">Entry tables</a></p>
<p class="calibre1"><a href="#calibre_link-59">102</a></p>
<p class="calibre1"><a href="#calibre_link-60">Subsidiary (supplementary) tables</a></p>
<p class="calibre1"><a href="#calibre_link-60">105</a></p>
<p class="calibre1"><a href="#calibre_link-61">Register</a></p>
<p class="calibre1"><a href="#calibre_link-61">107</a></p>
<p class="calibre1"><a href="#calibre_link-62">Posted document</a></p>
<p class="calibre1"><a href="#calibre_link-62">109</a></p>
<p class="calibre1"><a href="#calibre_link-63">Singleton</a></p>
<p class="calibre1"><a href="#calibre_link-63">110</a></p>
<p class="calibre1"><b class="calibre3">[ ii ]</b></p>
<p class="calibre1"><a id="calibre_link-419"></a> <i class="calibre4">Table of Contents</i></p>
<p class="calibre1"><a href="#calibre_link-64">Temporary</a></p>
<p class="calibre1"><a href="#calibre_link-64">111</a></p>
<p class="calibre1"><a href="#calibre_link-65">Content modifiable tables</a></p>
<p class="calibre1"><a href="#calibre_link-65">112</a></p>
<p class="calibre1"><a href="#calibre_link-65">System table</a></p>
<p class="calibre1"><a href="#calibre_link-65">112</a></p>
<p class="calibre1"><a href="#calibre_link-66">Read-only tables</a></p>
<p class="calibre1"><a href="#calibre_link-66">114</a></p>
<p class="calibre1"><a href="#calibre_link-66">Virtual</a></p>
<p class="calibre1"><a href="#calibre_link-66">114</a></p>
<p class="calibre1"><a href="#calibre_link-67"><b class="calibre3">Summary</b></a></p>
<p class="calibre1"><a href="#calibre_link-67">115</a></p>
<p class="calibre1"><a href="#calibre_link-67"><b class="calibre3">Questions</b></a></p>
<p class="calibre1"><a href="#calibre_link-67">115</a></p>
<p class="calibre1"><a href="#calibre_link-68"><b class="calibre3">Chapter 3: Data Types and Fields</b></a></p>
<p class="calibre1"><a href="#calibre_link-68">118</a></p>
<p class="calibre1"><a href="#calibre_link-69"><b class="calibre3">Basic definitions in Business Central</b></a></p>
<p class="calibre1"><a href="#calibre_link-69">119</a></p>
<p class="calibre1"><a href="#calibre_link-69"><b class="calibre3">Fields</b></a></p>
<p class="calibre1"><a href="#calibre_link-69">119</a></p>
<p class="calibre1"><a href="#calibre_link-70">Field properties</a></p>
<p class="calibre1"><a href="#calibre_link-70">120</a></p>
<p class="calibre1"><a href="#calibre_link-71">Field triggers</a></p>
<p class="calibre1"><a href="#calibre_link-71">125</a></p>
<p class="calibre1"><a href="#calibre_link-72">Field events</a></p>
<p class="calibre1"><a href="#calibre_link-72">126</a></p>
<p class="calibre1"><a href="#calibre_link-72">Data structure examples</a></p>
<p class="calibre1"><a href="#calibre_link-72">126</a></p>
<p class="calibre1"><a href="#calibre_link-73">Field numbering</a></p>
<p class="calibre1"><a href="#calibre_link-73">127</a></p>
<p class="calibre1"><a href="#calibre_link-74">Field and variable naming</a></p>
<p class="calibre1"><a href="#calibre_link-74">128</a></p>
<p class="calibre1"><a href="#calibre_link-75"><b class="calibre3">Data types</b></a></p>
<p class="calibre1"><a href="#calibre_link-75">129</a></p>
<p class="calibre1"><a href="#calibre_link-75">Fundamental data types</a></p>
<p class="calibre1"><a href="#calibre_link-75">129</a></p>
<p class="calibre1"><a href="#calibre_link-75">Numeric data</a></p>
<p class="calibre1"><a href="#calibre_link-75">129</a></p>
<p class="calibre1"><a href="#calibre_link-76">String data</a></p>
<p class="calibre1"><a href="#calibre_link-76">131</a></p>
<p class="calibre1"><a href="#calibre_link-77">Date/Time data</a></p>
<p class="calibre1"><a href="#calibre_link-77">132</a></p>
<p class="calibre1"><a href="#calibre_link-78">Complex data types</a></p>
<p class="calibre1"><a href="#calibre_link-78">134</a></p>
<p class="calibre1"><a href="#calibre_link-78">Data structure</a></p>
<p class="calibre1"><a href="#calibre_link-78">134</a></p>
<p class="calibre1"><a href="#calibre_link-79">Objects</a></p>
<p class="calibre1"><a href="#calibre_link-79">135</a></p>
<p class="calibre1"><a href="#calibre_link-79">Web services</a></p>
<p class="calibre1"><a href="#calibre_link-79">135</a></p>
<p class="calibre1"><a href="#calibre_link-79">DotNet</a></p>
<p class="calibre1"><a href="#calibre_link-79">135</a></p>
<p class="calibre1"><a href="#calibre_link-79">Input/output</a></p>
<p class="calibre1"><a href="#calibre_link-79">135</a></p>
<p class="calibre1"><a href="#calibre_link-80">DateFormula</a></p>
<p class="calibre1"><a href="#calibre_link-80">136</a></p>
<p class="calibre1"><a href="#calibre_link-81">References and other data types</a></p>
<p class="calibre1"><a href="#calibre_link-81">141</a></p>
<p class="calibre1"><a href="#calibre_link-82">Data type usage</a></p>
<p class="calibre1"><a href="#calibre_link-82">143</a></p>
<p class="calibre1"><a href="#calibre_link-83"><b class="calibre3">FieldClass property options</b></a></p>
<p class="calibre1"><a href="#calibre_link-83">145</a></p>
<p class="calibre1"><a href="#calibre_link-83">FieldClass &ndash; Normal</a></p>
<p class="calibre1"><a href="#calibre_link-83">145</a></p>
<p class="calibre1"><a href="#calibre_link-83">FieldClass &ndash; FlowField</a></p>
<p class="calibre1"><a href="#calibre_link-83">145</a></p>
<p class="calibre1"><a href="#calibre_link-84">FieldClass &ndash; FlowFilter</a></p>
<p class="calibre1"><a href="#calibre_link-84">148</a></p>
<p class="calibre1"><a href="#calibre_link-85">FlowFields and FlowFilter for our application</a></p>
<p class="calibre1"><a href="#calibre_link-85">150</a></p>
<p class="calibre1"><a href="#calibre_link-86"><b class="calibre3">Filtering</b></a></p>
<p class="calibre1"><a href="#calibre_link-86">153</a></p>
<p class="calibre1"><a href="#calibre_link-87">Experimenting with filters</a></p>
<p class="calibre1"><a href="#calibre_link-87">154</a></p>
<p class="calibre1"><a href="#calibre_link-88">Accessing filter controls</a></p>
<p class="calibre1"><a href="#calibre_link-88">161</a></p>
<p class="calibre1"><a href="#calibre_link-89"><b class="calibre3">Summary</b></a></p>
<p class="calibre1"><a href="#calibre_link-89">162</a></p>
<p class="calibre1"><a href="#calibre_link-90"><b class="calibre3">Questions</b></a></p>
<p class="calibre1"><a href="#calibre_link-90">163</a></p>
<p class="calibre1"><a href="#calibre_link-91"><b class="calibre3">Chapter 4: Pages - The Interactive Interface</b></a></p>
<p class="calibre1"><a href="#calibre_link-91">166</a></p>
<p class="calibre1"><a href="#calibre_link-92"><b class="calibre3">Page design and structure overview</b></a></p>
<p class="calibre1"><a href="#calibre_link-92">167</a></p>
<p class="calibre1"><a href="#calibre_link-92">Page design guidelines</a></p>
<p class="calibre1"><a href="#calibre_link-92">167</a></p>
<p class="calibre1"><a href="#calibre_link-93">Business Central page structure</a></p>
<p class="calibre1"><a href="#calibre_link-93">168</a></p>
<p class="calibre1"><a href="#calibre_link-94"><b class="calibre3">Types of pages</b></a></p>
<p class="calibre1"><a href="#calibre_link-94">171</a></p>
<p class="calibre1"><b class="calibre3">[ iii ]</b></p>
<p class="calibre1"><a id="calibre_link-420"></a> <i class="calibre4">Table of Contents</i></p>
<p class="calibre1"><a href="#calibre_link-94">Role Center page</a></p>
<p class="calibre1"><a href="#calibre_link-94">171</a></p>
<p class="calibre1"><a href="#calibre_link-95">HeadlinePart page</a></p>
<p class="calibre1"><a href="#calibre_link-95">173</a></p>
<p class="calibre1"><a href="#calibre_link-95">List page</a></p>
<p class="calibre1"><a href="#calibre_link-95">173</a></p>
<p class="calibre1"><a href="#calibre_link-96">Card page</a></p>
<p class="calibre1"><a href="#calibre_link-96">175</a></p>
<p class="calibre1"><a href="#calibre_link-96">Document page</a></p>
<p class="calibre1"><a href="#calibre_link-96">175</a></p>
<p class="calibre1"><a href="#calibre_link-97">FastTabs</a></p>
<p class="calibre1"><a href="#calibre_link-97">176</a></p>
<p class="calibre1"><a href="#calibre_link-98">List Plus page</a></p>
<p class="calibre1"><a href="#calibre_link-98">177</a></p>
<p class="calibre1"><a href="#calibre_link-99">Worksheet (journal) page</a></p>
<p class="calibre1"><a href="#calibre_link-99">178</a></p>
<p class="calibre1"><a href="#calibre_link-100">ConfirmationDialog page</a></p>
<p class="calibre1"><a href="#calibre_link-100">179</a></p>
<p class="calibre1"><a href="#calibre_link-100">StandardDialog page</a></p>
<p class="calibre1"><a href="#calibre_link-100">179</a></p>
<p class="calibre1"><a href="#calibre_link-101">Navigate page</a></p>
<p class="calibre1"><a href="#calibre_link-101">180</a></p>
<p class="calibre1"><a href="#calibre_link-102">Navigate function</a></p>
<p class="calibre1"><a href="#calibre_link-102">181</a></p>
<p class="calibre1"><a href="#calibre_link-103">Request page</a></p>
<p class="calibre1"><a href="#calibre_link-103">182</a></p>
<p class="calibre1"><a href="#calibre_link-103">Page parts</a></p>
<p class="calibre1"><a href="#calibre_link-103">182</a></p>
<p class="calibre1"><a href="#calibre_link-104">FactBox area</a></p>
<p class="calibre1"><a href="#calibre_link-104">183</a></p>
<p class="calibre1"><a href="#calibre_link-104">Card Parts and List Parts</a></p>
<p class="calibre1"><a href="#calibre_link-104">183</a></p>
<p class="calibre1"><a href="#calibre_link-105">Charts</a></p>
<p class="calibre1"><a href="#calibre_link-105">184</a></p>
<p class="calibre1"><a href="#calibre_link-106">Page names</a></p>
<p class="calibre1"><a href="#calibre_link-106">185</a></p>
<p class="calibre1"><a href="#calibre_link-107"><b class="calibre3">In-client designer</b></a></p>
<p class="calibre1"><a href="#calibre_link-107">186</a></p>
<p class="calibre1"><a href="#calibre_link-108">Designer</a></p>
<p class="calibre1"><a href="#calibre_link-108">187</a></p>
<p class="calibre1"><a href="#calibre_link-109"><b class="calibre3">Page components</b></a></p>
<p class="calibre1"><a href="#calibre_link-109">190</a></p>
<p class="calibre1"><a href="#calibre_link-110">Page triggers</a></p>
<p class="calibre1"><a href="#calibre_link-110">191</a></p>
<p class="calibre1"><a href="#calibre_link-111">Page properties</a></p>
<p class="calibre1"><a href="#calibre_link-111">192</a></p>
<p class="calibre1"><a href="#calibre_link-112">Inheritance</a></p>
<p class="calibre1"><a href="#calibre_link-112">194</a></p>
<p class="calibre1"><a href="#calibre_link-113"><b class="calibre3">WDTU page enhancement &ndash; part 1</b></a></p>
<p class="calibre1"><a href="#calibre_link-113">195</a></p>
<p class="calibre1"><a href="#calibre_link-114"><b class="calibre3">Page controls</b></a></p>
<p class="calibre1"><a href="#calibre_link-114">199</a></p>
<p class="calibre1"><a href="#calibre_link-115">Control types</a></p>
<p class="calibre1"><a href="#calibre_link-115">201</a></p>
<p class="calibre1"><a href="#calibre_link-116">Container controls</a></p>
<p class="calibre1"><a href="#calibre_link-116">202</a></p>
<p class="calibre1"><a href="#calibre_link-116">group controls</a></p>
<p class="calibre1"><a href="#calibre_link-116">202</a></p>
<p class="calibre1"><a href="#calibre_link-117">Field controls</a></p>
<p class="calibre1"><a href="#calibre_link-117">207</a></p>
<p class="calibre1"><a href="#calibre_link-118">Page part controls</a></p>
<p class="calibre1"><a href="#calibre_link-118">210</a></p>
<p class="calibre1"><a href="#calibre_link-119">Page control triggers</a></p>
<p class="calibre1"><a href="#calibre_link-119">211</a></p>
<p class="calibre1"><a href="#calibre_link-120">Bound and unbound pages</a></p>
<p class="calibre1"><a href="#calibre_link-120">212</a></p>
<p class="calibre1"><a href="#calibre_link-120"><b class="calibre3">WDTU page enhancement &ndash; part 2</b></a></p>
<p class="calibre1"><a href="#calibre_link-120">212</a></p>
<p class="calibre1"><a href="#calibre_link-121"><b class="calibre3">Page actions</b></a></p>
<p class="calibre1"><a href="#calibre_link-121">214</a></p>
<p class="calibre1"><a href="#calibre_link-122">Page action types and subtypes</a></p>
<p class="calibre1"><a href="#calibre_link-122">217</a></p>
<p class="calibre1"><a href="#calibre_link-123">Action groups</a></p>
<p class="calibre1"><a href="#calibre_link-123">218</a></p>
<p class="calibre1"><a href="#calibre_link-124">Navigation pane button actions</a></p>
<p class="calibre1"><a href="#calibre_link-124">220</a></p>
<p class="calibre1"><a href="#calibre_link-125">Actions summary</a></p>
<p class="calibre1"><a href="#calibre_link-125">221</a></p>
<p class="calibre1"><a href="#calibre_link-126"><b class="calibre3">Learning more</b></a></p>
<p class="calibre1"><a href="#calibre_link-126">222</a></p>
<p class="calibre1"><a href="#calibre_link-126">Patterns and creative plagiarism</a></p>
<p class="calibre1"><a href="#calibre_link-126">222</a></p>
<p class="calibre1"><a href="#calibre_link-127">Experimenting on your own</a></p>
<p class="calibre1"><a href="#calibre_link-127">223</a></p>
<p class="calibre1"><a href="#calibre_link-128">Experimentation</a></p>
<p class="calibre1"><a href="#calibre_link-128">224</a></p>
<p class="calibre1"><a href="#calibre_link-129"><b class="calibre3">Summary</b></a></p>
<p class="calibre1"><a href="#calibre_link-129">226</a></p>
<p class="calibre1"><a href="#calibre_link-129"><b class="calibre3">Questions</b></a></p>
<p class="calibre1"><a href="#calibre_link-129">226</a></p>
<p class="calibre1"><b class="calibre3">[ iv ]</b></p>
<p class="calibre1"><a id="calibre_link-421"></a> <i class="calibre4">Table of Contents</i></p>
<p class="calibre1"><a href="#calibre_link-130"><b class="calibre3">Chapter 5: Queries and Reports</b></a></p>
<p class="calibre1"><a href="#calibre_link-130">229</a></p>
<p class="calibre1"><a href="#calibre_link-131"><b class="calibre3">Queries</b></a></p>
<p class="calibre1"><a href="#calibre_link-131">230</a></p>
<p class="calibre1"><a href="#calibre_link-132">Building a simple query</a></p>
<p class="calibre1"><a href="#calibre_link-132">231</a></p>
<p class="calibre1"><a href="#calibre_link-133">Query and query component properties</a></p>
<p class="calibre1"><a href="#calibre_link-133">237</a></p>
<p class="calibre1"><a href="#calibre_link-133">Query properties</a></p>
<p class="calibre1"><a href="#calibre_link-133">237</a></p>
<p class="calibre1"><a href="#calibre_link-134">DataItem properties</a></p>
<p class="calibre1"><a href="#calibre_link-134">238</a></p>
<p class="calibre1"><a href="#calibre_link-134">Column properties</a></p>
<p class="calibre1"><a href="#calibre_link-134">238</a></p>
<p class="calibre1"><a href="#calibre_link-135"><b class="calibre3">Reports</b></a></p>
<p class="calibre1"><a href="#calibre_link-135">239</a></p>
<p class="calibre1"><a href="#calibre_link-135">What is a report? </a></p>
<p class="calibre1"><a href="#calibre_link-135">239</a></p>
<p class="calibre1"><a href="#calibre_link-136">Four Business Central report designers</a></p>
<p class="calibre1"><a href="#calibre_link-136">240</a></p>
<p class="calibre1"><a href="#calibre_link-137">Business Central report types</a></p>
<p class="calibre1"><a href="#calibre_link-137">242</a></p>
<p class="calibre1"><a href="#calibre_link-138">Report types summarized</a></p>
<p class="calibre1"><a href="#calibre_link-138">246</a></p>
<p class="calibre1"><a href="#calibre_link-139">Report naming</a></p>
<p class="calibre1"><a href="#calibre_link-139">247</a></p>
<p class="calibre1"><a href="#calibre_link-139"><b class="calibre3">Report components &ndash; overview</b></a></p>
<p class="calibre1"><a href="#calibre_link-139">247</a></p>
<p class="calibre1"><a href="#calibre_link-140">Report structure</a></p>
<p class="calibre1"><a href="#calibre_link-140">248</a></p>
<p class="calibre1"><a href="#calibre_link-141">Report data overview</a></p>
<p class="calibre1"><a href="#calibre_link-141">249</a></p>
<p class="calibre1"><a href="#calibre_link-142">Report layout overview</a></p>
<p class="calibre1"><a href="#calibre_link-142">250</a></p>
<p class="calibre1"><a href="#calibre_link-143"><b class="calibre3">Report data flow</b></a></p>
<p class="calibre1"><a href="#calibre_link-143">251</a></p>
<p class="calibre1"><a href="#calibre_link-144">Report components &ndash; detail</a></p>
<p class="calibre1"><a href="#calibre_link-144">254</a></p>
<p class="calibre1"><a href="#calibre_link-144">Report properties</a></p>
<p class="calibre1"><a href="#calibre_link-144">254</a></p>
<p class="calibre1"><a href="#calibre_link-145">Microsoft Word &ndash; report properties</a></p>
<p class="calibre1"><a href="#calibre_link-145">256</a></p>
<p class="calibre1"><a href="#calibre_link-146">Report triggers</a></p>
<p class="calibre1"><a href="#calibre_link-146">257</a></p>
<p class="calibre1"><a href="#calibre_link-147">Request page properties</a></p>
<p class="calibre1"><a href="#calibre_link-147">258</a></p>
<p class="calibre1"><a href="#calibre_link-147">Request page triggers</a></p>
<p class="calibre1"><a href="#calibre_link-147">258</a></p>
<p class="calibre1"><a href="#calibre_link-148">DataItem properties</a></p>
<p class="calibre1"><a href="#calibre_link-148">259</a></p>
<p class="calibre1"><a href="#calibre_link-149">DataItem triggers</a></p>
<p class="calibre1"><a href="#calibre_link-149">261</a></p>
<p class="calibre1"><a href="#calibre_link-149"><b class="calibre3">Creating a report in Business Central</b></a></p>
<p class="calibre1"><a href="#calibre_link-149">261</a></p>
<p class="calibre1"><a href="#calibre_link-150">Learn by experimentation</a></p>
<p class="calibre1"><a href="#calibre_link-150">262</a></p>
<p class="calibre1"><a href="#calibre_link-150">Report building &ndash; phase 1</a></p>
<p class="calibre1"><a href="#calibre_link-150">262</a></p>
<p class="calibre1"><a href="#calibre_link-151">Report building &ndash; phase 2</a></p>
<p class="calibre1"><a href="#calibre_link-151">265</a></p>
<p class="calibre1"><a href="#calibre_link-152">Report building &ndash; phase 3</a></p>
<p class="calibre1"><a href="#calibre_link-152">268</a></p>
<p class="calibre1"><a href="#calibre_link-153">Modifying an existing report with Report Designer or Word</a></p>
<p class="calibre1"><a href="#calibre_link-153">271</a></p>
<p class="calibre1"><a href="#calibre_link-154">Request page</a></p>
<p class="calibre1"><a href="#calibre_link-154">272</a></p>
<p class="calibre1"><a href="#calibre_link-155">Adding a request page option</a></p>
<p class="calibre1"><a href="#calibre_link-155">274</a></p>
<p class="calibre1"><a href="#calibre_link-156">Processing-only reports</a></p>
<p class="calibre1"><a href="#calibre_link-156">277</a></p>
<p class="calibre1"><a href="#calibre_link-156">Creative report plagiarism and patterns</a></p>
<p class="calibre1"><a href="#calibre_link-156">277</a></p>
<p class="calibre1"><a href="#calibre_link-157"><b class="calibre3">Summary</b></a></p>
<p class="calibre1"><a href="#calibre_link-157">278</a></p>
<p class="calibre1"><a href="#calibre_link-158"><b class="calibre3">Questions</b></a></p>
<p class="calibre1"><a href="#calibre_link-158">279</a></p>
<p class="calibre1"><a href="#calibre_link-159"><b class="calibre3">Chapter 6: Introduction to AL</b></a></p>
<p class="calibre1"><a href="#calibre_link-159">281</a></p>
<p class="calibre1"><a href="#calibre_link-160"><b class="calibre3">Understanding Visual Studio Code</b></a></p>
<p class="calibre1"><a href="#calibre_link-160">282</a></p>
<p class="calibre1"><a href="#calibre_link-160">Explorer</a></p>
<p class="calibre1"><a href="#calibre_link-160">282</a></p>
<p class="calibre1"><a href="#calibre_link-161">Starting a new object</a></p>
<p class="calibre1"><a href="#calibre_link-161">284</a></p>
<p class="calibre1"><a href="#calibre_link-162">Object designer navigation</a></p>
<p class="calibre1"><a href="#calibre_link-162">285</a></p>
<p class="calibre1"><a href="#calibre_link-163">Some AL naming conventions</a></p>
<p class="calibre1"><a href="#calibre_link-163">286</a></p>
<p class="calibre1"><a href="#calibre_link-164">Variables</a></p>
<p class="calibre1"><a href="#calibre_link-164">287</a></p>
<p class="calibre1"><a href="#calibre_link-165">AL Globals</a></p>
<p class="calibre1"><a href="#calibre_link-165">288</a></p>
<p class="calibre1"><b class="calibre3">[ v ]</b></p>
<p class="calibre1"><a id="calibre_link-422"></a> <i class="calibre4">Table of Contents</i></p>
<p class="calibre1"><a href="#calibre_link-165">AL Locals</a></p>
<p class="calibre1"><a href="#calibre_link-165">288</a></p>
<p class="calibre1"><a href="#calibre_link-166">Special working storage variables</a></p>
<p class="calibre1"><a href="#calibre_link-166">289</a></p>
<p class="calibre1"><a href="#calibre_link-167">AL programming</a></p>
<p class="calibre1"><a href="#calibre_link-167">292</a></p>
<p class="calibre1"><a href="#calibre_link-168">Non-modifiable procedures</a></p>
<p class="calibre1"><a href="#calibre_link-168">293</a></p>
<p class="calibre1"><a href="#calibre_link-168">Modifiable procedures</a></p>
<p class="calibre1"><a href="#calibre_link-168">293</a></p>
<p class="calibre1"><a href="#calibre_link-169">Custom procedures</a></p>
<p class="calibre1"><a href="#calibre_link-169">294</a></p>
<p class="calibre1"><a href="#calibre_link-170">Creating a procedure</a></p>
<p class="calibre1"><a href="#calibre_link-170">295</a></p>
<p class="calibre1"><a href="#calibre_link-171"><b class="calibre3">AL syntax</b></a></p>
<p class="calibre1"><a href="#calibre_link-171">297</a></p>
<p class="calibre1"><a href="#calibre_link-172">Assignment and punctuation</a></p>
<p class="calibre1"><a href="#calibre_link-172">298</a></p>
<p class="calibre1"><a href="#calibre_link-173">Expressions</a></p>
<p class="calibre1"><a href="#calibre_link-173">299</a></p>
<p class="calibre1"><a href="#calibre_link-174">Operators</a></p>
<p class="calibre1"><a href="#calibre_link-174">300</a></p>
<p class="calibre1"><a href="#calibre_link-175">Arithmetic operators and procedures</a></p>
<p class="calibre1"><a href="#calibre_link-175">302</a></p>
<p class="calibre1"><a href="#calibre_link-176">Boolean operators</a></p>
<p class="calibre1"><a href="#calibre_link-176">303</a></p>
<p class="calibre1"><a href="#calibre_link-176">Relational operators and procedures</a></p>
<p class="calibre1"><a href="#calibre_link-176">303</a></p>
<p class="calibre1"><a href="#calibre_link-177">Precedence of operators</a></p>
<p class="calibre1"><a href="#calibre_link-177">304</a></p>
<p class="calibre1"><a href="#calibre_link-178">Frequently used AL procedures</a></p>
<p class="calibre1"><a href="#calibre_link-178">305</a></p>
<p class="calibre1"><a href="#calibre_link-179">The MESSAGE procedure</a></p>
<p class="calibre1"><a href="#calibre_link-179">306</a></p>
<p class="calibre1"><a href="#calibre_link-180">The ERROR procedure</a></p>
<p class="calibre1"><a href="#calibre_link-180">307</a></p>
<p class="calibre1"><a href="#calibre_link-181">The CONFIRM procedure</a></p>
<p class="calibre1"><a href="#calibre_link-181">309</a></p>
<p class="calibre1"><a href="#calibre_link-182">The STRMENU procedure</a></p>
<p class="calibre1"><a href="#calibre_link-182">310</a></p>
<p class="calibre1"><a href="#calibre_link-183">Record procedures</a></p>
<p class="calibre1"><a href="#calibre_link-183">312</a></p>
<p class="calibre1"><a href="#calibre_link-183">The SETCURRENTKEY procedure</a></p>
<p class="calibre1"><a href="#calibre_link-183">312</a></p>
<p class="calibre1"><a href="#calibre_link-184">The SETRANGE procedure</a></p>
<p class="calibre1"><a href="#calibre_link-184">313</a></p>
<p class="calibre1"><a href="#calibre_link-184">The SETFILTER procedure</a></p>
<p class="calibre1"><a href="#calibre_link-184">313</a></p>
<p class="calibre1"><a href="#calibre_link-185">The GET procedure</a></p>
<p class="calibre1"><a href="#calibre_link-185">314</a></p>
<p class="calibre1"><a href="#calibre_link-186">FIND procedures</a></p>
<p class="calibre1"><a href="#calibre_link-186">315</a></p>
<p class="calibre1"><a href="#calibre_link-187">FIND ([Which]) options and the SQL Server alternatives</a></p>
<p class="calibre1"><a href="#calibre_link-187">316</a></p>
<p class="calibre1"><a href="#calibre_link-188">Conditional statements</a></p>
<p class="calibre1"><a href="#calibre_link-188">319</a></p>
<p class="calibre1"><a href="#calibre_link-188">The BEGIN-END compound statement</a></p>
<p class="calibre1"><a href="#calibre_link-188">319</a></p>
<p class="calibre1"><a href="#calibre_link-188">IF-THEN-ELSE statement</a></p>
<p class="calibre1"><a href="#calibre_link-188">319</a></p>
<p class="calibre1"><a href="#calibre_link-189">Indenting code</a></p>
<p class="calibre1"><a href="#calibre_link-189">320</a></p>
<p class="calibre1"><a href="#calibre_link-190"><b class="calibre3">Some simple coding modifications</b></a></p>
<p class="calibre1"><a href="#calibre_link-190">321</a></p>
<p class="calibre1"><a href="#calibre_link-190">Adding field validation to a table</a></p>
<p class="calibre1"><a href="#calibre_link-190">321</a></p>
<p class="calibre1"><a href="#calibre_link-191">Adding code to a report</a></p>
<p class="calibre1"><a href="#calibre_link-191">325</a></p>
<p class="calibre1"><a href="#calibre_link-192">Laying out the new Report Heading</a></p>
<p class="calibre1"><a href="#calibre_link-192">326</a></p>
<p class="calibre1"><a href="#calibre_link-192">Saving and testing</a></p>
<p class="calibre1"><a href="#calibre_link-192">326</a></p>
<p class="calibre1"><a href="#calibre_link-193">Lookup-related table data</a></p>
<p class="calibre1"><a href="#calibre_link-193">327</a></p>
<p class="calibre1"><a href="#calibre_link-194">Laying out the new report Body</a></p>
<p class="calibre1"><a href="#calibre_link-194">328</a></p>
<p class="calibre1"><a href="#calibre_link-194">Saving and testing</a></p>
<p class="calibre1"><a href="#calibre_link-194">328</a></p>
<p class="calibre1"><a href="#calibre_link-195">Handling user entered report options</a></p>
<p class="calibre1"><a href="#calibre_link-195">329</a></p>
<p class="calibre1"><a href="#calibre_link-196">Defining the Request Page</a></p>
<p class="calibre1"><a href="#calibre_link-196">331</a></p>
<p class="calibre1"><a href="#calibre_link-196">Finishing the processing code</a></p>
<p class="calibre1"><a href="#calibre_link-196">331</a></p>
<p class="calibre1"><a href="#calibre_link-197">Testing the completed report</a></p>
<p class="calibre1"><a href="#calibre_link-197">332</a></p>
<p class="calibre1"><a href="#calibre_link-198"><b class="calibre3">Summary</b></a></p>
<p class="calibre1"><a href="#calibre_link-198">334</a></p>
<p class="calibre1"><a href="#calibre_link-198"><b class="calibre3">Questions</b></a></p>
<p class="calibre1"><a href="#calibre_link-198">334</a></p>
<p class="calibre1"><a href="#calibre_link-199"><b class="calibre3">Chapter 7: Intermediate AL</b></a></p>
<p class="calibre1"><a href="#calibre_link-199">337</a></p>
<p class="calibre1"><a href="#calibre_link-200"><b class="calibre3">IntelliSense</b></a></p>
<p class="calibre1"><a href="#calibre_link-200">338</a></p>
<p class="calibre1"><a href="#calibre_link-201"><b class="calibre3">Internal documentation</b></a></p>
<p class="calibre1"><a href="#calibre_link-201">339</a></p>
<p class="calibre1"><b class="calibre3">[ vi ]</b></p>
<p class="calibre1"><a id="calibre_link-423"></a> <i class="calibre4">Table of Contents</i></p>
<p class="calibre1"><a href="#calibre_link-202"><b class="calibre3">Source code management</b></a></p>
<p class="calibre1"><a href="#calibre_link-202">341</a></p>
<p class="calibre1"><a href="#calibre_link-203"><b class="calibre3">Validation functions</b></a></p>
<p class="calibre1"><a href="#calibre_link-203">342</a></p>
<p class="calibre1"><a href="#calibre_link-203">TESTFIELD</a></p>
<p class="calibre1"><a href="#calibre_link-203">342</a></p>
<p class="calibre1"><a href="#calibre_link-204">FIELDERROR</a></p>
<p class="calibre1"><a href="#calibre_link-204">343</a></p>
<p class="calibre1"><a href="#calibre_link-205">INIT</a></p>
<p class="calibre1"><a href="#calibre_link-205">345</a></p>
<p class="calibre1"><a href="#calibre_link-205">VALIDATE</a></p>
<p class="calibre1"><a href="#calibre_link-205">345</a></p>
<p class="calibre1"><a href="#calibre_link-206"><b class="calibre3">Date and time functions</b></a></p>
<p class="calibre1"><a href="#calibre_link-206">346</a></p>
<p class="calibre1"><a href="#calibre_link-206">TODAY, TIME, and CURRENTDATETIME</a></p>
<p class="calibre1"><a href="#calibre_link-206">346</a></p>
<p class="calibre1"><a href="#calibre_link-207">WORKDATE</a></p>
<p class="calibre1"><a href="#calibre_link-207">347</a></p>
<p class="calibre1"><a href="#calibre_link-208">DATE2DMY function</a></p>
<p class="calibre1"><a href="#calibre_link-208">349</a></p>
<p class="calibre1"><a href="#calibre_link-208">DATE2DWY function</a></p>
<p class="calibre1"><a href="#calibre_link-208">349</a></p>
<p class="calibre1"><a href="#calibre_link-208">DMY2DATE and DWY2DATE functions</a></p>
<p class="calibre1"><a href="#calibre_link-208">349</a></p>
<p class="calibre1"><a href="#calibre_link-209">CALCDATE</a></p>
<p class="calibre1"><a href="#calibre_link-209">350</a></p>
<p class="calibre1"><a href="#calibre_link-210"><b class="calibre3">Data conversion and formatting functions</b></a></p>
<p class="calibre1"><a href="#calibre_link-210">351</a></p>
<p class="calibre1"><a href="#calibre_link-211">ROUND</a></p>
<p class="calibre1"><a href="#calibre_link-211">352</a></p>
<p class="calibre1"><a href="#calibre_link-212">FORMAT function</a></p>
<p class="calibre1"><a href="#calibre_link-212">353</a></p>
<p class="calibre1"><a href="#calibre_link-213">EVALUATE function</a></p>
<p class="calibre1"><a href="#calibre_link-213">354</a></p>
<p class="calibre1"><a href="#calibre_link-213"><b class="calibre3">FlowField and SumIndexField functions</b></a></p>
<p class="calibre1"><a href="#calibre_link-213">354</a></p>
<p class="calibre1"><a href="#calibre_link-214">CALCFIELDS function</a></p>
<p class="calibre1"><a href="#calibre_link-214">356</a></p>
<p class="calibre1"><a href="#calibre_link-215">SETAUTOCALCFIELDS function</a></p>
<p class="calibre1"><a href="#calibre_link-215">357</a></p>
<p class="calibre1"><a href="#calibre_link-215">CALCSUMS function</a></p>
<p class="calibre1"><a href="#calibre_link-215">357</a></p>
<p class="calibre1"><a href="#calibre_link-216">Comparing CALCFIELDS and CALCSUMS</a></p>
<p class="calibre1"><a href="#calibre_link-216">358</a></p>
<p class="calibre1"><a href="#calibre_link-217"><b class="calibre3">Flow control functions</b></a></p>
<p class="calibre1"><a href="#calibre_link-217">359</a></p>
<p class="calibre1"><a href="#calibre_link-217">REPEAT-UNTIL</a></p>
<p class="calibre1"><a href="#calibre_link-217">359</a></p>
<p class="calibre1"><a href="#calibre_link-218">WHILE-DO</a></p>
<p class="calibre1"><a href="#calibre_link-218">360</a></p>
<p class="calibre1"><a href="#calibre_link-218">FOR-TO or FOR-DOWNTO</a></p>
<p class="calibre1"><a href="#calibre_link-218">360</a></p>
<p class="calibre1"><a href="#calibre_link-219">CASE-ELSE statement</a></p>
<p class="calibre1"><a href="#calibre_link-219">361</a></p>
<p class="calibre1"><a href="#calibre_link-220">WITH-DO statement</a></p>
<p class="calibre1"><a href="#calibre_link-220">363</a></p>
<p class="calibre1"><a href="#calibre_link-221">QUIT, BREAK, EXIT, and SKIP functions</a></p>
<p class="calibre1"><a href="#calibre_link-221">364</a></p>
<p class="calibre1"><a href="#calibre_link-221">QUIT function</a></p>
<p class="calibre1"><a href="#calibre_link-221">364</a></p>
<p class="calibre1"><a href="#calibre_link-222">BREAK function</a></p>
<p class="calibre1"><a href="#calibre_link-222">365</a></p>
<p class="calibre1"><a href="#calibre_link-222">EXIT function</a></p>
<p class="calibre1"><a href="#calibre_link-222">365</a></p>
<p class="calibre1"><a href="#calibre_link-222">SKIP function</a></p>
<p class="calibre1"><a href="#calibre_link-222">365</a></p>
<p class="calibre1"><a href="#calibre_link-223"><b class="calibre3">Input and output functions</b></a></p>
<p class="calibre1"><a href="#calibre_link-223">366</a></p>
<p class="calibre1"><a href="#calibre_link-223">NEXT function with FIND or FINDSET</a></p>
<p class="calibre1"><a href="#calibre_link-223">366</a></p>
<p class="calibre1"><a href="#calibre_link-224">INSERT function</a></p>
<p class="calibre1"><a href="#calibre_link-224">367</a></p>
<p class="calibre1"><a href="#calibre_link-225">MODIFY function</a></p>
<p class="calibre1"><a href="#calibre_link-225">368</a></p>
<p class="calibre1"><a href="#calibre_link-225">Rec and xRec</a></p>
<p class="calibre1"><a href="#calibre_link-225">368</a></p>
<p class="calibre1"><a href="#calibre_link-225">DELETE function</a></p>
<p class="calibre1"><a href="#calibre_link-225">368</a></p>
<p class="calibre1"><a href="#calibre_link-226">MODIFYALL function</a></p>
<p class="calibre1"><a href="#calibre_link-226">369</a></p>
<p class="calibre1"><a href="#calibre_link-227">DELETEALL function</a></p>
<p class="calibre1"><a href="#calibre_link-227">370</a></p>
<p class="calibre1"><a href="#calibre_link-227"><b class="calibre3">Filtering</b></a></p>
<p class="calibre1"><a href="#calibre_link-227">370</a></p>
<p class="calibre1"><a href="#calibre_link-228">The SETFILTER function</a></p>
<p class="calibre1"><a href="#calibre_link-228">371</a></p>
<p class="calibre1"><a href="#calibre_link-229">The COPYFILTER and COPYFILTERS functions</a></p>
<p class="calibre1"><a href="#calibre_link-229">372</a></p>
<p class="calibre1"><a href="#calibre_link-229">The GETFILTER and GETFILTERS functions</a></p>
<p class="calibre1"><a href="#calibre_link-229">372</a></p>
<p class="calibre1"><b class="calibre3">[ vii ]</b></p>
<p class="calibre1"><a id="calibre_link-424"></a> <i class="calibre4">Table of Contents</i></p>
<p class="calibre1"><a href="#calibre_link-230">The FILTERGROUP function</a></p>
<p class="calibre1"><a href="#calibre_link-230">373</a></p>
<p class="calibre1"><a href="#calibre_link-231">The MARK function</a></p>
<p class="calibre1"><a href="#calibre_link-231">374</a></p>
<p class="calibre1"><a href="#calibre_link-231">CLEARMARKS function</a></p>
<p class="calibre1"><a href="#calibre_link-231">374</a></p>
<p class="calibre1"><a href="#calibre_link-231">The MARKEDONLY function</a></p>
<p class="calibre1"><a href="#calibre_link-231">374</a></p>
<p class="calibre1"><a href="#calibre_link-232">The RESET function</a></p>
<p class="calibre1"><a href="#calibre_link-232">375</a></p>
<p class="calibre1"><a href="#calibre_link-232"><b class="calibre3">InterObject communication</b></a></p>
<p class="calibre1"><a href="#calibre_link-232">375</a></p>
<p class="calibre1"><a href="#calibre_link-232">Communicating through data</a></p>
<p class="calibre1"><a href="#calibre_link-232">375</a></p>
<p class="calibre1"><a href="#calibre_link-233">Communicating through function parameters</a></p>
<p class="calibre1"><a href="#calibre_link-233">376</a></p>
<p class="calibre1"><a href="#calibre_link-233">Communication via object calls</a></p>
<p class="calibre1"><a href="#calibre_link-233">376</a></p>
<p class="calibre1"><a href="#calibre_link-234"><b class="calibre3">Enhancing the WDTU application</b></a></p>
<p class="calibre1"><a href="#calibre_link-234">377</a></p>
<p class="calibre1"><a href="#calibre_link-235">Modifying table fields</a></p>
<p class="calibre1"><a href="#calibre_link-235">378</a></p>
<p class="calibre1"><a href="#calibre_link-236">Adding validation logic</a></p>
<p class="calibre1"><a href="#calibre_link-236">380</a></p>
<p class="calibre1"><a href="#calibre_link-236">Playlist Header validation</a></p>
<p class="calibre1"><a href="#calibre_link-236">380</a></p>
<p class="calibre1"><a href="#calibre_link-237">Creating the Playlist subpage</a></p>
<p class="calibre1"><a href="#calibre_link-237">382</a></p>
<p class="calibre1"><a href="#calibre_link-238">Playlist Line validations</a></p>
<p class="calibre1"><a href="#calibre_link-238">385</a></p>
<p class="calibre1"><a href="#calibre_link-239">Creating a function for our FactBox</a></p>
<p class="calibre1"><a href="#calibre_link-239">388</a></p>
<p class="calibre1"><a href="#calibre_link-240">Creating a FactBox page</a></p>
<p class="calibre1"><a href="#calibre_link-240">390</a></p>
<p class="calibre1"><a href="#calibre_link-241"><b class="calibre3">Summary</b></a></p>
<p class="calibre1"><a href="#calibre_link-241">393</a></p>
<p class="calibre1"><a href="#calibre_link-242"><b class="calibre3">Questions</b></a></p>
<p class="calibre1"><a href="#calibre_link-242">394</a></p>
<p class="calibre1"><a href="#calibre_link-243"><b class="calibre3">Chapter 8: Advanced AL Development Tools</b></a></p>
<p class="calibre1"><a href="#calibre_link-243">396</a></p>
<p class="calibre1"><a href="#calibre_link-244"><b class="calibre3">Business Central process flow</b></a></p>
<p class="calibre1"><a href="#calibre_link-244">397</a></p>
<p class="calibre1"><a href="#calibre_link-245">Initial setup and data preparation</a></p>
<p class="calibre1"><a href="#calibre_link-245">399</a></p>
<p class="calibre1"><a href="#calibre_link-245">Transaction entry</a></p>
<p class="calibre1"><a href="#calibre_link-245">399</a></p>
<p class="calibre1"><a href="#calibre_link-245">Testing and posting the Journal batch</a></p>
<p class="calibre1"><a href="#calibre_link-245">399</a></p>
<p class="calibre1"><a href="#calibre_link-246">Utilizing and maintaining the data</a></p>
<p class="calibre1"><a href="#calibre_link-246">400</a></p>
<p class="calibre1"><a href="#calibre_link-247">Data maintenance</a></p>
<p class="calibre1"><a href="#calibre_link-247">401</a></p>
<p class="calibre1"><a href="#calibre_link-247"><b class="calibre3">Role Center pages</b></a></p>
<p class="calibre1"><a href="#calibre_link-247">401</a></p>
<p class="calibre1"><a href="#calibre_link-247">Role Center structure</a></p>
<p class="calibre1"><a href="#calibre_link-247">401</a></p>
<p class="calibre1"><a href="#calibre_link-248">Role Center headlines page</a></p>
<p class="calibre1"><a href="#calibre_link-248">404</a></p>
<p class="calibre1"><a href="#calibre_link-249">Role Center activities page</a></p>
<p class="calibre1"><a href="#calibre_link-249">405</a></p>
<p class="calibre1"><a href="#calibre_link-249">Cue groups and cues</a></p>
<p class="calibre1"><a href="#calibre_link-249">405</a></p>
<p class="calibre1"><a href="#calibre_link-250">System part</a></p>
<p class="calibre1"><a href="#calibre_link-250">409</a></p>
<p class="calibre1"><a href="#calibre_link-250">Page parts</a></p>
<p class="calibre1"><a href="#calibre_link-250">409</a></p>
<p class="calibre1"><a href="#calibre_link-251">Page parts not visible</a></p>
<p class="calibre1"><a href="#calibre_link-251">411</a></p>
<p class="calibre1"><a href="#calibre_link-251">Page parts for user data</a></p>
<p class="calibre1"><a href="#calibre_link-251">411</a></p>
<p class="calibre1"><a href="#calibre_link-252">Navigation pane and action menus</a></p>
<p class="calibre1"><a href="#calibre_link-252">412</a></p>
<p class="calibre1"><a href="#calibre_link-253">Action Designer</a></p>
<p class="calibre1"><a href="#calibre_link-253">414</a></p>
<p class="calibre1"><a href="#calibre_link-254">Creating a WDTU Role Center ribbon</a></p>
<p class="calibre1"><a href="#calibre_link-254">415</a></p>
<p class="calibre1"><a href="#calibre_link-255"><b class="calibre3">XMLports</b></a></p>
<p class="calibre1"><a href="#calibre_link-255">417</a></p>
<p class="calibre1"><a href="#calibre_link-256">XMLport components</a></p>
<p class="calibre1"><a href="#calibre_link-256">419</a></p>
<p class="calibre1"><a href="#calibre_link-256">XMLport properties</a></p>
<p class="calibre1"><a href="#calibre_link-256">419</a></p>
<p class="calibre1"><a href="#calibre_link-257">XMLport triggers</a></p>
<p class="calibre1"><a href="#calibre_link-257">422</a></p>
<p class="calibre1"><a href="#calibre_link-258">XMLport data lines</a></p>
<p class="calibre1"><a href="#calibre_link-258">423</a></p>
<p class="calibre1"><a href="#calibre_link-259">The XMLport line properties</a></p>
<p class="calibre1"><a href="#calibre_link-259">424</a></p>
<p class="calibre1"><a href="#calibre_link-260">SourceType as text</a></p>
<p class="calibre1"><a href="#calibre_link-260">425</a></p>
<p class="calibre1"><a href="#calibre_link-260">SourceType as table</a></p>
<p class="calibre1"><a href="#calibre_link-260">425</a></p>
<p class="calibre1"><b class="calibre3">[ viii ]</b></p>
<p class="calibre1"><a id="calibre_link-425"></a> <i class="calibre4">Table of Contents</i></p>
<p class="calibre1"><a href="#calibre_link-261">SourceType as field</a></p>
<p class="calibre1"><a href="#calibre_link-261">426</a></p>
<p class="calibre1"><a href="#calibre_link-262">Element or attribute</a></p>
<p class="calibre1"><a href="#calibre_link-262">427</a></p>
<p class="calibre1"><a href="#calibre_link-262">NodeType element data item</a></p>
<p class="calibre1"><a href="#calibre_link-262">427</a></p>
<p class="calibre1"><a href="#calibre_link-262">NodeType attribute data item</a></p>
<p class="calibre1"><a href="#calibre_link-262">427</a></p>
<p class="calibre1"><a href="#calibre_link-262">XMLport line triggers</a></p>
<p class="calibre1"><a href="#calibre_link-262">427</a></p>
<p class="calibre1"><a href="#calibre_link-262">DataType as text</a></p>
<p class="calibre1"><a href="#calibre_link-262">427</a></p>
<p class="calibre1"><a href="#calibre_link-263">DataType as Table</a></p>
<p class="calibre1"><a href="#calibre_link-263">428</a></p>
<p class="calibre1"><a href="#calibre_link-263">DataType as Field</a></p>
<p class="calibre1"><a href="#calibre_link-263">428</a></p>
<p class="calibre1"><a href="#calibre_link-264">XMLport Request Pages</a></p>
<p class="calibre1"><a href="#calibre_link-264">429</a></p>
<p class="calibre1"><a href="#calibre_link-264"><b class="calibre3">Web services</b></a></p>
<p class="calibre1"><a href="#calibre_link-264">429</a></p>
<p class="calibre1"><a href="#calibre_link-265">Exposing a web service</a></p>
<p class="calibre1"><a href="#calibre_link-265">431</a></p>
<p class="calibre1"><a href="#calibre_link-266">Publishing a web service</a></p>
<p class="calibre1"><a href="#calibre_link-266">432</a></p>
<p class="calibre1"><a href="#calibre_link-267">Enabling web services</a></p>
<p class="calibre1"><a href="#calibre_link-267">433</a></p>
<p class="calibre1"><a href="#calibre_link-267">Determining what was published</a></p>
<p class="calibre1"><a href="#calibre_link-267">433</a></p>
<p class="calibre1"><a href="#calibre_link-268">XMLport &ndash; web services integration example for WDTU</a></p>
<p class="calibre1"><a href="#calibre_link-268">436</a></p>
<p class="calibre1"><a href="#calibre_link-269"><b class="calibre3">Summary</b></a></p>
<p class="calibre1"><a href="#calibre_link-269">440</a></p>
<p class="calibre1"><a href="#calibre_link-269"><b class="calibre3">Questions</b></a></p>
<p class="calibre1"><a href="#calibre_link-269">440</a></p>
<p class="calibre1"><a href="#calibre_link-270"><b class="calibre3">Chapter 9: Successful Conclusions</b></a></p>
<p class="calibre1"><a href="#calibre_link-270">443</a></p>
<p class="calibre1"><a href="#calibre_link-271"><b class="calibre3">Creating new AL routines</b></a></p>
<p class="calibre1"><a href="#calibre_link-271">444</a></p>
<p class="calibre1"><a href="#calibre_link-272">Callable functions</a></p>
<p class="calibre1"><a href="#calibre_link-272">445</a></p>
<p class="calibre1"><a href="#calibre_link-272">Codeunit 358 &ndash; DateFilterCalc</a></p>
<p class="calibre1"><a href="#calibre_link-272">445</a></p>
<p class="calibre1"><a href="#calibre_link-273">Codeunit 359 &ndash; Period Form Management</a></p>
<p class="calibre1"><a href="#calibre_link-273">447</a></p>
<p class="calibre1"><a href="#calibre_link-273">FindDate function</a></p>
<p class="calibre1"><a href="#calibre_link-273">447</a></p>
<p class="calibre1"><a href="#calibre_link-274">NextDate function</a></p>
<p class="calibre1"><a href="#calibre_link-274">448</a></p>
<p class="calibre1"><a href="#calibre_link-275">CreatePeriodFormat function</a></p>
<p class="calibre1"><a href="#calibre_link-275">449</a></p>
<p class="calibre1"><a href="#calibre_link-275">Codeunit 365 &ndash; Format Address</a></p>
<p class="calibre1"><a href="#calibre_link-275">449</a></p>
<p class="calibre1"><a href="#calibre_link-276">Codeunit 396 &ndash; NoSeriesManagement</a></p>
<p class="calibre1"><a href="#calibre_link-276">451</a></p>
<p class="calibre1"><a href="#calibre_link-277">Function models to review and use</a></p>
<p class="calibre1"><a href="#calibre_link-277">452</a></p>
<p class="calibre1"><a href="#calibre_link-278">Management codeunits</a></p>
<p class="calibre1"><a href="#calibre_link-278">453</a></p>
<p class="calibre1"><a href="#calibre_link-279"><b class="calibre3">Multi-language system</b></a></p>
<p class="calibre1"><a href="#calibre_link-279">454</a></p>
<p class="calibre1"><a href="#calibre_link-280"><b class="calibre3">Multi-currency system</b></a></p>
<p class="calibre1"><a href="#calibre_link-280">455</a></p>
<p class="calibre1"><a href="#calibre_link-281"><b class="calibre3">Navigate</b></a></p>
<p class="calibre1"><a href="#calibre_link-281">456</a></p>
<p class="calibre1"><a href="#calibre_link-282">Modifying for Navigate</a></p>
<p class="calibre1"><a href="#calibre_link-282">458</a></p>
<p class="calibre1"><a href="#calibre_link-283"><b class="calibre3">Debugging in Business Central</b></a></p>
<p class="calibre1"><a href="#calibre_link-283">459</a></p>
<p class="calibre1"><a href="#calibre_link-284">Dialog function debugging techniques</a></p>
<p class="calibre1"><a href="#calibre_link-284">460</a></p>
<p class="calibre1"><a href="#calibre_link-284">Debugging with MESSAGE and CONFIRM</a></p>
<p class="calibre1"><a href="#calibre_link-284">460</a></p>
<p class="calibre1"><a href="#calibre_link-285">Debugging with DIALOG</a></p>
<p class="calibre1"><a href="#calibre_link-285">461</a></p>
<p class="calibre1"><a href="#calibre_link-286">Debugging with text output</a></p>
<p class="calibre1"><a href="#calibre_link-286">462</a></p>
<p class="calibre1"><a href="#calibre_link-286">Debugging with ERROR</a></p>
<p class="calibre1"><a href="#calibre_link-286">462</a></p>
<p class="calibre1"><a href="#calibre_link-287">The Business Central debugger</a></p>
<p class="calibre1"><a href="#calibre_link-287">463</a></p>
<p class="calibre1"><a href="#calibre_link-287">Activating the debugger</a></p>
<p class="calibre1"><a href="#calibre_link-287">463</a></p>
<p class="calibre1"><a href="#calibre_link-288">Creating break events</a></p>
<p class="calibre1"><a href="#calibre_link-288">464</a></p>
<p class="calibre1"><a href="#calibre_link-289">The debugger window</a></p>
<p class="calibre1"><a href="#calibre_link-289">465</a></p>
<p class="calibre1"><a href="#calibre_link-290"><b class="calibre3">Visual Studio Code test-driven development</b></a></p>
<p class="calibre1"><a href="#calibre_link-290">466</a></p>
<p class="calibre1"><a href="#calibre_link-291"><b class="calibre3">Other interfaces</b></a></p>
<p class="calibre1"><a href="#calibre_link-291">469</a></p>
<p class="calibre1"><a href="#calibre_link-292"><b class="calibre3">Client Add-ins</b></a></p>
<p class="calibre1"><a href="#calibre_link-292">470</a></p>
<p class="calibre1"><a href="#calibre_link-293">Client Add-in comments</a></p>
<p class="calibre1"><a href="#calibre_link-293">471</a></p>
<p class="calibre1"><b class="calibre3">[ ix ]</b></p>
<p class="calibre1"><a id="calibre_link-426"></a> <i class="calibre4">Table of Contents</i></p>
<p class="calibre1"><a href="#calibre_link-293"><b class="calibre3">Business Central development projects &ndash; general guidance</b></a></p>
<p class="calibre1"><a href="#calibre_link-293">471</a></p>
<p class="calibre1"><a href="#calibre_link-294">Knowledge is key</a></p>
<p class="calibre1"><a href="#calibre_link-294">472</a></p>
<p class="calibre1"><a href="#calibre_link-294">Data-focused design</a></p>
<p class="calibre1"><a href="#calibre_link-294">472</a></p>
<p class="calibre1"><a href="#calibre_link-294">Defining the required data views</a></p>
<p class="calibre1"><a href="#calibre_link-294">472</a></p>
<p class="calibre1"><a href="#calibre_link-295">Designing the data tables</a></p>
<p class="calibre1"><a href="#calibre_link-295">473</a></p>
<p class="calibre1"><a href="#calibre_link-295">Designing the user data access interface</a></p>
<p class="calibre1"><a href="#calibre_link-295">473</a></p>
<p class="calibre1"><a href="#calibre_link-296">Designing the data validation</a></p>
<p class="calibre1"><a href="#calibre_link-296">474</a></p>
<p class="calibre1"><a href="#calibre_link-296">Data design review and revision</a></p>
<p class="calibre1"><a href="#calibre_link-296">474</a></p>
<p class="calibre1"><a href="#calibre_link-297">Designing the Posting processes</a></p>
<p class="calibre1"><a href="#calibre_link-297">475</a></p>
<p class="calibre1"><a href="#calibre_link-297">Designing the supporting processes</a></p>
<p class="calibre1"><a href="#calibre_link-297">475</a></p>
<p class="calibre1"><a href="#calibre_link-297">Double-check everything</a></p>
<p class="calibre1"><a href="#calibre_link-297">475</a></p>
<p class="calibre1"><a href="#calibre_link-298"><b class="calibre3">Designing for efficiency</b></a></p>
<p class="calibre1"><a href="#calibre_link-298">476</a></p>
<p class="calibre1"><a href="#calibre_link-298">Disk I/O</a></p>
<p class="calibre1"><a href="#calibre_link-298">476</a></p>
<p class="calibre1"><a href="#calibre_link-299">Locking</a></p>
<p class="calibre1"><a href="#calibre_link-299">477</a></p>
<p class="calibre1"><a href="#calibre_link-300"><b class="calibre3">Updating and upgrading</b></a></p>
<p class="calibre1"><a href="#calibre_link-300">478</a></p>
<p class="calibre1"><a href="#calibre_link-301">Design for updating</a></p>
<p class="calibre1"><a href="#calibre_link-301">479</a></p>
<p class="calibre1"><a href="#calibre_link-301">Customization project recommendations</a></p>
<p class="calibre1"><a href="#calibre_link-301">479</a></p>
<p class="calibre1"><a href="#calibre_link-302">One change at a time</a></p>
<p class="calibre1"><a href="#calibre_link-302">480</a></p>
<p class="calibre1"><a href="#calibre_link-302">Testing</a></p>
<p class="calibre1"><a href="#calibre_link-302">480</a></p>
<p class="calibre1"><a href="#calibre_link-303">Database testing approaches</a></p>
<p class="calibre1"><a href="#calibre_link-303">481</a></p>
<p class="calibre1"><a href="#calibre_link-303">Testing in production</a></p>
<p class="calibre1"><a href="#calibre_link-303">481</a></p>
<p class="calibre1"><a href="#calibre_link-304">Using a testing database</a></p>
<p class="calibre1"><a href="#calibre_link-304">482</a></p>
<p class="calibre1"><a href="#calibre_link-305">Testing techniques</a></p>
<p class="calibre1"><a href="#calibre_link-305">483</a></p>
<p class="calibre1"><a href="#calibre_link-306">Deliverables</a></p>
<p class="calibre1"><a href="#calibre_link-306">484</a></p>
<p class="calibre1"><a href="#calibre_link-307">Finishing the project</a></p>
<p class="calibre1"><a href="#calibre_link-307">485</a></p>
<p class="calibre1"><a href="#calibre_link-307">Plan for upgrading</a></p>
<p class="calibre1"><a href="#calibre_link-307">485</a></p>
<p class="calibre1"><a href="#calibre_link-308">Benefits of upgrading</a></p>
<p class="calibre1"><a href="#calibre_link-308">486</a></p>
<p class="calibre1"><a href="#calibre_link-309">Coding considerations</a></p>
<p class="calibre1"><a href="#calibre_link-309">487</a></p>
<p class="calibre1"><a href="#calibre_link-309">Low-impact coding</a></p>
<p class="calibre1"><a href="#calibre_link-309">487</a></p>
<p class="calibre1"><a href="#calibre_link-310"><b class="calibre3">Supporting material</b></a></p>
<p class="calibre1"><a href="#calibre_link-310">488</a></p>
<p class="calibre1"><a href="#calibre_link-311"><b class="calibre3">Summary</b></a></p>
<p class="calibre1"><a href="#calibre_link-311">489</a></p>
<p class="calibre1"><a href="#calibre_link-311"><b class="calibre3">Questions</b></a></p>
<p class="calibre1"><a href="#calibre_link-311">489</a></p>
<p class="calibre1"><a href="#calibre_link-312"><b class="calibre3">Assessments</b></a></p>
<p class="calibre1"><a href="#calibre_link-312">492</a></p>
<p class="calibre1"><a href="#calibre_link-313"><b class="calibre3">Other Books You May Enjoy</b></a></p>
<p class="calibre1"><a href="#calibre_link-313">499</a></p>
<p class="calibre1"><a href="#calibre_link-314"><b class="calibre3">Index</b></a></p>
<p class="calibre1"><a href="#calibre_link-314">502</a></p>
<p class="calibre1"><b class="calibre3">[ x ]</b></p>
<p class="calibre1"><a id="calibre_link-1"></a>Preface</p>
<p class="calibre1">Welcome to the worldwide community of Microsoft Dynamics Business Central<br>developers. This is a collegial environment populated by AL developers who readily and generously share their knowledge. There are formal and informal organizations of Business Central-focused users, developers, and vendor firms scattered around the globe and active on the web. Our community continues to grow and prosper, and now includes over 110,000</p>
<p class="calibre1">user companies worldwide. </p>
<p class="calibre1">The information in this book will help you shorten your learning curve on how to program for the Business Central ERP system using the AL language, the Visual Studio integrated development environment, and their capabilities. We hope you enjoy working with</p>
<p class="calibre1">Business Central as much as we have. </p>
<p class="calibre1"><b class="calibre3">A brief history of Business Central</b></p>
<p class="calibre1">Each new version of Microsoft Dynamics Business Central (formerly NAV) is the result of inspiration and hard work, along with some good fortune and expert technical investment over the last thirty years. </p>
<p class="calibre1"><b class="calibre3">The beginning</b></p>
<p class="calibre1">Three college friends, Jesper Balser, Torben Wind, and Peter Bang, from <b class="calibre3">Denmark</b> <b class="calibre3">Technical University</b> (<b class="calibre3">DTU</b>) founded their computer software business in 1984 when they were in their early twenties; that business was <b class="calibre3">PC Computing &amp; Consulting</b> (<b class="calibre3">PC &amp; C</b>), and its first product was called PC Plus. </p>
<p class="calibre1"><a id="calibre_link-427"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1"><b class="calibre3">Single-user PC Plus</b></p>
<p class="calibre1">PC Plus was released in 1985 with the primary goal of ease of use. An early employee said its functional design was inspired by the combination of a manual ledger journal, an Epson FX 80 printer, and a Canon calculator. Incidentally, Peter Bang is the grandson of one of the founders of Bang &amp; Olufsen, the manufacturer of home entertainment systems par excellence. </p>
<p class="calibre1">PC Plus was a PC DOS-based, single-user system. PC Plus’ design included the following features:</p>
<p class="calibre1">An interface resembling the use of documents and calculators</p>
<p class="calibre1">Online help</p>
<p class="calibre1">Good exception handling</p>
<p class="calibre1">Minimal reliance on computer resources</p>
<p class="calibre1">The PC Plus product was marketed through dealers in Denmark and Norway. </p>
<p class="calibre1"><b class="calibre3">Multi-user Navigator</b></p>
<p class="calibre1">In 1987, PC &amp; C released a new product, the multi-user Navigator, and a new corporate name, Navision. Navigator was quite a technological leap forward. It included the following features:</p>
<p class="calibre1">Client/server technology</p>
<p class="calibre1">A relational database</p>
<p class="calibre1">Transaction-based processing</p>
<p class="calibre1">Version management</p>
<p class="calibre1">High-speed OLAP capabilities (SIFT technology)</p>
<p class="calibre1">A screen painter tool</p>
<p class="calibre1">A programmable report writer</p>
<p class="calibre1">In 1990, Navision was expanding its marketing and dealer recruitment efforts into Germany, Spain, and the United Kingdom. Also in 1990, a third version of Navigator was released. Navigator V3 was still a character-based system, albeit a very sophisticated one. If you had the opportunity to study Navigator V3.x, you would instantly recognize the roots of today’s Business Central product. By V3, the product included the following features: A design based on object-oriented concepts</p>
<p class="calibre1">Integrated 4GL Table, Form, and Report Design tools (the IDE)</p>
<p class="calibre1"><b class="calibre3">[ 2 ]</b></p>
<p class="calibre1"><a id="calibre_link-428"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1">Structured exception handling</p>
<p class="calibre1">Built-in resource management</p>
<p class="calibre1">The original programming language that became C/AL, which later changed to</p>
<p class="calibre1">AL</p>
<p class="calibre1">Function libraries</p>
<p class="calibre1">The concept of regional or country-based localization</p>
<p class="calibre1">When Navigator V3.5 was released, it also included support for multiple platforms and multiple databases. Navigator V3.5 would run on both Unix and Windows NT networks. It supported Oracle and Informix databases, as well as those developed in-house. </p>
<p class="calibre1">At about this time, several major strategic efforts were initiated. On the technical side, the decision was made to develop a GUI-based product. The first prototype of Navision Financials (for Windows) was shown in 1992. At about the same time, a relationship was established that would take Navision into distribution in the United States. The initial release in the US in 1995 was V3.5 of the character-based product, rechristened Avista for US distribution. </p>
<p class="calibre1"><b class="calibre3">Navision Financials for Windows</b></p>
<p class="calibre1">In 1995, Navision Financials V1.0 for Microsoft Windows was released. This product had many (but not all) of the features of Navigator V3.5. It was designed for complete look-and-feel compatibility with Windows 95. There was an effort to provide the ease of use and flexibility of development of Microsoft Access. The new Navision Financials was very compatible with Microsoft Office and was thus sold as “being familiar to any Office user”. </p>
<p class="calibre1">Like any V1.0 product, it was quickly followed by a much improved V1.1. </p>
<p class="calibre1">In the next few years, Navision continued to be improved and enhanced. Major new functionalities, such as the following, were added:</p>
<p class="calibre1">Customer Relation Management (CRM)</p>
<p class="calibre1">Manufacturing (ERP)</p>
<p class="calibre1">Advanced distribution (including Warehouse Management)</p>
<p class="calibre1">Various Microsoft certifications were obtained, providing muscle to the marketing efforts. </p>
<p class="calibre1">Geographic and dealer-based expansion continued apace. By 2000, according to the Navision Annual Report of that year, the product was represented by nearly 1,000 dealers (Navision Solution Centers) in 24 countries and used by 41,000 customers located in 108</p>
<p class="calibre1">countries. </p>
<p class="calibre1"><b class="calibre3">[ 3 ]</b></p>
<p class="calibre1"><a id="calibre_link-429"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1"><b class="calibre3">Growth and mergers</b></p>
<p class="calibre1">In 2000, Navision Software A/S, and its primary Danish competitor, Damgaard A/S, merged. Product development and new releases continued for the primary products of both original firms (Navision and Axapta). In 2002, the now much larger Navision Software, with all of its products (Navision, Axapta, the smaller, older C5, and XAL) was purchased by Microsoft, becoming part of the Microsoft Business Systems division along with the previously-purchased Great Plains Software business, and its several product lines. The Navision and Great Plains products all received a common rebranding to become the Dynamics product line. Navision was renamed as Dynamics NAV, and later to Business Central. </p>
<p class="calibre1"><b class="calibre3">Continuous enhancement</b></p>
<p class="calibre1">As early as 2003, research began with the Dynamics NAV development team, planning moves to further enhance NAV and take advantage of various parts of the Microsoft product line. Goals were defined to increase integration with products such as Microsoft Office and Microsoft Outlook. Goals were also set to leverage the functional capabilities of Visual Studio Code and SQL Server, among others. All the while, there was a<br>determination not to lose the strength and flexibility of the base product. </p>
<p class="calibre1">NAV 2009 was released in late 2008, NAV 2013 in late 2012, followed by NAV 2015 in late 2014. NAV 2017 was released in October 2016. The biggest hurdles to the new technologies have been cleared. A new user interface, the Role Tailored Client, was created as part of this renewal. NAV was tightly integrated with Microsoft’s SQL Server and other Microsoft products, such as Office, Outlook, and SharePoint. Development is more integrated with Visual Studio Code and is more .NET compliant. The product is becoming more open and, at the same time, more sophisticated, supporting features such as web services access, web and tablet clients, integration of third-party controls, RDLC and Word-based reporting, and so on. </p>
<p class="calibre1">Microsoft continues to invest in, enhance, and advance Business Central. More new capabilities and features are yet to come, with the aim of building on the successes of the past. We all benefit from their work. </p>
<p class="calibre1"><b class="calibre3">[ 4 ]</b></p>
<p class="calibre1"><a id="calibre_link-430"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1"><b class="calibre3">AL’s roots</b></p>
<p class="calibre1">One of the first questions asked by people new to AL is often, “What other programming language is it like?”. The best response is Pascal. To those unfamiliar with Pascal, the next best response would be C or C#. </p>
<p class="calibre1">At the time the three founders of Navision were attending classes at Denmark Technical University (DTU), Pascal was widely used as a preferred language not only on computer courses, but on other courses where computers were tools and software had to be written for data analyses. Some of the strengths of Pascal as a tool in an educational environment also made it an ideal model for Navision’s business applications development. </p>
<p class="calibre1">Perhaps coincidentally (or perhaps not), at the same time at DTU, a Pascal compiler called Blue Label Pascal was developed by Anders Hejlsberg. That compiler became the basis for what was Borland’s Turbo Pascal, which was considered the everyman’s compiler of the 1980s because of its low price. Anders went with his Pascal compiler to Borland. While he was there, Turbo Pascal morphed into the Delphi language and IDE tool set under his guidance. </p>
<p class="calibre1">Anders later left Borland and joined Microsoft, where he led the C# design team. Much of the NAV-related development at Microsoft is now being done in C#. Keeping it in the family, Anders’ brother, Thomas Hejlsberg, also works at Microsoft as a software architect on Business Central. Each in their own way, Anders and Thomas continue to make<br>significant contributions to Dynamics NAV. </p>
<p class="calibre1">In a discussion about AL and Visual Studio Code, Michael Nielsen of Navision and Microsoft, who developed the original AL compiler, runtime, and IDE, said that the design criteria provides an environment that can be used without the following tasks:</p>
<p class="calibre1">Dealing with memory and other resource handling</p>
<p class="calibre1">Thinking about exception handling and state</p>
<p class="calibre1">Thinking about database transactions and rollbacks</p>
<p class="calibre1">Knowing about set operations (SQL)</p>
<p class="calibre1">Knowing about OLAP (SIFT)</p>
<p class="calibre1"><b class="calibre3">[ 5 ]</b></p>
<p class="calibre1"><a id="calibre_link-431"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1">Paraphrasing some of Michael’s additional comments, the goals of the language and IDE</p>
<p class="calibre1">designs included:</p>
<p class="calibre1">Allowing the developer to focus on design rather than coding, but still allowing flexibility</p>
<p class="calibre1">Providing a syntax based on Pascal stripped of complexities, especially relating to memory management</p>
<p class="calibre1">Providing a limited set of predefined object types and reducing the complexity<br>and learning curve</p>
<p class="calibre1">Implementing database versioning for a consistent and reliable view of the<br>database</p>
<p class="calibre1">Making the developer and end user more at home by borrowing a large number<br>of concepts from Office, Windows, Access, and other Microsoft products</p>
<p class="calibre1">Michael is now a co-founder and partner at ForNAV. Michael and his fellow team members are all about developing high-quality reporting enhancements for Dynamics Business Central, with the goal of making working with reports easy. This is another example of how, once we’re part of the Business Central community, most of us want to stay part of that community. </p>
<p class="calibre1"><b class="calibre3">Who this book is for</b></p>
<p class="calibre1">This book is for the following:</p>
<p class="calibre1">The business applications software designer or developer for whom the<br>following is true:</p>
<p class="calibre1">Wants to become productive in Business Central Visual Code&mdash;AL</p>
<p class="calibre1">development as quickly as possible</p>
<p class="calibre1">Understands business applications and the type of software<br>required to support those applications</p>
<p class="calibre1">Has significant programming experience</p>
<p class="calibre1">Has access to a copy of Business Central, including the Designer<br>granules and a standard Cronus demo database</p>
<p class="calibre1">Is willing to do the exercises to get hands-on experience</p>
<p class="calibre1">The reseller manager or executive who wants a concise, in-depth view of</p>
<p class="calibre1">Business Central’s development environment and tool set. </p>
<p class="calibre1"><b class="calibre3">[ 6 ]</b></p>
<p class="calibre1"><a id="calibre_link-432"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1">The technically knowledgeable manager or executive of a firm using Business</p>
<p class="calibre1">Central that is about to embark on a significant Business Central enhancement<br>project. </p>
<p class="calibre1">The technically knowledgeable manager or executive of a firm considering the<br>purchase of Business Central as a highly-customizable business applications<br>platform. </p>
<p class="calibre1">The experienced business analyst, consultant, or advanced student of<br>applications software development who wants to learn more about Business</p>
<p class="calibre1">Central because it is one of the most widely used, and most flexible, business<br>application systems available. </p>
<p class="calibre1">The reader of this book does not need the following:</p>
<p class="calibre1">Does not need to be an expert in object-oriented programming</p>
<p class="calibre1">Does not need previous experience with Business Central, AL, or Visual Studio</p>
<p class="calibre1">Code</p>
<p class="calibre1"><b class="calibre3">What this book covers</b></p>
<p class="calibre1"><a href="#calibre_link-2">Chapter 1, </a> <i class="calibre4">Introduction to Business Central</i>, starts with an overview of Business Central as a business application system, which is followed by an introduction to the seven types of Business Central objects, as well as the basics of AL and Visual Studio Code. It then presents the opportunity for some hands-on work, such as defining tables, multiple page types, and reports. This chapter will close with a brief discussion of how backups and documentations are handled in Visual Studio Code. </p>
<p class="calibre1"><a href="#calibre_link-38">Chapter 2, </a> <i class="calibre4">Tables</i>, focuses on the foundation level of Business Central’s data structure: tables and their structures. This chapter covers properties, triggers (where AL resides), field groups, table relations, and SumIndexFields. It will then present the hands-on creation of several tables in support of an example application. The chapter will also review the types of tables found in the Business Central applications. </p>
<p class="calibre1"><a href="#calibre_link-68">Chapter 3, </a> <i class="calibre4">Data Types and Fields</i>, will teach you about fields, the basic building blocks of Business Central’s data structure. It will review the different data types in Business Central and cover all of its field properties and triggers in detail, as well as review the three different field classes. </p>
<p class="calibre1"><b class="calibre3">[ 7 ]</b></p>
<p class="calibre1"><a id="calibre_link-433"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1"><a href="#calibre_link-91">Chapter 4, </a> <i class="calibre4">Pages &ndash; The Interactive Interface</i>, reviews the different types of pages, their structures (triggers and properties), and general usage. The chapter will encourage readers to build several pages for an example application using snippets. It will also explore the different types of controls that can be used in pages. In addition, this chapter will review how and where actions are added to pages. </p>
<p class="calibre1"><a href="#calibre_link-130">Chapter 5, </a> <i class="calibre4">Queries and Reports</i>, teaches you about both queries and reports&mdash;two methods of extracting data for presentation to users. It will show readers how queries are constructed and some of the different ways they are utilized. It will also offer a walkthrough for reporting data flow in reports, and what the different report types are. This chapter will present two Report Designers: the Visual Studio Report Designer and the Visual Studio Report Designer, and will explain how a Business Central report is constructed using both of these and in what scenarios they are best applied. This chapter will also discuss properties and triggers, before reviewing how reports can be made interactive with hands-on report creation. </p>
<p class="calibre1"><a href="#calibre_link-159">Chapter 6, </a> <i class="calibre4">Introduction to AL</i>, explains general object designer navigation, as well as the individual designers (table, page, and report). It will explore AL code construction, syntax, variable types, expressions, operators, and functions. The chapter will then offer a closer look at some of the more frequently used built-in functions. This chapter will wrap up with an exercise that adds AL code to a report object created in an earlier exercise. </p>
<p class="calibre1"><a href="#calibre_link-199">Chapter 7, </a> <i class="calibre4">Intermediate AL</i>, digs deeper into AL development tools and techniques. It will review some more advanced built-in functions, including those relating to dates and decimal calculations&mdash;both critical business application tools. This chapter will also explore AL functions that support process flow control functions, input and output, and filtering, before reviewing methods of communication between objects. Finally, this chapter offers the opportunity to practically enhance an example application. </p>
<p class="calibre1"><a href="#calibre_link-243">Chapter 8, </a> <i class="calibre4"> Advanced AL Development Tools</i>, reviews some of the more important elements of Role’s tailored user experience; in particular, the Role Center page construction. It will dig into the components of a Role Center page and how to build one. This chapter will also cover two powerful ways of connecting Business Central applications to the world outside of Business Central, using XMLports and web services. To better understand these, the chapter will not only review their individual component parts, but will also go through the hands-on effort of building an example of each one. </p>
<p class="calibre1"><b class="calibre3">[ 8 ]</b></p>
<p class="calibre1"><a id="calibre_link-434"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1"><a href="#calibre_link-270">Chapter 9, </a> <i class="calibre4">Successful Conclusions</i>, gives readers a detailed study of how Business Central functions are constructed, and will explain how to construct functions. This chapter will include more information about the tools and features built into AL and Visual Studio Code, as well as the new debugger. It will also review support for test-driven development, and take a look at how to integrate .NET Client Add-ins with example applications. Finally, it will review tips for design efficiency, and updating and upgrading the system, all with the goal of helping readers become more productive, high-quality Business Central developers. </p>
<p class="calibre1"><b class="calibre3">To get the most out of this book</b></p>
<p class="calibre1">To get the maximum out of this book as a developer, the following should match you: Be an experienced developer</p>
<p class="calibre1">Know more than one programming language</p>
<p class="calibre1">Have IDE experience</p>
<p class="calibre1">Be knowledgeable about business applications</p>
<p class="calibre1">Be good at self-directed study</p>
<p class="calibre1">If you have these attributes, this book will help you become productive with AL and Business Central much more rapidly. </p>
<p class="calibre1">Even though this book is targeted first at developers, it is also designed to be useful to executives, consultants, managers, business owners, and others who want to learn about the development technology and operational capabilities of Dynamics 365 Business Central. </p>
<p class="calibre1">If you fit into one of these, or similar, categories, start by studying Chapter 1 for a good overview of Business Central and its tools. You should then consider reviewing sections of other chapters, where specific topics may apply to your specific areas of interest. </p>
<p class="calibre1">This book’s illustrations are from the W1 Cronus database, Dynamics 365 Business Central V2017. </p>
<p class="calibre1">You will need some basic tools to get the most of this book, including the following: A license and database that can be used for development experimentation. The<br>ideal license is a full developer’s license. If your license only contains the page, report, and table designer capabilities, you will still be able to do many of the exercises, but you will not have access to the inner workings of pages and tables and the AL code contained therein. </p>
<p class="calibre1"><b class="calibre3">[ 9 ]</b></p>
<p class="calibre1"><a id="calibre_link-435"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1">A copy of the Business Central Cronus demo or test database for your<br>development testing and study. Having a copy of a production database for<br>examination is ideal. This book’s illustrations are from the W1 Cronus database<br>for V2017. </p>
<p class="calibre1">The hardware and software requirements for installing and running Microsoft</p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/dynamics-nav/system-requirements-for-microsoft-dynamics-nav">Dynamics Business Central can be found at https:/​/​msdn.​microsoft.​com/​en-</a></p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/dynamics-nav/system-requirements-for-microsoft-dynamics-nav">us/​dynamics-​nav/​system-​requirements-​for-​microsoft-​dynamics-​nav</a>. </p>
<p class="calibre1">Access to other Business Central manuals, training materials, websites, and experienced associates will obviously be of benefit, but they are not required for the time spent with this book to be a good investment. </p>
<p class="calibre1"><b class="calibre3">Downloading the example code files</b></p>
<p class="calibre1">You can download the example code files for this book from your account at</p>
<p class="calibre1"><a href="http://www.packtpub.com">www.packtpub.com. If you purchased this book elsewhere, you can visit</a></p>
<p class="calibre1"><a href="http://www.packtpub.com/support">www.packtpub.com/support</a> and register to have the files emailed directly to you. </p>
<p class="calibre1">You can download the code files by following these steps:</p>
<p class="calibre1">1. Log in or register at <a href="http://www.packtpub.com/support">www.packtpub.com. </a></p>
<p class="calibre1">2. Select the <b class="calibre3">SUPPORT</b> tab. </p>
<p class="calibre1">3. Click on <b class="calibre3">Code Downloads &amp; Errata</b>. </p>
<p class="calibre1">4. Enter the name of the book in the <b class="calibre3">Search</b> box and follow the onscreen<br>instructions. </p>
<p class="calibre1">Once the file is downloaded, please make sure that you unzip or extract the folder using the latest version of:</p>
<p class="calibre1">WinRAR/7-Zip for Windows</p>
<p class="calibre1">Zipeg/iZip/UnRarX for Mac</p>
<p class="calibre1">7-Zip/PeaZip for Linux</p>
<p class="calibre1">The code bundle for the book is also hosted on GitHub at <a href="https://github.com/PacktPublishing/Programming-Microsoft-Dynamics-365-Business-Central-Sixth-Edition">https:/​/​github.​com/</a></p>
<p class="calibre1"><a href="https://github.com/PacktPublishing/Programming-Microsoft-Dynamics-365-Business-Central-Sixth-Edition">PacktPublishing/​Programming-​Microsoft-​Dynamics-​365-​Business-​Central-​Sixth-</a></p>
<p class="calibre1"><a href="https://github.com/PacktPublishing/Programming-Microsoft-Dynamics-365-Business-Central-Sixth-Edition">Edition. </a>In case there’s an update to the code, it will be updated on the existing GitHub repository. </p>
<p class="calibre1">We also have other code bundles from our rich catalog of books and videos available at <a href="https://github.com/PacktPublishing/">https:/​/​github.​com/​PacktPublishing/</a>​. Check them out! </p>
<p class="calibre1"><b class="calibre3">[ 10 ]</b></p>
<p class="calibre1"><a id="calibre_link-436"></a><img src="images/000082.png" alt="Image 4" class="calibre2" /></p>
<p class="calibre1"><img src="images/000107.png" alt="Image 5" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Preface</i></p>
<p class="calibre1"><b class="calibre3">Downloading the color images</b></p>
<p class="calibre1">We also provide a PDF file that has color images of the screenshots and diagrams used in this book. You can download it here: <a href="https://www.packtpub.com/sites/default/files/downloads/9781789137798_ColorImages.pdf">https:/​/​www.​packtpub.​com/​sites/​default/​files/</a></p>
<p class="calibre1"><a href="https://www.packtpub.com/sites/default/files/downloads/9781789137798_ColorImages.pdf">downloads/​9781789137798_​ColorImages.​pdf. </a></p>
<p class="calibre1"><b class="calibre3">Conventions used</b></p>
<p class="calibre1">There are a number of text conventions used throughout this book. </p>
<p class="calibre1">CodeInText indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. An example of this is as follows: “The HelloWorld.al file can be deleted immediately.” </p>
<p class="calibre1">A block of code is set as follows:</p>
<p class="calibre1">IF Type = ‘Resource’ THEN No. := Resource.No. </p>
<p class="calibre1">ELSE IF Type = ‘Show’ THEN No. := Radio Show.No. </p>
<p class="calibre1">ELSE IF Type = ‘Item’ THEN No. := Item.No. )</p>
<p class="calibre1">When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set in bold, as follows:</p>
<p class="calibre1">IF Type = ‘Resource’ THEN No. := Resource.No. </p>
<p class="calibre1">ELSE IF Type = ‘Show’ THEN No. := <b class="calibre3">Radio Show.No. </b></p>
<p class="calibre1">ELSE IF Type = ‘Item’ THEN No. := Item.No. )</p>
<p class="calibre1">Any command-line input or output is written as follows:</p>
<p class="calibre1"><b class="calibre3">$ cd css</b></p>
<p class="calibre1"><b class="calibre3">Bold</b> indicates a new term, an important word, or words that you see onscreen. For example, words in menus or dialog boxes appear in the text like this, such as “From Visual Studio Code, click on <b class="calibre3">New</b>, then click on <b class="calibre3">File</b>.” </p>
<p class="calibre1">Warnings or important notes appear like this. </p>
<p class="calibre1">Tips and tricks appear like this. </p>
<p class="calibre1"><b class="calibre3">[ 11 ]</b></p>
<p class="calibre1"><a id="calibre_link-437"></a> <i class="calibre4">Preface</i></p>
<p class="calibre1"><b class="calibre3">Get in touch</b></p>
<p class="calibre1">Feedback from our readers is always welcome. </p>
<p class="calibre1"><b class="calibre3">General feedback</b>: Email feedback@packtpub.com and mention the book title in the subject of your message. If you have questions about any aspect of this book, please email us at questions@packtpub.com. </p>
<p class="calibre1"><b class="calibre3">Errata</b>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you could report this to us. Please visit <a href="http://www.packtpub.com/submit-errata">www.packtpub.com/submit-errata, select your book, click on</a></p>
<p class="calibre1">the <b class="calibre3">Errata Submission Form</b> link, and enter the details. </p>
<p class="calibre1"><b class="calibre3">Piracy</b>: If you come across any illegal copies of our works in any form on the internet, we would be grateful if you could provide us with the location address or website name. </p>
<p class="calibre1">Please contact us at copyright@packtpub.com with a link to the material. </p>
<p class="calibre1"><b class="calibre3">Becoming an author</b>: If there is a topic that you have expertise in and you are interested in either writing about or contributing to, please visit <a href="http://authors.packtpub.com/">authors.packtpub.com. </a></p>
<p class="calibre1"><b class="calibre3">Reviews</b></p>
<p class="calibre1">Please leave a review. Once you have read and used this book, why not leave a review on the site that you purchased it from? Potential readers can then see and use your unbiased opinion to make purchase decisions, we at Packt can understand what you think about our products, and our authors can see your feedback on their book. Thank you! </p>
<p class="calibre1"><a href="https://www.packtpub.com/">For more information about Packt, please visit packtpub.com</a>. </p>
<p class="calibre1"><b class="calibre3">[ 12 ]</b></p>
<p class="calibre1"><a id="calibre_link-2"></a>1</p>
<p class="calibre1">Introduction to Business Central</p>
<p class="calibre1"> <i class="calibre4">“Time changes all things; there is no reason why language should escape this universal</i> <i class="calibre4">law.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Ferdinand de Saussure</i></p>
<p class="calibre1"> <i class="calibre4">“When we use a language, we should commit ourselves to knowing it, being able to read it,</i> <i class="calibre4">and writing it idiomatically.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Ron Jeffries</i></p>
<p class="calibre1">Microsoft Dynamics 365 Business Central has one of the largest installed user bases of any <b class="calibre3">enterprise resource planning</b> (<b class="calibre3">ERP</b>) system, serving over 150,000 companies and 2.5</p>
<p class="calibre1">million plus individual users, at the time of writing. The community of supporting organizations, consultants, implementers, and developers continues to grow and prosper. </p>
<p class="calibre1">The capabilities of the off-the-shelf product increase with every release. The selection of add-on products and services expands both in variety and depth. </p>
<p class="calibre1">The release of Microsoft Dynamics Business Central continues its 20-plus year history of continuous product improvement. It provides more user options for access and output formatting. For new installations, Business Central includes tools for rapid implementation. </p>
<p class="calibre1">For all installations, it provides enhanced business functionality and more support for ERP</p>
<p class="calibre1">computing in the cloud, including integration with Microsoft Office 365. </p>
<p class="calibre1">Our goal in this chapter is to gain a big-picture understanding of Business Central. You will be able to envision how Business Central can be used by managers (or owners) of an organization to help manage activities and the resources, whether the organization is for-profit or not-for-profit. You will also be introduced to the technical side of Business Central from a developer’s point of view. </p>
<p class="calibre1"><a id="calibre_link-3"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">In this chapter, we will take a look at Business Central, including the following topics: A general overview of Business Central</p>
<p class="calibre1">A technical overview of Business Central</p>
<p class="calibre1">A hands-on introduction to Visual Studio Code development in Business Central</p>
<p class="calibre1"><b class="calibre3">Business Central &ndash; an ERP system</b></p>
<p class="calibre1">Business Central is an integrated set of business applications designed to service a wide variety of business operations. Microsoft Dynamics 365 Business Central is an ERP system. </p>
<p class="calibre1">An ERP system integrates internal and external data across a variety of functional areas, including manufacturing, accounting, supply chain management, customer relationships, service operations, and human resource management, as well as the management of other valued resources and activities. By having many related applications well integrated, a fully-featured ERP system provides an  <i class="calibre4">enter data once, use many ways</i> information processing toolset. </p>
<p class="calibre1">Business Central ERP addresses the following functional areas (and more):</p>
<p class="calibre1">Basic accounting functions (for example, general ledger, accounts payable, and<br>accounts receivable)</p>
<p class="calibre1">Order processing and inventory (for example, sales orders, purchase orders, </p>
<p class="calibre1">shipping, inventory, and receiving)</p>
<p class="calibre1">Relationship management (for example, vendors, customers, prospects, </p>
<p class="calibre1">employees, and contractors)</p>
<p class="calibre1">Planning (for example, MRP, sales forecasting, and production forecasting)</p>
<p class="calibre1">Other critical business areas (for example, manufacturing, warehouse<br>management, marketing, cash management, and fixed assets)</p>
<p class="calibre1">A good ERP system, such as Business Central, is modular in design, which simplifies implementation, upgrading, modification, integration with third-party products, and expansion for different types of clients. All the modules in the system share a common database and, where appropriate, common data. </p>
<p class="calibre1"><b class="calibre3">[ 14 ]</b></p>
<p class="calibre1"><a id="calibre_link-335"></a><img src="images/000051.png" alt="Image 6" class="calibre2" /></p>
<p class="calibre1"><img src="images/000070.jpg" alt="Image 7" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">The following groupings of individual Business Central functions are based on the <b class="calibre3">Search</b> menu structure, which is supplemented by information from Microsoft marketing<br>materials. The important thing is to understand the overall components that make up the Business Central ERP system:</p>
<p class="calibre1">Business Central has a role tailored <b class="calibre3">User Interface</b> (<b class="calibre3">UI</b>). In Business Central, there are four instances of the <b class="calibre3">role tailored client</b> (<b class="calibre3">RTC</b>)&mdash;one each for Windows, web interaction, tablet use, and as a phone client. Generally the various clients are referred to for the most part based on where and how they are displayed (Windows, web, tablet, and so on). </p>
<p class="calibre1">The Windows client is only available for on-premises installations. </p>
<p class="calibre1"><b class="calibre3">[ 15 ]</b></p>
<p class="calibre1"><a id="calibre_link-4"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Financial management</b></p>
<p class="calibre1">At the foundation of any ERP system is financial management. Irrespective of the business, the money must be kept flowing with a track of it. Business Central’s financial management module contains the tools that help to manage the capital resources of the business. These include all or part of the following application functions:</p>
<p class="calibre1">General ledger, for managing the overall finances of the firm</p>
<p class="calibre1">Cash management and banking, for managing the inventory of financial assets</p>
<p class="calibre1">Accounts receivable, for tracking the incoming revenue</p>
<p class="calibre1">Accounts payable, for tracking the outgoing funds</p>
<p class="calibre1">Analytical accounting, for analyzing the various flows of funds</p>
<p class="calibre1">Inventory and fixed assets, for managing inventories of goods and equipment</p>
<p class="calibre1">Multicurrency and multilingual, for supporting international business activities <b class="calibre3">Manufacturing</b></p>
<p class="calibre1">Business Central manufacturing is general-purpose enough to be appropriate for <b class="calibre3">Make to</b> <b class="calibre3">Stock</b> (<b class="calibre3">MTS</b>), <b class="calibre3">Make to Order</b> (<b class="calibre3">MTO</b>), and <b class="calibre3">Assemble to Order</b> (<b class="calibre3">ATO</b>), as well as various subsets and combinations of those. Although off-the-shelf Business Central is not particularly suitable for most process manufacturing and some of the very high-volume assembly line operations, there are third-party add-on and add-in enhancements available for those applications. As with most of the Business Central application functions, manufacturing can be implemented either in a basic mode or as a fully-featured system. </p>
<p class="calibre1">Business Central manufacturing includes the following functions:</p>
<p class="calibre1">Product design (BOMs and routings), for structure management of product<br>components and the flow management of manufacturing processes</p>
<p class="calibre1">Capacity and supply requirement planning, for tracking the intangible and<br>tangible manufacturing resources</p>
<p class="calibre1">Production scheduling (infinite and finite), execution, and tracking quantities<br>and costs, plus tracking manufacturing resources’ planned use, both on a<br>constrained and unconstrained basis</p>
<p class="calibre1"><b class="calibre3">[ 16 ]</b></p>
<p class="calibre1"><a id="calibre_link-5"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Supply chain management</b></p>
<p class="calibre1">Some of the functions that are categorized as part of Business Central <b class="calibre3">supply chain</b> <b class="calibre3">management</b> (<b class="calibre3">SCM</b>), such as sales and purchasing, are actively used in almost every Business Central implementation. The supply chain applications in Business Central include all or parts of the following applications:</p>
<p class="calibre1">Sales order processing and pricing, to support the heart of every<br>business</p>
<p class="calibre1">Purchasing (including requisitions), for planning, entering, pricing, and<br>processing purchase orders</p>
<p class="calibre1">Inventory management, for managing inventories of goods and materials</p>
<p class="calibre1">Warehouse management, including receiving and shipping, for managing the<br>receipt, storage, retrieval, and shipment of material and goods in warehouses</p>
<p class="calibre1">As a whole, these functions constitute the base components of a system that’s appropriate for distribution operations, including those that operate on an ATO basis. </p>
<p class="calibre1"><b class="calibre3">Business intelligence and reporting</b></p>
<p class="calibre1">Although Microsoft marketing materials identify <b class="calibre3">business intelligence</b> (<b class="calibre3">BI</b>) and reporting as though it were a separate module within Business Central, it’s difficult to physically identify it as such. Most of the components that are used for BI and reporting purposes are (appropriately) scattered throughout various application areas. In the words of one Microsoft document,  <i class="calibre4">business intelligence is a strategy, not a product</i>. Functions within Business Central that support a BI strategy include the following:</p>
<p class="calibre1">Standard reports: Distributed and ready to use by end users</p>
<p class="calibre1">Account schedules and analysis reports: A specialized report writer for general<br>ledger data</p>
<p class="calibre1">Query, XMLport, and report designers: Developer tools to support the creation of a wide variety of report formats, charts, and XML and CSV files</p>
<p class="calibre1">Analysis by dimensions: A capability embedded in many of the other tools</p>
<p class="calibre1">Interfaces into Microsoft Office and Microsoft Office 365, including Excel-</p>
<p class="calibre1">communications of data either into Business Central or out of Business Central</p>
<p class="calibre1">RDLC report viewer: Provides the ability to present Business Central data in a<br>variety of textual and graphic formats, including user interactive capabilities</p>
<p class="calibre1"><b class="calibre3">[ 17 ]</b></p>
<p class="calibre1"><a id="calibre_link-6"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Interface capabilities such as Dotnet interoperability and web services:</p>
<p class="calibre1">Technologies to support interfaces between Business Central and external<br>software products</p>
<p class="calibre1">Standard packages for Power BI: Integrated in the role center as well as<br>dashboards</p>
<p class="calibre1"><b class="calibre3">Relationship management</b></p>
<p class="calibre1">Business Central’s <b class="calibre3">relationship management</b> (<b class="calibre3">RM</b>) functionality is definitely the  <i class="calibre4">little sister</i> (or, if you prefer,  <i class="calibre4">little brother</i>) of the fully featured standalone Microsoft CRM system and Dynamics 365 for Sales and Dynamics 365 for Marketing. The big advantage of Business Central RM is its tight integration with Business Central customer and sales data. </p>
<p class="calibre1">Also falling under the heading of the customer relationship module is the Business Central <b class="calibre3">service management</b> (<b class="calibre3">SM</b>) functionality. The different functionalities under RM and SM</p>
<p class="calibre1">are as follows:</p>
<p class="calibre1"><b class="calibre3">Relationship management</b>:</p>
<p class="calibre1">Marketing campaigns, to plan and manage promotions</p>
<p class="calibre1">Customer activity tracking, to analyze customer orders</p>
<p class="calibre1">To-do lists, to manage what is to be done and track what has been<br>done</p>
<p class="calibre1"><b class="calibre3">Service management</b>:</p>
<p class="calibre1">Service contracts, to support service operations</p>
<p class="calibre1">Labor and part consumption tracking, to track resources that are<br>consumed by the service business</p>
<p class="calibre1">Planning and dispatching, to manage service calls</p>
<p class="calibre1"><b class="calibre3">Human resource management</b></p>
<p class="calibre1">The Business Central human resources module is a very small module, but it relates to a critical component of the business: employees. Basic employee data can be stored and reported via the master table (in fact, you can use the <b class="calibre3">human resources</b> (<b class="calibre3">HR</b>) module to manage data about individual contractors in addition to employees). A wide variety of individual employee attributes can be tracked by the use of dimension fields:</p>
<p class="calibre1"><b class="calibre3">Employee tracking</b>: Maintain basic employee description data</p>
<p class="calibre1"><b class="calibre3">Skills inventory</b>: Inventory of the capabilities of employees</p>
<p class="calibre1"><b class="calibre3">[ 18 ]</b></p>
<p class="calibre1"><a id="calibre_link-7"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Absence tracking</b>: Maintain basic attendance information</p>
<p class="calibre1"><b class="calibre3">Employee statistics</b>: Tracking government required employee attribute data such as age, gender, length of service</p>
<p class="calibre1"><b class="calibre3">Project management</b></p>
<p class="calibre1">The Business Central project management module consists of the job functionality that’s supported by the resources functionality. Projects can be short or long term. They can be external (in other words, billable) or internal. This module is often used by third parties as the base for vertical market add-ons (such as construction or job-oriented manufacturing). </p>
<p class="calibre1">This application area includes parts or all of the following functions:</p>
<p class="calibre1">Budgeting and cost tracking, for managing project finances</p>
<p class="calibre1">Scheduling, for planning project activities</p>
<p class="calibre1">Resource requirements and usage tracking, for managing people and equipment</p>
<p class="calibre1">Project accounting, for tracking the results</p>
<p class="calibre1"><b class="calibre3">A developer’s overview of Business Central</b></p>
<p class="calibre1">From the point of view of a developer, Business Central consists of about almost six thousand potentially customizable, off-the-shelf program objects, plus the <b class="calibre3">integrated</b> <b class="calibre3">development environment</b> (<b class="calibre3">IDE</b>/<b class="calibre3">Visual Studio Code</b>) development tools that allow us to modify existing objects and create new ones. </p>
<p class="calibre1"><b class="calibre3">Business Central object types</b></p>
<p class="calibre1">Let’s start with basic definitions of the Business Central object types:</p>
<p class="calibre1"><b class="calibre3">Table extension</b>: Table extensions allow for the creation of companion tables that are linked to tables defined by Microsoft in the base product or by other<br>solutions. </p>
<p class="calibre1"><b class="calibre3">Page customization</b>: Page customizations allow controls in existing pages to be modified and moved. As they are primarily a tool for use by end users, they are<br>outside the scope of this book. </p>
<p class="calibre1"><b class="calibre3">Page extension</b>: Page extensions allow controls in existing pages to be added or hidden. </p>
<p class="calibre1"><b class="calibre3">[ 19 ]</b></p>
<p class="calibre1"><a id="calibre_link-8"></a><img src="images/000407.png" alt="Image 8" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Table</b>: Tables serve both to define the data structure and to contain the data records. </p>
<p class="calibre1"><b class="calibre3">Page</b>: Pages are the way data is formatted and displayed appropriately for each of the client types and user roles. </p>
<p class="calibre1"><b class="calibre3">Report</b>: Reports are provided for the display of data to the user in hard copy format, either on-screen (preview mode) or via a printing device. Report objects can also update data in processes with or without data display. </p>
<p class="calibre1"><b class="calibre3">Codeunit</b>: Codeunits are containers for code that’s been utilized by other objects. </p>
<p class="calibre1">Codeunits are always structured in code segments called procedures. </p>
<p class="calibre1"><b class="calibre3">Query</b>: Queries support extracting data from one or more tables, making<br>calculations, and outputting them in the form of a new data structure. Queries<br>can output data directly into charts, Excel, XML, and OData. They can be used as an indirect source for pages and reports. </p>
<p class="calibre1"><b class="calibre3">XMLport</b>: XMLports allow for the importing and exporting of data to/from<br>external files. The external file structure can be in XML or other file formats. </p>
<p class="calibre1"><b class="calibre3">Profile</b>: Profiles allow the definition of Role Centers and group page<br>customizations. </p>
<p class="calibre1"><b class="calibre3">Control add-in</b>: Control add-in objects allow the display of HTML5</p>
<p class="calibre1">visualizations based on data from Business Central. These objects can send back<br>events that can be used to trigger additional code. </p>
<p class="calibre1"><b class="calibre3">The Visual Studio Code integrated development</b></p>
<p class="calibre1"><b class="calibre3">environment</b></p>
<p class="calibre1">Business Central includes an extensive set of software development tools. The Business Central development tools are accessed through Visual Studio Code. Visual Studio Code includes the <b class="calibre3">Application Language</b> (<b class="calibre3">AL</b>) compiler extension. All Business Central programming uses AL. </p>
<p class="calibre1">When used on premises, the old development environment C/SIDE can<br>also be used for development. To learn C/SIDE, refer to the following<br>book:  <i class="calibre4">Programming Microsoft Dynamics NAV</i>, 2017. The use of C/SIDE for</p>
<p class="calibre1">Business Central development is discouraged by Microsoft. </p>
<p class="calibre1"><b class="calibre3">[ 20 ]</b></p>
<p class="calibre1"><a id="calibre_link-9"></a><img src="images/000448.jpg" alt="Image 9" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">The Visual Studio Code IDE is Microsoft’s most popular code editor and is available for Windows, Linux, and macOS. The images used in this book will be from Windows. You can</p>
<p class="calibre1"><a href="https://code.visualstudio.com/">download Visual Studio Code from https:/​/​code.​visualstudio.​com/</a>​: <b class="calibre3">Visual Studio Code icons</b></p>
<p class="calibre1">When we open Visual Studio Code, we will see five icons. The icons appear on the left-hand side part of the screen. The icons determine the navigation part that appears on the left-hand side of your screen. If you click on an icon twice, the navigation part will be hidden and allow full screen code editing. </p>
<p class="calibre1"><b class="calibre3">[ 21 ]</b></p>
<p class="calibre1"><a id="calibre_link-10"></a><img src="images/000189.jpg" alt="Image 10" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Explorer</b></p>
<p class="calibre1">The <b class="calibre3">EXPLORER</b> view is the default view when you open a project. It allows you to view the files in a project and select one or more files for editing. The <b class="calibre3">EXPLORER</b> view is shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Search</b></p>
<p class="calibre1">The <b class="calibre3">SEARCH</b> view provides an advanced search and replace option within the files of your project. The <b class="calibre3">SEARCH</b> view is shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 22 ]</b></p>
<p class="calibre1"><a id="calibre_link-11"></a><img src="images/000052.jpg" alt="Image 11" class="calibre2" /></p>
<p class="calibre1"><img src="images/000071.jpg" alt="Image 12" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Source control</b></p>
<p class="calibre1">Visual Studio Code provides access to a built-in connection to <b class="calibre3">SOURCE CONTROL</b>. When source control is activated, all changes that are made to files are automatically tracked and displayed in this window:</p>
<p class="calibre1"><b class="calibre3">[ 23 ]</b></p>
<p class="calibre1"><a id="calibre_link-12"></a><img src="images/000159.png" alt="Image 13" class="calibre2" /></p>
<p class="calibre1"><img src="images/000181.png" alt="Image 14" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">The video at <a href="https://www.youtube.com/watch?v=NTY5VELbCWI&amp;t=22s">https:/​/​www.​youtube.​com/​watch?​v=​NTY5VELbCWI​t=​22s</a></p>
<p class="calibre1">explains how to get started with Source Control in Visual Studio Code. </p>
<p class="calibre1"><b class="calibre3">Debugger</b></p>
<p class="calibre1">You can connect Visual Studio Code to an active session of Business Central and use the built-in debugger to do basic troubleshooting for your code. The <b class="calibre3">DEBUG</b> view is shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Extensions</b></p>
<p class="calibre1">Out-of-the-box Visual Studio Code does not understand the Business Central <b class="calibre3">AL Language</b> syntax. To activate the compiler, an extension needs to be installed in the <b class="calibre3">EXTENSIONS</b></p>
<p class="calibre1">window. </p>
<p class="calibre1">This extension, called AL language, can be downloaded from the Visual Studio</p>
<p class="calibre1">Marketplace or installed directly from Visual Studio Code:</p>
<p class="calibre1"><b class="calibre3">[ 24 ]</b></p>
<p class="calibre1"><a id="calibre_link-13"></a><img src="images/000080.png" alt="Image 15" class="calibre2" /></p>
<p class="calibre1"><img src="images/000102.jpg" alt="Image 16" class="calibre2" /></p>
<p class="calibre1"><img src="images/000124.jpg" alt="Image 17" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><a href="https://marketplace.visualstudio.com/">The Visual Studio Code Marketplace can be found at https:/​/</a></p>
<p class="calibre1"><a href="https://marketplace.visualstudio.com/">marketplace.​visualstudio.​com/</a>​. </p>
<p class="calibre1"><b class="calibre3">AL programming language</b></p>
<p class="calibre1">The language in which Business Central is coded is AL. A small sample of AL code within the AL Editor is shown here:</p>
<p class="calibre1"><b class="calibre3">[ 25 ]</b></p>
<p class="calibre1"><a id="calibre_link-318"></a><img src="images/000341.png" alt="Image 18" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">AL syntax is similar to Pascal syntax. Code readability is always enhanced by careful programmer attention to structure and logical variable naming, and ensuring that the process flow is consistent with that of the code in the base product and that there is good documentation both inside and outside of the code. </p>
<p class="calibre1">Good software development focuses on design before coding and<br>accomplishing design goals with a minimal amount of code. Dynamics</p>
<p class="calibre1">Business Central facilitates that approach. In 2012, a team made up of</p>
<p class="calibre1">Microsoft and Business Central community members began the Business</p>
<p class="calibre1">Central design patterns project. As defined by Wikipedia,  <i class="calibre4">a design pattern</i></p>
<p class="calibre1"> <i class="calibre4">is a general reusable solution to a commonly occurring problem</i>. The following links provide information on the Business Central design patterns project:</p>
<p class="calibre1"><a href="http://blogs.msdn.com/b/nav/archive/2013/08/29/what-is-the-nav-design-patterns-project.aspx">http://blogs.msdn.com/b/nav/archive/2013/08/29/what-is-</a></p>
<p class="calibre1"><a href="http://blogs.msdn.com/b/nav/archive/2013/08/29/what-is-the-nav-design-patterns-project.aspx">the-nav-design-patterns-project.aspx</a></p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/default.aspx">https://community.dynamics.com/nav/w/designpatterns/def</a></p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/default.aspx">ault.aspx</a></p>
<p class="calibre1"><a href="https://www.packtpub.com/big-data-and-business-intelligence/learning-dynamics-nav-patterns">https://www.packtpub.com/big-data-and-business-intellig</a></p>
<p class="calibre1"><a href="https://www.packtpub.com/big-data-and-business-intelligence/learning-dynamics-nav-patterns">ence/learning-dynamics-nav-patterns</a></p>
<p class="calibre1">One of the primary goals of this project is to document patterns that exist<br>within Business Central. In addition, new best practice patterns have been<br>suggested as ways to solve common issues we encounter during our<br>customization efforts. Now, when we work on Business Central<br>enhancements, we will be aided by references to the documentation of<br>patterns within Business Central. This allows us to spend more of our<br>time designing a good solution using existing, proven procedures (the<br>documented patterns) and spend less time writing and debugging code. A</p>
<p class="calibre1">good reference for Business Central design and development using<br>patterns can be found here: <a href="https://www.packtpub.com/application-development/microsoft-dynamics-nav-2013-application-design">https:/​/​www.​packtpub.​com/​application-</a></p>
<p class="calibre1"><a href="https://www.packtpub.com/application-development/microsoft-dynamics-nav-2013-application-design">development/​microsoft-​dynamics-​nav-​2013-​application-​design. </a>​</p>
<p class="calibre1">You can refer to the  <i class="calibre4">Reusing Code</i> section of Business Central at <a href="https://docs.microsoft.com/en-us/previous-versions/dynamicsnav-2009/dd355277(v=nav.60)">https:/​/​docs.​microsoft. </a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/previous-versions/dynamicsnav-2009/dd355277(v=nav.60)">com/​en-​us/​previous-​versions/​dynamicsnav-​2009/​dd355277(v=​nav.​60)</a>. </p>
<p class="calibre1">Much of our Business Central development work is done by assembling references to previously defined objects and procedures, adding new data structures where necessary. </p>
<p class="calibre1">As the tools for Business Central design and development that are provided both by Microsoft and by the Business Central community continue to mature, our development work becomes more oriented toward design and less toward coding. The end result is that we are more productive and cost-effective on behalf of our customers. Everyone wins. </p>
<p class="calibre1"><b class="calibre3">[ 26 ]</b></p>
<p class="calibre1"><a id="calibre_link-14"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Business Central object and system elements</b></p>
<p class="calibre1">Here are some important terms that are used in Business Central:</p>
<p class="calibre1"><b class="calibre3">Language extension</b>: A file that’s downloaded from the Visual Studio Code</p>
<p class="calibre1">Marketplace or supplied by Microsoft. The version of the language extension in<br>use must match the build version of Business Central with which you are<br>working. Microsoft does a monthly update of Business Central and the language<br>extension. There is also an insider program that allows early access before the<br>language extension is published on the Marketplace. </p>
<p class="calibre1"><b class="calibre3">Field</b>: An individual data item, defined either in a table or in the working storage (temporary storage) of an object. </p>
<p class="calibre1"><b class="calibre3">Record</b>: A group of fields (data items) that are handled as a unit in many operations. Table data consists of rows (records) with columns (fields). </p>
<p class="calibre1"><b class="calibre3">Control</b>: In MSDN, a control is defined as a component that provides (or enables) UI capabilities. </p>
<p class="calibre1"><b class="calibre3">Properties</b>: These are the attributes of the element, such as an object, field, record, or control that define some aspect of its behavior or use. Example property<br>attributes include display captions, relationships, size, position, and whether the element is editable or viewable. </p>
<p class="calibre1"><b class="calibre3">Trigger</b>: These are mechanisms that initiate (fire) an action when an event occurs and is communicated to the application object. A trigger in an object is either<br>empty, contains code that is executed when the associated event fires the trigger, or only contains comments (in a few cases, this affects the behavior of the<br>trigger). Each object type, data field, control, and so on may have its own set of predefined triggers. The event trigger name begins with On, such as OnInsert, </p>
<p class="calibre1">OnOpenPage, or OnNextRecord. Business Central triggers have similarities to<br>those in SQL, but they are not the same (similarly named triggers may not even<br>serve similar purposes). Business Central triggers are locations within objects<br>where a developer can place comments or AL code. When we view the AL code<br>of an object in its designer, we can see non-trigger code groups that resemble</p>
<p class="calibre1">Business Central event-based triggers. </p>
<p class="calibre1"><b class="calibre3">Procedures</b>: These can be defined by the developer. They are callable routines that can be accessed by other AL code from either inside or outside the object<br>where the called function resides. When we view the AL code of an object in its<br>designer, we can see non-trigger code groups that resemble Business Central<br>event-based triggers. Many procedures are provided as part of the standard<br>product. As developers, we may add our own custom procedures as needed. </p>
<p class="calibre1"><b class="calibre3">[ 27 ]</b></p>
<p class="calibre1"><a id="calibre_link-324"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Object numbers and field numbers</b>: All objects of the same object type are assigned a number that’s unique within the object type. All fields within an object are assigned a number that’s unique within the object (that is, the same field<br>number may be repeated within many objects, regardless of whether it is<br>referring to similar or different data). In this book, we will generally use comma notation for these numbers (fifty thousand is 50,000). In AL, no punctuation is<br>used. The object numbers from 1 (one) to 50,000 and in the 99,000,000 (99 million) range are reserved for use by Business Central as part of the base product. </p>
<p class="calibre1">Objects in these number ranges can be modified or deleted with a developer’s<br>license, but cannot be created. Field numbers in standard objects often start with one (1). Historically, object and field numbers from 50,000 to 99,999 are generally available to the rest of us for assignment as part of customizations that are<br>developed in the field using a normal development license. Field numbers from</p>
<p class="calibre1">90,000 to 99,999 should not be used for new fields that have been added to<br>standard tables as those numbers are sometimes used in training materials. </p>
<p class="calibre1">Microsoft allocates ranges of object and field numbers to <b class="calibre3">Independent Software</b> <b class="calibre3">Vendor</b> (<b class="calibre3">ISV</b>) developers for their add-on enhancements. Some such objects (the 14 million range in North America, and other ranges for other geographic<br>regions) can be accessed, modified, or deleted, but not created using a normal<br>development license. Others (such as in the 37 million range) can be executed but not viewed or modified with a typical development license. The following table<br>summarizes the object numbering practice:</p>
<p class="calibre1"><b class="calibre3">Object number range</b></p>
<p class="calibre1"><b class="calibre3">Usage</b></p>
<p class="calibre1">1 - 9,999</p>
<p class="calibre1">Base-application objects</p>
<p class="calibre1">10,000 - 49,999</p>
<p class="calibre1">Country-specific objects</p>
<p class="calibre1">50,000 - 99,999</p>
<p class="calibre1">Customer-specific objects</p>
<p class="calibre1">100,000 - 98,999,999</p>
<p class="calibre1">Partner-created objects</p>
<p class="calibre1">Above 98,999,999</p>
<p class="calibre1">Microsoft territory</p>
<p class="calibre1"><b class="calibre3">Events</b>: Procedures can subscribe to events that are raised in the system. Business Central has both platform and manual events. Procedures can also be used to<br>raise events. </p>
<p class="calibre1"><b class="calibre3">[ 28 ]</b></p>
<p class="calibre1"><a id="calibre_link-330"></a><img src="images/000312.png" alt="Image 19" class="calibre2" /></p>
<p class="calibre1"><img src="images/000333.jpg" alt="Image 20" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Work date</b>: This is a date that’s controlled by the user operator. It is used as the default date for many transaction entries. The system date is the date that’s<br>recognized by Windows. The work date that can be adjusted at any time by the<br>user is specific to the workstation, and can be set to any point in the future or the past. This is very convenient for procedures such as the ending sales order entry for one calendar day at the end of the first shift, and then entering sales orders by the second shift dated to the next calendar day. There are settings to allow you to limit the range of work dates allowed. The work date can be set by clicking on<br>the cogwheel drop-down list next to the question mark icon and selecting the <b class="calibre3">My</b> <b class="calibre3">Settings</b> option:</p>
<p class="calibre1">Clicking on <b class="calibre3">My Settings</b> in the drop-down options displays the <b class="calibre3">My Settings</b> screen. Here, we can enter a new <b class="calibre3">Work Date</b>:</p>
<p class="calibre1"><b class="calibre3">[ 29 ]</b></p>
<p class="calibre1"><a id="calibre_link-15"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Business Central functional terminology</b></p>
<p class="calibre1">For various application functions, Business Central uses terminology that is more similar to accounting than to traditional data processing terminology. Here are some examples: <b class="calibre3">Journal</b>: A table of unposted transaction entries, each of which represents an event, an entity, or an action to be processed. There are general journals for<br>general accounting entries, item journals for changes in inventory, and so on. </p>
<p class="calibre1"><b class="calibre3">Ledger</b>: A detailed history of posted transaction entries that have been processed, for example, the general ledger, customer ledger, vendor ledger, and item ledger. </p>
<p class="calibre1">Some ledgers have subordinate detail ledgers, typically providing a greater level of quantity and/or value detail. With minor exceptions, ledger entries cannot be edited. This maintains auditable data integrity. </p>
<p class="calibre1"><b class="calibre3">Posting</b>: The process by which entries in a journal are validated, and then entered into one or more ledgers. </p>
<p class="calibre1"><b class="calibre3">Batch</b>: A group of one or more journal entries, posted at the same time. </p>
<p class="calibre1"><b class="calibre3">Register</b>: An audit trail showing a history, by entry number ranges, of posted journal batches. </p>
<p class="calibre1"><b class="calibre3">Document</b>: A formatted page such as an invoice, a purchase order, or a payment check, typically one page for each primary transaction (a page may require<br>display scrolling to be fully viewed). </p>
<p class="calibre1"><b class="calibre3">User interface</b></p>
<p class="calibre1">The Business Central UI is designed to be role oriented (also called role tailored). The term role oriented means tailoring the available options to fit the user-specific job tasks and responsibilities. </p>
<p class="calibre1">The first page that a user will see is the Role Center page. The Role Center page provides the user with a view of work tasks to be done; it acts as the user home page. The home Role Center page should be tailored to the job duties of each user, so there will be a variety of Role Center page formats for any installation. </p>
<p class="calibre1">Someone whose role is focused on order entry will probably see a different Role Center home page than the user whose role focuses on invoicing, even though both user roles are in what we generally think of as sales and receivables. The Business Central tailorable Role Center allows a great deal of flexibility for implementers, system administrators, managers, and individual users to configure and reconfigure screen layouts and the set of functions that are visible to a particular user. </p>
<p class="calibre1"><b class="calibre3">[ 30 ]</b></p>
<p class="calibre1"><a id="calibre_link-332"></a><img src="images/000196.jpg" alt="Image 21" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">The following screenshot is the out-of-the-box Role Center:</p>
<p class="calibre1">The key to properly designing and implementing any system, especially a role tailored system, is the quality of the user profile analysis that’s done as the first step in requirements analysis. User profiles identify the day-to-day needs of each user’s responsibilities, relative to accomplishing the business’s goals. Each user’s tasks must be mapped to individual Business Central functions or elements, identifying how those tasks will be supported by the system. A successful implementation requires the use of a proven methodology. It is very important that the up-front work is done and done well. The best programming cannot compensate for a bad definition of goals. </p>
<p class="calibre1">In our exercises, we will assume that the up-front work has been well done, and we will concentrate on addressing the requirements that have been defined by our project team. </p>
<p class="calibre1"><b class="calibre3">[ 31 ]</b></p>
<p class="calibre1"><a id="calibre_link-16"></a><img src="images/000284.png" alt="Image 22" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Hands-on development in Business Central</b></p>
<p class="calibre1">One of the best ways to learn a new set of tools, like those that make up a programming language and environment, is to experiment with them. We’re going to have some fun doing that throughout this book. We’re going to experiment where the cost of errors (otherwise known as learning) is small. Our development work will be a custom </p>
<p class="calibre1">application of Business Central for a relatively simple, but realistic, application. </p>
<p class="calibre1">We’re going to do our work using the Cronus demo database that is available with all Business Central distributions and is installed by default when we install the Business Central demo system. The simplest way is to use the sandbox. </p>
<p class="calibre1">You can find up-to-date information on getting started with Business</p>
<p class="calibre1">Central sandboxes on Microsoft Docs at <a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-sandbox-overview">https:/​/​docs.​microsoft.​com/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-sandbox-overview">en-​us/​dynamics365/​business-​central/​dev-​itpro/​developer/​devenv-</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-sandbox-overview">sandbox-​overview. </a></p>
<p class="calibre1">The Cronus database contains all of the Business Central objects and a small, but reasonably complete, set of data populated in most of the system’s functional application areas. Our exercises will interface very slightly with the Cronus data, but will not depend on any specific data values already there. </p>
<p class="calibre1"><b class="calibre3">Business Central development exercise scenario</b></p>
<p class="calibre1">Our business is a small radio station that features a variety of programming, news, music, listener call-ins, and other program types. Our station call letters are WDTU. Our broadcast materials come from several sources and in several formats: vinyl records, CDs, MP3s, and downloaded digital (usually MP3s). While our station has a large library, especially of recorded music, sometimes, our program hosts (also called disc jockeys or DJs) want to share material from other sources. For that reason, we need to be able to easily add items to our playlists (the list of what is to be broadcast) and also have an easy-to-access method for our DJs to preview MP3 material. </p>
<p class="calibre1">Like any business, we have accounting and activity tracking requirements. Our income is from selling advertisements. We must pay royalties for music played, fees for purchased materials, such as prepared text for news, sports, and weather information, and service charges for our streaming internet broadcast service. As part of our licensed access to the public airwaves, a radio station is required to broadcast public service programming at no charge. </p>
<p class="calibre1"><b class="calibre3">[ 32 ]</b></p>
<p class="calibre1"><a id="calibre_link-17"></a><img src="images/000326.jpg" alt="Image 23" class="calibre2" /></p>
<p class="calibre1"><img src="images/000347.jpg" alt="Image 24" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Often, this is in the form of <b class="calibre3">public service announcements</b> (<b class="calibre3">PSAs</b>), such as encouraging traffic safety or reduction in tobacco use. Like all radio stations, we must plan what is to be broadcast (create schedules) and track what has been broadcast (such as ads, music, purchased programming, and PSAs) by date and time. We bill our customers for the advertising, pay our vendors their fees and royalties, and report our public service data to the appropriate government agency. </p>
<p class="calibre1"><b class="calibre3">Getting started with application design</b></p>
<p class="calibre1">The design for our radio station will start with a Radio Show table, a Radio Show Card page, a Radio Show List page, and a simple Radio Show List report. Along the way, we will review the basics of each Business Central object type. </p>
<p class="calibre1">When we open Visual Studio, we need to create a new project folder. This can be done using the Command Palette via <b class="calibre3">View</b> | <b class="calibre3">Command Palette… </b> or  <i class="calibre4">Ctrl</i> +  <i class="calibre4">Shift</i> +  <i class="calibre4">P</i>. Then, type AL:Go!:</p>
<p class="calibre1">The project folder will default to your Documents folder if you run this on a Windows machine. We will call our project WDTU:</p>
<p class="calibre1"><b class="calibre3">[ 33 ]</b></p>
<p class="calibre1"><a id="calibre_link-18"></a><img src="images/000410.jpg" alt="Image 25" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Folder structure</b></p>
<p class="calibre1">A folder called WDTU is created with some default files and subfolders. The HelloWorld.al file can be deleted immediately:</p>
<p class="calibre1"><b class="calibre3">launch.json</b></p>
<p class="calibre1">Inside a subfolder called .vscode, a file is created called launch.json that defines the connection to your Business Central sandbox:</p>
<p class="calibre1">name: For documentation purposes only. You can put the name of your project<br>here. The content of this property does not affect the behavior. </p>
<p class="calibre1">server: This contains a URL to the development endpoint of your sandbox. </p>
<p class="calibre1">serverInstance: A server can have multiple instances. </p>
<p class="calibre1">authentication: This can be UserPassword, AAD, or Windows. The default is</p>
<p class="calibre1">UserPassword. </p>
<p class="calibre1">startupObjectId: This option determines which object is executed when the<br>project is published. </p>
<p class="calibre1">startupObjectType: This allows a switch between executing a table or a page<br>upon publishing. </p>
<p class="calibre1"><b class="calibre3">[ 34 ]</b></p>
<p class="calibre1"><a id="calibre_link-19"></a><img src="images/000431.jpg" alt="Image 26" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">app.json</b></p>
<p class="calibre1">The app.json file contains properties about your extension, such as the name and version. </p>
<p class="calibre1">All properties are explained in the Microsoft Docs (<a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-json-files">https:/​/​docs.​microsoft.​com/​en-​us/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-json-files">dynamics365/​business-​central/​dev-​itpro/​developer/​devenv-​json-​files). We will only</a></p>
<p class="calibre1">populate the mandatory properties for now:</p>
<p class="calibre1">id: This is a unique ID for your extension and is autogenerated.  <i class="calibre4">Never</i> change this value. </p>
<p class="calibre1">name: The name of your extension as it will be displayed to the user. </p>
<p class="calibre1">publisher: This usually contains the name of the company or individual who<br>owns the intellectual property of the extension. </p>
<p class="calibre1">version: Your extensions can be versioned using this property. You can use this<br>when you create a new version of the extension to determine if upgrade code<br>needs to be executed. </p>
<p class="calibre1">idRange: This tells the compiler which object numbers are to be used for this<br>extension. You must provide a range for application object IDs in the format</p>
<p class="calibre1">“idRanges”: [{“from”: 50100,“to”: 50200},{“from”: 50202,“to”: 50300}]. </p>
<p class="calibre1"><b class="calibre3">Symbol files</b></p>
<p class="calibre1">Before we can start creating our extension, we need to perform one more step, that is,downloading the symbol files. The compiler needs the symbol files to determine whether the dependencies are correct. The symbol files contain metadata about other extensions. To download the default symbol files from Business Central, we need to select <b class="calibre3">Al: Download</b> <b class="calibre3">Symbols</b> from the Visual Studio Command Palette:</p>
<p class="calibre1"><b class="calibre3">[ 35 ]</b></p>
<p class="calibre1"><a id="calibre_link-20"></a><img src="images/000452.png" alt="Image 27" class="calibre2" /></p>
<p class="calibre1"><img src="images/000019.png" alt="Image 28" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">When the symbol files are downloaded, they are placed in the</p>
<p class="calibre1">,/alpackages folder of your project. </p>
<p class="calibre1"><b class="calibre3">Application tables</b></p>
<p class="calibre1">Table objects are the foundation of every Business Central application. Tables contain data structure definitions, as well as properties that describe the behavior of the data, including data validations and constraints. </p>
<p class="calibre1">More business logic is required in complex applications than in simple data type validation, and Business Central allows AL code to be put in the table to control the insertion, modification, and deletion of records, as well as logic on the field level. When the bulk of the business logic is coded on the table level, it is easier to develop, debug, support, modify, and even upgrade. Good design in Business Central requires that as much of the business logic as possible resides in the tables. Having the business logic coded on the table level doesn’t necessarily mean that the code resides in the table. </p>
<p class="calibre1">The Business Central online documentation recommends the following<br>guidelines for placing AL code:</p>
<p class="calibre1">In general, put the code in codeunits instead of on the object on<br>which it operates. This promotes a clean design and provides<br>the ability to reuse code. It also helps enforce security. For<br>example, typically, users do not have direct access to tables that<br>contain sensitive data, such as the general ledger entry table, </p>
<p class="calibre1">nor do they have permission to modify objects. If you put the<br>code that operates on the general ledger in a codeunit, give the<br>codeunit access to the table, and give the user permission to<br>execute the codeunit, then you will not compromise the security<br>of the table and the user will be able to access the table. </p>
<p class="calibre1">If you must put code on an object instead of in a codeunit, then<br>put the code as close as possible to the object on which it<br>operates. For example, put code that modifies records in the<br>triggers of the table fields. </p>
<p class="calibre1"><b class="calibre3">[ 36 ]</b></p>
<p class="calibre1"><a id="calibre_link-21"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Designing a simple table</b></p>
<p class="calibre1">Our primary master data table will be the Radio Show table. This table lists our inventory of shows that are available to be scheduled. </p>
<p class="calibre1">First, create a new file in Visual Studio Code. Click on <b class="calibre3">File</b> | <b class="calibre3">New</b> and Visual Studio Code will create a new file and open the code editor window. </p>
<p class="calibre1">Each master table has a standard field for the primary key (a Code data type field of 20</p>
<p class="calibre1">characters called No.) and has standard information regarding the entity the master record represents (for example, Name, Address, and City for the Customer table, and</p>
<p class="calibre1">Description, Base Unit of Measure, and Unit Cost for the Item table). </p>
<p class="calibre1">The Radio Show table will have the following field definitions (we may add more later on): <b class="calibre3">Field names</b></p>
<p class="calibre1"><b class="calibre3">Definitions</b></p>
<p class="calibre1">No. </p>
<p class="calibre1">20-character text (code)</p>
<p class="calibre1">Radio Show Type</p>
<p class="calibre1">10-character text (code)</p>
<p class="calibre1">Name</p>
<p class="calibre1">50-character text</p>
<p class="calibre1">Run Time</p>
<p class="calibre1">Duration</p>
<p class="calibre1">Host No. </p>
<p class="calibre1">20-character text (code)</p>
<p class="calibre1">Host Name</p>
<p class="calibre1">50-character text</p>
<p class="calibre1">Average Listeners</p>
<p class="calibre1">Decimal</p>
<p class="calibre1">Audience Share</p>
<p class="calibre1">Decimal</p>
<p class="calibre1">Advertising Revenue</p>
<p class="calibre1">Decimal</p>
<p class="calibre1">Royalty Cost</p>
<p class="calibre1">Decimal</p>
<p class="calibre1">In the preceding list, three of the fields are defined as Code fields, which are text fields that limit the alphanumeric characters to uppercase values. Code fields are used throughout Business Central for primary key values. Code fields are used to reference or be referenced by other tables (foreign keys). No. will be the unique identifier in our table. We will utilize a set of standard internal Business Central functions to assign a user-defined No. series range that will auto-increment the value on table insertion and possibly allow for user entry (as long as it is unique in the table) based on a setup value. The Host No. references the standard Resource table, and the Radio Show Type field will reference a custom table that we will create to allow for flexible Type values. </p>
<p class="calibre1">We will have to design and define the reference properties at the field level in the table designer, as well as compile them, before the validation will work. At this point, let’s just get started with these field definitions and create the foundation for the Radio Show table. </p>
<p class="calibre1"><b class="calibre3">[ 37 ]</b></p>
<p class="calibre1"><a id="calibre_link-22"></a><img src="images/000040.png" alt="Image 29" class="calibre2" /></p>
<p class="calibre1"><img src="images/000059.jpg" alt="Image 30" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Creating a simple table</b></p>
<p class="calibre1">The easiest way to create a table the easiest way is by using snippets. To use snippets, Visual Studio Code needs to understand that our file is written in the AL language. This is simply done by saving the file with the .al extension. We will save our newly created file using <b class="calibre3">File</b> | <b class="calibre3">Save</b> and using a name that makes sense later. Let’s use Radio Show.al for now:</p>
<p class="calibre1">Now, we can use the snippet called ttable. If we type in the letters tta, IntelliSense will suggest this snippet:</p>
<p class="calibre1"><b class="calibre3">[ 38 ]</b></p>
<p class="calibre1"><a id="calibre_link-319"></a><img src="images/000081.png" alt="Image 31" class="calibre2" /></p>
<p class="calibre1"><img src="images/000103.png" alt="Image 32" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">This snippet creates content for our file and sets the cursor on the place where we need to define the object ID:</p>
<p class="calibre1">We will type 50100 and use  <i class="calibre4">Tab</i> to go to the next field, object name, where we will type</p>
<p class="calibre1">“Radio Show”. </p>
<p class="calibre1">The snippet has already created a field with the default ID of 1. The field name is MyField and the type is Integer. We will change the name to “No.” and the type to Code [20]. </p>
<p class="calibre1">The next field can be field number 2. Sometimes, it is useful to leave large gaps (such as jumping from 80 to 200 or 500) when the next set of fields has a particular purpose that isn’t associated with the prior set of fields. </p>
<p class="calibre1">The fields combining the primary key can use numbers up to nine since<br>they are very unlikely to change. If this is changed at a later date, then a<br>substantial amount of refactoring has to be done. </p>
<p class="calibre1"><b class="calibre3">[ 39 ]</b></p>
<p class="calibre1"><a id="calibre_link-320"></a><img src="images/000125.png" alt="Image 33" class="calibre2" /></p>
<p class="calibre1"><img src="images/000147.png" alt="Image 34" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">The Business Central online documentation says to not leave gaps in field numbers. Based on many years of experience, we disagree. Leaving numbering gaps will allow us to add additional fields between existing fields at a later date, if necessary. The result will be data structures that are (at least initially) easier to read and understand. Once a table is referenced by other objects or contains any data, the field numbers of the previously defined fields should not be changed. </p>
<p class="calibre1">The following screenshot shows our new table definition in the table designer:</p>
<p class="calibre1">Note that you can remove anything you don’t need from the snippet. In<br>our case, we removed the DataClassification and keys sections, the<br>variable declaration, and triggers. </p>
<p class="calibre1"><b class="calibre3">[ 40 ]</b></p>
<p class="calibre1"><a id="calibre_link-23"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Pages</b></p>
<p class="calibre1">Pages provide views of data or processes that are designed for on-screen display (or exposure as web services), and also allow user data entry into the system. Pages act as containers for action items (menu options). </p>
<p class="calibre1">There are several basic types of display/entry pages in Business Central:</p>
<p class="calibre1">List</p>
<p class="calibre1">Card</p>
<p class="calibre1">Document</p>
<p class="calibre1">Journal/worksheet</p>
<p class="calibre1">List plus</p>
<p class="calibre1">Confirmation dialog</p>
<p class="calibre1">Standard dialog</p>
<p class="calibre1">There are also page parts (they look and program like a page, but aren’t intended to stand alone), as well as UIs that display like pages, but are not page objects. The latter user interfaces are generated by various dialog functions. In addition, there are special page types, such as <b class="calibre3">Role Center</b> pages and <b class="calibre3">Navigate</b> pages (for wizards). </p>
<p class="calibre1"><b class="calibre3">Standard elements of pages</b></p>
<p class="calibre1">A page consists of page properties and triggers, controls, and control properties. Data controls are generally either labels displaying constant text or graphics, or containers that display data or other controls. Controls can also be buttons, action items, and page parts. </p>
<p class="calibre1">While there are a few instances where we must include AL code within page or page control triggers, it is good practice to minimize the amount of code embedded within pages. Any data-related AL code should be located in the table object rather than in the page object. </p>
<p class="calibre1"><b class="calibre3">[ 41 ]</b></p>
<p class="calibre1"><a id="calibre_link-24"></a><img src="images/000169.jpg" alt="Image 35" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">List pages</b></p>
<p class="calibre1">List pages display a simple list of any number of records in a single table. The <b class="calibre3">Customers</b> list page (with its associated FactBoxes) in the following screenshot shows a subset of the data for each customer displayed. List pages/forms often do not allow you to enter or edit data. Journal/worksheet pages look like list pages, but are intended for data entry. Standard list pages are always displayed with the navigation pane on the left: <b class="calibre3">Card pages</b></p>
<p class="calibre1">Card pages display one record at a time. These are generally used for the entry or display of individual table records. Examples of frequently accessed card pages include <b class="calibre3">Customer</b> <b class="calibre3">Card</b> for customer data, <b class="calibre3">Item Card</b> for inventory items, and <b class="calibre3">G/L Account Card</b> for general ledger accounts. </p>
<p class="calibre1">Card pages have FastTabs (a FastTab consists of a group of controls, with each tab focusing on a different set of related customer data). FastTabs can be expanded or collapsed dynamically, allowing the data that’s visible to be controlled by the user at any time. </p>
<p class="calibre1">Important data elements can be promoted to be visible, even when a FastTab is collapsed. </p>
<p class="calibre1"><b class="calibre3">[ 42 ]</b></p>
<p class="calibre1"><a id="calibre_link-25"></a><img src="images/000191.jpg" alt="Image 36" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Card pages for master records display all the required data entry fields. If a field is set to ShowMandatory (a control property that we will discuss in <a href="#calibre_link-91">Chapter 4, </a> <i class="calibre4">Pages &ndash; the</i> <i class="calibre4">Interactive Interface</i>), a red asterisk will display until the field is filled. Typically, card pages also display FactBoxes that contain summary data about related activity. Thus, cards can be used as the primary inquiry point for master records. The following screenshot is a sample of a standard customer card<b class="calibre3">:</b></p>
<p class="calibre1"><b class="calibre3">Document pages</b></p>
<p class="calibre1">A document page looks like a card page with one tab containing a <b class="calibre3">list part</b> page. An example of a document page is the <b class="calibre3">Sales Orders</b> page that’s shown in the following screenshot. In this example, the first tab and the last four tabs are in card page format, and show <b class="calibre3">Sales Orders</b> data fields that have a single occurrence on the page (in other words, they do not occur in a repeating column). </p>
<p class="calibre1"><b class="calibre3">[ 43 ]</b></p>
<p class="calibre1"><a id="calibre_link-26"></a><img src="images/000213.jpg" alt="Image 37" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">The second tab from the top is in a list part page format (all fields are in repeating columns) that shows the <b class="calibre3">Sales Orders</b> line items. <b class="calibre3">Sales Orders</b> line items may include products to be shipped, special charges, comments, and other pertinent order details. The information to the right of the data entry area is related to data and computations (FactBoxes) that have been retrieved and formatted. The top FactBox contains information about the ordering customer. The bottom FactBox contains information about the item on the currently highlighted sales line:</p>
<p class="calibre1"><b class="calibre3">Journal/worksheet pages</b></p>
<p class="calibre1">Journal and worksheet pages look very much like list pages. They display a list of records in the body of the page. Many also have a section at the bottom that shows details about the selected line and/or totals for the displayed data. These pages may include a filter pane and perhaps a FactBox. The biggest difference between journal/worksheet pages and basic list pages is that journal and worksheet pages are designed to be used for data entry (though this may be a matter of personal or site preference). </p>
<p class="calibre1"><b class="calibre3">[ 44 ]</b></p>
<p class="calibre1"><a id="calibre_link-27"></a><img src="images/000235.jpg" alt="Image 38" class="calibre2" /></p>
<p class="calibre1"><img src="images/000257.jpg" alt="Image 39" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">An example of the <b class="calibre3">Payment Journals</b> page in finance is shown in the following screenshot: <b class="calibre3">Creating a list page</b></p>
<p class="calibre1">Now, we will create a list page for the table we created earlier. A list page is the initial page that is displayed when a user initally accesses any data table for the first time. The Business Central Development Environment has wizards (object generation tools) to help you create basic pages. Generally, after our wizard work is done, we will spend additional time in the page design tool to make the layout ready for users. </p>
<p class="calibre1">Our first list page will be the basis for viewing our Radio Show master records. From Visual Studio Code, click on <b class="calibre3">New</b>, then click on <b class="calibre3">File</b>. A <b class="calibre3">New Page</b> screen will appear. Click on <b class="calibre3">New</b>, type in the name of the file to be saved, and then click on <b class="calibre3">Save</b>. Enter the name (Radio Show Page.al). Now, we can use the snippet for the list pages called <b class="calibre3">tpage</b>:</p>
<p class="calibre1"><b class="calibre3">[ 45 ]</b></p>
<p class="calibre1"><a id="calibre_link-350"></a><img src="images/000279.jpg" alt="Image 40" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Now we will set ID to 50100 and the name to “Radio Show List” , and change the SourceTable to “Radio Show”, as shown in the following screenshot:</p>
<p class="calibre1">After doing this, we can see that NameSource is highlighted as a problem, and the <b class="calibre3">PROBLEMS</b> window at the bottom of our screen tells us that NameSource does not exist in the context. </p>
<p class="calibre1">The reason why this problem is occurring is because of the combination of the table object and this page. We joined these objects by selecting the Radio Show table as SourceTable for this page. By joining them, the page object now has a dependency on the table object. </p>
<p class="calibre1">The next step will be to add the fields from the table to the page in the repeater. We will remove the NameSource field to do so. </p>
<p class="calibre1"><b class="calibre3">[ 46 ]</b></p>
<p class="calibre1"><a id="calibre_link-351"></a><img src="images/000300.png" alt="Image 41" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">We should also remove everything we do not need, such as FactBoxes and actions:</p>
<p class="calibre1"><b class="calibre3">[ 47 ]</b></p>
<p class="calibre1"><a id="calibre_link-352"></a><img src="images/000321.jpg" alt="Image 42" class="calibre2" /></p>
<p class="calibre1"><img src="images/000342.jpg" alt="Image 43" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">We can <b class="calibre3">Preview</b> the page by making a modification to the launch.json file. Change the startupObjectId to 50100 and select <b class="calibre3">AL: Publish without debugging</b> from the Command Palette, as shown in the following screenshot:</p>
<p class="calibre1">This will launch the Business Central application with our newly created page as the startup object:</p>
<p class="calibre1">Because our table does not contain any data, we will only see a header with the name of our page. </p>
<p class="calibre1"><b class="calibre3">[ 48 ]</b></p>
<p class="calibre1"><a id="calibre_link-28"></a><img src="images/000363.png" alt="Image 44" class="calibre2" /></p>
<p class="calibre1"><img src="images/000384.png" alt="Image 45" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Creating a card page</b></p>
<p class="calibre1">Now, let’s create a card page. The process for a card page is almost the same as for a list page, but using a different snippet. Our page number will be 50101 , and the name will be Radio Show Card:</p>
<p class="calibre1">You can copy and paste most of the definitions from the list page file, or<br>even use <b class="calibre3">File</b> and <b class="calibre3">Save As</b> in Visual Studio Code if you find that faster or easier to use. </p>
<p class="calibre1"><b class="calibre3">[ 49 ]</b></p>
<p class="calibre1"><a id="calibre_link-29"></a><img src="images/000405.png" alt="Image 46" class="calibre2" /></p>
<p class="calibre1"><img src="images/000426.png" alt="Image 47" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Let’s change the launch.json file to this new page and publish the extension again. We can preview the page by making a modification to the launch.json file. Change the startupObjectId to 50101 and select <b class="calibre3">AL: Publish without debugging</b> from the Command Palette, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Creating some sample data</b></p>
<p class="calibre1">Even though we haven’t added all the bells and whistles to our Radio Show table and pages, we can still use them to enter sample data. The <b class="calibre3">Radio Show List</b> page will be the easiest to use for this. </p>
<p class="calibre1">We will now revert the launch.json file to run the 50100 page, as originally defined, and then publish the extension. In the published window, we will click on <b class="calibre3">New</b> and see the following screen:</p>
<p class="calibre1"><b class="calibre3">[ 50 ]</b></p>
<p class="calibre1"><a id="calibre_link-30"></a><img src="images/000447.png" alt="Image 48" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Enter the data shown in the following table so that we can see what the page looks like when it contains data. Later on, after we have added more capabilities to our table and pages, some fields will be validated, and some will be either automatically entered or available on a lookup basis. But for now, simply key in each field value. If the data we key in now conflicts with the validations we create later (such as data in referenced tables), we may have to delete this test data and enter new test data later:</p>
<p class="calibre1"><b class="calibre3">No. </b></p>
<p class="calibre1"><b class="calibre3">Radio Show</b></p>
<p class="calibre1"><b class="calibre3">Type</b></p>
<p class="calibre1"><b class="calibre3">Description</b></p>
<p class="calibre1"><b class="calibre3">Host Code Host Name</b></p>
<p class="calibre1"><b class="calibre3">Run Time</b></p>
<p class="calibre1">RS001 TALK</p>
<p class="calibre1">CeCe and Friends</p>
<p class="calibre1">CECE</p>
<p class="calibre1">CeCe Grace</p>
<p class="calibre1">2 hours</p>
<p class="calibre1">Alec Rocks and</p>
<p class="calibre1">RS002 MUSIC</p>
<p class="calibre1">ALEC</p>
<p class="calibre1">Alec Benito</p>
<p class="calibre1">2 hours</p>
<p class="calibre1">Bops</p>
<p class="calibre1">RS003 CALL-IN</p>
<p class="calibre1">Ask Cole! </p>
<p class="calibre1">COLE</p>
<p class="calibre1">Cole Henry</p>
<p class="calibre1">2 hours</p>
<p class="calibre1">RS004 CALL-IN</p>
<p class="calibre1">What do you think? WESLEY</p>
<p class="calibre1">Wesley Ernest</p>
<p class="calibre1">1 hour</p>
<p class="calibre1">RS005 MUSIC</p>
<p class="calibre1">Quiet Times</p>
<p class="calibre1">SASKIA</p>
<p class="calibre1">Saskia Mae</p>
<p class="calibre1">3 hours</p>
<p class="calibre1">RS006 NEWS</p>
<p class="calibre1">World News</p>
<p class="calibre1">DAAN</p>
<p class="calibre1">Daan White</p>
<p class="calibre1">1 hour</p>
<p class="calibre1">RS007 ROCK</p>
<p class="calibre1">Rock Classics</p>
<p class="calibre1">JOSEPH</p>
<p class="calibre1">Josephine Black</p>
<p class="calibre1">2 hours</p>
<p class="calibre1">RS008 TALK</p>
<p class="calibre1">Kristels Babytalks KRIS</p>
<p class="calibre1">Kristel van Vugt 1 hour</p>
<p class="calibre1">We will use the testability framework for automated testing later in this<br>book. A test codeunit is provided in the downloads, but for now it is<br>recommended to key in the data manually. </p>
<p class="calibre1"><b class="calibre3">Creating a list report</b></p>
<p class="calibre1">To create a report, we will use the report snippet and create the 50000 Radio Shows report. </p>
<p class="calibre1">Open <b class="calibre3">Object Designer</b>, select <b class="calibre3">Report</b>, and click <b class="calibre3">New</b>. The <b class="calibre3">Report Dataset Designer</b> is empty when it is displayed, so we need to add a <b class="calibre3">Data Source</b> (table) to the first blank row. </p>
<p class="calibre1"><b class="calibre3">[ 51 ]</b></p>
<p class="calibre1"><a id="calibre_link-353"></a><img src="images/000013.png" alt="Image 49" class="calibre2" /></p>
<p class="calibre1"><img src="images/000033.png" alt="Image 50" class="calibre2" /></p>
<p class="calibre1"><img src="images/000054.png" alt="Image 51" class="calibre2" /></p>
<p class="calibre1"><img src="images/000073.png" alt="Image 52" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Type 50000 or Radio Show into the <b class="calibre3">Data Source</b> column:</p>
<p class="calibre1">If we want users to be able to execute our report from Business Central, we also need to enable a search so that they can find our report. We will do that using the UsageCategory and ApplicationArea properties. </p>
<p class="calibre1">More information on ApplicationArea can be found in the Microsoft</p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics-nav/applicationarea-property">Docs at https:/​/​docs.​microsoft.​com/​en-​us/​dynamics-​nav/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics-nav/applicationarea-property">applicationarea-​property. </a></p>
<p class="calibre1">UsageCategory will determine where the report will be listed, </p>
<p class="calibre1">and ApplicationArea will determine the access level a user requires to be able to execute the report:</p>
<p class="calibre1">Microsoft Docs has a good up-to-date explanation of the UsageCategory<br>options (<a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-al-menusuite-functionality">https:/​/​docs.​microsoft.​com/​en-​us/​dynamics365/​business-</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-al-menusuite-functionality">central/​dev-​itpro/​developer/​devenv-​al-​menusuite-​functionality</a>). </p>
<p class="calibre1">The SourceTableName for our report is the Radio Show table. The columns are the fields from this table. Spaces and special characters are not allowed in column names for reports. </p>
<p class="calibre1"><b class="calibre3">[ 52 ]</b></p>
<p class="calibre1"><a id="calibre_link-31"></a><img src="images/000095.jpg" alt="Image 53" class="calibre2" /></p>
<p class="calibre1"><img src="images/000117.png" alt="Image 54" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">After selecting the columns and removing any unnecessary elements from the snippet, our report code should look as follows:</p>
<p class="calibre1"><b class="calibre3">Generating the layout</b></p>
<p class="calibre1">Now that we have defined our dataset, we can create the layout. Business Central supports both RDLC, which can be edited in Visual Studio, and SQL Report Builder, and it also supports Microsoft Word. </p>
<p class="calibre1">Both layouts can be added to the report definition using the WordLayout and RDLCLayout properties:</p>
<p class="calibre1"><b class="calibre3">[ 53 ]</b></p>
<p class="calibre1"><a id="calibre_link-356"></a><img src="images/000139.jpg" alt="Image 55" class="calibre2" /></p>
<p class="calibre1"><img src="images/000161.jpg" alt="Image 56" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">To generate the layout, we need to package our application, which can be done from the Command Palette:</p>
<p class="calibre1">This screenshot shows the generated RDLC, which is essentially to XML syntax:</p>
<p class="calibre1"><b class="calibre3">[ 54 ]</b></p>
<p class="calibre1"><a id="calibre_link-357"></a><img src="images/000183.png" alt="Image 57" class="calibre2" /></p>
<p class="calibre1"><img src="images/000205.jpg" alt="Image 58" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Let’s see if we can run our report. To do that, we will publish our extension without startupObjectId:</p>
<p class="calibre1">In the Business Central session, we will use the searchbox and type in the word radio , which will show our report:</p>
<p class="calibre1">When you click on the report and select <b class="calibre3">Preview</b>, you should see an empty layout. </p>
<p class="calibre1"><b class="calibre3">[ 55 ]</b></p>
<p class="calibre1"><a id="calibre_link-32"></a><img src="images/000227.jpg" alt="Image 59" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Designing the layout</b></p>
<p class="calibre1">In this book, we will focus on Word reports, and we will go ahead and remove the RDLC</p>
<p class="calibre1">file and associated property in the report. We will use the DefaultLayout property to make Word the default report format choice. Next, we will right-click on the</p>
<p class="calibre1">RadioShows.docx file and open it in Microsoft Word:</p>
<p class="calibre1">In Microsoft Word, we need to locate the <b class="calibre3">Developer</b> tab, which might not be visible by default. Go to <b class="calibre3">File</b> | <b class="calibre3">Options</b> | <b class="calibre3">Customize Ribbon</b> and select <b class="calibre3">Developer</b>:</p>
<p class="calibre1"><b class="calibre3">[ 56 ]</b></p>
<p class="calibre1"><a id="calibre_link-354"></a><img src="images/000249.png" alt="Image 60" class="calibre2" /></p>
<p class="calibre1"><img src="images/000271.jpg" alt="Image 61" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">This will allow you to select <b class="calibre3">XML Mapping Pane</b>:</p>
<p class="calibre1"><b class="calibre3">[ 57 ]</b></p>
<p class="calibre1"><a id="calibre_link-355"></a><img src="images/000292.png" alt="Image 62" class="calibre2" /></p>
<p class="calibre1"><img src="images/000313.png" alt="Image 63" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Let’s create a simple list report by adding a table control to the report. We will select the middle row of the table control. Then, we will right-click on DataItemName and use <b class="calibre3">Insert</b> <b class="calibre3">Content Control</b> | <b class="calibre3">Repeating</b>:</p>
<p class="calibre1">The next step is to add the fields to the rows, add captions, and, for eye candy, add a style: After saving the Microsoft Word document, we can publish our extension, search for the report, and select <b class="calibre3">Preview</b>:</p>
<p class="calibre1"><b class="calibre3">[ 58 ]</b></p>
<p class="calibre1"><a id="calibre_link-33"></a><img src="images/000334.png" alt="Image 64" class="calibre2" /></p>
<p class="calibre1"><img src="images/000355.jpg" alt="Image 65" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">There is much more to come. All we’ve done so far is scratch the surface. But by now, you should have a pretty good overview of the development process for Business Central. </p>
<p class="calibre1">You will be in especially good shape if you’ve been able to follow along in<br>your own system, doing a little experimenting along the way. </p>
<p class="calibre1"><b class="calibre3">Other Business Central object types</b></p>
<p class="calibre1">Let’s finish up our introductory review of the Business Central object types. </p>
<p class="calibre1"><b class="calibre3">TableExtension and PageExtension</b></p>
<p class="calibre1">Similar to the Table and Page objects, the table and page extension objects allow you to define fields in the database and display them to the user. </p>
<p class="calibre1">Table extensions are connected to existing tables and share the same primary key values. </p>
<p class="calibre1">Fields defined in table extensions can be used on any existing page and report that uses the original table. </p>
<p class="calibre1"><b class="calibre3">[ 59 ]</b></p>
<p class="calibre1"><a id="calibre_link-34"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">Page extensions allow developers to add new fields, tabs, actions, and FactBoxes to existing pages. You can also use this to hide controls. </p>
<p class="calibre1"><b class="calibre3">Codeunits</b></p>
<p class="calibre1">A codeunit is a container for <b class="calibre3">chunks</b> of AL code to be called from other objects. These chunks of code are called procedures. Procedures can be called from any of the other Business Central object types that can contain AL code. Codeunits can also be exposed (published) as web services. This allows the procedures within a published codeunit to be invoked by external routines. </p>
<p class="calibre1">Codeunits are suited structurally to contain only procedures. Even though procedures could be placed in other object types, the other object types have superstructures that relate to their designed primary use, such as pages, and reports. </p>
<p class="calibre1">Codeunits act only as containers for AL coded procedures. They have no auxiliary procedures, no method of direct user interaction, and no predefined processing. Even if we are creating only one or two procedures and they are closely related to the primary activity of a particular object, and if these procedures are needed from both inside and outside of the report, the best practice is still to locate the procedures in a codeunit. </p>
<p class="calibre1">There are several codeunits being delivered as part of the standard Business Central product, which are really function libraries. These codeunits consist completely of utility routines, and are generally organized on some functional basis (for example, associated with dimensions, some aspect of manufacturing, or some aspect of warehouse<br>management). Many of these can be found by filtering the codeunit names on the</p>
<p class="calibre1">Management and Mgt strings (the same could be said for some of the tables with<br>the Buffer string in their name). When we customize a system, we should create our own procedure library codeunits to consolidate our customizations and make software<br>maintenance easier. Some developers create their own libraries of favorite special procedures, and include a procedure library codeunit in systems on which they work. </p>
<p class="calibre1"><b class="calibre3">[ 60 ]</b></p>
<p class="calibre1"><a id="calibre_link-35"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Queries</b></p>
<p class="calibre1"><b class="calibre3">Queries</b> are objects whose purpose is to create extracted sets of data from the Business Central database and do so very efficiently. Business Central queries translate directly into T-SQL query statements and run on the SQL Server side rather than on the Business Central Service Tier. A query can extract data from a single table or multiple tables. In the process of extracting data, a query can make different types of joins (inner join, outer join, or cross join), filter, calculate FlowFields (special Business Central calculations that are discussed in detail in Chapter 3,  <i class="calibre4">Data Types and Fields</i>), sort, and create sums and averages. Queries obey the Business Central data structure business logic. </p>
<p class="calibre1">The output of a query can be a CSV file (useful for Excel charts), an XML file (for charts or external applications), or an Odata file for a web service. Queries can be published for web service access, similar to pages and codeunits. The results of a query can also be viewed by</p>
<p class="calibre1"><a href="#calibre_link-130">pages (as described in Chapter 5</a>,  <i class="calibre4">Queries and Reports)</i>, but are especially powerful when output to charts. With a little creativity, a query can also be used to feed data to a page or report via the use of a temporary table to hold the query results. </p>
<p class="calibre1"><b class="calibre3">XMLports</b></p>
<p class="calibre1">XMLports is a tool for importing and exporting data. XMLports handle both XML</p>
<p class="calibre1">structured data and other external text data formats. <b class="calibre3">XML</b> (<b class="calibre3">eXtensible Markup Language)</b> is the de facto standard for exchanging data between dissimilar systems. For example, XMLports could be used to communicate between our Business Central ERP system and our accounting firm’s financial analysis and tax preparation system. </p>
<p class="calibre1">XML is designed to be extensible, which means that we can create or extend the definition as long as we communicate the defined XML format to our correspondents. There is a standard set of syntax rules to which XML formats must conform. A lot of new software uses XML. For example, the new versions of Microsoft Office are quite XML friendly. All web services communications are in the form of an exchange of XML structured data. </p>
<p class="calibre1">The non-XML text data files handled by XMLports fall into two categories. One is known as <b class="calibre3">comma-separated value</b> or <b class="calibre3">comma-delimited</b> files (they usually have a .csv file extension). Of course, the delimiters don’t have to be commas. The other category is fixed format, in which the length and relative position of each field is predefined. </p>
<p class="calibre1">XMLports can contain AL logic for any type of appropriate data manipulation, either when importing or exporting. Functions such as editing, validating, combining, and filtering can be applied to the data as it passes through an XMLport. </p>
<p class="calibre1"><b class="calibre3">[ 61 ]</b></p>
<p class="calibre1"><a id="calibre_link-36"></a><img src="images/000376.png" alt="Image 66" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Control add-ins</b></p>
<p class="calibre1">A control add-in allows JavaScript developers to create custom controls using plain HTML5</p>
<p class="calibre1">or jQuery. In fact, anything that creates JavaScript can be loaded into the browser, although Microsoft officially does not support frameworks like Angular and React. </p>
<p class="calibre1"><b class="calibre3">Development backups and documentation</b></p>
<p class="calibre1">As with any system where we can do development work, careful attention to<br>documentation and backing up our work is very important. Visual Studio Code provides a variety of techniques for handling each of these tasks. </p>
<p class="calibre1">The first area we can place documentation is in line with modified AL code. Individual comment lines can be created by starting the line with double forward slashes, //. Whole sections of comments (or commented out code) can be created by starting and ending the section with a pair of curly braces { }. Depending on the type of object and the nature of the specific changes, we should generally annotate each change inline with forward slashes rather than with curly braces wherever the code is touched so that all the changes can be easily identified by the next developer. </p>
<p class="calibre1">The best documentation resides outside of our source code. Visual Studio Code has built-in support for Git, which means that we can use any source code control system supporting that, including, but not limited to, GitHub, GitLab, or Visual Studio Team Services. </p>
<p class="calibre1">There are some great resources on how to get started with GitHub online, like the ones we mentioned earlier in this chapter. A good explanation about Git in general can be found on</p>
<p class="calibre1"><a href="https://www.youtube.com/watch?v=tDlHCr70WUs">YouTube (https:/​/​www.​youtube.​com/​watch?​v=​tDlHCr70WUs). </a></p>
<p class="calibre1">In short, when doing development in Business Central Visual Studio Code, everything we have learned earlier about good documentation practices applies. This holds true, regardless of whether the development is new work or the modification of existing logic. </p>
<p class="calibre1">You can download the code from this book on GitHub at <a href="https://github.com/markbrummel/Programming-Microsoft-Dynamics-365-Business-Central">https:/​/</a></p>
<p class="calibre1"><a href="https://github.com/markbrummel/Programming-Microsoft-Dynamics-365-Business-Central">github.​com/​markbrummel/​Programming-​Microsoft-​Dynamics-​365-</a></p>
<p class="calibre1"><a href="https://github.com/markbrummel/Programming-Microsoft-Dynamics-365-Business-Central">Business-​Central. </a></p>
<p class="calibre1"><b class="calibre3">[ 62 ]</b></p>
<p class="calibre1"><a id="calibre_link-37"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1"><b class="calibre3">Summary</b></p>
<p class="calibre1">In this chapter, we covered some basic definitions of terms related to Business Central and Visual Studio Code. We followed with an introduction to the 11 Business Central objects types (tables, table extensions, pages, page extensions, page customizations, profiles, reports, codeunits, queries, control add-ins, and XMLports). We introduced table, page, and report creation through review and hands-on use, and began a Business Central application for the programming management of the Radio Show WTDU. Finally, we looked briefly at the tools that we use to integrate with external entities and discussed how different types of backups and documentation are handled in Visual Studio Code. Now that we have covered the basics, we will dive into the detail of the primary object types in the next few chapters. </p>
<p class="calibre1">In the next chapter, we will focus on tables: the foundation of any Business Central system. </p>
<p class="calibre1"><b class="calibre3">Questions</b></p>
<p class="calibre1">1. An ERP system such as Business Central includes a number of functional areas. </p>
<p class="calibre1">Which of the following are part of Business Central? Choose four:</p>
<p class="calibre1">Manufacturing</p>
<p class="calibre1">Order processing</p>
<p class="calibre1">Planning</p>
<p class="calibre1">Computer Aided Design (CAD)</p>
<p class="calibre1">General accounting</p>
<p class="calibre1">2. Functionality in Business Central includes the following (choose three):</p>
<p class="calibre1">Tablet client</p>
<p class="calibre1">Drag and drop</p>
<p class="calibre1">Document emailing</p>
<p class="calibre1">Spellchecker</p>
<p class="calibre1">Mandatory fields</p>
<p class="calibre1"><b class="calibre3">[ 63 ]</b></p>
<p class="calibre1"><a id="calibre_link-438"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">3. Business Central development is done in the Visual Studio Code IDE or Visual</p>
<p class="calibre1">Studio. True or false? </p>
<p class="calibre1">4. Match the following table types and descriptions for Business Central:</p>
<p class="calibre1">Journal audit trail</p>
<p class="calibre1">Ledger validation process</p>
<p class="calibre1">Register invoice</p>
<p class="calibre1">Document transaction entries</p>
<p class="calibre1">Posting history</p>
<p class="calibre1">5. With Business Central, iPads can be used to display the RTC. True or false? </p>
<p class="calibre1">6. Which of the following describe Business Central? Choose two:</p>
<p class="calibre1">Customizable</p>
<p class="calibre1">Includes a storefront module</p>
<p class="calibre1">Object-based</p>
<p class="calibre1">C# IDE</p>
<p class="calibre1">Object-oriented</p>
<p class="calibre1">7. What are the Business Central object types? </p>
<p class="calibre1">8. All Business Central objects except XMLports can contain AL code. True or false? </p>
<p class="calibre1">9. Business Central includes support for publishing objects as web services. True or false? </p>
<p class="calibre1">10. The home page for a Business Central user is called what? Choose one:</p>
<p class="calibre1">Role Home</p>
<p class="calibre1">Home Center</p>
<p class="calibre1">Main Page</p>
<p class="calibre1">Role Center</p>
<p class="calibre1">11. Codeunits can be used as startupObjectId. True or false? </p>
<p class="calibre1">12. Microsoft Word is used in Business Central for what work? Choose one:</p>
<p class="calibre1">Report data definition</p>
<p class="calibre1">Report layout</p>
<p class="calibre1">Role Center design</p>
<p class="calibre1">Query processing</p>
<p class="calibre1"><b class="calibre3">[ 64 ]</b></p>
<p class="calibre1"><a id="calibre_link-439"></a> <i class="calibre4">Introduction to Business Central</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 1</i></p>
<p class="calibre1">13. Codeunits are the only Business Central objects that can contain procedures. True or false? </p>
<p class="calibre1">14. Query output can be used as a data item for reports. True or false? </p>
<p class="calibre1">15. AL and Visual Studio Code are required for Business Central development. True or false? </p>
<p class="calibre1">16. Which object number range is available for assignment to customer-specific<br>objects? Choose two:</p>
<p class="calibre1">20 - 500</p>
<p class="calibre1">50,000 - 60,000</p>
<p class="calibre1">150,000 - 200,000</p>
<p class="calibre1">50,000 - 99,999</p>
<p class="calibre1">10,000 - 100,000</p>
<p class="calibre1">17. XMLports can only process XML formatted data. True or false? </p>
<p class="calibre1">18. The work date can only be changed by the system administrator. True or false? </p>
<p class="calibre1">19. A design pattern is which of the following? Choose two:</p>
<p class="calibre1">Reusable code</p>
<p class="calibre1">Stripes and plaid together</p>
<p class="calibre1">A proven way to solve a common problem</p>
<p class="calibre1">UI guidelines</p>
<p class="calibre1">20. Business Central reports are often generated automatically through the use of a wizard. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 65 ]</b></p>
<p class="calibre1"><a id="calibre_link-38"></a><img src="images/000397.png" alt="Image 67" class="calibre2" /></p>
<p class="calibre1">2</p>
<p class="calibre1">Tables</p>
<p class="calibre1"> <i class="calibre4">“If you don’t know where you are going, you might wind up someplace else.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Yogi Berra</i></p>
<p class="calibre1"> <i class="calibre4">Successful design is anticipating the anticipations of others. </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; John Maynard Keynes, paraphrased</i></p>
<p class="calibre1">The foundation of any system is the data structure definition. In Business Central, the building blocks of this foundation are the tables and the individual data fields that the tables contain. Once the functional analysis and process definition have been completed, any new design work must begin with the data structure. For Business Central, that means the tables and their contents. </p>
<p class="calibre1">A Business Central table includes much more than just the data fields and keys. A Business Central table definition also includes data validation rules, processing rules, business rules, and logic to ensure referential integrity. These rules are in the form of properties and AL</p>
<p class="calibre1">code. </p>
<p class="calibre1">For object-oriented developers, a Dynamics Business Central table is best<br>compared to a class with methods and properties that have been stored<br>one-to-one as a table on SQL Server. </p>
<p class="calibre1"><a id="calibre_link-39"></a><img src="images/000418.jpg" alt="Image 68" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">In this chapter, we will learn about the structure and creation of tables. Details regarding fields and the components of tables will be covered in the following chapter. In particular, we will cover the following topics:</p>
<p class="calibre1">An overview of tables, including properties, triggers, keys, SumIndexFields, and field groups</p>
<p class="calibre1">Enhancing our scenario application&mdash;creating and modifying tables</p>
<p class="calibre1">Types of table&mdash;fully modifiable, content modifiable, and read-only tables</p>
<p class="calibre1"><b class="calibre3">An overview of tables</b></p>
<p class="calibre1">There is a distinction between the table (data definition and data container) and the data (the contents of a table). The table definition describes the identification information, data structure, validation rules, storage, and retrieval of the data that is stored in the table (container). This definition is defined by its design and can only be changed by a developer. </p>
<p class="calibre1">The data is the variable content that originates from user activities. The place where we can see the data being explicitly referenced, independent of the table as a definition of structure, is in the permissions setup data. In the following screenshot, the data is formally referred to as <b class="calibre3">Table Data</b>:</p>
<p class="calibre1"><b class="calibre3">[ 67 ]</b></p>
<p class="calibre1"><a id="calibre_link-40"></a><img src="images/000439.png" alt="Image 69" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">The table is not the data&mdash;it is the definition of data contained in the table. Even so, we commonly refer to both the data and the table as if they were one and the same. That is what we will do in this book. </p>
<p class="calibre1">All permanent data must be stored in a table. All tables are defined by the developer working in the development environment. As much as possible, critical system design components should be embedded in the tables. Each table should include the code that controls what happens when records are added, changed, or deleted, as well as how data is validated when records are added or changed. This includes functions to maintain the aspects of referential integrity that are not automatically handled. The table object should also include the functions that are commonly used to manipulate the table and its data, whether this be for database maintenance or in support of business logic. In the cases where the business logic is either a modification that’s been applied to a standard (out-of-the-box) table or used elsewhere in the system, the code should reside in a codeunit function library and called from the table. </p>
<p class="calibre1">Visual Studio Code provides snippets for the definition of the data structure within tables. </p>
<p class="calibre1">We will explore these capabilities through examples and analysis of the structure of table objects. We find that the approach of embedding control and business logic within the table object has a number of advantages:</p>
<p class="calibre1">Clarity of design</p>
<p class="calibre1">Centralization of rules for data constraints</p>
<p class="calibre1">More efficient development of logic</p>
<p class="calibre1">Increased ease of debugging</p>
<p class="calibre1">Easier upgrading</p>
<p class="calibre1"><b class="calibre3">Components of a table</b></p>
<p class="calibre1">A table is made up of <b class="calibre3">Fields</b>, <b class="calibre3">Properties</b>, <b class="calibre3">Triggers</b> (some of which may contain AL code), and <b class="calibre3">Keys</b>. <b class="calibre3">Fields</b> also have <b class="calibre3">Properties</b> and <b class="calibre3">Triggers</b>. <b class="calibre3">Keys</b> also have <b class="calibre3">Properties</b>:</p>
<p class="calibre1"><b class="calibre3">[ 68 ]</b></p>
<p class="calibre1"><a id="calibre_link-41"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">A table definition that takes full advantage of these capabilities reduces the effort that’s required to construct other parts of the application. Good table design can significantly enhance the application’s processing speed, efficiency, and flexibility. </p>
<p class="calibre1">A table can have the following components:</p>
<p class="calibre1">Up to 500 fields</p>
<p class="calibre1">A defined record size of up to 8,000 bytes (with each field sized at its maximum) Up to 40 different keys</p>
<p class="calibre1"><b class="calibre3">Naming tables</b></p>
<p class="calibre1">There are standardized naming conventions for Business Central that we should follow. </p>
<p class="calibre1">Names for tables and other objects should be as descriptive as possible, while kept to a reasonable length. This makes our work more self-documenting. </p>
<p class="calibre1">Table names should always be singular. The table containing data about customers should not be named Customers, but Customer. The table we created for our WDTU Radio</p>
<p class="calibre1">Station Business Central enhancement was named Radio Show, even though it will contain data for all of WDTU’s radio shows. </p>
<p class="calibre1">In general, we should always name a table so that it is easy to identify the relationship between the table and the data it contains. For example, two tables containing the transactions on which a document page is based should normally be referred to as a Header table (for the main portion of the page) and a Line table (for the line detail portion of the page). As an example, the tables underlying a <b class="calibre3">Sales Order</b> page are the <b class="calibre3">Sales Header</b> and the <b class="calibre3">Sales Line</b> tables. The <b class="calibre3">Sales Header</b> table contains all of the data that occurs only once for a <b class="calibre3">Sales Order</b>, while the <b class="calibre3">Sales Line</b> table contains all of the lines for the order. </p>
<p class="calibre1"><b class="calibre3">Table numbering</b></p>
<p class="calibre1">There are no hard and fast rules for table numbering, except that we must only use the table object numbers that we are licensed to use. If all we have is the basic table designer rights, we are generally allowed to create tables numbered from 50,000 to 50,009 (unless our license was defined differently compared to the typical one). If we need more table objects, we can purchase licensing for table objects numbered up to 99,999. <b class="calibre3">Independent Software</b> <b class="calibre3">Vendors</b> (<b class="calibre3">ISVs</b>) can purchase access to tables in other number ranges. </p>
<p class="calibre1"><b class="calibre3">[ 69 ]</b></p>
<p class="calibre1"><a id="calibre_link-42"></a><img src="images/000005.jpg" alt="Image 70" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">When creating several related tables, ideally, we should assign them to numbers in sequential order. We should let common sense be our guide for assigning table numbers. It requires considerable effort to renumber tables containing data. </p>
<p class="calibre1"><b class="calibre3">Table properties</b></p>
<p class="calibre1">The first step in studying the internal construction of a table is to open one in Visual Studio Code. We will use the Radio Show<a href="#calibre_link-2"> table we created in Chapter 1</a>,  <i class="calibre4">Introduction to Business</i> <i class="calibre4">Central</i>, to show you this. </p>
<p class="calibre1">We now have the Radio Show table open in Visual Studio Code, as shown in the following screenshot:</p>
<p class="calibre1">We can access the properties of a table. Place the cursor on the empty line above the fields (as shown in the preceding screenshot) and click on  <i class="calibre4">Ctrl</i> + spacebar. If we hit  <i class="calibre4">Ctrl</i> +</p>
<p class="calibre1">spacebar while the focus is on a filled field line, we will see the properties of that field (not the table). </p>
<p class="calibre1"><b class="calibre3">[ 70 ]</b></p>
<p class="calibre1"><a id="calibre_link-384"></a><img src="images/000025.jpg" alt="Image 71" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">The options that you can see in Visual Studio Code should look as follows:</p>
<p class="calibre1">The table properties are as follows:</p>
<p class="calibre1">Caption: This contains the caption that was defined for the currently selected<br>language. The default language for Business Central is <b class="calibre3">English, US</b> (<b class="calibre3">ENU</b>). </p>
<p class="calibre1">CaptionML: This defines the MultiLanguage caption for the table. For an<br>extended discussion on the language capabilities of Business Central, refer to the <i class="calibre4">Multilanguage Development</i> section</p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/dynamics-nav/multilanguage-development">(https://msdn.microsoft.com/en-us/dynamics-nav/multilanguage-developme</a></p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/dynamics-nav/multilanguage-development">nt</a>) in the online <b class="calibre3">Developer and IT Pro Help</b>. </p>
<p class="calibre1">Description: This property is for optional documentation usage. </p>
<p class="calibre1">DataPerCompany: This lets us define whether or not the data in this table is<br>segregated by company (the default), or whether it is common (shared) across all of the companies in the database. The generated names of tables within SQL</p>
<p class="calibre1">Server (not within Business Central) are affected by this choice. </p>
<p class="calibre1"><b class="calibre3">[ 71 ]</b></p>
<p class="calibre1"><a id="calibre_link-440"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Permissions: This allows us to grant users of this table different levels of access (r for read, i for insert, m for modify, and d for delete) to the table data in other table objects. </p>
<p class="calibre1">LookupPageID: This allows us to define what page is the default for looking up<br>data in this table. </p>
<p class="calibre1">DrillDownPageID: This allows us to define what page is the default for drilling<br>down into the supporting detail for data that is summarized in this table. </p>
<p class="calibre1">DataCaptionFields: This allows us to define specific fields whose contents will<br>be displayed as part of the caption. For the Customer table, the No. and the Name will be displayed in the title bar at the top of a page showing a customer record. </p>
<p class="calibre1">PasteIsValid: This property (paste is valid) determines whether users are<br>allowed to paste data into the table. </p>
<p class="calibre1">LinkedObject: This lets us link the table to an SQL Server object. This feature<br>allows a connection, for data access or maintenance, to a non-Business Central<br>system or an independent Business Central system. For example, a</p>
<p class="calibre1">LinkedObject could be an independently hosted and maintained special<br>purpose database, and hence we could offload that processing from the main</p>
<p class="calibre1">Business Central system. When this property is set to Yes, </p>
<p class="calibre1">LinkedInTransactionProperty becomes available. </p>
<p class="calibre1">LinkedInTransactionProperty should be set to No for any linkage to a SQL</p>
<p class="calibre1">Server object outside the current database. The object being linked must have a</p>
<p class="calibre1">SQL Server table definition that is compatible with the Microsoft Dynamics</p>
<p class="calibre1">Business Central table definition. </p>
<p class="calibre1">TableType: This allows you to consume data from an OData web service, such<br>as Dynamics CRM or an External SQL, as a table. </p>
<p class="calibre1">ObsoleteState: This can be used to indicate to developers that this table will be removed in a future version. </p>
<p class="calibre1">ObsoleteReason: When the ObsoleteState property is used, this property can<br>be set to explain why the table has been discontinued or what will replace it. </p>
<p class="calibre1">As developers, we most frequently deal with the ID, Name, LookupPageID, </p>
<p class="calibre1">DrillDownPageID, Caption, CaptionML (outside of the United States), </p>
<p class="calibre1">DataCaptionFields, and Permissions properties. We rarely deal with the others. </p>
<p class="calibre1"><b class="calibre3">[ 72 ]</b></p>
<p class="calibre1"><a id="calibre_link-43"></a><img src="images/000046.png" alt="Image 72" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">Table triggers</b></p>
<p class="calibre1">To display the triggers with the table open in Visual Studio Code, enter the trigger keyword in the first line after the fields section, followed by  <i class="calibre4">Ctrl</i> + spacebar. This is shown in the following screenshot:</p>
<p class="calibre1">The code contained in trigger is executed prior to the event represented by trigger. In other words, the code in the OnInsert() trigger is executed before the record is inserted into the table. This allows the developer a final opportunity to perform validations and to enforce data consistency such as referential integrity. We can even abort the intended action if data inconsistencies or conflicts are found. </p>
<p class="calibre1">These triggers are automatically invoked when record processing occurs as the result of user action. But when table data is changed by AL code or by a data import, the AL code or import process determines whether or not the code in the applicable trigger is executed: OnInsert(): This is executed when a new record is to be inserted in the table<br>through the UI. (In general, new records are added when the last field of the<br>primary key is completed and focus leaves that field. See the property in <a href="#calibre_link-91">Chapter</a></p>
<p class="calibre1"><a href="#calibre_link-91">4</a>,  <i class="calibre4">Pages &ndash; The Interactive Interface</i>). </p>
<p class="calibre1">OnModify(): This is executed when a record is rewritten after the contents of<br>any field other than a primary key field has been changed. The change is<br>determined by comparing xRec (the image of the record prior to being changed)</p>
<p class="calibre1">to Rec (the current record copy). During our development work, if we need to<br>see what the  <i class="calibre4">before</i> value of a record or field is, we can reference the contents of xRec and compare that to the equivalent portion of Rec. These variables (Rec<br>and xRec) are system-defined variables. </p>
<p class="calibre1"><b class="calibre3">[ 73 ]</b></p>
<p class="calibre1"><a id="calibre_link-385"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">OnDelete(): This is executed before a record is to be deleted from the table. </p>
<p class="calibre1">OnRename(): This is executed when some portion of the primary key of the<br>record is about to be changed. Changing any part of the primary key is a rename<br>action. This maintains a level of referential integrity. Unlike some systems, </p>
<p class="calibre1">Business Central allows the primary key of any master record to be changed. </p>
<p class="calibre1">This automatically maintains all of the affected foreign key references from other records. </p>
<p class="calibre1">There is an internal inconsistency in the handling of data integrity by Business Central. On the one hand, the Rename trigger automatically maintains one level of referential integrity when any part of the primary key is changed (that is, the record is <b class="calibre3">renamed</b>). This happens in a black box process, an internal process that we cannot see or touch. </p>
<p class="calibre1">However, if we delete a record, Business Central doesn’t automatically do anything to maintain referential integrity. For example, child records could be orphaned by a deletion, that is, left without any parent record. Or, if there are references in other records back to the deleted record, they could be left with no target. As developers, we are responsible for ensuring this part of referential integrity in our customizations. </p>
<p class="calibre1">When we write AL code in one object that updates data in another (table) object, we can control whether or not the applicable table update trigger fires (executes). For example, if we were adding a record to our Radio Show table and used the following AL code, the OnInsert() trigger would fire:</p>
<p class="calibre1">RadioShow.INSERT(TRUE); </p>
<p class="calibre1">However, if we were to use either of the following AL code options instead, the</p>
<p class="calibre1">OnInsert() trigger would not fire and none of the logic inside the trigger would be executed:</p>
<p class="calibre1">RadioShow.INSERT(FALSE); </p>
<p class="calibre1">Alternatively, you can use the following code:</p>
<p class="calibre1">RadioShow.INSERT; </p>
<p class="calibre1">The automatic black box logic enforcing primary key uniqueness will happen regardless of whether the OnInsert() trigger is fired. </p>
<p class="calibre1"><b class="calibre3">[ 74 ]</b></p>
<p class="calibre1"><a id="calibre_link-44"></a><img src="images/000065.png" alt="Image 73" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">Keys</b></p>
<p class="calibre1">Table keys are used to identify records and to speed up filtering and sorting. Having too few keys may result in painfully slow inquiries and reports. However, each key incurs a processing cost, because the index containing the key must be updated every time information in a key field changes. Key cost is measured primarily in terms of increased index maintenance processing. There is also additional cost in terms of disk storage space (usually not significant) and additional backup/recovery time for the increased database size (sometimes very important). </p>
<p class="calibre1">When a system is optimized for processing speed, it is critical to analyze the SQL Server indexes that are active because that is where the updating and retrieval time are determined. The determination of the proper number and design of keys and indexes for a table requires a thorough understanding of the types and frequencies of inquiries, reports, and other processing for that table. </p>
<p class="calibre1">Every Business Central table must have at least one key: the primary key. The primary key is always the first key in the key list. By default, the primary key is made up of the first field that’s defined in the table. In many of the reference tables, there is only one field in the primary key, and the only key is the primary key. </p>
<p class="calibre1">Our Radio Show table does not have an explicit key defined, which means that Business Central defaults to the first field. If we were to explicitly define this key, we would have to declare it, as shown in the following screenshot:</p>
<p class="calibre1">The primary key must have a unique value in each table record. We can change the primary key to be any field, or a combination of up to 16 fields totaling up to 900 bytes, but the uniqueness requirement must be met. It will automatically be enforced by Business Central, because Business Central will not allow us to add a record with a duplicate primary key to a table. </p>
<p class="calibre1"><b class="calibre3">[ 75 ]</b></p>
<p class="calibre1"><a id="calibre_link-441"></a><img src="images/000087.png" alt="Image 74" class="calibre2" /></p>
<p class="calibre1"><img src="images/000109.png" alt="Image 75" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">When we add other keys, the first key remains the unique key and other keys become secondary, non-unique keys:</p>
<p class="calibre1">All keys except the primary key are secondary ones. There is no required uniqueness constraint on secondary keys. There is no requirement to have any secondary keys. If we want a secondary key not to have duplicate values, our AL code must check for duplication before completing the new entry. </p>
<p class="calibre1">The maximum number of fields that can be used in any one key is 16, with a maximum total length of 900 bytes. At the same time, the total number of different fields that can be used in all of the keys combined cannot exceed 16. If the primary key includes three fields (like in the preceding screenshot), then the secondary keys can utilize up to 13 other fields (16 minus 3) in various combinations, plus any or all of the fields in the primary key. If the primary key has 16 fields, then the secondary keys can only consist of different groupings and sequences of those 16 fields. </p>
<p class="calibre1">Behind the scenes, each secondary key has the primary key appended to the backend. A maximum of 40 keys are allowed per table. </p>
<p class="calibre1">Database maintenance performance is faster with fewer fields in keys, </p>
<p class="calibre1">especially the primary key. The same is true for fewer keys. This must be<br>balanced against improved performance in processes by having the<br>optimum key contents and choices. </p>
<p class="calibre1"><b class="calibre3">[ 76 ]</b></p>
<p class="calibre1"><a id="calibre_link-382"></a><img src="images/000131.jpg" alt="Image 76" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Other significant key attributes include key groups and SQL Server-specific properties: A number of SQL Server-specific key-related parameters have been added to</p>
<p class="calibre1">Business Central. These key properties can be accessed by using  <i class="calibre4">Ctrl</i> + spacebar inside the curly braces in a key. </p>
<p class="calibre1">The MaintainSQLIndex and MaintainSIFTIndex properties allow the<br>developer and/or system administrator to determine whether or not a particular<br>key or <b class="calibre3">SumIndexField Technology</b> (<b class="calibre3">SIFT</b>) field will be continuously maintained or whether it will be recreated only when needed. Indexes that are not<br>maintained minimize record update time but require longer processing time to<br>dynamically create the indexes when they are used. This level of control is useful for managing indexes that are only needed occasionally. For example, a key or</p>
<p class="calibre1">SIFT index that is used only for monthly reports can be disabled, and no index<br>maintenance processing will be done day to day. If the month end need is for a<br>single report, that particular index will be recreated automatically when the<br>report is run. If the month end need is for a number of reports, the system<br>administrator might enable the index, process the reports, and then disable the<br>index again:</p>
<p class="calibre1"><b class="calibre3">[ 77 ]</b></p>
<p class="calibre1"><a id="calibre_link-45"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">SumIndexFields</b></p>
<p class="calibre1">Dynamics Business Central, which is inherited from Dynamics NAV (formerly Navision), has a unique capability called the SIFT feature. These fields serve as the basis for FlowFields (automatically accumulating totals) and are unique to Business Central. This feature allows Business Central to provide almost instantaneous responses to user inquiries for summed data, which are calculated on the fly at runtime and are related to the SumIndexFields. The cost is primarily that of the time required to maintain the SIFT indexes when a table is updated. </p>
<p class="calibre1">Business Central maintains SIFT totals using SQL Server indexed views. An indexed view is a view that has been preprocessed and stored. Business Central creates one indexed view for each enabled SIFT key. SIFT keys are enabled and disabled through the</p>
<p class="calibre1">MaintainSIFTIndex property. SQL Server maintains the contents of the view when any changes are made to the base table, unless the MaintainSIFTIndex property is set to No. </p>
<p class="calibre1">SumIndexFields are accumulated sums of individual fields (columns) in tables. When the totals are automatically pre-calculated, they are easy to use and provide very high-speed access for inquiries. If users need to know the total of the Amount values in a Ledger table, the Amount field can be attached as a SumIndexField to the appropriate keys. In another table, such as Customer, FlowFields can be defined as display fields that take the advantage of SumIndexFields. This gives users very rapid response for calculating a total balance amount inquiry, based on detailed ledger amounts tied to those keys. We will discuss the various data field types and FlowFields in more detail in a later chapter. </p>
<p class="calibre1">In a typical ERP system, many thousands, millions, or even hundreds of millions of records might have to be processed to give such results, which takes considerable time. In Business Central, only a few records need to be accessed to provide the requested results. Processing is fast and programming is greatly simplified. </p>
<p class="calibre1">SQL Server SIFT values are maintained through the use of SQL indexed views. By using the key property, MaintainSIFTIndex, we can control whether or not the SIFT index is maintained dynamically (faster response) or only created when needed (less ongoing system performance load). The AL code is the same, regardless of whether the SIFT is maintained dynamically or not. </p>
<p class="calibre1">Having too many keys or SIFT fields can negatively affect system performance for two reasons. The first, which we have already discussed, is the index maintenance processing load. The second is the table locking interference that can occur when multiple threads are requesting update access to a set of records that update SIFT values. </p>
<p class="calibre1"><b class="calibre3">[ 78 ]</b></p>
<p class="calibre1"><a id="calibre_link-46"></a><img src="images/000153.png" alt="Image 77" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Conversely, a lack of necessary keys or SIFT definitions can also cause performance problems. Having unnecessary data fields in a SIFT key creates many extra entries, which affect performance. Integer fields usually create an especially large number of unique SIFT</p>
<p class="calibre1">index values, and Option fields create a relatively small number of index values. </p>
<p class="calibre1">The best design for a SIFT index is where the fields that will be used most frequently in queries are positioned on the left-hand side of the index, in order of descending frequency of use. In a nutshell, we should be careful when designing keys and SIFT fields. While a system is in production, applicable SQL Server statistics should be monitored regularly and appropriate maintenance actions should be taken. Business Central automatically maintains a count for all SIFT indexes, thus speeding up all Count and Average FlowField<br>calculations. </p>
<p class="calibre1"><b class="calibre3">Field groups</b></p>
<p class="calibre1">When a user starts to enter data in a field where the choices are constrained to existing data (for example, an <b class="calibre3">Item No. </b>, a <b class="calibre3">Salesperson Code</b>, a <b class="calibre3">Unit of Measure</b> code, a <b class="calibre3">Customer No. </b>, and so on), good design dictates that the system will help the user by displaying the universe of acceptable choices. Put simply, a lookup list of choices should be displayed. </p>
<p class="calibre1">In the <b class="calibre3">Role Tailored Client</b> (<b class="calibre3">RTC</b>), the lookup display (a drop-down control) is generated dynamically when its display is requested by the user’s effort to enter data in a field that references a table through the TableRelation property (which will be discussed in more detail in the next chapter). The format of the drop-down control is a basic list. The fields that are included in that list and their left to right display sequence are either defined by default or by an entry in the FieldGroups table. </p>
<p class="calibre1">The fieldgroups table is part of the Business Central table definition, much like the list of keys. In fact, the fieldgroups table is accessed very similar to the keys, that is, via  <i class="calibre4">Ctrl</i> +</p>
<p class="calibre1">spacebar, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 79 ]</b></p>
<p class="calibre1"><a id="calibre_link-442"></a><img src="images/000175.png" alt="Image 78" class="calibre2" /></p>
<p class="calibre1"><img src="images/000197.jpg" alt="Image 79" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">If we add fieldgroups for the Radio Show table, we can create two, which must be named DropDown (without a hyphen) and Brick:</p>
<p class="calibre1">The drop-down display that’s created by this particular field group is shown in the following screenshot on the <b class="calibre3">Sales Order</b> page. It contains fields that are in the same order of appearance as they are in the field group definition:</p>
<p class="calibre1">If no field group is defined for a table, the system defaults to using the primary key plus the <b class="calibre3">DESCRIPTION</b> field (or <b class="calibre3">NAME</b> field). </p>
<p class="calibre1"><b class="calibre3">[ 80 ]</b></p>
<p class="calibre1"><a id="calibre_link-47"></a><img src="images/000219.jpg" alt="Image 80" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">Bricks</b></p>
<p class="calibre1">In addition to the DropDown field group, we can also define a brick. Bricks are used differently in the web client and phone client. The brick for the <b class="calibre3">Customers</b> table is rendered as follows:</p>
<p class="calibre1"><b class="calibre3">[ 81 ]</b></p>
<p class="calibre1"><a id="calibre_link-48"></a><img src="images/000241.jpg" alt="Image 81" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">The same brick is rendered differently in the web client, as displayed in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Enhancing our sample application</b></p>
<p class="calibre1">Now, we can take our knowledge of tables and expand our WDTU application. Our base Radio Show table needs to be added to and modified. We also need to create and reference additional tables. </p>
<p class="calibre1">Although we want to have a realistic design in our sample application, we will focus on changes that illustrate features in Business Central table design that the authors feel are among the most important. If there are capabilities or functionalities that you feel are missing, feel free to add them. Adjust the examples as much as you wish to make them more meaningful to you. </p>
<p class="calibre1"><b class="calibre3">Creating and modifying tables</b></p>
<p class="calibre1"><a href="#calibre_link-2">In Chapter 1</a>,  <i class="calibre4">Introduction to Business Central</i>, we created the Radio Show table for the WDTU application. At that time, we used the minimum fields that allowed us to usefully define a master record. Now, let’s set properties on existing data fields, add more data fields, and create an additional data table to which the Radio Show table can refer. </p>
<p class="calibre1"><b class="calibre3">[ 82 ]</b></p>
<p class="calibre1"><a id="calibre_link-443"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Our new data fields are shown in the following layout table:</p>
<p class="calibre1"><b class="calibre3">Field</b></p>
<p class="calibre1"><b class="calibre3">no. </b></p>
<p class="calibre1"><b class="calibre3">Field name</b></p>
<p class="calibre1"><b class="calibre3">Description</b></p>
<p class="calibre1">An Option data type (Hourly, Daily, Weekly, or Monthly) is<br>used for the frequency of a show; Hourly should be used for a</p>
<p class="calibre1">1000</p>
<p class="calibre1">Frequency<br>show segment such as news, sports, or weather that is<br>scheduled every hour. A space/blank is used for the first option<br>to allow a valid blank field value. </p>
<p class="calibre1">This is the number (stored as Integer) of <b class="calibre3">Public Service</b></p>
<p class="calibre1">PSA Planned</p>
<p class="calibre1">1010</p>
<p class="calibre1"><b class="calibre3">Announcements</b> (<b class="calibre3">PSAs</b>) to be played per show; this will be</p>
<p class="calibre1">Quantity<br>used by playlist generation and posting logic. </p>
<p class="calibre1">This is the number (stored as Integer) of advertisements to be</p>
<p class="calibre1">Ads Planned</p>
<p class="calibre1">1020</p>
<p class="calibre1">played per show; this will be used by playlist generation and</p>
<p class="calibre1">Quantity<br>posting logic. </p>
<p class="calibre1">Is headline news required to be broadcast during the show (a</p>
<p class="calibre1">1030</p>
<p class="calibre1">News Required</p>
<p class="calibre1">Boolean)? </p>
<p class="calibre1">This is the duration (stored as Duration) of the news program</p>
<p class="calibre1">1040</p>
<p class="calibre1">News Duration<br>that’s embedded within the show. </p>
<p class="calibre1">Sports</p>
<p class="calibre1">Is sports news required to be broadcast during the show (a</p>
<p class="calibre1">1050</p>
<p class="calibre1">Required</p>
<p class="calibre1">Boolean)? </p>
<p class="calibre1">Sports</p>
<p class="calibre1">This is the duration (stored as Duration) of the sports</p>
<p class="calibre1">1060</p>
<p class="calibre1">Duration<br>program that’s embedded within the show. </p>
<p class="calibre1">Weather</p>
<p class="calibre1">Is weather news required to be broadcast during the show</p>
<p class="calibre1">1070</p>
<p class="calibre1">Required</p>
<p class="calibre1">(Boolean)? </p>
<p class="calibre1">Weather</p>
<p class="calibre1">This is the duration (stored as Duration) of the weather</p>
<p class="calibre1">1080</p>
<p class="calibre1">Duration<br>program that’s embedded within the show. </p>
<p class="calibre1">This is the date FlowFilter (stored as Data Type Date or Data</p>
<p class="calibre1">Class FlowFilter) that will change the calculations of the</p>
<p class="calibre1">1090</p>
<p class="calibre1">Date Filter<br>flow fields based on the date filter that’s applied. We will cover</p>
<p class="calibre1">FlowFilters in more detail in Chapter 3,  <i class="calibre4">Data Types and Fields</i>. </p>
<p class="calibre1"><b class="calibre3">[ 83 ]</b></p>
<p class="calibre1"><a id="calibre_link-444"></a><img src="images/000077.jpg" alt="Image 82" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">After we have completed our Radio Show table, it will look like this:</p>
<p class="calibre1"><b class="calibre3">[ 84 ]</b></p>
<p class="calibre1"><a id="calibre_link-395"></a><img src="images/000100.png" alt="Image 83" class="calibre2" /></p>
<p class="calibre1"><img src="images/000118.jpg" alt="Image 84" class="calibre2" /></p>
<p class="calibre1"><img src="images/000141.png" alt="Image 85" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Next, we need to fill the OptionMembers property for the Option field called Frequency. </p>
<p class="calibre1">This is done between the curly braces, as shown in the following screenshot:</p>
<p class="calibre1">More information about working with the Option fields can be found</p>
<p class="calibre1"><a href="https://redandbundle.com/2018/05/23/options-and-the-agony-of-choice/">at https:/​/​redandbundle.​com/​2018/​05/​23/​options-​and-​the-​agony-​of-</a></p>
<p class="calibre1"><a href="https://redandbundle.com/2018/05/23/options-and-the-agony-of-choice/">choice/​. </a></p>
<p class="calibre1">Next, we want to define the reference table we are going to tie to the Type field. The table will contain a list of the available Radio Show types, such as Music, Talk, and Sports. We will keep this table very simple, with Code as the unique key field and Description as the text field. Both fields will be of the default length, as shown in the following layout. Create the new table and save it as table 50101 with the name of Radio Show Type:</p>
<p class="calibre1">Before we can use this table as a reference from the Radio Station table, we need to create a List page that will be used for both data entry and data selection for the table. We will use a snippet to create a List page. We should be able to do this pretty quickly. Create a new file in Visual Studio Code called page 50102 Radio Show Type.al and start typing tp, then click on tpage, Page of type list:</p>
<p class="calibre1"><b class="calibre3">[ 85 ]</b></p>
<p class="calibre1"><a id="calibre_link-445"></a><img src="images/000164.jpg" alt="Image 86" class="calibre2" /></p>
<p class="calibre1"><img src="images/000187.png" alt="Image 87" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Populate the page properties with both (all) of the fields from the Radio Show Type table. </p>
<p class="calibre1">Our designed page should look as follows:</p>
<p class="calibre1"><b class="calibre3">[ 86 ]</b></p>
<p class="calibre1"><a id="calibre_link-49"></a><img src="images/000208.jpg" alt="Image 88" class="calibre2" /></p>
<p class="calibre1"><img src="images/000228.jpg" alt="Image 89" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Publish your solution and search for the Radio Show Type page. The new page will be displayed. While the page is open, enter some data (by clicking on <b class="calibre3">New</b>), as shown in the following screenshot:</p>
<p class="calibre1">Now, we’ll return to the Radio Show Type table and set the table’s properties for LookupPageID and DrillDownPageID to point to the new page we have just created:</p>
<p class="calibre1"><b class="calibre3">Assigning a table relation property</b></p>
<p class="calibre1">Finally, we will open the Radio Show table again. This time, add the TableRelation property between the curly braces of the Type field. Connect it to our new Radio Show Type table:</p>
<p class="calibre1"><b class="calibre3">[ 87 ]</b></p>
<p class="calibre1"><a id="calibre_link-393"></a><img src="images/000252.jpg" alt="Image 90" class="calibre2" /></p>
<p class="calibre1"><img src="images/000274.png" alt="Image 91" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">To check that the TableRelation property is working properly, we can publish and run the <b class="calibre3">Radio Show List</b> page again. We should highlight the <b class="calibre3">RADIO SHOW TYPE</b> field and click on the drop-down arrow to view the list of available entries. The following screenshot is of our <b class="calibre3">Radio Show List</b> page:</p>
<p class="calibre1">If all has gone according to plan, the <b class="calibre3">RADIO SHOW TYPE</b> field will display an assist edit image (the three dots). We will invoke the drop-down list for the Radio Show Type table, as shown in the preceding screenshot. </p>
<p class="calibre1"><b class="calibre3">[ 88 ]</b></p>
<p class="calibre1"><a id="calibre_link-50"></a><img src="images/000295.png" alt="Image 92" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">Assigning an InitValue property</b></p>
<p class="calibre1">Another property we can define for several of the Radio Show fields is InitValue. WDTU</p>
<p class="calibre1">has a standard policy that states that news, sports, and weather should be broadcast for a few minutes at the beginning of every hour in the day. We want the Boolean (true/false) fields, News Required, Sports Required, and Weather Required, to default to true. </p>
<p class="calibre1">Setting the default for a field to a specific value simply requires setting the InitValue property to the desired value. In the case of the required Boolean fields, that value is set to true:</p>
<p class="calibre1"><b class="calibre3">Adding a few activity-tracking tables</b></p>
<p class="calibre1">Our WDTU organization is a profitable and productive radio station. We track historical information about our advertisers, royalties owed, and listenership. We track the music that is played, the rates we charge for advertisements based on the time of day, and we provide a public service by broadcasting a variety of government and other public service announcements. </p>
<p class="calibre1">We aren’t going to cover all of these features and functions in the following detailed exercises. However, it’s always good to have a complete view of the system that we are working on, even if we are only working on one or two components. In this case, the parts of the system that aren’t covered in detail in our exercises will be opportunities for you to extend your studies and practice on your own. </p>
<p class="calibre1"><b class="calibre3">[ 89 ]</b></p>
<p class="calibre1"><a id="calibre_link-446"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Any system development should start with a design document that completely spells out the goals and the functional design details. Neither system design nor project management will be covered in this book, but when we begin working on production projects, proper attention to both of these areas will be critical to success. Use of a proven project management methodology can make a project much more likely to be on time and within budget. </p>
<p class="calibre1">Based on the requirements our analysts have given us, we need to expand our application design. We started with a Radio Show table, one reference table (Radio Show Type), and pages for each of them. Earlier, we entered some test data and added a few additional fields to the Radio Show table (which we will not add to our pages here). </p>
<p class="calibre1">Now, we will add a supplemental table, document (header and line) tables, plus a ledger (activity history) table relating to playlist activities. Following this, we will also create some pages for our new data structures. </p>
<p class="calibre1">Our WDTU application will now include the following tables:</p>
<p class="calibre1">Radio Show: This is a master list of all programs broadcast by our station. </p>
<p class="calibre1">Radio Show Type: This is a reference list of possible types of radio shows. </p>
<p class="calibre1">Playlist Header: This is a single instance of Radio Show with child data in<br>the form of playlist lines. </p>
<p class="calibre1">Playlist Line: Each line represents one of a list of items and/or duration per</p>
<p class="calibre1">Radio Show. </p>
<p class="calibre1">Playlist Item Rate: This is a list of rates for items that are played during a<br>show, as determined by our advertising sales staff or the royalty organization we use. </p>
<p class="calibre1">Radio Show Entry: This is a detailed history of all of the time spent and items<br>played during the show, with any related royalties owed or advertisement<br>revenue expected. </p>
<p class="calibre1">Listenership Entry: This is a detailed history of estimated listenership<br>provided by the ratings organization to which we subscribe. </p>
<p class="calibre1">Publisher: This is a reference list of the publishers of content that we use. This will include music distributors, news wires, sports, and weather sources, as well as WDTU (we use material that we publish). </p>
<p class="calibre1">Remember, one purpose of this example system is for you to follow along on a hands-on basis in your own system. You may want to try different data structures and other object features. For example, you could add functionality to track volunteer activity, perhaps even detailing the type of support the volunteers provide. </p>
<p class="calibre1"><b class="calibre3">[ 90 ]</b></p>
<p class="calibre1"><a id="calibre_link-51"></a><img src="images/000315.png" alt="Image 93" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">For the best learning experience, you should be creating each of these objects in your development system to learn by experimenting. During the course of these exercises, it will be good if you make some mistakes and see some new error messages. That’s part of the learning experience. A test system is the best place to learn from mistakes with the minimum cost. </p>
<p class="calibre1"><b class="calibre3">New tables for our WDTU project</b></p>
<p class="calibre1">First, we need to create a Playlist Header table (table number 50102), which will contain one record for each scheduled Radio Show:</p>
<p class="calibre1">Then, we will create the associated Playlist Line table (table number 50103). This table will contain child records for the Playlist Header table. Each Playlist Line record represents one scheduled piece of music, advertisement, public service announcement, or embedded show within scheduled Radio Show that’s defined in the Playlist Header<br>table. Description for each of the option fields shows the information that needs to be entered into the OptionMembers property for those fields:</p>
<p class="calibre1"><b class="calibre3">[ 91 ]</b></p>
<p class="calibre1"><a id="calibre_link-447"></a><img src="images/000338.jpg" alt="Image 94" class="calibre2" /></p>
<p class="calibre1"><img src="images/000398.png" alt="Image 95" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Now, we’ll create our Playlist Item Rate table. These rates include both what we charge for advertising time and what we must pay in royalties for material we broadcast:</p>
<p class="calibre1"><b class="calibre3">[ 92 ]</b></p>
<p class="calibre1"><a id="calibre_link-394"></a><img src="images/000420.jpg" alt="Image 96" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">An entry table contains the detailed history of processed activity records. In this case, the data is a detailed history of all of the Playlist Line records for previously broadcast shows:</p>
<p class="calibre1"><b class="calibre3">[ 93 ]</b></p>
<p class="calibre1"><a id="calibre_link-448"></a><img src="images/000442.jpg" alt="Image 97" class="calibre2" /></p>
<p class="calibre1"><img src="images/000006.jpg" alt="Image 98" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Now, we’ll create one more entry table to retain data we receive from the listenership rating service:</p>
<p class="calibre1">Finally, we’ll add the last new table definition for now, which is our Publisher table:</p>
<p class="calibre1"><b class="calibre3">[ 94 ]</b></p>
<p class="calibre1"><a id="calibre_link-52"></a><img src="images/000026.png" alt="Image 99" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">New list pages for our WDTU project</b></p>
<p class="calibre1">Each of the new tables we have created should be supported with an appropriately named list page. As part of our WDTU project work, we should create the following pages: 50103: Playlist document list</p>
<p class="calibre1">50105: Playlist item rates</p>
<p class="calibre1">50106: Radio show entries</p>
<p class="calibre1">50107: Listenership entries</p>
<p class="calibre1">50108: Publishers</p>
<p class="calibre1"><b class="calibre3">Keys, SumIndexFields, and table relations in our</b></p>
<p class="calibre1"><b class="calibre3">examples</b></p>
<p class="calibre1">So far, we have created basic table definitions and associated pages for the WDTU project. </p>
<p class="calibre1">The next step is to flesh out those definitions with additional keys, SIFT field definitions, table relations, and so on. The purpose of these are to make our data easier and faster to access, to take advantage of the special features of Business Central to create data totals, and to facilitate relationships between various data elements. </p>
<p class="calibre1"><b class="calibre3">Secondary keys and SumIndexFields</b></p>
<p class="calibre1">The Playlist Line table’s default primary key was Document No.. For the primary key to be unique for each record, another field is needed. For a Line table, the additional field is the Line No. field, which is incremented via AL code for each record. So, we’ll change the key for table 50003 accordingly:</p>
<p class="calibre1"><b class="calibre3">[ 95 ]</b></p>
<p class="calibre1"><a id="calibre_link-53"></a><img src="images/000048.png" alt="Image 100" class="calibre2" /></p>
<p class="calibre1"><img src="images/000067.jpg" alt="Image 101" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">We know that a lot of reporting will be done based on the data in Radio Show Ledger. </p>
<p class="calibre1">We also know that we want to do reporting on data by Radio Show and by the type of entry (individual song, specific advertisement, and so on). So, we will add secondary keys for each of those, including a Date field so that we can rapidly filter the data by Date. The reporting that is financial in nature will need totals of the Fee Amount field, so we’ll put that in the SumIndexFields column for our new keys:</p>
<p class="calibre1">We know that to do the necessary listenership analysis, the listenership ledger needs an additional key, combined with SumIndexFields for totaling listener statistics:</p>
<p class="calibre1">To utilize the SumIndexFields column we have just defined, we will need to define corresponding FlowFields in other tables. We will leave that part of the development effort for the next chapter, where we are going to discuss fields, Flowfields, and FlowFilters in detail. </p>
<p class="calibre1"><b class="calibre3">Table relations</b></p>
<p class="calibre1">For the tables where we defined fields that are intended to refer to data in other tables for lookups and validation, we must define their relationships in the referring tables. </p>
<p class="calibre1">Sometimes, these relationships are complicated and are dependent on other values within the record. </p>
<p class="calibre1"><b class="calibre3">[ 96 ]</b></p>
<p class="calibre1"><a id="calibre_link-54"></a><img src="images/000090.png" alt="Image 102" class="calibre2" /></p>
<p class="calibre1"><img src="images/000110.png" alt="Image 103" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">In table 50103, Playlist Line, we have the No. field. If the Type field contains Resource, then the No. field should contain Resource No.. If the Type field contains Show, then the No. field should contain Radio Show No.. Finally, if the Type field contains Item, the No. field should contain Item No.. The pseudocode (approximate syntax) for that logic can be written as follows:</p>
<p class="calibre1">IF Type = ‘Resource’ THEN No. := Resource.No. ELSE IF Type = ‘Show’ THEN</p>
<p class="calibre1">No. := Radio Show.No. ELSE IF Type = ‘Item’ THEN No. := Item.No. </p>
<p class="calibre1">The syntax to put in Visual Studio Code is displayed in the following screenshot: Table 50004, Playlist Item Rate, has a similar TableRelation requirement for the Source No. field in that table. In this case, if Source Type = Vendor, then the Source No. field will refer to Vendor No., and if Source Type = Customer, then the Source No. field will refer to Customer No.:</p>
<p class="calibre1"><b class="calibre3">Modifying an original Business Central table</b></p>
<p class="calibre1">One of the big advantages of the Business Central system development environment is the fact that we are allowed to enhance the tables that are part of the original standard product. </p>
<p class="calibre1">Many package software products do not provide this flexibility. Nevertheless, with privilege comes responsibility. When we modify a standard Business Central table, we must do so carefully. </p>
<p class="calibre1"><b class="calibre3">[ 97 ]</b></p>
<p class="calibre1"><a id="calibre_link-55"></a><img src="images/000133.jpg" alt="Image 104" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">In our system, we are going to use the standard Item table&mdash;table 27&mdash;to store data about recordings such as music and advertisements and PSAs that we have available for<br>broadcast. To do this, we will create a table extension, as described in <a href="#calibre_link-2">Chapter 1, </a></p>
<p class="calibre1"> <i class="calibre4">Introduction to Business Central</i>. One of the new fields will be an Option field. Another will refer to the Publisher table we created earlier. When the modifications for the Item table design are completed, they will look as follows:</p>
<p class="calibre1"><b class="calibre3">Types of table</b></p>
<p class="calibre1">For this discussion, we will divide table types into three categories. As developers, we can change the definition and the contents of the first category (the fully modifiable tables). We cannot change the definition of the base fields of the second category, but we can change the contents (the content modifiable tables) and add new fields. The third category can be accessed for information, but neither the definition nor the data within is modifiable (the read-only tables). </p>
<p class="calibre1"><b class="calibre3">[ 98 ]</b></p>
<p class="calibre1"><a id="calibre_link-56"></a><img src="images/000155.jpg" alt="Image 105" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">Fully modifiable tables</b></p>
<p class="calibre1">The following tables are included in the fully modifiable tables category. </p>
<p class="calibre1"><b class="calibre3">Master data</b></p>
<p class="calibre1">The master data table type contains primary data (such as customers, vendors, items, and employees). In any enhancement project, these are the tables that should be designed first because everything else will be based on these tables. When working on a modification, necessary changes to master data tables should be defined first. Master data tables always use card pages as their primary user input method. The <b class="calibre3">Customers</b> page is a master data table. A customer record is shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 99 ]</b></p>
<p class="calibre1"><a id="calibre_link-57"></a><img src="images/000177.jpg" alt="Image 106" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">The preceding screenshot shows how the card page segregates the data into categories on different FastTabs (such as <b class="calibre3">General</b>, <b class="calibre3">Address &amp; Contact</b>, and <b class="calibre3">Invoicing</b>), and includes primary data fields (for example, <b class="calibre3">Name</b> and <b class="calibre3">Address</b>) and a FlowField (<b class="calibre3">Balance (LCY)</b>). </p>
<p class="calibre1"><b class="calibre3">Journal</b></p>
<p class="calibre1">The journal table type contains unposted activity detail, which is data that other systems refer to as transactions. Journals are where the most repetitive data entry occurs in Business Central. In the standard system, all journal tables are matched with corresponding template tables (one template table for each journal table). The standard system includes journals for <b class="calibre3">Sales</b>, <b class="calibre3">Cash Receipts</b>, <b class="calibre3">General Journal</b> entries, <b class="calibre3">Physical Inventory</b>, <b class="calibre3">Purchases</b>, <b class="calibre3">Fixed</b> <b class="calibre3">Assets</b>, and <b class="calibre3">Warehouse Activity</b>, among others. </p>
<p class="calibre1">The transactions in a journal can be segregated into batches for entry, edit review, and processing purposes. Journal tables always use worksheet pages as their primary user input method. The following screenshots show two journal entry screens. They both use the <b class="calibre3">General Journals</b> table, but each have quite a different appearance and are based on different pages and different templates:</p>
<p class="calibre1"><b class="calibre3">[ 100 ]</b></p>
<p class="calibre1"><a id="calibre_link-58"></a><img src="images/000199.jpg" alt="Image 107" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">By comparing the preceding and following screenshots, we can see that the differences include not only which fields are visible, but also what logic applies to data entry defaults and validations:</p>
<p class="calibre1"><b class="calibre3">Template</b></p>
<p class="calibre1">The template table type operates behind the scenes, providing control information for a journal, which operates in the foreground. By using a template, multiple instances of a journal can each be tailored for different purposes. Control information that’s contained in a template includes the following:</p>
<p class="calibre1">The default type of accounts to be updated (for example, <b class="calibre3">Customer</b>, <b class="calibre3">Vendor</b>, <b class="calibre3">Bank</b>, and <b class="calibre3">General Ledger</b>)</p>
<p class="calibre1">The specific account numbers to be used as defaults, including balancing<br>accounts</p>
<p class="calibre1">What transaction numbering series will be used</p>
<p class="calibre1">The default encoding to be applied to transactions for the journal (for example, <b class="calibre3">Source Code</b> and <b class="calibre3">Reason Code</b>)</p>
<p class="calibre1">Specific pages and reports to be used for data entry and processing of both edits and posting runs</p>
<p class="calibre1"><b class="calibre3">[ 101 ]</b></p>
<p class="calibre1"><a id="calibre_link-59"></a><img src="images/000222.jpg" alt="Image 108" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">For example, <b class="calibre3">General Journal Templates</b> allow the <b class="calibre3">General Journal</b> table to be tailored so that it can display fields and perform validations that are specific to the entry of particular transaction categories, such as <b class="calibre3">Cash Receipts</b>, <b class="calibre3">Payments</b>, <b class="calibre3">Sales</b>, and other transaction entry types. Template tables always use tabular pages for user input. The following screenshot shows a listing of the various <b class="calibre3">General Journal Templates</b> that are defined in the Cronus International Ltd. demonstration database:</p>
<p class="calibre1">In addition to these templates, there are batch tables, which allow us to set up any number of batches of data under each journal template. The batch, template, and journal line structure provides a great deal of flexibility in the data organization and definition of required fields while utilizing a common underlying table definition (<b class="calibre3">General Journal</b>). </p>
<p class="calibre1"><b class="calibre3">Entry tables</b></p>
<p class="calibre1">The entry table type contains posted activity detail, which is the data other systems call history. Business Central data flows from a journal through a posting routine into an entry. </p>
<p class="calibre1">A significant advantage of Business Central entry design is the fact that Business Central allows you to retain all transaction details indefinitely. While there are routines that support the compression of the entry data (if that’s even feasible), we should retain the full historical detail of all activities. This allows users to have total flexibility for historical comparative or trend data analysis. </p>
<p class="calibre1">Entry data is considered accounting data in Business Central. We are not allowed to directly enter the data into an entry or change existing data in an entry; instead, we must post to an entry. Posting is done by creating journal lines, validating the data as necessary, then posting those journal lines into the appropriate ledgers. Although we can physically force data into an entry with our developer tools, we shouldn’t do so. </p>
<p class="calibre1"><b class="calibre3">[ 102 ]</b></p>
<p class="calibre1"><a id="calibre_link-449"></a><img src="images/000242.png" alt="Image 109" class="calibre2" /></p>
<p class="calibre1"><img src="images/000265.jpg" alt="Image 110" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">When used with accounting, an entry is called a <b class="calibre3">ledger entry</b>. </p>
<p class="calibre1">When Ledger Entry data is accounting data, we are not permitted to delete this data from an entry table. Corrections are done by posting adjustments or reversing entries. We can compress or summarize some entry data (very carefully), which eliminates detail, but we should not change anything that would affect accounting totals for money or quantities. </p>
<p class="calibre1">User views of entry data are generally done through the use of list pages. The following screenshots show a <b class="calibre3">CUSTOMER LEDGER ENTRIES</b> list (financially-oriented data) and an <b class="calibre3">ITEM LEDGER ENTRIES</b> list (quantity-oriented data). In each case, the data represents historical activity details with accounting significance. There are other data fields in addition to those shown in the following screenshots, but the fields that are shown here are representative. The users can utilize page-customization tools (which we will discuss in</p>
<p class="calibre1"><a href="#calibre_link-91">Chapter 4, </a> <i class="calibre4">Pages &ndash; The Interactive Interface</i>) to create personalized page displays in a wide variety of ways. First, we have the <b class="calibre3">CUSTOMER LEDGER ENTRIES</b> list:</p>
<p class="calibre1"><b class="calibre3">[ 103 ]</b></p>
<p class="calibre1"><a id="calibre_link-450"></a><img src="images/000287.jpg" alt="Image 111" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Then, we have the <b class="calibre3">ITEM LEDGER ENTRIES</b> list:</p>
<p class="calibre1">The <b class="calibre3">CUSTOMER LEDGER ENTRIES</b> page displays critical information such as <b class="calibre3">POSTING</b></p>
<p class="calibre1"><b class="calibre3">DATE</b> (the effective accounting date), <b class="calibre3">DOCUMENT TYPE</b> (the type of transaction), <b class="calibre3">CUSTOMER NO. </b>, and the <b class="calibre3">ORIGINAL</b> and <b class="calibre3">REMAINING AMOUNT</b> of the transaction. </p>
<p class="calibre1">The record also contains the <b class="calibre3">ENTRY NO. </b>, which uniquely identifies each record. The open entries are those where the transaction amount has not been fully applied, such as an invoice amount that’s not been fully paid or a payment amount that’s not been fully consumed by invoices. </p>
<p class="calibre1">The <b class="calibre3">ITEM LEDGER ENTRIES</b> page displays similar information that’s pertinent to inventory transactions. As we described previously, <b class="calibre3">POSTING DATE</b>, <b class="calibre3">ENTRY TYPE</b>, and <b class="calibre3">ITEM NO. </b>, as well as the assigned <b class="calibre3">LOCATION CODE</b> for the item, control the meaning of each transaction. Item Ledger Entries are expressed both in <b class="calibre3">QUANTITY</b> and <b class="calibre3">AMOUNT</b></p>
<p class="calibre1"><b class="calibre3">(VALUE)</b>. The open entries here are tied to the <b class="calibre3">REMAINING QUANTITY</b>, such as material that has been received but is still available in stock. In other words, the open entries represent current inventory. Both the Customer Ledger Entry and Item Ledger Entry tables have underlying tables that provide additional details for entries affecting values. </p>
<p class="calibre1"><b class="calibre3">[ 104 ]</b></p>
<p class="calibre1"><a id="calibre_link-60"></a><img src="images/000309.jpg" alt="Image 112" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">Subsidiary (supplementary) tables</b></p>
<p class="calibre1">The subsidiary (also called supplementary) table type contains lists of codes, descriptions, or other validation data. Subsidiary table examples are postal zone codes, country codes, currency codes, currency exchange rates, and so on. Subsidiary tables are often accessed by means of one of the setup menu options because they must be set up prior to being used for reference purposes by other tables. In our WDTU example, tables 50001 Radio Show Type and 50007 Publisher are subsidiary tables. </p>
<p class="calibre1">The following screenshots show some sample subsidiary tables for location, country/region, and payment terms. Each table contains data elements that are appropriate for use as a subsidiary table, plus, in some cases, fields that control the effect of referencing a particular entry. These data elements are usually entered as part of a setup process and then updated over time as appropriate:</p>
<p class="calibre1"><b class="calibre3">[ 105 ]</b></p>
<p class="calibre1"><a id="calibre_link-451"></a><img src="images/000329.jpg" alt="Image 113" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">The <b class="calibre3">Location List</b> in the preceding screenshot is a simple validation list of the locations for this implementation. Usually, they represent physical sites, but depending on the implementation, they can also be used to segregate types of inventory. For example, locations could be refrigerated versus unrefrigerated, or there could be locations for awaiting inspection, passed inspection, and failed inspection:</p>
<p class="calibre1">The countries/regions that are listed in the preceding screenshot are used as validation data, and define the acceptable country codes. It also provides control information for the mailing <b class="calibre3">Address Format</b> (general organization address) and the <b class="calibre3">Contact Address Format</b> (for an individual’s contact address). </p>
<p class="calibre1"><b class="calibre3">[ 106 ]</b></p>
<p class="calibre1"><a id="calibre_link-61"></a><img src="images/000348.jpg" alt="Image 114" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">The <b class="calibre3">Payment Terms</b> table that’s shown in the following screenshot provides a list of payment terms codes, along with a set of parameters that allows the system to calculate specific terms. In this set of data, for example, the <b class="calibre3">1M(8D)</b> code will yield payment terms that are due in a month, with a discount of 2% applied to payments that are processed within eight days of the invoice date. In another instance, <b class="calibre3">14D</b> payment terms will calculate the payment as being due in 14 days from the date of invoice with no discount available: <b class="calibre3">Register</b></p>
<p class="calibre1">The register table type contains a record of the range of transaction ID numbers for each batch of posted Ledger Entries. Register data provides an audit trail of the physical timing and sequence of postings. This, combined with the full details that are retained in the Ledger Entry, makes Business Central a very auditable system, because we can see exactly what activity was done and when it was done:</p>
<p class="calibre1"><b class="calibre3">[ 107 ]</b></p>
<p class="calibre1"><a id="calibre_link-452"></a><img src="images/000370.jpg" alt="Image 115" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">The user views the register through a tabular page, as shown in the previous screenshot. </p>
<p class="calibre1">We can see that each register entry has the <b class="calibre3">CREATION DATE</b>, <b class="calibre3">SOURCE CODE</b>, <b class="calibre3">JOURNAL BATCH NAME</b>, and the identifying entry number range for all of the entries in that batch. Another Business Central feature, the <b class="calibre3">NAVIGATE</b> function, which we will</p>
<p class="calibre1"><a href="#calibre_link-91">discuss in detail in Chapter 4</a>,  <i class="calibre4">Pages &ndash; The Interactive Interface</i>, also provides a very useful auditing tool. The <b class="calibre3">NAVIGATE</b> function allows the user (who may be a developer doing testing) to highlight a single Ledger Entry and find all of the other ledger entries and related records that resulted from the posting that created that highlighted entry. </p>
<p class="calibre1"><b class="calibre3">[ 108 ]</b></p>
<p class="calibre1"><a id="calibre_link-62"></a><img src="images/000391.jpg" alt="Image 116" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">Posted document</b></p>
<p class="calibre1">The posted document type contains the history version of the original documents for a variety of data types, such as <b class="calibre3">Sales Invoices</b>, <b class="calibre3">Purchase Invoices</b>, <b class="calibre3">Sales Shipments</b>, and <b class="calibre3">Purchase Receipts</b>. Posted documents are designed to provide an easy reference to the historical data in a format similar to what would have been stored in paper files. A posted document looks very similar to the original source document. For example, a <b class="calibre3">Posted Sales</b> <b class="calibre3">Invoice</b> will look very similar to the original <b class="calibre3">Sales Orders</b> or <b class="calibre3">Sales Invoices</b>. The posted documents are included in the <b class="calibre3">NAVIGATE</b> function. </p>
<p class="calibre1">The following screenshots show a <b class="calibre3">Sales Orders</b> before posting and the resulting <b class="calibre3">Posted</b> <b class="calibre3">Sales Invoice</b> document. Both documents are in a header/detail format, where the information in the header applies to the whole order and the information in the detail is specific to the individual order line. As part of the <b class="calibre3">Sales Orders</b> page, there is information being displayed to the right of the actual order. This is designed to make the user’s life easier by providing related information without requiring a separate lookup action. </p>
<p class="calibre1">First, we can see that the <b class="calibre3">Sales Orders</b> document is ready to be posted:</p>
<p class="calibre1"><b class="calibre3">[ 109 ]</b></p>
<p class="calibre1"><a id="calibre_link-63"></a><img src="images/000413.jpg" alt="Image 117" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">The following screenshot is that of the partial shipment <b class="calibre3">Sales Invoice</b> document, after the invoice was posted for the shipped goods:</p>
<p class="calibre1"><b class="calibre3">Singleton</b></p>
<p class="calibre1">The singleton table type contains system or functional application control information, often referred to as setup. There is one setup table per functional application area, for example, one for <b class="calibre3">Sales &amp; Receivables</b>, one for <b class="calibre3">Purchases &amp; Payables</b>, one for <b class="calibre3">General</b> <b class="calibre3">Ledger</b>, and one for <b class="calibre3">Inventory</b>. Setup tables contain only a single record. Since a setup table has only one record, it can have a primary key field that has no value assigned to it (this is how all of the standard Business Central setup tables are designed). The singleton table design pattern can be found at</p>
<p class="calibre1"><a href="http://blogs.msdn.com/b/nav/archive/2013/07/19/nav-design-pattern-of-the-week-single-record-setup-table.aspx">http://blogs.msdn.com/b/nav/archive/2013/07/19/nav-design-pattern-of-the-week-s</a></p>
<p class="calibre1"><a href="http://blogs.msdn.com/b/nav/archive/2013/07/19/nav-design-pattern-of-the-week-single-record-setup-table.aspx">ingle-record-setup-table.aspx. </a></p>
<p class="calibre1"><b class="calibre3">[ 110 ]</b></p>
<p class="calibre1"><a id="calibre_link-64"></a><img src="images/000435.jpg" alt="Image 118" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">The <b class="calibre3">Inventory Setup</b> page is as follows:</p>
<p class="calibre1"><b class="calibre3">Temporary</b></p>
<p class="calibre1">A temporary table is used within objects to hold temporary data. A temporary table does not exist outside the instance of the object where it is defined using a permanent table as the source of the table definition. A temporary table has exactly the same data structure as the permanent table after which it is modeled. </p>
<p class="calibre1">Temporary tables are created empty when the parent object execution initiates, and they disappear along with their data when the parent object execution terminates (that is, when the temporary table variable goes out of scope). </p>
<p class="calibre1"><b class="calibre3">[ 111 ]</b></p>
<p class="calibre1"><a id="calibre_link-65"></a><img src="images/000000.png" alt="Image 119" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Temporary tables are not generally accessible to users, except on a display-only basis. They can directly be the target of reports, pages, and XML ports. In general, temporary tables are intended to be work areas, and as such, are containers of data. The definition of a temporary table can only be changed by changing the definition of the permanent table on which it has been modeled. </p>
<p class="calibre1">A temporary table technique is used by advanced developers to define a<br>new temporary table format without consuming a (paid for) licensed table<br>slot. You can do this as follows: define the new table in an unlicensed<br>number range. If the current production license allows for tables 50000</p>
<p class="calibre1">through 50099, assign the new layout to 50500 (for example). That layout<br>can then be used to define a temporary table in an object. The layout<br>cannot be used to actually store data in the database; it can only be used to<br>provide a convenient data format design for some special intermediate<br>process. </p>
<p class="calibre1"><b class="calibre3">Content modifiable tables</b></p>
<p class="calibre1">The content modifiable table category includes only one table type, the system table type. </p>
<p class="calibre1"><b class="calibre3">System table</b></p>
<p class="calibre1">The system table type contains user-maintainable information that pertains to the management or administration of the Business Central application system. System tables are created by Business Central; we cannot create system tables. However, with full developer license rights, we can modify system tables to extend their usage. With full system permissions, we can also change the data in system tables. </p>
<p class="calibre1">An example of a system table type is the User table, which contains user login information. </p>
<p class="calibre1">This particular system table is often modified to define special user access routing or processing limitations. Other system tables contain data on report-to-printer routing assignments, transaction numbers to be assigned, batch job scheduling, and so on. The following are examples of system tables in which definition and content can be modified. </p>
<p class="calibre1">The first three relate to system security functions:</p>
<p class="calibre1">User: The table of identified users and their security information</p>
<p class="calibre1">Permission Set: The table containing a list of all of the permission sets in the database</p>
<p class="calibre1"><b class="calibre3">[ 112 ]</b></p>
<p class="calibre1"><a id="calibre_link-453"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">Permission: The table defining what individual permission sets are allowed to<br>do, based on object permission assignments</p>
<p class="calibre1">Access Control: The table of the security roles that are assigned to each</p>
<p class="calibre1">Windows login</p>
<p class="calibre1">The following tables are used to track a variety of system data or control structures: Company: The companies in this database. Most Business Central data is<br>automatically segregated by company. </p>
<p class="calibre1">Chart: This defines all of the chart parts that have been set up for use in<br>constructing pages. </p>
<p class="calibre1">Web Service: This lists the pages, queries, and codeunits that have been<br>published as web services. </p>
<p class="calibre1">Profile: This contains a list of all of the active profiles and their associated <b class="calibre3">Role</b> <b class="calibre3">Center</b> pages. A profile is a collection of Business Central users who are assigned to the same <b class="calibre3">Role Center</b>. </p>
<p class="calibre1">User Personalization: In spite of its name, this table does not contain<br>information about user personalization that has occurred. Instead, this table<br>contains the link between the user ID and the profile ID, the language, company, and debugger controls. (A personalization is a change in the layout of a page by a user, such as adding or removing fields, page parts, restructuring menus, </p>
<p class="calibre1">resizing columns, and so on. This information can be found in the User</p>
<p class="calibre1">Metadata table.)</p>
<p class="calibre1">The following tables contain information about various system internals. Their explanation is outside the scope of this book:</p>
<p class="calibre1">Send-to Program</p>
<p class="calibre1">Style Sheet</p>
<p class="calibre1">User Default Style Sheet</p>
<p class="calibre1">Record Link</p>
<p class="calibre1">Object Tracking</p>
<p class="calibre1">Object Metadata</p>
<p class="calibre1">Profile Metadata</p>
<p class="calibre1">User Metadata</p>
<p class="calibre1"><b class="calibre3">[ 113 ]</b></p>
<p class="calibre1"><a id="calibre_link-66"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">Read-only tables</b></p>
<p class="calibre1">There is only one table type included in the read-only table category, the virtual table type. </p>
<p class="calibre1"><b class="calibre3">Virtual</b></p>
<p class="calibre1">The virtual table type is computed at runtime by the system. A virtual table contains data and is accessed like other tables, but we cannot modify either the definition or the contents of a virtual table. We can think of virtual tables as system data that’s presented in the form of a table so that it is readily available to AL code. Some of these tables (such as the Database File, File, and Drive tables) provide access to information about the<br>computing environment. Other virtual tables (such as the Table Information, Field, and Session tables) provide information about the internal structure and operating activities of our database. A good way to learn more about any of these tables is to create a list or card page that’s bound to the table of interest. Include all of the fields in the page layout, <b class="calibre3">Save</b> the page, and <b class="calibre3">Run</b> it. We can then view the field definition and data contents of the target virtual table. </p>
<p class="calibre1">Some virtual tables (such as Date and Integer) provide tools that can be used in our application routines. The Date table provides a list of calendar periods (such as days, weeks, months, quarters, and years) to make it much easier to manage various types of accounting and managerial data handling. The Integer table provides a list of integers from -1.000.000.000 to 1.000.000.000. As we explore standard Business Central reports, we will frequently see the Integer table being used to supply a sequential count to facilitate a reporting sequence (often in a limited numeric range, such as 1 or 1 to 10). </p>
<p class="calibre1">We cannot see these tables in the list of table objects, and we can only access them as targets for pages, reports, or variables in AL code. Knowledge of the existence, contents, and usage of these virtual tables isn’t useful to an end user. However, as developers, we will regularly use some of these virtual tables. There is educational value in studying the structure and contents of these tables, as well as having the ability to create valuable tools with knowledge of and by accessing one or more virtual tables. </p>
<p class="calibre1"><b class="calibre3">[ 114 ]</b></p>
<p class="calibre1"><a id="calibre_link-67"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1"><b class="calibre3">Summary</b></p>
<p class="calibre1">In this chapter, we focused on the foundation level of Business Central data structure: tables and their internal structure. We worked our way through the hands-on creation of a number of tables and their data definitions in support of our WDTU application. We briefly discussed field groups and how they are used. </p>
<p class="calibre1">We identified essential table structure elements, including properties, object numbers, triggers, keys, and SumIndexFields. Finally, we reviewed the various categories of tables that can be found in Business Central. </p>
<p class="calibre1">In the next chapter, we will dig deeper into the Business Central data structure to understand how fields and their attributes are assembled to make up tables. We will also focus on what can be done with triggers. Then, we will explore how other object types use tables so that we can work toward developing a fully-featured Business Central<br>development toolkit. </p>
<p class="calibre1"><b class="calibre3">Questions</b></p>
<p class="calibre1">1. Which of the following is a correct description of a table in Business Central? </p>
<p class="calibre1">Choose two:</p>
<p class="calibre1">A Business Central table is the definition of data structure</p>
<p class="calibre1">A Business Central table includes a built-in data entry page</p>
<p class="calibre1">A Business Central table can contain AL code, but that should be<br>avoided</p>
<p class="calibre1">A Business Central table should implement many of the business rules<br>of a system</p>
<p class="calibre1">2. All primary keys should contain only one data field. True or false? </p>
<p class="calibre1">3. It is possible to link a Business Central table to a table outside of the Business Central database using what property? Choose one:</p>
<p class="calibre1">DatabaseLink</p>
<p class="calibre1">ObjectPointer</p>
<p class="calibre1">LinkedObject</p>
<p class="calibre1">C# Codelet</p>
<p class="calibre1"><b class="calibre3">[ 115 ]</b></p>
<p class="calibre1"><a id="calibre_link-454"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">4. System tables cannot be modified. True or false? </p>
<p class="calibre1">5. Which of the following are table triggers? Choose two:</p>
<p class="calibre1">OnInsert</p>
<p class="calibre1">OnChange</p>
<p class="calibre1">OnNewKey</p>
<p class="calibre1">OnRename</p>
<p class="calibre1">6. Keys can be enabled or disabled in executable code. True or false? </p>
<p class="calibre1">7. Because setup tables only contain one record, they do not need to have a primary key. True or false? </p>
<p class="calibre1">8. Table numbers that are intended to be used for customized table objects should only range between 5000 to 9999. True or false? </p>
<p class="calibre1">9. Which of the following tables can be modified by partner developers? Choose<br>three:</p>
<p class="calibre1">Customer</p>
<p class="calibre1">Date</p>
<p class="calibre1">User</p>
<p class="calibre1">Item Ledger Entry</p>
<p class="calibre1">10. The drop-down display on a field lookup can be changed by modifying the<br>table’s field groups. True or false? </p>
<p class="calibre1">11. Temporary table data can be saved in a special database storage area. True or false? </p>
<p class="calibre1">12. Which of the following virtual tables are commonly used in Business Central<br>development projects? Choose two:</p>
<p class="calibre1">Date</p>
<p class="calibre1">GPS Location</p>
<p class="calibre1">Integer</p>
<p class="calibre1">Object Metadata</p>
<p class="calibre1">13. SumIndexFields can be used to calculate totals. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 116 ]</b></p>
<p class="calibre1"><a id="calibre_link-455"></a> <i class="calibre4">Tables</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 2</i></p>
<p class="calibre1">14. Table permissions (for access to another table’s data) include which of the<br>following permissions? Choose three:</p>
<p class="calibre1">Read</p>
<p class="calibre1">Sort</p>
<p class="calibre1">Delete</p>
<p class="calibre1">Modify</p>
<p class="calibre1">15. The table relation property allows a field in one table to reference data in another table. True or false? </p>
<p class="calibre1">16. Tables can be created or deleted dynamically. True or false? </p>
<p class="calibre1">17. Only tables have triggers and only fields have properties. True or false? </p>
<p class="calibre1">18. Ledger Entry data in Business Central can be freely updated through either<br>posting routines or direct data entry. True or false? </p>
<p class="calibre1">19. SQL Server for Business Central supports SIFT by which mechanism? Choose<br>one:</p>
<p class="calibre1">SQL SIFT indexes</p>
<p class="calibre1">SQL dynamic indexes</p>
<p class="calibre1">SQL indexed views</p>
<p class="calibre1">SIFT not supported in SQL</p>
<p class="calibre1">20. Reference tables and virtual tables are simply two different names for the same type of tables. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 117 ]</b></p>
<p class="calibre1"><a id="calibre_link-68"></a>3</p>
<p class="calibre1">Data Types and Fields</p>
<p class="calibre1"> <i class="calibre4">“You can’t build a great building on a weak foundation. You must have a solid foundation</i> <i class="calibre4">if you’re going to have a strong superstructure.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Gordon B. Hinckley</i></p>
<p class="calibre1"> <i class="calibre4">“Perfection is achieved, not when there is nothing more to add, but rather when there is</i> <i class="calibre4">nothing more to take away.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Antoine de Saint-Exupéry</i></p>
<p class="calibre1">The design of an application should begin at the simplest level, that is, with the design of the data elements. The type of data our development tool supports has a significant effect on our design. Because Business Central is designed for financially-oriented business applications, Business Central data types are financially- and business-oriented. </p>
<p class="calibre1">In this chapter, we will cover many of the data types that we will use within Business Central. For each data type, we will cover some of the more frequently modified field properties and how particular properties, such as FieldClass, are used to support application functionality. FieldClass is a fundamental property that defines whether the contents of the field is data to be processed or control information to be interpreted. </p>
<p class="calibre1">In particular, we will be covering the following topics:</p>
<p class="calibre1">Basic definitions</p>
<p class="calibre1">Fields</p>
<p class="calibre1">Data types</p>
<p class="calibre1">FieldClass properties</p>
<p class="calibre1">Filtering</p>
<p class="calibre1"><a id="calibre_link-69"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1"><b class="calibre3">Basic definitions in Business Central</b></p>
<p class="calibre1">First, let’s review some basic Business Central terminology:</p>
<p class="calibre1"><b class="calibre3">Data type</b>: This defines the kind of data that can be held in a field, whether it be numeric (such as integer or decimal), text, a table RecordID, time, date, Boolean, and so forth. The data type defines what constraints can be placed on the<br>contents of a field, determines the functions in which the data element can be<br>used (not all data types are supported by all functions), and defines what the<br>results of certain functions will be. </p>
<p class="calibre1"><b class="calibre3">Fundamental data type</b>: This is a simple, single component structure consisting of a single value at any point in time, for example, a number, a string, or a</p>
<p class="calibre1">Boolean value. </p>
<p class="calibre1"><b class="calibre3">Complex data type</b>: This is a structure that’s made up of or relates to simple data types, for example, records, program objects, such as pages or reports, <b class="calibre3">Binary</b> <b class="calibre3">Large OBjects</b> (<b class="calibre3">BLOBs</b>), DateFormulas, external files, and indirect reference variables. </p>
<p class="calibre1"><b class="calibre3">Data element</b>: This is an instance of a data type that may be a constant or a variable. </p>
<p class="calibre1"><b class="calibre3">Constant</b>: This is a data element that’s explicitly defined in the code by a literal value. Constants are only modifiable during execution by a developer. All of the simple data types can be represented by constants. Examples include MAIN (code<br>or text), 12.34 (decimal), and +01-312-444-5555 (text). </p>
<p class="calibre1"><b class="calibre3">Variable</b>: This is a data element that can have a value assigned to it dynamically during execution. Except for special cases, a variable will be of a single, </p>
<p class="calibre1">unchanging, specific data type. </p>
<p class="calibre1"><b class="calibre3">Fields</b></p>
<p class="calibre1">A field is the basic element of data definition in Business Central&mdash;the atom in the structure of a system. The elemental definition of a field consists of its number, its description (name), its data type, and, of course, any properties that are required for its particular data type. A field is defined by the values of its properties and the AL code contained in its triggers. </p>
<p class="calibre1"><b class="calibre3">[ 119 ]</b></p>
<p class="calibre1"><a id="calibre_link-70"></a><img src="images/000020.png" alt="Image 120" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1"><b class="calibre3">Field properties</b></p>
<p class="calibre1">The specific properties that can be defined for a field depend on the data type. There is a minimum set of universal properties, which we will review first. Then, we will review the rest of the more frequently used properties, some of which are data dependent and some are not. Check out the remaining properties by using Microsoft Documents. </p>
<p class="calibre1">We can access the properties of a field while viewing the table in Visual Studio Code, highlighting the field, and then clicking inside the curly braces and<br>pressing  <i class="calibre4">Ctrl</i> + spacebar. All of the property screenshots in this section were obtained in this way for fields within the Radio Show table. As we review various field properties, you will learn more if you follow along in your Business Central system using Visual Studio Code. </p>
<p class="calibre1">Explore different properties and the values they can have. Use Microsoft Docs liberally for additional information and examples. </p>
<p class="calibre1">When a property value is not explicitly set, the default value is used. It is<br>considered a best practice to not set a property if the default value applies. </p>
<p class="calibre1">All of the fields, of any data type, have the following properties:</p>
<p class="calibre1">Field No.: This is the identifier for the field within the containing table object. </p>
<p class="calibre1">Name: This is the label by which AL code references the field. A name can consist of up to 30 characters, including special characters. The name can be changed by a developer at any time, and Business Central will automatically ripple that<br>change throughout the system. If no Caption value has been defined, the name<br>is used as the default caption when data from this field is displayed. Changing<br>names that are used as literals in AL code can cause problems with some<br>functions, such as web services and GETFILTERS, where the reference is based on<br>the field name rather than the field number. </p>
<p class="calibre1">Caption: This contains the defined caption for the currently selected language. It will always be one of the defined multi-language captions. The default language<br>for a Business Central installation is determined by the combination of a set of built-in rules and the languages that are available in a specific installation of the software. </p>
<p class="calibre1"><b class="calibre3">[ 120 ]</b></p>
<p class="calibre1"><a id="calibre_link-392"></a><img src="images/000042.png" alt="Image 121" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">CaptionML: This defines the multi-language caption for the table. It also<br>identifies the language in use, for example, ENU for US English (as shown in the following screenshot). </p>
<p class="calibre1">Description: This is an optional use property for our internal documentation. </p>
<p class="calibre1">Data Type: This defines what type of data format applies to this field (for<br>example, Integer, Date, Code, Text, Decimal, Option, and Boolean). </p>
<p class="calibre1">Enabled: This determines whether or not the field has been activated for user<br>generated events. The property defaults to &lt;Yes&gt; and is rarely changed. </p>
<p class="calibre1">AccessByPermission: This determines the permission mask that’s required for<br>a user to access this field in pages or in the <b class="calibre3">user interface</b> (<b class="calibre3">UI</b>). </p>
<p class="calibre1">The following screenshot shows the properties for a field of the data type, BLOB: The set of properties shown for a BLOB data type field is the simplest set of field properties. </p>
<p class="calibre1">After the properties that are shared by all of the data types are given, the BLOB-specific properties are shown, that is, SubType and Compressed:</p>
<p class="calibre1">SubType: This defines the type of data stored in BLOB and sets a filter in the<br>import/export function for the field. The three subtype choices are Bitmap (for<br>bitmap graphics), Memo (for text data), and UserDefined (for anything else). </p>
<p class="calibre1">UserDefined is the default value. </p>
<p class="calibre1">Compressed: This defines whether the data stored in BLOB is stored in a<br>compressed format. If we want to access BLOB data with an external tool (from<br>outside Business Central), this property must be set to false. </p>
<p class="calibre1"><b class="calibre3">[ 121 ]</b></p>
<p class="calibre1"><a id="calibre_link-341"></a><img src="images/000062.png" alt="Image 122" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">The properties of Code and Text data type fields are quite similar to one another. This is logical since both represent types of textual data, as shown in the following screenshot: The following are some common properties between the Code and Text data types:</p>
<p class="calibre1">InitValue: This is the value that the system will supply as a default when the<br>field is initialized. </p>
<p class="calibre1">CaptionClass: This can be set up by the developer to allow users to<br>dynamically change the caption for a text box or a check box. CaptionClass<br>defaults to empty. For more information, refer to  <i class="calibre4">Developer and IT-pro</i>  <i class="calibre4">help</i></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/">(https:/​/​docs.​microsoft.​com/​en-​us/​dynamics365/​business-​central/​dev-</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/">itpro/​). This is used in base Business Central in the dimensions fields. </a></p>
<p class="calibre1">Editable: This is set to false when we don’t want to allow a field to be edited, for example, if it is a computed or assigned value field that the user should not change. Editable defaults to true. </p>
<p class="calibre1">NotBlank, Numeric, CharAllowed, DateFormula, and ValuesAllowed: Each<br>of these allows us to place constraints on the data that can be entered into this field by a user. They do not affect data updates that are driven by application AL</p>
<p class="calibre1">code. </p>
<p class="calibre1"><b class="calibre3">[ 122 ]</b></p>
<p class="calibre1"><a id="calibre_link-456"></a><img src="images/000084.png" alt="Image 123" class="calibre2" /></p>
<p class="calibre1"><img src="images/000105.png" alt="Image 124" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">SQL Data Type: This applies to Code fields only. SQL Data Type defines what<br>data type will be allowed in this particular Code field and how it will be mapped to a SQL Server data type. This controls sorting and display. Options<br>include Varchar, Integer, BigInteger or Variant. Varchar is the default<br>and causes all of the data to be treated as text. Integer and BigInteger allow<br>only numeric data to be entered. Variant can contain any of a wide range of</p>
<p class="calibre1">Business Central data types. In general, once set, this property should not be<br>changed. These settings should not affect data handling that’s done in SQL</p>
<p class="calibre1">Server external to Business Central, but the conservative approach is not to make changes here. </p>
<p class="calibre1">TableRelation: This is used to specify a relationship to data in the specified<br>target table. The target table field must be in the primary key. The relationship can be conditional and/or filtered. The relationship can be used for validation, lookups, and data-change propagation. </p>
<p class="calibre1">ValidateTableRelation: If TableRelation is specified, set this to &lt;Yes&gt; to validate the relation when data is entered or changed (in other words, confirm<br>that the entered data exists in the target table). If TableRelation is defined and this property is set to &lt;No&gt;, the automatic table referential integrity will not be maintained. </p>
<p class="calibre1"><b class="calibre3">Caution</b>: Application code can be written that will bypass this validation. </p>
<p class="calibre1">ExtendedDataType: This property allows for the optional designation of an<br>extended data type, which automatically receives special formatting and<br>validation. Type options include an email address, URL, phone number, report<br>filter, progress bar ratio, or masked entry (as dots). An action icon may also be displayed, as shown in the following screenshot, where there are three fields<br>with ExtendedDataType defined:</p>
<p class="calibre1"><b class="calibre3">[ 123 ]</b></p>
<p class="calibre1"><a id="calibre_link-346"></a><img src="images/000126.png" alt="Image 125" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Let’s take a look at the properties of two more data types, Decimal and Integer, especially those properties related to numeric content:</p>
<p class="calibre1">DecimalPlaces: This sets the minimum and maximum number of decimal<br>places (min:max) for storage and for display in a Decimal data item. The default is 2 &lt;2:2&gt;, the minimum is 0, and the maximum is 255. </p>
<p class="calibre1">BlankNumbers, BlankZero, and SignDisplacement: These can be used to<br>control the formatting and display of the data field on a page. BlankNumbers<br>and BlankZero means that all fields of the chosen values are to be displayed as<br>blank. SignDisplacement allows data positioning to be shifted for negative<br>values. </p>
<p class="calibre1">MinValue and MaxValue: When set, these constrain the range of data values that<br>are allowed for user entry. The range that’s available depends on the field data type. </p>
<p class="calibre1">AutoIncrement: This allows for the definition of one Integer field in a table to automatically increment for each record that’s entered. When this is used, which is not often, it is almost always to support the automatic updating of a field that’s used as the last field in a primary key, hence enabling the creation of a unique key. Use of this feature does not ensure a contiguous number sequence. When<br>the property is set to true, the automatic functionality should not be overridden in code:</p>
<p class="calibre1">The properties for an Option data type are similar to those of other numeric data types. </p>
<p class="calibre1">This is reasonable because Option is stored as an integer, but there are also Option-specific properties:</p>
<p class="calibre1">OptionMembers: This details the text interpretations for each of the stored<br>integer values contained in an Option field</p>
<p class="calibre1">OptionCaption or OptionCaptionML: These serve the same captioning and<br>multi-language purposes as caption properties for other data types</p>
<p class="calibre1"><b class="calibre3">[ 124 ]</b></p>
<p class="calibre1"><a id="calibre_link-71"></a><img src="images/000149.png" alt="Image 126" class="calibre2" /></p>
<p class="calibre1"><img src="images/000171.png" alt="Image 127" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Internally, options are stored as integers that are tied to each option’s position in OptionMembers, starting with position 0, 1, 2, and so on. OptionMembers and</p>
<p class="calibre1">OptionCaption are shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Field triggers</b></p>
<p class="calibre1">To view the field triggers, let’s look at our 50100 “Radio Show” table. Add the following triggers to the No. field within the curly braces:</p>
<p class="calibre1">Each field has two triggers, the OnValidate() trigger and the OnLookup() trigger, which function as follows:</p>
<p class="calibre1">OnValidate(): The AL code in this trigger is executed whenever an entry is<br>made by the user. The intended use is to validate that the entry conforms to the design parameters for the field. It can also be executed under program control<br>through use of the VALIDATE function (which we will discuss later). </p>
<p class="calibre1"><b class="calibre3">[ 125 ]</b></p>
<p class="calibre1"><a id="calibre_link-72"></a><img src="images/000193.png" alt="Image 128" class="calibre2" /></p>
<p class="calibre1"><img src="images/000216.png" alt="Image 129" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">OnLookup(): Lookup behavior can be triggered by clicking on the lookup arrow<br>in a field, as shown in the following screenshot:</p>
<p class="calibre1">If the field’s TableRelation property refers to a table, then the default behavior is to display a drop-down list to allow for the selection of a table entry to be stored in this field. The list will be based on Field Groups that have been<br>defined for the table. We may choose to override that behavior by coding<br>different behavior for a special case. We must be careful, because any entry<br>whatsoever in the body of an OnLookup() trigger, even a comment line, will<br>eliminate the default behavior of this trigger. </p>
<p class="calibre1"><b class="calibre3">Field events</b></p>
<p class="calibre1">Instead of placing your business code in the OnValidate trigger of a field, you can also subscribe to system generated events. For each field, we can subscribe to the</p>
<p class="calibre1">OnBeforeValidate event and the OnAfterValidate event. These events are triggered, as their name suggests, before and after the code we place in the OnValidate trigger. </p>
<p class="calibre1">Subscribing to these events can be useful to avoid making modifications to the objects that are shipped by Microsoft so that future updates are easier to implement and merging code is prevented. </p>
<p class="calibre1">More information about events in Dynamics Business Central can be</p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-events-in-al">found on MSDN: https:/​/​docs.​microsoft.​com/​en-​us/​dynamics365/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-events-in-al">business-​central/​dev-​itpro/​developer/​devenv-​events-​in-​al. </a></p>
<p class="calibre1"><b class="calibre3">Data structure examples</b></p>
<p class="calibre1">Some good examples of tables in the standard product to review for particular features are as follows:</p>
<p class="calibre1">Table 18 Customer has a variety of data types and field classes. This table<br>contains some fairly complex examples of AL code in the Triggers table. A</p>
<p class="calibre1">wide variety of field property variations can be seen in this table as well. </p>
<p class="calibre1"><b class="calibre3">[ 126 ]</b></p>
<p class="calibre1"><a id="calibre_link-73"></a><img src="images/000236.png" alt="Image 130" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Table 14 Location and Table 91 User Setup both have good examples of</p>
<p class="calibre1">OnValidate trigger AL code, as do all of the primary master tables (Customer, </p>
<p class="calibre1">Vendor, Item, Job, and so on). </p>
<p class="calibre1"><b class="calibre3">Field numbering</b></p>
<p class="calibre1">The number of each field within its parent table object is the unique identifier that Business Central uses internally to identify that field. We can easily change a field number when we are initially defining a table layout, but after other objects, such as pages, reports, or codeunits, reference the fields in a table, it becomes difficult to change the number of referenced fields. Deleting a field and reusing its field number for a different purpose is not a good idea and can easily lead to programming confusion. </p>
<p class="calibre1">We cannot safely change the definition of, re-number, or delete a field that<br>has data present in the database easily. The same can be said for reducing<br>the defined size of a field to less than the largest size of the data that’s<br>already present in that field. However, if we force the change, the force<br>function will override the system’s built-in safeguards. This action can<br>truncate or delete data. </p>
<p class="calibre1">When we add new fields to standard Business Central product tables (those shipped with the product), the new field numbers must be in the 50,000 to 99,999 number range, unless we have been explicitly licensed for another number range. Field numbers for fields in new tables that we create may be anything from 1 to 999,999,999. </p>
<p class="calibre1">When a field representing the same data element appears in related tables (for example, Table 37 Sales Line and Table 113 Sales Invoice Line), the same field number<br>should be assigned to that data element for each of the tables. Not only is this consistent approach easier for reference and maintenance, but it also supports the TRANSFERFIELDS</p>
<p class="calibre1">function. TRANSFERFIELDS permits the copying data from one table’s record instance to another table’s record instance by doing record to record mapping based on the field numbers. </p>
<p class="calibre1">If we plan ahead and number the fields logically and consistently from the beginning of our design work, we will create code that’s easier to maintain. It’s a good idea to leave frequent gaps in field number sequences within a table. This allows for easier insertion of new fields numerically adjacent to related, previously defined fields. In turn, that makes it easier for the next developer to understand the modification’s data structure. </p>
<p class="calibre1"><b class="calibre3">[ 127 ]</b></p>
<p class="calibre1"><a id="calibre_link-74"></a><img src="images/000259.png" alt="Image 131" class="calibre2" /></p>
<p class="calibre1"><img src="images/000280.png" alt="Image 132" class="calibre2" /></p>
<p class="calibre1"><img src="images/000302.png" alt="Image 133" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">See  <i class="calibre4">Object Numbering Conventions</i> in Microsoft Docs for additional<br>information. </p>
<p class="calibre1"><b class="calibre3">Field and variable naming</b></p>
<p class="calibre1">In general, the rules for naming fields (data elements in a table) and variables (data elements within the working storage of an object) are the same, and we will discuss them on that basis. Information on this can be found in the released C/ <i class="calibre4">AL Coding Guidelines</i> at</p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/156.cal-coding-guidelines">https://community.dynamics.com/nav/w/designpatterns/156.cal-coding-guidelines, </a></p>
<p class="calibre1">including a  <i class="calibre4">How do I</i> video. </p>
<p class="calibre1">Variables in Business Central can either be global (with a scope across the breadth of an object) or local (with a scope only within a single function). Variable names should be unique within the sphere of their scope. </p>
<p class="calibre1">Uniqueness includes not duplicating reserved words or system variables. Refer to the  <i class="calibre4">AL</i></p>
<p class="calibre1"> <i class="calibre4">Reserved Words</i> list in the  <i class="calibre4">Developer and IT pro</i>  <i class="calibre4">help</i> for more information. </p>
<p class="calibre1">Avoid using any word as a variable name that appears as an uppercase or<br>capitalized word in either the  <i class="calibre4">Developer and IT-pro</i>  <i class="calibre4">help</i> or any of the published Business Central technical documentation. For example, we<br>shouldn’t use the words page or image as variable names. </p>
<p class="calibre1">Variable names in Business Central are not case-sensitive. There is a 128-character length limit on variable names (but still a 30-character length limit on field names in tables). </p>
<p class="calibre1">Variable names can contain all ASCII characters, except for control characters (ASCII values 0 to 31 and 255) and the double quote (ASCII value 34), as well as some Unicode characters that are used in languages other than English. Characters outside the standard ASCII set (0-127) may display differently on different systems. </p>
<p class="calibre1">Note that the compiler won’t tell us that an asterisk (*, ASCII value 42) or<br>question mark (?, ASCII value 63) cannot be used in a variable name. </p>
<p class="calibre1">However, because both the asterisk and the question mark can be used as<br>wildcards in many expressions, especially filtering, neither one should be<br>used in a variable name. </p>
<p class="calibre1"><b class="calibre3">[ 128 ]</b></p>
<p class="calibre1"><a id="calibre_link-75"></a><img src="images/000324.png" alt="Image 134" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">The first character of a variable name must be a letter from  <i class="calibre4">A</i> to  <i class="calibre4">Z</i> (upper or lowercase) or an underscore (_, ASCII value 95), that is, unless the variable name is enclosed in double quotes when it is referenced in code (and such names should be avoided). Alphabets other than the 26-character English alphabet may interpret the ASCII values as characters other than  <i class="calibre4">A</i> to  <i class="calibre4">Z</i> and may include more than 26 characters. A variable name’s first character can be followed by any combination of legal characters. </p>
<p class="calibre1">If we use any characters other than the  <i class="calibre4">A-Z</i> alphabet, numerals, and underscore, we must surround our variable name with double quotes each time we use it in AL code (for example, Cust List, which contains an embedded space, or No, which contains a period). </p>
<p class="calibre1">See  <i class="calibre4">Naming Conventions</i> in the  <i class="calibre4">Developer and IT-pro</i>  <i class="calibre4">help</i> for additional AL</p>
<p class="calibre1">variable naming guidance. </p>
<p class="calibre1"><b class="calibre3">Data types</b></p>
<p class="calibre1">In this section, we are going to segregate the data types into several groups. First, we will look at fundamental data types and then complex data types. </p>
<p class="calibre1"><b class="calibre3">Fundamental data types</b></p>
<p class="calibre1">Fundamental data types are the basic components from which the complex data types are formed. They are grouped into Numeric, String, and Date/Time data types. </p>
<p class="calibre1"><b class="calibre3">Numeric data</b></p>
<p class="calibre1">Just like other systems, Business Central supports several numeric data types. The specifications for each Business Central data type are defined for Business Central, independent of the supporting SQL Server database rules. But some data types are stored and handled somewhat differently from a SQL Server point of view than the way they appear to us as Business Central developers and users. For more details on the SQL Server-specific representations of various data elements, refer to the  <i class="calibre4">developer and IT pro help</i>. Our discussion will focus on the Business Central representation and handling for each data type. </p>
<p class="calibre1"><b class="calibre3">[ 129 ]</b></p>
<p class="calibre1"><a id="calibre_link-363"></a><img src="images/000343.png" alt="Image 135" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">The various numeric data types are as follows:</p>
<p class="calibre1">Integer: This is an integer number ranging from -2.147.483.646 to</p>
<p class="calibre1">+2.147.483.647. </p>
<p class="calibre1">Decimal: This is a decimal number in the range of +/- 999.999.999.999.999,99. </p>
<p class="calibre1">Although it is possible to construct larger numbers, errors such as overflow, </p>
<p class="calibre1">truncation, or loss of precision might occur. In addition, there is no facility to display or edit larger numbers. </p>
<p class="calibre1">Option: This is a special instance of an integer, stored as an integer number<br>ranging from 0 to +2.147.483.647. An Option data type is normally represented<br>in the body of our AL code as an option string. We can compare an Option data<br>type to an integer in AL rather than using the option string, but that’s not good practice because it eliminates the self-documenting aspect of an option field. </p>
<p class="calibre1">OptionMembers: This is a set of choices listed in a comma-separated string, one<br>of which is chosen and stored as the current option. Since the maximum length of this string is 250 characters, the practical maximum number of choices for a<br>single option is less than 125. The currently selected choice within the set of<br>options is stored in the option field as the ordinal position of that option within the set. For example, the selection of an entry from the option string of red, </p>
<p class="calibre1">yellow, blue would result in the storing of 0 (red), 1 (yellow), and 2 (blue). If red were selected, 0 would be stored in the variable, and if blue were selected, 2</p>
<p class="calibre1">would be stored. Quite often, an option string starts with a blank to allow an<br>effective choice if none has been chosen. An example of this (blank, Hourly, </p>
<p class="calibre1">Daily, Monthly) is as follows:</p>
<p class="calibre1">Boolean: A Boolean variable is stored as 1 or 0, which in AL code is<br>programmatically referred to as True or False. Boolean variables may be<br>displayed as yes or no (language dependent),  <i class="calibre4">P</i> or blank, or True or False. </p>
<p class="calibre1"><b class="calibre3">[ 130 ]</b></p>
<p class="calibre1"><a id="calibre_link-76"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">BigInteger: This is an 8-byte integer as opposed to a 4-byte integer. </p>
<p class="calibre1">BigIntegers are for very big numbers (from -9.223.372.036.854.775.807 to</p>
<p class="calibre1">9.223.372.036.854.775.807). </p>
<p class="calibre1">Char: This is a numeric code between 0 and 65,535 (hexadecimal FFFF)</p>
<p class="calibre1">representing a single 16-bit Unicode character. Char variables can operate either as text or as numbers. Numeric operations can be done on Char variables. </p>
<p class="calibre1">Char variables can also be defined with individual text character values. Char<br>variables cannot be defined as permanent variables in a table, only as working<br>storage variables within AL objects. </p>
<p class="calibre1">Byte: A single 8-bit ASCII character with a value of 0 to 255. Byte variables can operate either as text or as numbers. Numeric operations can be done on Byte<br>variables. Byte variables can also be defined with individual text character<br>values. Byte variables cannot be defined as permanent variables in a table, only as working storage variables within AL objects. </p>
<p class="calibre1">Action: This is a variable that’s returned from a PAGE RUNMODAL function or</p>
<p class="calibre1">RUNMODAL (Page) function that specifies what action a user performs on a page. </p>
<p class="calibre1">Possible values are OK, Cancel, LookupOK, LookupCancel, Yes, No, RunObject, </p>
<p class="calibre1">and RunSystem. </p>
<p class="calibre1">ExecutionMode: This specifies the mode in which a session is running. The<br>possible values are Debug and Standard. </p>
<p class="calibre1"><b class="calibre3">String data</b></p>
<p class="calibre1">The following are the data types that are included in String data:</p>
<p class="calibre1">Text: This contains any string of alphanumeric characters. In a table, a Text field can be from 1 to 250 characters long. In working storage within an object, a Text variable can be any length if there is no length defined. If a maximum length is defined, it must not exceed 1,024. Business Central does not require a length to be specified, but if we define a maximum length, it will be enforced. When<br>calculating the length of a record for design purposes (relative to the maximum<br>record length of 8,000 bytes), the full defined field length should be counted. </p>
<p class="calibre1"><b class="calibre3">[ 131 ]</b></p>
<p class="calibre1"><a id="calibre_link-77"></a><img src="images/000364.png" alt="Image 136" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Code: Help says the length constraints for Code variables are the same as those<br>for text variables, but the AL editor enforces limits of 1 to 250 characters in<br>length. All of the letters are automatically converted into uppercase when data is entered into a Code variable; any leading or trailing spaces are removed. </p>
<p class="calibre1">TextBuilder: Allows for easy string manipulation, such as Append, Replace, </p>
<p class="calibre1">and Length. </p>
<p class="calibre1">You can find more details on the TextBuilder class in Microsoft Docs:</p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/api/textbuilder-class">https:/​/​docs.​microsoft.​com/​en-​us/​dynamics365/​business-​central/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/api/textbuilder-class">dev-​itpro/​developer/​api/​textbuilder-​class</a>. </p>
<p class="calibre1"><b class="calibre3">Date/Time data</b></p>
<p class="calibre1">Date/Time data display is region-specific; in other words, the data is displayed according to local standards for date and time display. The following are the data types that are included in Date/Time data:</p>
<p class="calibre1">Date: This contains an integer number, which is interpreted as a date ranging<br>from January 1, 1754 to December 31, 9999. A <b class="calibre3">0D</b> (<b class="calibre3">numeral zero, letter D</b>) represents an undefined date (stored as a SQL Server DateTime field), which is<br>interpreted as January 1, 1753. According to the  <i class="calibre4">developer and IT pro help</i>, Business Central supports a date of 1/1/0000 (presumably as a special case for backward<br>compatibility, but not supported by SQL Server). </p>
<p class="calibre1">A <b class="calibre3">date constant</b> can be written as the letter <b class="calibre3">D</b>, preceded by either six digits in the format <i class="calibre4">MMDDYY</i> or eight digits as  <i class="calibre4">MMDDYYYY</i> (where  <i class="calibre4">M</i> for month,  <i class="calibre4">D</i> for day, and  <i class="calibre4">Y</i> for year). </p>
<p class="calibre1">For example,  <i class="calibre4">011917D</i> or  <i class="calibre4">01192017D</i> both represent January 19, 2017. Later, in DateFormula, we will find  <i class="calibre4">D</i> interpreted as day, but here, the trailing  <i class="calibre4">D</i> is interpreted as the date (data type) constant. When the year is expressed as  <i class="calibre4">YY</i> rather than  <i class="calibre4">YYYY</i>, the century portion (in this case, 20) is 20 if the two-digit year is from 00 to 29, or 19 if the year is from 30 through 99. </p>
<p class="calibre1">Business Central also defines a special date called a <b class="calibre3">closing</b> <b class="calibre3">date</b>, which represents the point in time between one day and the next. The purpose of a closing date is to provide a point at the end of a day, after all of the real date and time-sensitive activity is recorded, that is, the point when accounting closing entries can be recorded. </p>
<p class="calibre1"><b class="calibre3">[ 132 ]</b></p>
<p class="calibre1"><a id="calibre_link-338"></a><img src="images/000386.jpg" alt="Image 137" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Closing entries are recorded, in effect, at the stroke of midnight between two dates&mdash;this is the date of closing of accounting books and has been designed like this so that you can include or not include, at the user’s option, closing entries in various reports. When sorted by date, the closing date entries will get sorted after all of the normal entries for a day. For example, the normal date entry for December 31, 2017 would display as 12/31/17</p>
<p class="calibre1">(depending on the date format masking), and the closing date entry would display as C12/31/17. All of the C12/31/17 ledger entries would appear after all normal 12/31/17 ledger entries. The following screenshot shows three 2018 closing date entries mixed with normal entries from January 1st, 2019 (this data is from the CRONUS demo. The 2018 closing entries have an opening <b class="calibre3">Entry</b> description showing that these were the first entries for the demo data in the respective accounts. This is not a normal set of production data):</p>
<p class="calibre1">Let’s discuss a few parameters in detail:</p>
<p class="calibre1">Time: This contains an integer number, which is interpreted on a 24-hour clock, </p>
<p class="calibre1">in milliseconds plus 1, from 00:00:00 to 23:59:59:999. A 0T (numeral zero, letter T) represents an undefined time and is stored as 1/1/1753 00:00:00.000. </p>
<p class="calibre1">DateTime: This represents a combined date and time, stored in <b class="calibre3">Coordinated</b></p>
<p class="calibre1"><b class="calibre3">Universal Time</b> (<b class="calibre3">UTC</b>), and always displays local time (that is, the local time on our system). DateTime fields do not support Business Central closing dates. </p>
<p class="calibre1">DateTime is helpful for an application that needs to support multiple time zones simultaneously. DateTime values can range from January 1, 1754 00:00:00.000 to</p>
<p class="calibre1">December 31, 9999 23:59:59.999, but dates earlier than January 1, 1754 cannot be entered (don’t test with dates late in 9999 as an intended advance to the year</p>
<p class="calibre1">10000 won’t work). Assigning a date of 0DT yields an undefined or blank</p>
<p class="calibre1">DateTime. </p>
<p class="calibre1"><b class="calibre3">[ 133 ]</b></p>
<p class="calibre1"><a id="calibre_link-78"></a><img src="images/000408.png" alt="Image 138" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Duration: This represents the positive or negative difference between two</p>
<p class="calibre1">DateTime values, in milliseconds, stored as BigInteger. Durations are<br>automatically output in the text format:  <i class="calibre4">DDD</i> days  <i class="calibre4">HH</i> hours  <i class="calibre4">MM</i> minutes  <i class="calibre4">SS</i></p>
<p class="calibre1">seconds. </p>
<p class="calibre1"><b class="calibre3">Complex data types</b></p>
<p class="calibre1">Each complex data type consists of multiple data elements. For ease of reference, we will categorize them into several groups of similar types. </p>
<p class="calibre1"><b class="calibre3">Data structure</b></p>
<p class="calibre1">The following data types are in the data structure group:</p>
<p class="calibre1"><b class="calibre3">File</b>: This refers to any standard Windows file outside the Business Central database. There is a reasonably complete set of functions to allow a range of<br>actions, including creating, deleting, opening, closing, reading, writing, and<br>copying data files. For example, we could create our own Business Central<br>routines in AL to import or export data to or from a file that had been created by some other application. </p>
<p class="calibre1">With the three tier architecture of Business Central, business logic runs on<br>the server, not the client. We need to keep this in mind whenever we are<br>referring to local external files, because they will be on the server by<br>default. Use of <b class="calibre3">Universal Naming Convention</b> (<b class="calibre3">UNC</b>) paths can make<br>this easier to manage. </p>
<p class="calibre1"><b class="calibre3">Record</b>: This refers to a single data row within a Business Central table that consists of individual fields. Quite often, multiple variable instances of a record (table) are defined in working storage to support a validation process, allowing access to different records within the table at one time in the same function. </p>
<p class="calibre1"><b class="calibre3">[ 134 ]</b></p>
<p class="calibre1"><a id="calibre_link-79"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1"><b class="calibre3">Objects</b></p>
<p class="calibre1">Page, report, codeunit, query, and XMLport each represent an object data type. Object data types are used when there is a need for a reference to an object or a function in another object. Some examples of this are as follows:</p>
<p class="calibre1">Invoking a report or an XMLport from a page or a report</p>
<p class="calibre1">Calling a function for data validation or processing is coded as a function in a table or a codeunit</p>
<p class="calibre1"><b class="calibre3">Web services</b></p>
<p class="calibre1">To work with web services, Business Central supports a set of HTTP, XML, and JSON</p>
<p class="calibre1">variables. Documentation on these types can be found<a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-restapi-overview"> in the Microsoft Docs: https:/​/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-restapi-overview">docs.​microsoft.​com/​en-​us/​dynamics365/​business-​central/​dev-​itpro/​developer/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-restapi-overview">devenv-​restapi-​overview</a>. </p>
<p class="calibre1"><b class="calibre3">DotNet</b></p>
<p class="calibre1">Business Central supports using .NET in on premises installations. </p>
<p class="calibre1">DotNet allows for the definition of a variable for .NET Framework interface types within an assembly. This supports the access of .NET Framework type members, including methods, properties, and constructors from AL. These can be members of the global assembly cache or custom assemblies. </p>
<p class="calibre1"><b class="calibre3">Input/output</b></p>
<p class="calibre1">The following are the input/output data types:</p>
<p class="calibre1">Dialog: This supports the definition of a simple UI window without the use of a<br>page object. Typically, Dialog windows are used to communicate processing<br>progress or to allow a brief user response to a go/no-go question, although the<br>latter could result in bad performance due to locking. There are other user<br>communication tools as well, but they do not use a Dialog type data item. </p>
<p class="calibre1">InStream and OutStream: These allow you to read from and write to external<br>files, BLOB data type’s, and objects of the automation and DotNet data types. </p>
<p class="calibre1"><b class="calibre3">[ 135 ]</b></p>
<p class="calibre1"><a id="calibre_link-80"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1"><b class="calibre3">DateFormula</b></p>
<p class="calibre1">DateFormula provides the definition and storage of a simple, but clever, set of constructs to support the calculation of runtime-sensitive dates. DateFormula is stored in a non-language dependent format, hence supporting multi-language functionality. DateFormula is a combination of the following:</p>
<p class="calibre1">Numeric multipliers (for example, 1, 2, 3, 4, and so on)</p>
<p class="calibre1">Alpha time units (all must be uppercase)</p>
<p class="calibre1"> <i class="calibre4">D</i> for a day</p>
<p class="calibre1"> <i class="calibre4">W</i> for a week</p>
<p class="calibre1"> <i class="calibre4">WD</i> for the day of the week, that is, day 1 through day 7 (either in the future or in the past, not today); Monday is day 1, and Sunday is day 7</p>
<p class="calibre1"> <i class="calibre4">M</i> for calendar month</p>
<p class="calibre1"> <i class="calibre4">Y</i> for year</p>
<p class="calibre1"> <i class="calibre4">CM</i> for current month,  <i class="calibre4">CY</i> for current year, and  <i class="calibre4">CW</i> for current week Math symbols interpretation: <b class="calibre3">+</b> (plus), that is,  <i class="calibre4">CM + 10D</i> means the current month end plus 10 days (in other words, the 10th of next month), and <b class="calibre3">-</b> (minus), that is, ( <i class="calibre4">-</i></p>
<p class="calibre1"> <i class="calibre4">WD3</i>), which means the date of the previous Wednesday (the third day of the past week)</p>
<p class="calibre1">Positional notation ( <i class="calibre4">D15</i> means the 15th day of the month and  <i class="calibre4">15D</i> means 15</p>
<p class="calibre1">days)</p>
<p class="calibre1">Payment terms for invoices supports full use of DateFormula. All DateFormula results are expressed as a date based on a reference date. The default reference date is the system date, not the work date. </p>
<p class="calibre1">Here are some sample DateFormulas and their interpretations (displayed dates are based on the US calendar) with a reference date of July 10, 2017, a Friday:</p>
<p class="calibre1"> <i class="calibre4">CM</i>: The last day of the current month, 07/31/15</p>
<p class="calibre1"> <i class="calibre4">CM + 10D</i>: The 10th of next month, 08/10/15</p>
<p class="calibre1"> <i class="calibre4">WD6</i>: The next sixth day of the week, 07/11/15</p>
<p class="calibre1"> <i class="calibre4">WD5</i>: The next fifth day of the week, 07/17/15</p>
<p class="calibre1"> <i class="calibre4">CM - M + D</i>: The end of the current month minus one month plus one day, </p>
<p class="calibre1">07/01/15</p>
<p class="calibre1"> <i class="calibre4">CM - 5M</i>: The end of the current month minus five months, 02/28/15</p>
<p class="calibre1"><b class="calibre3">[ 136 ]</b></p>
<p class="calibre1"><a id="calibre_link-457"></a><img src="images/000429.png" alt="Image 139" class="calibre2" /></p>
<p class="calibre1"><img src="images/000449.png" alt="Image 140" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Let’s take the opportunity to use the DateFormula data type to learn a few Business Central development basics. We will do so by experimenting with some hands-on<br>evaluations of several DateFormula values. We will create a table to calculate dates using DateFormula and reference dates. </p>
<p class="calibre1">Go to <b class="calibre3">File</b> | <b class="calibre3">New</b> | <b class="calibre3">Save</b>. Save the file with the name: table 50140 Date Formula. Type in ttable (with two t’s) and give the table an ID of 50140 and a name of Date Formula. </p>
<p class="calibre1">After we’ve finished this test, we will save the table for later testing:</p>
<p class="calibre1">Now, we will add some simple AL code to our table so that, when we enter or change either Reference Date or the DateFormula data, we can calculate a new result date. </p>
<p class="calibre1">At the bottom of the file, we delete the triggers that were generated by the snippet and create a new procedure. The name of the procedure is CalculateNewDate:</p>
<p class="calibre1">Notice that our new procedure was defined as a LOCAL function. This means that it cannot be accessed from another object unless we change it to a global procedure. </p>
<p class="calibre1">Because our goal now is to focus on experimenting with DateFormula, we will not go into detail explaining the logic we are creating. </p>
<p class="calibre1"><b class="calibre3">[ 137 ]</b></p>
<p class="calibre1"><a id="calibre_link-458"></a><img src="images/000015.png" alt="Image 141" class="calibre2" /></p>
<p class="calibre1"><img src="images/000034.jpg" alt="Image 142" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">The logic we’re going to code follows: when an entry is made (new or<br>changed) in either the Reference Date field or in the Date Formula to</p>
<p class="calibre1">Test field, invoke the CalculateNewDate function to calculate a new</p>
<p class="calibre1">Date Result value based on the entered data. </p>
<p class="calibre1">First, we will create the logic within our new function, CalculateNewDate(), to evaluate and store Date Result based on the DateFormula and Reference Date fields that we enter into the table. </p>
<p class="calibre1">Just copy the AL code exactly, as shown in the following screenshot, and save the table: If you get an error message of any type when you close and save the table, you probably didn’t copy the AL code exactly as it is shown in the preceding screenshot (this is shown again in the following code to make it easy to copy):</p>
<p class="calibre1">CalculateNewDate; </p>
<p class="calibre1">“Date Result” := CalcDate(“Date Formula to Test”,“Reference for Date Calculation”); </p>
<p class="calibre1">This code will cause the CalculateNewDate() function to be called via the OnValidate trigger when an entry is made in either the Reference for Date Calculation or Date Formula to Test fields. The function will place the result in the Date Result field. The use of an integer value in the redundantly named primary key field allows us to enter any number of records into the table (by manually numbering them 1, 2, 3, and so forth). </p>
<p class="calibre1"><b class="calibre3">[ 138 ]</b></p>
<p class="calibre1"><a id="calibre_link-337"></a><img src="images/000056.jpg" alt="Image 143" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Let’s experiment with several different date and date formula combinations. We will access the table via a simple page, as shown in the following screenshot:</p>
<p class="calibre1">If we build and publish the extension, we can run the page from the search option. </p>
<p class="calibre1">Enter a primary key value of 1 (one). In Reference for Date Calculation, enter either an uppercase or lowercase T for today, the system date. The same date will appear in the Date Result field, because at this point no date formula has been entered. Now, enter 1D</p>
<p class="calibre1">(numeral 1 followed by uppercase or lowercase letter  <i class="calibre4">D</i>; C/SIDE will take care of making it upper case) in the Date Formula to Test field. We will see that the contents of the Date Result field has changed to be one day beyond the date in the Reference for Date Calculation field. </p>
<p class="calibre1">Now, for another test entry&mdash;let’s start with 2 in the primary key field. Again, enter the letter T (for today) in the Reference Date for Calculation field, and enter the letter W</p>
<p class="calibre1">(for week) in the Date Formula to Test field. We will get an error message telling us that our formulas should include a number. Make the system happy and enter 1W. We’ll now see a date in the Date Result field that is one week beyond our system date. </p>
<p class="calibre1"><b class="calibre3">[ 139 ]</b></p>
<p class="calibre1"><a id="calibre_link-459"></a><img src="images/000076.png" alt="Image 144" class="calibre2" /></p>
<p class="calibre1"><img src="images/000099.png" alt="Image 145" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Set the system’s work date to a date in the middle of a month (remember, we discussed</p>
<p class="calibre1"><a href="#calibre_link-2">setting the work date in Chapter 1</a>,  <i class="calibre4">Introduction to Business Central</i>). Start another line with the number 3 as the primary key, followed by W (for work date) in the Reference Date for Calculation field. Enter cm (or CM, cM, or Cm&mdash;it doesn’t matter) in the Date Formula to Test field. Our result date will be the last day of our work date month. Now, enter another line using the work date, but enter a formula of -cm (the same as before, but with a minus sign). This time, our result date will be the first day of our work date month. </p>
<p class="calibre1">Notice that the DateFormula logic handles month end dates correctly, even including leap years. Try starting with a date in the middle of February 2016 to confirm that:</p>
<p class="calibre1">Enter another line with a new primary key. Skip over the Reference Date for</p>
<p class="calibre1">Calculation field and just enter 1D in the Date Formula to Test field. What happens? </p>
<p class="calibre1">We get an error message stating that <b class="calibre3">You cannot base a date calculation on an undefined</b> <b class="calibre3">date</b>. In other words, Business Central cannot make the requested calculation without a reference date. Before we put this function into production, we want our code to check for a reference date before calculating. We could default an empty date to the system date or the work date and avoid this particular error. </p>
<p class="calibre1">The preceding and following screenshots show different sample calculations. Build on these sample calculations and then experiment more on your own:</p>
<p class="calibre1"><b class="calibre3">[ 140 ]</b></p>
<p class="calibre1"><a id="calibre_link-81"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">We can create a variety of different algebraic date formulas and get some very interesting and useful results. One Business Central user business has due dates for all invoices of the 10th of the next month. The invoices are dated on the dates they are actually printed, at various times throughout the month. But by using DateFormula of  <i class="calibre4">CM + 10D</i>, each invoice due date is always automatically calculated to be the 10th of the next month. </p>
<p class="calibre1">Don’t forget to test with WD (weekday), Q (quarter), and Y (year), as well as D (day), W</p>
<p class="calibre1">(week), and M (month). For our code to be language-independent, we should enter the date formulas with &lt; &gt; delimiters around them (for example, &lt;1D+1W&gt;). Business Central will translate the formula into the correct language codes using the installed language layer. </p>
<p class="calibre1">Although our focus for the work we just completed was the DateFormula data type, we’ve accomplished a lot more than simply learning about that one data type:</p>
<p class="calibre1">We created a new table just for the purpose of experimenting with an AL feature<br>that we might use. This is a technique that comes in handy when we are learning<br>a new feature, trying to decide how it works or how we might use it. </p>
<p class="calibre1">We put some critical OnValidate logic into the table. When data is entered in<br>one area, the entry is validated and, if valid, the defined processing is done<br>instantly. </p>
<p class="calibre1">We created a common routine as a new LOCAL function. That function is then<br>called from all of the places to which it applies. </p>
<p class="calibre1">Finally, and most specifically, we saw how Business Central tools make a variety of relative date calculations easy. These are very useful in business applications, many aspects of which are date centered. </p>
<p class="calibre1"><b class="calibre3">References and other data types</b></p>
<p class="calibre1">The following data types are used for advanced functionality in Business Central, and sometimes support an interface with an external object:</p>
<p class="calibre1">RecordID: This contains the object number and primary key of a table. </p>
<p class="calibre1">RecordRef: This identifies a record/row in a table. RecordRef can be used to<br>obtain information about the table, the record, the fields in the record, and the currently active filters on the table. </p>
<p class="calibre1">FieldRef: This identifies a field in a table, hence allowing access to the contents of that field. </p>
<p class="calibre1"><b class="calibre3">[ 141 ]</b></p>
<p class="calibre1"><a id="calibre_link-317"></a><img src="images/000119.png" alt="Image 146" class="calibre2" /></p>
<p class="calibre1"><img src="images/000142.png" alt="Image 147" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">KeyRef: This identifies a key in a table and the fields in that key. </p>
<p class="calibre1">Since the specific record, field, and key references are assigned at runtime, </p>
<p class="calibre1">RecordRef, FieldRef, and KeyRef are used to support logic that can run<br>on tables that aren’t specified at design time. This means that one routine<br>built on these data types can be created to perform a common function for<br>a variety of different tables and table formats. </p>
<p class="calibre1">Variant: This defines variables that are typically used for interfacing with</p>
<p class="calibre1">Automation and DotNet objects. Variant variables can contain data of various</p>
<p class="calibre1">AL data types for passing an Automation or DotNet object, as well as external</p>
<p class="calibre1">Automation data types that cannot be mapped to AL data types. </p>
<p class="calibre1">TableFilter: This is for variables that can only be used for setting security<br>filters from the Permissions table. </p>
<p class="calibre1">Transaction Type: This has optional values of UpdateNoLocks, Update, </p>
<p class="calibre1">Snapshot, Browse, and Report, which define SQL Server behavior for a</p>
<p class="calibre1">Business Central report or XMLport transaction from the beginning of the<br>transaction. </p>
<p class="calibre1">BLOB: This can contain either specially formatted text, a graphic in the form of a bitmap, or other developer-defined binary data that’s up to 2 GB in size. <b class="calibre3">Binary</b> <b class="calibre3">Large Objects</b> (<b class="calibre3">BLOBs</b>) can only be included in tables; they cannot be used to define working storage variables. See the  <i class="calibre4">Developer and IT-pro</i>  <i class="calibre4">help</i> for additional information. </p>
<p class="calibre1">BigText: This can contain large chunks of text up to 2 GB in size. BigText<br>variables can only be defined in the working storage within an object, but are not included in tables. BigText variables cannot be directly displayed or seen in the debugger. There is a group of special functions that can be used to handle</p>
<p class="calibre1">BigText data. See  <i class="calibre4">developer and IT pro help</i> for additional information. </p>
<p class="calibre1">To handle text strings in a single data element greater than 250 characters<br>in length, use a combination of BLOB and BigText variables. </p>
<p class="calibre1"><b class="calibre3">[ 142 ]</b></p>
<p class="calibre1"><a id="calibre_link-82"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">GUID: This is used to assign a unique identifying number to any database object. </p>
<p class="calibre1">A <b class="calibre3">Globally Unique Identifier</b> (<b class="calibre3">GUID</b>) is a 16-byte binary data type that is used for the unique global identification of records, objects, and so on. The GUID is generated by an algorithm that was developed by Microsoft. </p>
<p class="calibre1">TestPage: This is used to store a test page that is a logical representation of a page that does not display a UI. Test pages are used when you’re performing</p>
<p class="calibre1">Business Central application testing using the automated testing facility that is part of Business Central. </p>
<p class="calibre1"><b class="calibre3">Data type usage</b></p>
<p class="calibre1">About 40% of the data types we talked about previously can be used to define the data that’s stored either in tables or in working storage data definitions (that is, in a global or local data definition within an object). Two data types, BLOB and TableFilter, can only be used to define table stored data, not working storage data. About 60% of these data types can only be used for working storage data definitions. </p>
<p class="calibre1">The following list shows which data types can be used for table (persisted) data fields and which ones can be used for working storage (variable) data:</p>
<p class="calibre1"><b class="calibre3">Table data types</b></p>
<p class="calibre1"><b class="calibre3">Working storage data types</b></p>
<p class="calibre1">Action</p>
<p class="calibre1">• BigInteger</p>
<p class="calibre1">BigInteger</p>
<p class="calibre1">• BigText</p>
<p class="calibre1">BLOB</p>
<p class="calibre1">• Boolean</p>
<p class="calibre1">Boolean</p>
<p class="calibre1">• Byte</p>
<p class="calibre1">• Char</p>
<p class="calibre1">• Code</p>
<p class="calibre1">Code</p>
<p class="calibre1">• Codeunit</p>
<p class="calibre1">Date</p>
<p class="calibre1">Date</p>
<p class="calibre1">DateFormula</p>
<p class="calibre1">DateFormula</p>
<p class="calibre1">DateTime</p>
<p class="calibre1">DateTime</p>
<p class="calibre1">• Decimal</p>
<p class="calibre1">Decimal</p>
<p class="calibre1">• Dialog</p>
<p class="calibre1">• DotNet</p>
<p class="calibre1">Duration</p>
<p class="calibre1">Duration</p>
<p class="calibre1"><b class="calibre3">[ 143 ]</b></p>
<p class="calibre1"><a id="calibre_link-460"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">• Enum</p>
<p class="calibre1">• ExecutionMode</p>
<p class="calibre1">Enum</p>
<p class="calibre1">• FieldRef</p>
<p class="calibre1">• File</p>
<p class="calibre1">• GUID</p>
<p class="calibre1">• HttpClient</p>
<p class="calibre1">• HttpContent</p>
<p class="calibre1">GUID</p>
<p class="calibre1">• HttpHeaders</p>
<p class="calibre1">• HttpRequestMessage</p>
<p class="calibre1">• HttpResponseMessage</p>
<p class="calibre1">• InStream</p>
<p class="calibre1">• Integer</p>
<p class="calibre1">• JsonArray</p>
<p class="calibre1">• JsonObject</p>
<p class="calibre1">Integer</p>
<p class="calibre1">• JsonToken</p>
<p class="calibre1">• JsonValue</p>
<p class="calibre1">• KeyRef</p>
<p class="calibre1">• Notification</p>
<p class="calibre1">Media</p>
<p class="calibre1">MediaSet</p>
<p class="calibre1">• Option</p>
<p class="calibre1">• Outstream</p>
<p class="calibre1">Option</p>
<p class="calibre1">• Page</p>
<p class="calibre1">• Query</p>
<p class="calibre1">• Record</p>
<p class="calibre1">• RecordID</p>
<p class="calibre1">RecordID</p>
<p class="calibre1">• RecordRef</p>
<p class="calibre1">• Report</p>
<p class="calibre1">TableFilter</p>
<p class="calibre1">TestPage</p>
<p class="calibre1">Text</p>
<p class="calibre1">Text</p>
<p class="calibre1">TextBuilder</p>
<p class="calibre1">Time</p>
<p class="calibre1">Time</p>
<p class="calibre1">TransactionType</p>
<p class="calibre1">Variant</p>
<p class="calibre1">XMLport</p>
<p class="calibre1"><b class="calibre3">[ 144 ]</b></p>
<p class="calibre1"><a id="calibre_link-83"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1"><b class="calibre3">FieldClass property options</b></p>
<p class="calibre1">Almost all data fields have a FieldClass property. FieldClass has as much effect on the content and usage of a data field as the data type does and, in some instances, more. In the next chapter, we’ll cover most of the field properties, but we’ll discuss the FieldClass property options now. </p>
<p class="calibre1"><b class="calibre3">FieldClass &ndash; Normal</b></p>
<p class="calibre1">When FieldClass is Normal, the field will contain the type of application data that’s typically stored in a table, which is the content we would expect based on the data type and various properties. </p>
<p class="calibre1"><b class="calibre3">FieldClass &ndash; FlowField</b></p>
<p class="calibre1">FlowFields must be dynamically calculated. FlowFields are virtual fields that are stored as metadata; they do not contain data in the conventional sense. FlowField contains the definition of how to calculate (at runtime) the data that the field represents and a place to store the result of that calculation. Generally, the Editable property for FlowField is set to No. </p>
<p class="calibre1">Depending on the CalcFormula method, this could be a value, a reference lookup, or a Boolean value. When the CalcFormula method is Sum, FieldClass connects a data field to a previously defined SumIndexField in the table defined in CalcFormula. FlowField processing speed will be significantly affected by the key configuration of the table being processed. While we must be careful not to define extra keys, having the right keys defined will have a major effect on system performance, and thus on user satisfaction. </p>
<p class="calibre1">A FlowField value is always 0, blank, or false, unless it has been calculated. If FlowField is displayed directly on a page, it is calculated automatically when the page is rendered. </p>
<p class="calibre1">FlowFields are also automatically calculated when they are the subject of predefined filters as part of the properties of a data item in an object (this will be explained in more detail in</p>
<p class="calibre1"><a href="#calibre_link-91">Chapter 5, </a> <i class="calibre4">Pages &ndash; The Interactive Interface</i>, when we talk about reports and <a href="#calibre_link-199">Chapter</a></p>
<p class="calibre1"><a href="#calibre_link-199">8</a>,  <i class="calibre4">Intermediate AL</i>, when we talk about XMLports). In all other cases, FlowField must be forced to calculate using the AL RecordName.CALCFIELDS(FlowField1, </p>
<p class="calibre1">[FlowField2],…) function or by using the SETAUTOCALCFIELDS function. This is also true if the underlying data is changed after the initial display of a page (that is, FlowField must be recalculated to take a data change into account). </p>
<p class="calibre1"><b class="calibre3">[ 145 ]</b></p>
<p class="calibre1"><a id="calibre_link-347"></a><img src="images/000163.png" alt="Image 148" class="calibre2" /></p>
<p class="calibre1"><img src="images/000186.png" alt="Image 149" class="calibre2" /></p>
<p class="calibre1"><img src="images/000209.png" alt="Image 150" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">Because FlowField does not contain actual data, it cannot be used as a<br>field in a key; in other words, we cannot include FlowField as part of a<br>key. Also, we cannot define a FlowField that is based on another</p>
<p class="calibre1">FlowField, except in special circumstances. </p>
<p class="calibre1">When a field has its FieldClass set to FlowField, another directly associated property becomes available&mdash;CalcFormula. CalcFormula is the place where we can define the<br>formula for calculating FlowField. On the CalcFormula property line, there is an ellipsis button. Clicking on that button will bring up the following:</p>
<p class="calibre1">Use  <i class="calibre4">Ctrl</i> +  <i class="calibre4">Spacebar</i> to show the seven FlowField methods:</p>
<p class="calibre1">The seven FlowFields are described in the following table:</p>
<p class="calibre1"><b class="calibre3">FlowField</b></p>
<p class="calibre1"><b class="calibre3">method</b></p>
<p class="calibre1"><b class="calibre3">Field data type Calculated value as it applies to the specified set of</b></p>
<p class="calibre1"><b class="calibre3">data within a specific column (field) in a table</b></p>
<p class="calibre1">Sum</p>
<p class="calibre1">Decimal</p>
<p class="calibre1">The sum total</p>
<p class="calibre1">Average</p>
<p class="calibre1">Decimal</p>
<p class="calibre1">The average value (the sum divided by the row count)</p>
<p class="calibre1">Exist</p>
<p class="calibre1">Boolean</p>
<p class="calibre1">Yes or no / true or false&mdash;does an entry exist? </p>
<p class="calibre1">Count</p>
<p class="calibre1">Integer</p>
<p class="calibre1">The number of entries that exist</p>
<p class="calibre1">Min</p>
<p class="calibre1">Any</p>
<p class="calibre1">The smallest value of any entry</p>
<p class="calibre1">Max</p>
<p class="calibre1">Any</p>
<p class="calibre1">The largest value of any entry</p>
<p class="calibre1">Lookup</p>
<p class="calibre1">Any</p>
<p class="calibre1">The value of the specified entry</p>
<p class="calibre1"><b class="calibre3">[ 146 ]</b></p>
<p class="calibre1"><a id="calibre_link-461"></a><img src="images/000229.png" alt="Image 151" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">The Reverse Sign control allows us to change the displayed sign of the result for the Sum and Average FlowField types only; the underlying data is not changed. If Reverse Sign is used with the FlowField type, Exist, it changes the effective function to  <i class="calibre4">does not exist</i>. </p>
<p class="calibre1">The last, but by no means the least significant, component of the FlowField calculation formula is the Table filter in the where clause:</p>
<p class="calibre1">The left part of the where clause contains a field in the linked table where the right part links to a field in this table, const, or filter. These choices are described in the following table:</p>
<p class="calibre1"><b class="calibre3">Filter type</b></p>
<p class="calibre1"><b class="calibre3">Value</b></p>
<p class="calibre1"><b class="calibre3">Filtering action</b></p>
<p class="calibre1"><b class="calibre3">OnlyMax&mdash;Limit Values&mdash;Filter</b></p>
<p class="calibre1">A constant that<br>will be defined Uses the constant to filter for<br>const<br>in the Value<br>equally valued entries<br>field</p>
<p class="calibre1">A filter that will<br>be spelled out</p>
<p class="calibre1">Applies the filter expression<br>filter<br>as a literal in the from the Value field</p>
<p class="calibre1">Value field</p>
<p class="calibre1">A field from the<br>table within</p>
<p class="calibre1">Uses the contents of the<br>field<br>which the<br>specified field to filter for</p>
<p class="calibre1">False</p>
<p class="calibre1">FlowField exists equally valued entries</p>
<p class="calibre1"><b class="calibre3">[ 147 ]</b></p>
<p class="calibre1"><a id="calibre_link-84"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">If the specified field is a</p>
<p class="calibre1">FlowFilter and the</p>
<p class="calibre1">OnlyMaxLimit parameter is<br>true, then the FlowFilter range<br>will be applied on the basis of<br>only having MaxLimit, that True<br>is, having no bottom limit. This<br>is useful for the date filters for<br>balance sheet data. (For an<br>example, see  <i class="calibre4">Field 31 - Balance</i></p>
<p class="calibre1"> <i class="calibre4">at Date in Table 15 - G/L</i></p>
<p class="calibre1"> <i class="calibre4">Account</i>)</p>
<p class="calibre1">Causes the contents of the<br>specified field to be interpreted<br>as a filter (For an example, see</p>
<p class="calibre1"> <i class="calibre4">Field 31 - Balance at Date in</i></p>
<p class="calibre1">True or false</p>
<p class="calibre1">True</p>
<p class="calibre1"> <i class="calibre4">Table 15-  G/L Account for an</i></p>
<p class="calibre1"> <i class="calibre4">example</i>)</p>
<p class="calibre1"><b class="calibre3">FieldClass &ndash; FlowFilter</b></p>
<p class="calibre1">FlowFilters control the calculation of FlowFields in the table (when the FlowFilters are included in the CalcFormula). FlowFilters do not contain permanent data, but instead contain filters on a per user basis, with the information stored in that user’s instance of the code being executed. A FlowFilter field allows a filter to be entered at a parent record level by the user (for example, G/L Account) and applied (through the use of FlowField formulas, for example) to constrain what child data (for example, G/L entry records) is selected. </p>
<p class="calibre1">FlowFilter allows us to provide flexible data selection functions to users. The user does not need to have a full understanding of the data structure that’s used in apply filtering in intuitive ways to both the primary data table and also to subordinate data. Based on our AL</p>
<p class="calibre1">code design, FlowFilters can be used to apply filtering on multiple tables, whether this be from a subordinate to a parent table. Of course, it is our responsibility as the developers to make good use of this tool. As with many AL capabilities, a good way to learn more is by studying standard code, as designed by the Microsoft developers of Business Central, and then experimenting. </p>
<p class="calibre1"><b class="calibre3">[ 148 ]</b></p>
<p class="calibre1"><a id="calibre_link-358"></a><img src="images/000251.jpg" alt="Image 152" class="calibre2" /></p>
<p class="calibre1"><img src="images/000273.jpg" alt="Image 153" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">A number of good examples on the use of FlowFilters can be found in the Customer (table 18) and Item (table 27) tables. In the Customer table, some of the FlowFields that are using FlowFilters are Balance, Balance (LCY), Net Change, Net Change (LCY), Sales</p>
<p class="calibre1">(LCY), and Profit (LCY), where <b class="calibre3">LCY</b> stands for <b class="calibre3">Local Currency</b>. The Sales (LCY) FlowField FlowFilter usage is shown in the following screenshot:</p>
<p class="calibre1">Similarly constructed FlowFields that use FlowFilters in the Item table include Inventory, Net Invoiced Qty., Net Change, and Purchases (Qty.), as well as others. </p>
<p class="calibre1">Throughout the standard code, there are FlowFilters in most of the master table definitions, which includes date filters and global dimension filters (global dimensions are user-defined codes that facilitate the segregation of accounting data by groupings such as divisions, departments, projects, customer type, and so on). Other FlowFilters that are widely used in the standard code are related to inventory activity such as Location Filter, Lot No. </p>
<p class="calibre1">Filter, Serial No. Filter, and Bin Filter. </p>
<p class="calibre1">The following screenshot shows two fields from the Customer table, both with a data type of Date. The first field in the screenshot is the Last Date Modified field (FieldClass is not defined), while the last field in the screenshot is the Date Filter field (FieldClass of FlowFilter):</p>
<p class="calibre1"><b class="calibre3">[ 149 ]</b></p>
<p class="calibre1"><a id="calibre_link-85"></a><img src="images/000294.png" alt="Image 154" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1"><b class="calibre3">FlowFields and FlowFilter for our application</b></p>
<p class="calibre1">In our application, we have decided to have several FlowFields and FlowFilters in Table 50000 Radio Show. The reason for these fields is to provide instant analysis for individual shows based on the detailed data stored in subordinate tables. In <a href="#calibre_link-38">Chapter 2, </a> <i class="calibre4">Tables</i>, we showed table 50000 with fields 100 through 130 and 1,090, but didn’t provide any information on how those fields should be constructed. Let’s go through that construction process now. Here’s how fields 100 through 130 and 1,090 should look when we open table 50000 in the table designer. If you didn’t add these fields as described in <a href="#calibre_link-38">Chapter 2, </a> <i class="calibre4">Tables</i>, in the  <i class="calibre4">Creating and modifying tables</i> section, do that now:</p>
<p class="calibre1">The following five fields will be used for statistical analysis for each radio show: <b class="calibre3">Field 100&mdash;Average Listeners</b>: The average number of listeners, as reported by the ratings agency</p>
<p class="calibre1"><b class="calibre3">Field 110&mdash;Audience Share</b>: The percentage of the station’s total estimated listening audience per time slot</p>
<p class="calibre1"><b class="calibre3">Field 120&mdash;Advertising Revenue</b>: The sum total of the advertising revenue<br>generated by show</p>
<p class="calibre1"><b class="calibre3">[ 150 ]</b></p>
<p class="calibre1"><a id="calibre_link-462"></a><img src="images/000316.png" alt="Image 155" class="calibre2" /></p>
<p class="calibre1"><img src="images/000337.jpg" alt="Image 156" class="calibre2" /></p>
<p class="calibre1"><img src="images/000357.jpg" alt="Image 157" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1"><b class="calibre3">Field 130&mdash;Royalty Cost</b>: The sum total of the royalties incurred by the show by playing copyrighted material</p>
<p class="calibre1"><b class="calibre3">Field 1090&mdash;Date Filter</b>: A filter to restrict the data that’s calculated for the preceding four fields</p>
<p class="calibre1">To begin with, we will set the calculation properties for the first FlowField, Average Listeners:</p>
<p class="calibre1">Set the Editable property to No. </p>
<p class="calibre1">The following fields will be used for statistical analysis:</p>
<p class="calibre1">For field 110, Audience Share, repeat the procedure we just went through, but<br>for field, select Audience Share from the Listenership Entry field list. Our<br>result should be as follows:</p>
<p class="calibre1">For fields 120&mdash;Advertising Revenue and 130&mdash;Royalty Cost, the</p>
<p class="calibre1">FlowField calculation is a sum with multiple fields that have filters applied. </p>
<p class="calibre1"><b class="calibre3">[ 151 ]</b></p>
<p class="calibre1"><a id="calibre_link-348"></a><img src="images/000378.png" alt="Image 158" class="calibre2" /></p>
<p class="calibre1"><img src="images/000399.jpg" alt="Image 159" class="calibre2" /></p>
<p class="calibre1"><img src="images/000421.png" alt="Image 160" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">For Advertising Revenue, make the method Sum; for table enter, Radio Show</p>
<p class="calibre1">Ledger; and set field to Fee Amount:</p>
<p class="calibre1">Advertisement is an available value of the DataFormat field (data type<br>option). If, in the Radio Show entry, we had typed a value that was not an</p>
<p class="calibre1">Option value, such as Commercial, an error message would have displayed, </p>
<p class="calibre1">showing us what the available Option choices are:</p>
<p class="calibre1">We can use this feature as a development aid when we don’t remember<br>what the option values are. We can enter a known incorrect value (such as<br>xxx), press  <i class="calibre4">F11</i> to compile, and find out all of the correct option values. </p>
<p class="calibre1">Let’s start with the compilation:</p>
<p class="calibre1">1. Click <b class="calibre3">OK</b> on the <b class="calibre3">Table Filter</b> form and <b class="calibre3">OK</b> again on the <b class="calibre3">Calculation Formula</b> form. </p>
<p class="calibre1">2. Start Royalty Cost in the same way (<b class="calibre3">method</b> is Sum), all of the way through the table (table 50005) and <b class="calibre3">Field</b> choices in the <b class="calibre3">Calculation Formula</b> form. Click on the <b class="calibre3">Assist Edit</b> button for the table filter. Just like we did previously, fill in the first <b class="calibre3">Field</b> row with a value of <b class="calibre3">Date</b>, the <b class="calibre3">Type</b> with <b class="calibre3">FIELD</b>, and the <b class="calibre3">Value</b> with <b class="calibre3">Date Filter</b>. </p>
<p class="calibre1"><b class="calibre3">[ 152 ]</b></p>
<p class="calibre1"><a id="calibre_link-86"></a><img src="images/000443.png" alt="Image 161" class="calibre2" /></p>
<p class="calibre1"><img src="images/000007.png" alt="Image 162" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">3. Fill in the second row by setting <b class="calibre3">Field</b> to Format and <b class="calibre3">Type</b> to <b class="calibre3">FILTER</b>. In the <b class="calibre3">Value</b> column, enter Vinyl|CD|MP3. This means that we will filter for all of the records where the <b class="calibre3">Format</b> field contains a value equal to Vinyl, CD, or MP3 (the pipe symbol is translated to the Boolean <b class="calibre3">OR</b>). As a result, this FlowField will sum up all of the Fee Amount values that have a <b class="calibre3">Format</b> option selected as Vinyl, CD, or MP3, and a date satisfying the <b class="calibre3">Date Filter</b> that’s specified in the Radio Show table:</p>
<p class="calibre1">4. The last field we will define in this exercise is the Date Filter field. We have already been referencing this Radio Show table field as a source of a user-defined date selection to help to analyze the data for listenership, payable, and revenue, but we haven’t defined the field yet. This one is much easier than</p>
<p class="calibre1">FlowFields because no calculation formula is required:</p>
<p class="calibre1"><b class="calibre3">Filtering</b></p>
<p class="calibre1">Filtering is one of the most powerful tools within Business Central. Filtering is the application of defined limits on the data that is to be considered in a process. When we apply a filter to a Normal data field, we only view or process records where the filtered data field satisfies the limits defined by the filter. When we apply a filter to FlowField, the calculated value for that field will only consider data that satisfies the limits defined by the filter. </p>
<p class="calibre1">Filter structures can be applied in at least three different ways, depending on the design of the process:</p>
<p class="calibre1">The first way is for the developer to fully define the filter structure and the value of the filter. This might be done in a report that’s designed to show information on only a selected group of customers, such as those with an unpaid balance. The Customer table would be filtered to report only on customers who have an<br>outstanding balance greater than zero. </p>
<p class="calibre1"><b class="calibre3">[ 153 ]</b></p>
<p class="calibre1"><a id="calibre_link-87"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">The second way is for the developer to define the filter structure, but allow the user to fill in the specific value to be applied. This approach would be<br>appropriate in an accounting report that has to be tied to specific accounting<br>periods. The user would be allowed to define what periods are to be considered<br>for each report run. </p>
<p class="calibre1">The third way is the ad hoc definition of a filter structure and value by the user. </p>
<p class="calibre1">This approach is often used for the general analysis of ledger data, where the<br>developer wants to give the user total flexibility in how they slice and dice the available data. </p>
<p class="calibre1">It is common to use a combination of the different filtering types. For example, the report we previously mentioned that lists only customers with an open balance (via a developer-defined filter) could also allow the user to define additional filter criteria. If the user wants to see only euro currency customers, they would filter on the customer currency code field. </p>
<p class="calibre1">Filters are an integral part of the implementation of both FlowFields and FlowFilters. These flexible, powerful tools allow the Business Central designer to create pages, reports, and other processes that can be used under a wide variety of circumstances. In most<br>competitive systems, standard user inquiries and processes are quite specific. The Business Central AL toolset allows us to have relatively generic user inquiries and processes, and then allows the user to apply filtering to generate results that fit their specific needs. </p>
<p class="calibre1">The user will see FlowFilter filtering referred to as filter totals by onscreen. The application of filters and ranges may give varying results, depending on Windows settings or the SQL Server collation setup. A good set of examples of filtering options and syntax can be found in the  <i class="calibre4">developer and IT pro help</i> in the section titled  <i class="calibre4">Entering criteria in filters</i>. </p>
<p class="calibre1"><b class="calibre3">Experimenting with filters</b></p>
<p class="calibre1">Now, it’s time to do some experimenting with filters. We want to accomplish a couple of things through our experimentation. First, we want to get more comfortable with how filters are entered; and second, we want to see the effects of different types of filter structures and combinations. If we had a database with a large volume of data, we could also test the speed of filtering on fields in keys and on fields not in keys. However, the amount of data in the basic CRONUS database is small, so any speed differences will be difficult to see in these tests. </p>
<p class="calibre1"><b class="calibre3">[ 154 ]</b></p>
<p class="calibre1"><a id="calibre_link-463"></a><img src="images/000027.png" alt="Image 163" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">We could experiment on any report that allows filtering. A good report for this<br>experimentation is the <b class="calibre3">Customer/Item</b> list. This reports which customer purchased what items. The <b class="calibre3">Customer/Item</b> list can be accessed on the role tailored client <b class="calibre3">Actions</b> menu via <b class="calibre3">Reports</b> | <b class="calibre3">Customer</b> | <b class="calibre3">Customer/Item Sales</b>. </p>
<p class="calibre1">When we initially run <b class="calibre3">Customer/Item Sales</b>, we will see just three data fields listed for the entry of filters on the Customer table and the Value Entry table, as shown in the following screenshot:</p>
<p class="calibre1">For both <b class="calibre3">Customer</b> and <b class="calibre3">Value Entry</b>, these are the fields that the developer of this report determined should be emphasized. If we run the report without entering any filter constraints at all and just use the standard Cronus data, the first page of the report will resemble the following:</p>
<p class="calibre1"><b class="calibre3">[ 155 ]</b></p>
<p class="calibre1"><a id="calibre_link-464"></a><img src="images/000049.png" alt="Image 164" class="calibre2" /></p>
<p class="calibre1"><img src="images/000068.png" alt="Image 165" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">If we want to print information only for customers whose names begin with the letter A, our filter will be very simple and similar to the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 156 ]</b></p>
<p class="calibre1"><a id="calibre_link-342"></a><img src="images/000091.png" alt="Image 166" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">The resulting report will be similar to the following screenshot, showing only the data for the two customers on file whose names begin with the letter A:</p>
<p class="calibre1"><b class="calibre3">[ 157 ]</b></p>
<p class="calibre1"><a id="calibre_link-465"></a><img src="images/000111.png" alt="Image 167" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">If we want to expand the customer fields so that we can apply filters, we can access the full list of other fields in the customer table. We can either click on the drop-down symbol next to a filter field that is not already in use or click on the <b class="calibre3">Add Filter</b> button to add a new filter field with drop-down list access. Notice that the lists are in alphabetical order, based on their field names:</p>
<p class="calibre1"><b class="calibre3">[ 158 ]</b></p>
<p class="calibre1"><a id="calibre_link-343"></a><img src="images/000134.png" alt="Image 168" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">From these lists, we can choose one or more fields and then enter filters on those fields. If we chose <b class="calibre3">Territory Code</b>, for example, then the request page would look similar to what’s shown in the following screenshot. If we clicked on the lookup arrow in the <b class="calibre3">Filter</b> column, a screen would pop up, allowing us to choose from data items in the related table, which, in this case, is <b class="calibre3">Territories</b>:</p>
<p class="calibre1">This particular request page has FastTabs for each of the two primary tables in the report. </p>
<p class="calibre1">Click on the <b class="calibre3">Value Entry</b> FastTab to filter on the item related data. If we filter on the <b class="calibre3">Item</b> <b class="calibre3">No. </b> for item numbers that contain the letter W, the report will look similar to the following:</p>
<p class="calibre1"><b class="calibre3">[ 159 ]</b></p>
<p class="calibre1"><a id="calibre_link-344"></a><img src="images/000156.png" alt="Image 169" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">If we want to see all of the items containing either the letter W or the letter S, our filter would be *W* | *S*. If we made the filter, W | S, then we would only get entries that are exactly equal to W or to S because we didn’t include any wildcards. </p>
<p class="calibre1">You should go back over the various types of filters we discussed and try each one and try them in combination. Get creative! Try some things that you’re not sure will work and see what happens. Explore a variety of reports or list pages in the system by applying filters to see the results of your experiments. A good page to apply filters on is the customer list (<b class="calibre3">Sales</b> | <b class="calibre3">Customers</b>). This filtering experimentation process is safe (you can’t hurt anything or anyone) and is a great learning experience. </p>
<p class="calibre1"><b class="calibre3">[ 160 ]</b></p>
<p class="calibre1"><a id="calibre_link-88"></a><img src="images/000178.png" alt="Image 170" class="calibre2" /></p>
<p class="calibre1"><img src="images/000200.png" alt="Image 171" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1"><b class="calibre3">Accessing filter controls</b></p>
<p class="calibre1">When a page such as the customer list is opened, the filter section at the top of the page looks as follows. On the upper-left corner is a place to enter multiple-field filters. This is called <b class="calibre3">Search</b>, but the result will be a multi-column filter:</p>
<p class="calibre1">If we click on the <b class="calibre3">All</b> button with the chevron button in the upper-left corner to expand the <b class="calibre3">Filter</b> pane, the result will look similar to the following. This filter display includes an additional filtering capability, <b class="calibre3">Filter list by:</b>, which allows for the entry of filters for the filter totals by type:</p>
<p class="calibre1"><b class="calibre3">[ 161 ]</b></p>
<p class="calibre1"><a id="calibre_link-89"></a><img src="images/000223.png" alt="Image 172" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">If we apply a filter, the traditional filter icon will appear on the column with a filter, as shown in the following screenshot:</p>
<p class="calibre1">If we click on the filter icon, we can clear the filter. We can also select <b class="calibre3">Filter to This Value</b>, which will add a filter with the value of the currently selected row. </p>
<p class="calibre1"><b class="calibre3">Summary</b></p>
<p class="calibre1">In this chapter, we focused on the basic building blocks of Business Central data structure: fields and their attributes. We reviewed the types of data fields, properties, and trigger elements for each type of field. We walked through a number of examples to illustrate most of these elements, though we have postponed exploring triggers until later, when we have more knowledge of AL. We covered data type and FieldClass properties, which<br>determine what kind of data can be stored in a field. </p>
<p class="calibre1"><b class="calibre3">[ 162 ]</b></p>
<p class="calibre1"><a id="calibre_link-90"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">We reviewed and experimented with the date calculation tool, which gives AL an edge in business applications. We discussed filtering, how filtering is considered as we design our database structure, and how users will access data. Finally, more of our Business Central Radio Show application was constructed. </p>
<p class="calibre1">In the next chapter, we will look at the many different types of pages in more detail. We’ll put some of that knowledge to use to further expand our example Business Central application. </p>
<p class="calibre1"><b class="calibre3">Questions</b></p>
<p class="calibre1">1. The maximum length for an AL field name or variable name is 250 characters<br>long. True or false? </p>
<p class="calibre1">2. The table relation property defines the reference of a data field to a table. The related table data field must be one of the following:</p>
<p class="calibre1">In any key in the related table</p>
<p class="calibre1">Defined in the related table, but not in a key</p>
<p class="calibre1">In the primary key in the related table</p>
<p class="calibre1">The first field in the primary key in the related table</p>
<p class="calibre1">3. How many of the following field data types support storing application data<br>such as names and amounts&mdash;1, 2, 3, or 4? </p>
<p class="calibre1">FlowFilter</p>
<p class="calibre1">Editable</p>
<p class="calibre1">Normal</p>
<p class="calibre1">FlowField</p>
<p class="calibre1">4. The ExtendedDataType property supports the designation of all but one of the<br>following data types for displaying an appropriate action icon (choose the one<br>that isn’t supported):</p>
<p class="calibre1">Email address</p>
<p class="calibre1">Website URL</p>
<p class="calibre1">GPS location</p>
<p class="calibre1">Telephone number</p>
<p class="calibre1">Masked entry</p>
<p class="calibre1"><b class="calibre3">[ 163 ]</b></p>
<p class="calibre1"><a id="calibre_link-466"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">5. One of the following is not a FlowField method (choose one):</p>
<p class="calibre1">Median</p>
<p class="calibre1">Count</p>
<p class="calibre1">Max</p>
<p class="calibre1">Exist</p>
<p class="calibre1">Average</p>
<p class="calibre1">6. It is important to have a consistent, well planned approach to field numbers, especially if the application will use the TransferFields function. True or<br>false? </p>
<p class="calibre1">7. Field filters and limit totals cannot be used at the same time. True or false? </p>
<p class="calibre1">8. Which property is used to support the multi-language feature of Business Central (choose one)? </p>
<p class="calibre1">Name</p>
<p class="calibre1">CaptionML</p>
<p class="calibre1">Caption</p>
<p class="calibre1">LanguageRef</p>
<p class="calibre1">9. Which of the following are field triggers (choose two)? </p>
<p class="calibre1">OnEntry</p>
<p class="calibre1">OnValidate</p>
<p class="calibre1">OnDeletion</p>
<p class="calibre1">OnLookup</p>
<p class="calibre1">10. Which of the following are complex data types (choose three)? </p>
<p class="calibre1">Records</p>
<p class="calibre1">Strings of text</p>
<p class="calibre1">DateFormula</p>
<p class="calibre1">DateTime data</p>
<p class="calibre1">Objects</p>
<p class="calibre1"><b class="calibre3">[ 164 ]</b></p>
<p class="calibre1"><a id="calibre_link-467"></a> <i class="calibre4">Data Types and Fields</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 3</i></p>
<p class="calibre1">11. Every table must have a primary key. A primary key entry can be defined as<br>unique or duplicates allowed, based on a table property. True or false? </p>
<p class="calibre1">12. Text and Code variables can be any length:</p>
<p class="calibre1">In a memory variable (working storage)&mdash;true or false? </p>
<p class="calibre1">In a table field&mdash;true or false? </p>
<p class="calibre1">13. FlowField results are not stored in the Business Central table data. True or false? </p>
<p class="calibre1">14. The following two filters are equivalent. True or false? </p>
<p class="calibre1">(*W50?|I?5|D*)</p>
<p class="calibre1">(I?5) OR (D*) OR (*W50?)</p>
<p class="calibre1">15. Limit totals apply to FlowFilters. True or false? </p>
<p class="calibre1">16. All data types can be used to define data both in tables and in working storage. </p>
<p class="calibre1">True or false? </p>
<p class="calibre1">17. DateFormula alpha time units include which of the following (choose two):</p>
<p class="calibre1"> <i class="calibre4">C</i> for century</p>
<p class="calibre1"> <i class="calibre4">W</i> for week</p>
<p class="calibre1"> <i class="calibre4">H</i> for holiday</p>
<p class="calibre1"> <i class="calibre4">CM</i> for current month</p>
<p class="calibre1">18. FlowFilter data is stored in the database. True or false? </p>
<p class="calibre1">19. Option data is stored as alpha data strings. True or false? </p>
<p class="calibre1">20. Which of the following are numeric data types in Business Central (choose two)? </p>
<p class="calibre1">Decimal</p>
<p class="calibre1">Option</p>
<p class="calibre1">Hexadecimal</p>
<p class="calibre1">BLOB</p>
<p class="calibre1">21. Which of the following act as wildcards in Business Central (choose two)? </p>
<p class="calibre1">Decimal point (.)</p>
<p class="calibre1">Question mark (?)</p>
<p class="calibre1">Asterisk (*)</p>
<p class="calibre1">Hash mark (#)</p>
<p class="calibre1"><b class="calibre3">[ 165 ]</b></p>
<p class="calibre1"><a id="calibre_link-91"></a>4</p>
<p class="calibre1">Pages - The Interactive</p>
<p class="calibre1">Interface</p>
<p class="calibre1"> <i class="calibre4">“Design is not just what it looks like and feels like. Design is how it works.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Steve Jobs</i></p>
<p class="calibre1"> <i class="calibre4">“True interactivity is not about clicking on icons or downloading files, it’s about</i> <i class="calibre4">encouraging communication.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Ed Scholssberg</i></p>
<p class="calibre1">Pages are Business Central’s object type for interactively presenting information. The page rendering routines that paint the page on the target display handle much of the data presentation details. This allows a variety of clients to be created by Microsoft, such as a web browser resident client, the Windows RTC client, and a universal client that can be used on all devices, such as phones, tablets, and other platforms (iPad, Android, and Windows). <b class="calibre3">Independent Software Vendors</b> (<b class="calibre3">ISVs</b>) have created mobile clients and even clients targeted by devices other than video displays. </p>
<p class="calibre1">One of the benefits of page technology is the focus on the user experience rather than the underlying data structure. As always, the designer/developer has the responsibility of using the tools to their best effect. Another advantage of Business Central pages is the flexibility they provide the user for personalization, allowing them to tailor what is displayed and how it is organized. </p>
<p class="calibre1">In this chapter, we will explore the various types of pages offered by Business Central. We will review many options for format, data access, and tailoring pages. We will also learn about the page designer tools and the inner structures of pages. </p>
<p class="calibre1"><a id="calibre_link-92"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">We will cover the following topics:</p>
<p class="calibre1">Page design and structure overview</p>
<p class="calibre1">Types of pages</p>
<p class="calibre1">Page designer</p>
<p class="calibre1">Page components</p>
<p class="calibre1">Page controls</p>
<p class="calibre1">Page actions</p>
<p class="calibre1">WDTU page enhancement exercises</p>
<p class="calibre1"><b class="calibre3">Page design and structure overview</b></p>
<p class="calibre1">Pages serve the purpose of input, output, and control. They are views of data or process information designed for onscreen display only. They are also user data entry vehicles. </p>
<p class="calibre1">Pages are made up of various combinations of controls, properties, actions, triggers, and AL</p>
<p class="calibre1">code, which are briefly explained here:</p>
<p class="calibre1"><b class="calibre3">Controls</b>: These provide the users with ways to view, enter, and edit data; choose options or commands; initiate actions; and view status. </p>
<p class="calibre1"><b class="calibre3">Properties</b>: These are attributes or characteristics of an object that define its state, appearance, or value. </p>
<p class="calibre1"><b class="calibre3">Actions</b>: These are menu items that may be icons. </p>
<p class="calibre1"><b class="calibre3">Triggers</b>: These are predefined functions that are executed when certain actions or events occur. </p>
<p class="calibre1">The internal structure of a page maps to a tree structure, some of which is readily visible in the page designer display while the rest is in the background. </p>
<p class="calibre1"><b class="calibre3">Page design guidelines</b></p>
<p class="calibre1">Good design practice dictates that enhancements integrate seamlessly with the existing software, unless there is an overwhelming justification for being different. When we add new pages or change existing pages, the changes should have the same look and feel as the original pages, unless the new functionality requires significant differences. This consistency not only makes the user’s life easier, it makes support, maintenance, and training more efficient. </p>
<p class="calibre1"><b class="calibre3">[ 167 ]</b></p>
<p class="calibre1"><a id="calibre_link-93"></a><img src="images/000243.jpg" alt="Image 173" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">There will be instances where we will need to create a significantly different page layout in order to address a special requirement. Maybe we will need to use industry-specific symbols, or we will need to create a screen layout for a special display device. Perhaps, we will create a special dashboard display to report the status of work queues. Even when it will be different, we should continue to be guided by the environment and context in which our new work will operate. </p>
<p class="calibre1"><b class="calibre3">Business Central page structure</b></p>
<p class="calibre1">Let’s take a look at what makes up a typical page in the Business Central web client. The page in the following screenshot includes a list page at its core (the content area):</p>
<p class="calibre1"><b class="calibre3">[ 168 ]</b></p>
<p class="calibre1"><a id="calibre_link-333"></a><img src="images/000266.png" alt="Image 174" class="calibre2" /></p>
<p class="calibre1"><img src="images/000288.png" alt="Image 175" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Here is a brief description of all of these options:</p>
<p class="calibre1">The title bar (<b class="calibre3">1</b>) displays page caption and product identification. </p>
<p class="calibre1">The company indicator (<b class="calibre3">2</b>) acts as a home button. It allows the user to navigate to the Role Center or to refresh the Role Center depending on where the user is at<br>the moment of using the link:</p>
<p class="calibre1">The filter button is where the user controls the filtering to be applied to the page display. </p>
<p class="calibre1">If we click on the down-facing arrowheads in the filter button, child menu<br>options will be displayed in a drop-down list, as shown in the following<br>screenshot. The same list of options subordinate to <b class="calibre3">Sales Orders</b> is displayed both in the drop-down menu from the filter button and in the detailed list of<br>options in the navigation pane:</p>
<p class="calibre1"><b class="calibre3">[ 169 ]</b></p>
<p class="calibre1"><a id="calibre_link-334"></a><img src="images/000310.png" alt="Image 176" class="calibre2" /></p>
<p class="calibre1"><img src="images/000330.png" alt="Image 177" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The search field (<b class="calibre3">4</b>) allows users to find pages, reports, or views based on the object’s name (full or partial):</p>
<p class="calibre1">The settings button (<b class="calibre3">5</b>) provides access to a general set of menu options. It provides access to some basic application information and administration<br>functions, as shown in the following screenshot:</p>
<p class="calibre1">The ribbon (<b class="calibre3">6</b>) contains shortcut icons to actions. These same commands will be duplicated in other menu locations, but are in the ribbon for quick and easy<br>access. The ribbon can be collapsed (made not visible) or expanded (made<br>visible) under user control. </p>
<p class="calibre1"><b class="calibre3">[ 170 ]</b></p>
<p class="calibre1"><a id="calibre_link-94"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The navigation pane (<b class="calibre3">7</b>) contains menu options based on the active Role Center, which is tied to the user’s login. </p>
<p class="calibre1">The content area (<b class="calibre3">8</b>) is the focus of the page. It may be a Role Center, a list page, or a department menu list. </p>
<p class="calibre1">The FactBox pane (<b class="calibre3">9</b>) can appear on the right side of certain page types, such as card, list, List Plus, document, navigate, or worksheet. A FactBox can only<br>display a Card Part, list part, system part, or a limited set of predefined charts. </p>
<p class="calibre1">FactBoxes can provide no-click and one-click access to related information about the relevant data in the content area. </p>
<p class="calibre1"><b class="calibre3">Types of pages</b></p>
<p class="calibre1">Let’s review the types of pages available for use in an application. Then, we will create several examples for our WDTU Radio Station system. </p>
<p class="calibre1">Each time we work on an application design, we will carefully need to consider which page type is best to use for the functionality we are creating. Types of pages available include Role Center, HeadlinePart, list, card, List Part, Card Part, List Plus, document, worksheet, navigate page, ConfirmationDialog, and StandardDialog. Pages can be created and<br>modified by the developer and can be personalized by the administrator, superuser, or user. </p>
<p class="calibre1"><b class="calibre3">Role Center page</b></p>
<p class="calibre1">Users are each assigned a Role Center page as their home page in Business Central&mdash;the page where they land when first logging into Business Central. The purpose of a Role Center page is to provide a task-oriented home base that focuses on the tasks that the user typically needs in order to do his/her job on a day-to-day basis. Common tasks for any user should be no more than one or two clicks away. </p>
<p class="calibre1">The standard Business Central distribution includes predefined Role Center pages, including generic roles such as the bookkeeper, sales manager, and production planner. </p>
<p class="calibre1">Some of the provided Role Centers are richly featured and have been heavily tailored by Microsoft as illustrations of what is possible. On the other hand, some of the provided Role Centers are only skeletons, acting essentially as placeholders. </p>
<p class="calibre1"><b class="calibre3">[ 171 ]</b></p>
<p class="calibre1"><a id="calibre_link-468"></a><img src="images/000349.png" alt="Image 178" class="calibre2" /></p>
<p class="calibre1"><img src="images/000371.png" alt="Image 179" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">It is critical to understand that the provided Role Center pages are<br>intended to be templates, not final deliverables. </p>
<p class="calibre1">Central to each Role Center page is the activities area. The activities area provides the user with a visual overview of their primary tasks. Within the activities area are the cues. Each blue cue icon (containing a document symbol) represents a filtered list of documents in a particular status, indicating an amount of work to be handled by the user. The grey cue icons (with no document symbol) display a calculated value. </p>
<p class="calibre1">The following screenshot shows a Role Center page for the user role profile of a sales order processor:</p>
<p class="calibre1"><b class="calibre3">[ 172 ]</b></p>
<p class="calibre1"><a id="calibre_link-95"></a><img src="images/000392.jpg" alt="Image 180" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">HeadlinePart page</b></p>
<p class="calibre1">HeadlinePart pages are embedded in the Role Center similar to activities. The part is designed to give the user insight into how the company is performing using the most important <b class="calibre3">Key Performance Indicators</b> (<b class="calibre3">KPIs</b>). As an option, machine learning can be used to provide predictive analytics:</p>
<p class="calibre1"><b class="calibre3">List page</b></p>
<p class="calibre1">List pages are the first pages accessed when choosing any menu option to access data. This includes all of the entries under the buttons on the navigation pane. A list page displays a list of records (rows), one line per record, with each displayed data field in a column. </p>
<p class="calibre1">When a list page is initially selected, it is not editable. When we click on the vertical dots an entry in a list, either an editable card page or an editable list page entry is displayed. </p>
<p class="calibre1">Examples of this latter behavior are the reference table pages, such as <b class="calibre3">postcodes</b>, <b class="calibre3">territories</b>, and <b class="calibre3">languages</b>. A list page can also be used to show a list of master records to allow the user to visually scan through the list of records or to easily choose a record on which to focus. </p>
<p class="calibre1"><b class="calibre3">[ 173 ]</b></p>
<p class="calibre1"><a id="calibre_link-469"></a><img src="images/000414.jpg" alt="Image 181" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">List pages may optionally include FactBoxes. Some Business Central list pages, such as customer ledger entries, allow editing of some fields (for example, invoice due dates) and not of other fields. </p>
<p class="calibre1">The following screenshot shows a typical list page&mdash;the <b class="calibre3">Items</b> list page:</p>
<p class="calibre1"><b class="calibre3">[ 174 ]</b></p>
<p class="calibre1"><a id="calibre_link-96"></a><img src="images/000436.jpg" alt="Image 182" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Card page</b></p>
<p class="calibre1">Card pages display and allow updating of a single record at a time. Card pages are used for master tables and setup data. Complex cards can contain multiple FastTabs and FactBoxes, as well as display data from subordinate tables. For example, a card page image for the <b class="calibre3">Customer Card</b>, page 21, follows with the <b class="calibre3">General</b> and <b class="calibre3">Shipping</b> FastTab expanded and the other FastTabs (<b class="calibre3">Address &amp; Contact</b>, <b class="calibre3">Invoicing</b>, and <b class="calibre3">Payments</b>) collapsed: <b class="calibre3">Document page</b></p>
<p class="calibre1">Document (task) pages have at least two FastTabs in a header/detail format. The FastTab at the top contains the header fields in a card style format, followed by a FastTab containing multiple records in a list style format (a List Part page). Some examples are <b class="calibre3">Sales Orders</b>, <b class="calibre3">Sales Invoices</b>, <b class="calibre3">Purchase Orders</b>, <b class="calibre3">Purchase Invoices</b>, and <b class="calibre3">Production Orders</b>. The document page type is appropriate whenever we have a parent record tied to subordinate child records in a one-to-many relationship. A document page may also have FactBoxes. An example, the <b class="calibre3">SALES ORDER</b> document page follows with two FastTabs expanded and four FastTabs collapsed:</p>
<p class="calibre1"><b class="calibre3">[ 175 ]</b></p>
<p class="calibre1"><a id="calibre_link-97"></a><img src="images/000001.jpg" alt="Image 183" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">FastTabs</b></p>
<p class="calibre1">FastTabs, as shown in the preceding <b class="calibre3">CUSTOMER CARD</b> and <b class="calibre3">SALES ORDER</b> screenshots, are collapsible/expandable replacements for traditional left-to-right form tabs. FastTabs are often used to segregate data by subject area on a card page or a document page. In the preceding screenshot, the <b class="calibre3">General</b> and <b class="calibre3">Lines</b> FastTabs are expanded and the remaining FastTabs are collapsed. Individually-important fields can be promoted so that they display on the FastTab header when the tab is collapsed, allowing the user to see this data with minimal effort. Examples appear on the <b class="calibre3">Sales Orders</b> collapsed <b class="calibre3">Invoice Details</b> and <b class="calibre3">Prepayment</b> FastTabs. Promoted field displays disappear from the FastTab header when the FastTab is expanded. </p>
<p class="calibre1"><b class="calibre3">[ 176 ]</b></p>
<p class="calibre1"><a id="calibre_link-98"></a><img src="images/000021.jpg" alt="Image 184" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">List Plus page</b></p>
<p class="calibre1">A List Plus page is similar in layout to a document page as it will have at least one FastTab with fields in a card type format and one FastTab with a list page format. Unlike a document page, a List Plus page may have more than one FastTab with card format fields and one or more FastTabs with a list page format, while a document page can only have a single list style subpage. The card format portion of a List Plus page often contains control information determining what data is displayed in the associated list, such as in page 113, <b class="calibre3">BUDGET</b>, which is shown in the following screenshot:</p>
<p class="calibre1">A List Plus page may also have FactBoxes. Other examples of List Plus pages are page 155, <b class="calibre3">Customer Sales</b>, and page 157, <b class="calibre3">Item Availability by Periods</b>. </p>
<p class="calibre1"><b class="calibre3">[ 177 ]</b></p>
<p class="calibre1"><a id="calibre_link-99"></a><img src="images/000043.jpg" alt="Image 185" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Worksheet (journal) page</b></p>
<p class="calibre1"><b class="calibre3">Worksheet</b> pages are widely used in Business Central to enter transactions. The worksheet page format consists of a List page style section showing multiple record lines in the content area, followed by a section containing either additional detail fields for the line in focus or containing totals. All of the journals in Business Central use worksheet pages. Data is usually entered into a journal/worksheet by keyboard entry, but in some cases via a batch process. </p>
<p class="calibre1">The following screenshot shows a worksheet page, <b class="calibre3">Sales Journals</b>&mdash;page 253:</p>
<p class="calibre1"><b class="calibre3">[ 178 ]</b></p>
<p class="calibre1"><a id="calibre_link-100"></a><img src="images/000063.png" alt="Image 186" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">ConfirmationDialog page</b></p>
<p class="calibre1">This is a simple display page embedded in a process. It is used to allow a user to control the flow of a process. A sample ConfirmationDialog page is shown in the following screenshot: <b class="calibre3">StandardDialog page</b></p>
<p class="calibre1">The StandardDialog page is also a simple page format to allow the user to control a process, such as <b class="calibre3">Copy Tax Setup</b> (page 476). The StandardDialog page allows the entry of control data, such as that shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 179 ]</b></p>
<p class="calibre1"><a id="calibre_link-101"></a><img src="images/000085.png" alt="Image 187" class="calibre2" /></p>
<p class="calibre1"><img src="images/000106.png" alt="Image 188" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Navigate page</b></p>
<p class="calibre1">The primary use of the <b class="calibre3">navigate</b> page type in Business Central is as the basis for some wizard pages. With Business Central, Microsoft introduced a new application feature called <b class="calibre3">Assisted Setup</b>. This feature uses many wizard pages. A wizard page consists of multiple user data entry screens linked together to provide a series of steps necessary to complete a task. The following screenshot shows assisted email setup:</p>
<p class="calibre1"><b class="calibre3">[ 180 ]</b></p>
<p class="calibre1"><a id="calibre_link-102"></a><img src="images/000127.png" alt="Image 189" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Navigate function</b></p>
<p class="calibre1">The <b class="calibre3">navigate function</b> has been a very powerful and unique feature of Business Central since the 1990s. Somewhat confusingly, in Business Central, the navigate function is implemented using the worksheet page type, not the navigate page type, which was used in earlier Business Central releases. </p>
<p class="calibre1">The navigate page (page 344) allows the user, who may be a developer operating in user mode, to view a summary of the number and type of posted entries having the same document number and posting date as a related entry or as a user-entered value. The user can drill down to examine the individual entries. Navigate is a terrific tool for tracking down related posted entries. It can be productively used by a user, an auditor, or even a developer. A sample <b class="calibre3">NAVIGATE</b> page is shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 181 ]</b></p>
<p class="calibre1"><a id="calibre_link-103"></a><img src="images/000150.png" alt="Image 190" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Request page</b></p>
<p class="calibre1">A <b class="calibre3">request page</b> is a simple page that allows the user to enter information to control the execution of a report or XMLport object. Request pages can have multiple FastTabs, but can only be created as part of a report or XMLport object. All request page designs will be similar to the following screenshot for the Item <b class="calibre3">PRICE LIST</b> (report 715) request page: <b class="calibre3">Page parts</b></p>
<p class="calibre1">Several of the page types we have reviewed so far contain multiple panes, with each pane including special purpose parts. Let’s look at some of the component page parts available to the developer. </p>
<p class="calibre1"><b class="calibre3">[ 182 ]</b></p>
<p class="calibre1"><a id="calibre_link-104"></a><img src="images/000194.png" alt="Image 191" class="calibre2" /></p>
<p class="calibre1"><img src="images/000217.png" alt="Image 192" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Some page parts compute the displayed data on the fly, taking advantage<br>of <b class="calibre3">FlowFields</b> that may require considerable system resources to process<br>the FlowField calculations. As developers, we must be careful about<br>causing performance problems through overuse of such displays. </p>
<p class="calibre1"><b class="calibre3">FactBox area</b></p>
<p class="calibre1">The <b class="calibre3">FactBox</b> area can be defined on the right side of certain page types, including card, list, List Plus, document, and worksheet. A FactBox area can contain page parts (Card Part or List Part), chart parts, and system parts (notes, MyNotes, or record links). A variety of standard Card Parts, List Parts, and charts that can be used in FactBoxes are available. </p>
<p class="calibre1">System parts cannot be modified. All of the others can be enhanced from the standard instances, or new ones may be created from scratch. </p>
<p class="calibre1"><b class="calibre3">Card Parts and List Parts</b></p>
<p class="calibre1">Card Parts are used for FactBoxes that don’t require a list. Card Parts display fields or perhaps a picture control. (Business Central Help contains an example of including a .NET</p>
<p class="calibre1">add-in within a FactBox to display a chart). An example of the <b class="calibre3">Customer Statistics</b> FactBox (page 9,082&mdash;<b class="calibre3">Customer Statistics</b> Factbox) is shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 183 ]</b></p>
<p class="calibre1"><a id="calibre_link-105"></a><img src="images/000237.png" alt="Image 193" class="calibre2" /></p>
<p class="calibre1"><img src="images/000260.png" alt="Image 194" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">List Parts are used for FactBoxes that require a list. A list is defined as columns of repeated data. No more than two or three columns should appear in a FactBox list. The following screenshot shows the three column <b class="calibre3">My Items</b> FactBox List Part (page 9,152): <b class="calibre3">Charts</b></p>
<p class="calibre1">The Business Central distribution includes a charting capability that is based on a control add-in created with .NET code written outside of AL and integrated into Business Central. </p>
<p class="calibre1">An example is the <b class="calibre3">Trailing Sales Orders</b> chart in a Factbox page part (page 760) that appears in the <b class="calibre3">Order Processor Role Center</b> (page 9,006). The following screenshot is of that chart:</p>
<p class="calibre1"><b class="calibre3">[ 184 ]</b></p>
<p class="calibre1"><a id="calibre_link-106"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The  <i class="calibre4">Cash Flow Chart Example</i><a href="https://docs.microsoft.com/en-us/previous-versions/dynamicsnav-2016/hh169415(v=nav.90)"> article (https:/​/​docs.​microsoft.​com/​en-​us/​previous-</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/previous-versions/dynamicsnav-2016/hh169415(v=nav.90)">versions/​dynamicsnav-​2016/​hh169415(v=​nav.​90)</a>) in the Business Central  <i class="calibre4">Developer and</i> <i class="calibre4">IT-pro</i> help describes how to create charts using the chart control add-in. </p>
<p class="calibre1"><b class="calibre3">Page names</b></p>
<p class="calibre1"><b class="calibre3">Card</b> pages are named similarly to the table with which they are associated, with the addition of the word “Card,” for example, Customer table and Customer Card, Item table and Item Card, Vendor table and Vendor Card. </p>
<p class="calibre1">List pages are named similarly to the table with which they are associated. List pages that are simple not-editable lists have the word “List” associated with the table name, for example, Customer List, Item List, and Vendor List. For each of these, the table also has an associated card page. Where the table has no associated card page, the list pages are named after the tables, but in the plural format, for example, Customer Ledger Entry table and Customer Ledger Entries page, Check Ledger Entry table and Check Ledger Entries page, Country/Region table and Countries/Regions page, and Production Forecast Name table and Production Forecast Names page. </p>
<p class="calibre1">The single-record setup tables that are used for application control information throughout Business Central are named after their functional area, with the addition of the word</p>
<p class="calibre1">“Setup.” The associated Card page should also be, and generally is, named similarly to the table, for example, General Ledger Setup table and General Ledger Setup page, </p>
<p class="calibre1">Manufacturing Setup table and Manufacturing Setup page, and so on. </p>
<p class="calibre1"><b class="calibre3">Journal entry</b> (worksheet) pages are given names tied to their purpose, with the addition of the word “Journal.” In the standard product, several journal pages for different purposes are associated with the same table. For example, the Sales Journal, Cash Receipts Journal, Purchases Journal, and Payments Journal all use the General Journal Line table as their source table (they are different pages all tied to the same table). </p>
<p class="calibre1"><b class="calibre3">[ 185 ]</b></p>
<p class="calibre1"><a id="calibre_link-107"></a><img src="images/000281.png" alt="Image 195" class="calibre2" /></p>
<p class="calibre1"><img src="images/000303.png" alt="Image 196" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">If there is a header and line table associated with a data category, such as <b class="calibre3">Sales Orders</b>, the related page and subpage ideally should be named to describe the relationship between the tables and the pages. However, in some cases, it’s better to tie the page names directly to the function they perform rather than the underlying tables. An example is the two pages making up the display called by the Sales Order menu entry&mdash;the <b class="calibre3">Sales Orders</b> page is tied to the Sales Header table, and the Sales Order subform page is tied to the Sales Line table. The same tables are involved for the Sales Invoice page and <b class="calibre3">Sales Invoice</b> subform page. </p>
<p class="calibre1">The use of the word subform rather than subpage, as in Sales Invoice<br>subform, is a leftover from previous versions of Business Central, which<br>had forms rather than pages. We are hopeful Microsoft will eventually fix<br>this historical artifact and rename these pages subpages. </p>
<p class="calibre1">Sometimes, while naming pages, we will have a conflict between naming pages based on the associated tables and naming them based on the use of the data. For example, the menu entry Contacts invokes a main page/subpage named Contact Card and Contact Card<br>subform. The respective tables are the Contact table and the <b class="calibre3">Contact Profile Answer table</b>. </p>
<p class="calibre1">The context usage should take precedence in the page naming as was done here. </p>
<p class="calibre1"><b class="calibre3">In-client designer</b></p>
<p class="calibre1">The in-client designer is accessed from within the web client, through <b class="calibre3">Settings | Design</b>. </p>
<p class="calibre1">The page designer can be opened from anywhere in the application, but its use may be limited in some areas:</p>
<p class="calibre1"><b class="calibre3">[ 186 ]</b></p>
<p class="calibre1"><a id="calibre_link-108"></a><img src="images/000325.jpg" alt="Image 197" class="calibre2" /></p>
<p class="calibre1"><img src="images/000344.png" alt="Image 198" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Designer</b></p>
<p class="calibre1">When we are in design mode and click on any part, it will highlight the section, as you can see in the following screenshot:</p>
<p class="calibre1">We can proceed to select a specific control within the section and choose to remove it: If we select a FastTab, we can change the name, for example, to <b class="calibre3">Customer</b>. </p>
<p class="calibre1">When we click on the more button in the designer and select <b class="calibre3">+ Field</b>, we will get a list of controls that can be added to the page, which we can drag and drop into the page:</p>
<p class="calibre1"><b class="calibre3">[ 187 ]</b></p>
<p class="calibre1"><a id="calibre_link-470"></a><img src="images/000365.jpg" alt="Image 199" class="calibre2" /></p>
<p class="calibre1"><img src="images/000387.jpg" alt="Image 200" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">When we move the <b class="calibre3">Name 2</b> field into the newly renamed <b class="calibre3">Customer</b> tab, we can drop it right under the <b class="calibre3">Name</b> field:</p>
<p class="calibre1"><b class="calibre3">[ 188 ]</b></p>
<p class="calibre1"><a id="calibre_link-359"></a><img src="images/000409.png" alt="Image 201" class="calibre2" /></p>
<p class="calibre1"><img src="images/000430.png" alt="Image 202" class="calibre2" /></p>
<p class="calibre1"><img src="images/000450.png" alt="Image 203" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Once we have done all of the work that is feasible within the in-client designer, we will click on <b class="calibre3">Stop designing</b>. The in-client designer will ask for an <b class="calibre3">Extension Name</b> and <b class="calibre3">Publisher</b>. We will select <b class="calibre3">Download Code</b> and click <b class="calibre3">Save</b>, as shown in the following screenshot:</p>
<p class="calibre1">In the web browser (in our case, Google Chrome), a downloaded ZIP file will pop up that we have to save somewhere on our local computer:</p>
<p class="calibre1">The next step is to unzip the file into a folder and look at the contents. With a little bit of luck, you will recognize the structure as an extension that we can open in Visual Studio Code:</p>
<p class="calibre1"><b class="calibre3">[ 189 ]</b></p>
<p class="calibre1"><a id="calibre_link-109"></a><img src="images/000016.png" alt="Image 204" class="calibre2" /></p>
<p class="calibre1"><img src="images/000035.jpg" alt="Image 205" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">When we open the extension in Visual Studio Code, we see that each page we changed using the in-client designer has a file. If we open the file that is related to the customer card, in our case, PageExtension50101.al, we can see exactly what we did. We can see the modification of the General tab and the adding of the Name 2 field:</p>
<p class="calibre1">Using the in-client designer together with Visual Studio Code is a great<br>way to learn the technical notation (syntax) for page modification. </p>
<p class="calibre1"><b class="calibre3">Page components</b></p>
<p class="calibre1">All pages are made up of certain common components. The basic elements of a page object are the page triggers, page properties, controls, control triggers, and control properties. </p>
<p class="calibre1"><b class="calibre3">[ 190 ]</b></p>
<p class="calibre1"><a id="calibre_link-110"></a><img src="images/000057.jpg" alt="Image 206" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Page triggers</b></p>
<p class="calibre1">The following screenshot shows page triggers. The <b class="calibre3">Help</b> section’s <b class="calibre3">Page and Action</b> <b class="calibre3">Triggers</b> provides good general guidance to the events that cause each page trigger to fire. </p>
<p class="calibre1">Note that the <b class="calibre3">OnQueryClosePage</b> trigger isn’t related to any query object action: In general, according to best practices, we should minimize the AL code placed in page triggers, putting code in a table or field trigger or calling a codeunit library function instead. However, many standard pages include a modest amount of code supporting page-specific filter or display functions. When we develop a new page, it’s always a good idea to look for similar pages in the standard product and be guided by how those pages operate internally. Sometimes, special display requirements result in complex code being required within a page. It is important that the code in a page be used only to manage the data display, not for data modification. </p>
<p class="calibre1">To execute AL code in pages, you can also use events. Each page object automatically generates events that you can subscribe to. Using events is preferred when adding code to page objects shipped by Microsoft to avoid any merge challenges when Microsoft changes the page in a new release. </p>
<p class="calibre1"><b class="calibre3">[ 191 ]</b></p>
<p class="calibre1"><a id="calibre_link-111"></a><img src="images/000078.jpg" alt="Image 207" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Page properties</b></p>
<p class="calibre1">We will now look at the properties of the <b class="calibre3">Radio Show List</b> page we created earlier. The list of available page properties is the same for all page types. The values of those properties vary considerably from one page to another, even more from one page type to another. The following screenshot shows a subset of the possible properties using  <i class="calibre4">Ctrl</i> + spacebar in our Radio Show List page (page 50100):</p>
<p class="calibre1">We can see that many of these properties are still in their default condition (they are not shown in bold letters). The following are the properties with which we are most likely to be concerned:</p>
<p class="calibre1">Caption and CaptionML: This is the page name to be displayed, depending on<br>the language option in use. </p>
<p class="calibre1">Editable: This determines whether or not the controls in the page can be edited</p>
<p class="calibre1">(assuming the table’s editable properties are also set to Yes). If this property is set to Yes, the page allows the individual control to determine the appropriate<br>editable property value. </p>
<p class="calibre1">Description: This is for internal documentation only. </p>
<p class="calibre1"><b class="calibre3">[ 192 ]</b></p>
<p class="calibre1"><a id="calibre_link-471"></a><img src="images/000101.png" alt="Image 208" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Permissions: This is used to instruct the system to allow the users of this page to have certain levels of access (r to read, i to insert, m to modify, and d to delete) to the table data in the specified table objects. For example, users of page 499</p>
<p class="calibre1">(<b class="calibre3">Available - Sales Lines</b>) are allowed to only read or modify (permissions for Sales Line equal to rm) the data in the Sales Line table. </p>
<p class="calibre1">Whenever defining special permissions, be sure to test with an end-user<br>license. In fact, it’s always important to test with an end-user license. </p>
<p class="calibre1">PageType: This specifies how this page will be displayed using one of the<br>available ten page types: Role Center, card, list, List Plus, Worksheet, </p>
<p class="calibre1">Confirmation Dialog, Standard Dialog, Navigate page, Card Part, List Part. </p>
<p class="calibre1">CardPageID: This is the ID of the card page that should be launched when the<br>user double-clicks on an entry in the list. This is only used on List pages. </p>
<p class="calibre1">RefreshOnActivate: When this is set to Yes, it causes the page to refresh when<br>the page is activated. This property is unsupported by the web client. </p>
<p class="calibre1">PromotedActionCategoriesML: This allows changing the language for<br>promoted ActionCategories from the default English (ENU) to another<br>language or to extend the number of promoted ActionCategories from the<br>standard three options&mdash;<b class="calibre3">New</b>, <b class="calibre3">Process</b>, and <b class="calibre3">Reports</b>&mdash;to add up to seven more categories. See the <b class="calibre3">Help</b> section,  <i class="calibre4">How to: Define Promoted Action Categories Captions</i> <i class="calibre4">for the Ribbon</i>. </p>
<p class="calibre1">SourceTable: This is the name of the table to which the page is bound. </p>
<p class="calibre1">SourceTableView: This can be utilized to automatically apply defined filters<br>and/or open the page with a key other than the primary key. </p>
<p class="calibre1">ShowFilter: This is set to No to make the filter pane default to Not Visible. </p>
<p class="calibre1">The user can still make the filter pane visible. </p>
<p class="calibre1">DelayedInsert: This delays the insertion of a new record until the user moves<br>focus away from the new line being entered. If this value is No, then a new record will automatically be inserted into the table as soon as the primary key fields are completed. This property is generally set to Yes when AutoSplitKey (see<br>following) is set to Yes. It allows complex new data records to be entered with all of the necessary fields completed. </p>
<p class="calibre1">MultipleNewLines: When set to Yes, this property supposedly allows the<br>insertion of multiple new lines between existing records. However, it is set to No in the standard order forms from Microsoft. This indicates that this property is no longer active in Business Central. </p>
<p class="calibre1"><b class="calibre3">[ 193 ]</b></p>
<p class="calibre1"><a id="calibre_link-112"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">SaveValues<b class="calibre3">:</b> If set to Yes, this causes user-specific entered control values to be retained and redisplayed when the page is invoked another time. </p>
<p class="calibre1">AutoSplitKey: This allows for the automatic assignment of a primary key, </p>
<p class="calibre1">provided the last field in the primary key is an integer; there are rare exceptions to this, but we won’t worry about them in this book. This feature enables each<br>new entry to be assigned a key so it will remain sequenced in the table following the record appearing above it. Note that AutoSplitKey and DelayedInsert are<br>generally used jointly. On a new entry, at the end of a list of entries, the trailing integer portion of the primary key, often named Line No, is automatically<br>incremented by 10,000 (the increment value cannot be changed). When a new<br>entry is inserted between two previously existing entries, their current key-</p>
<p class="calibre1">terminating integer values are summed and divided by two (hence, the term</p>
<p class="calibre1">AutoSplitKey) with the resultant value being used for the new entry key-</p>
<p class="calibre1">terminating integer value. Because 10,000 (the automatic increment) can only be<br>divided by two and rounded to a non-zero integer result 13 times, only 13 new<br>automatically numbered entries can be inserted between two previously<br>recorded entries by the AutoSplitKey function. </p>
<p class="calibre1">SourceTableTemporary: This allows the use of a temporary table as the source<br>table for the page. This can be very useful where there is a need to display data based on the structure of a table, but not using the table data as it persists in the database. Examples of such application usage are in page 634&mdash;<b class="calibre3">Chart of</b></p>
<p class="calibre1"><b class="calibre3">Accounts Overview</b> and page 6510&mdash;<b class="calibre3">Item Tracking Lines</b>. Note that the temporary instance of the source table is empty when the page opens up, so our<br>code must populate the temporary table in memory. </p>
<p class="calibre1"><b class="calibre3">Inheritance</b></p>
<p class="calibre1">One of the attributes of an object-oriented system is the inheritance of properties. While Business Central is object based rather than object oriented, the properties that affect data validation are inherited. Properties such as decimal formatting are also inherited. If a property is explicitly defined in the table, it cannot be less restrictively defined elsewhere. </p>
<p class="calibre1">Controls that are bound to a table field will inherit the settings of the properties that are common to both the field definition and the control definition. This basic concept applies to inheritance of data properties, beginning from fields in tables to pages and reports, and then from pages and reports to controls within pages and reports. Inherited property settings that involve data validation cannot be overridden, but all others can be changed. </p>
<p class="calibre1">This is another example of why it is generally best to define the properties in the table for consistency and ease of maintenance, rather than defining them for each instance of use in a page or a report. </p>
<p class="calibre1"><b class="calibre3">[ 194 ]</b></p>
<p class="calibre1"><a id="calibre_link-113"></a><img src="images/000120.png" alt="Image 209" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">WDTU page enhancement &ndash; part 1</b></p>
<p class="calibre1">Before we move on to learn about controls and actions, let’s do some basic enhancement</p>
<p class="calibre1"><a href="#calibre_link-2">work on our WDTU Radio Show application. In Chapter 1</a>,  <i class="calibre4">Introduction to Business Central</i>, in the  <i class="calibre4">Getting started with application design</i> section, we created several minimal pages, and later added new fields to our Radio Show master table (table 50100). We’ll now enhance the Radio Show’s list and card page to include those added fields. </p>
<p class="calibre1">Because our previous page development work resulted in simple pages, we have the opportunity to decide whether we want to start with a new page snippet and replace our original pages or use the page designer to modify the original pages. If we had done any significant work on these pages previously in the page designer, the choice to go right to the page designer would be easy. Let’s do a quick evaluation to help us to make our decision. First, let’s take a look at the existing <b class="calibre3">Radio Show List</b> page:</p>
<p class="calibre1">We want to compare the list of fields that exist in the source table (Radio Show&mdash;50100) to what we see is already in the page. If there are only a couple of fields missing, it will be more efficient to do our work in the page designer. The quickest way to inspect the fields of the source table is to use the <b class="calibre3">Open to the Side</b> option in the list available from the drop-down menu when clicking on a file in Visual Studio Code, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 195 ]</b></p>
<p class="calibre1"><a id="calibre_link-396"></a><img src="images/000143.png" alt="Image 210" class="calibre2" /></p>
<p class="calibre1"><img src="images/000165.jpg" alt="Image 211" class="calibre2" /></p>
<p class="calibre1"><img src="images/000188.jpg" alt="Image 212" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">This allows us to compare the page fields and table fields side-by-side and examine whether only a few fields are missing:</p>
<p class="calibre1">Note that the Date Filter field cannot be placed on the page. This is a<br>virtual field that is meant for users to limit totals by using the filter pane. </p>
<p class="calibre1"><b class="calibre3">[ 196 ]</b></p>
<p class="calibre1"><a id="calibre_link-472"></a><img src="images/000210.png" alt="Image 213" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Next, we want to also create a new layout for <b class="calibre3">RADIO SHOW CARD</b>. When we review the data fields, we decide that we should have three FastTabs: <b class="calibre3">General</b>, <b class="calibre3">Requirements</b>, and <b class="calibre3">Statistics</b>. As before, the <b class="calibre3">Date Filter</b> field should not be on the page. After we have generated, compiled, and saved our new <b class="calibre3">RADIO SHOW CARD</b>, it will look like this:</p>
<p class="calibre1"><b class="calibre3">[ 197 ]</b></p>
<p class="calibre1"><a id="calibre_link-397"></a><img src="images/000230.jpg" alt="Image 214" class="calibre2" /></p>
<p class="calibre1"><img src="images/000253.png" alt="Image 215" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Our final step at this point is to connect the <b class="calibre3">RADIO SHOW CARD</b> to the <b class="calibre3">Radio Show List</b> page, so that when the user double-clicks on a list entry, the card page will be invoked, showing the list-selected entry. This is a simple matter of adding CardPageId to the list of properties. Fill in that property with either the name (Radio Show Card) or object ID</p>
<p class="calibre1">number (50101) of the target card, then save, compile, and run it:</p>
<p class="calibre1">We should see a ribbon with both <b class="calibre3">Edit</b> and <b class="calibre3">Edit List</b>, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 198 ]</b></p>
<p class="calibre1"><a id="calibre_link-114"></a><img src="images/000275.png" alt="Image 216" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Clicking on <b class="calibre3">Edit</b> will bring up <b class="calibre3">Radio Show Card</b>. Clicking on <b class="calibre3">Edit List</b> will make the line in the list editable in place within the List page. If we don’t want the user to be able to edit within the list, we should change the List page property from <b class="calibre3">Editable</b> to <b class="calibre3">No</b>, and the <b class="calibre3">Edit</b> <b class="calibre3">List</b> option will not be available, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Page controls</b></p>
<p class="calibre1">Controls on pages serve a variety of purposes. Some controls display information on pages. </p>
<p class="calibre1">This can be data from the database, static material, pictures, or the results of an AL</p>
<p class="calibre1">expression. Container controls can contain other controls. <b class="calibre3">Group</b> controls make it easy for the developer to handle a set of contained controls as a group. A FastTabs control also makes it easy for the user to consider a set of controls as a group. The user can make all of the controls on FastTabs visible or invisible by expanding or collapsing the FastTabs. The user also has the option to show or not to show a particular FastTab as a part of the page customizing capability. The <b class="calibre3">Help</b> section’s <b class="calibre3">Pages Overview</b> and <b class="calibre3">How to: Create a Page</b> provide good background guidance on the organization of controls within page types for Business Central. </p>
<p class="calibre1"><b class="calibre3">[ 199 ]</b></p>
<p class="calibre1"><a id="calibre_link-360"></a><img src="images/000296.jpg" alt="Image 217" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The following screenshot from the page designer shows all of the data controls on page 5600 “Fixed Asset Card”. The first column, Expanded, is a + or -, indicating whether the section is expanded or not. Type and subtype define how this control is interpreted by the RTC:</p>
<p class="calibre1">The page’s control structure can be seen in the indented format shown in the preceding screenshot. The container controls define the primary parts of the page structure. The next level of structure is the group control level. In this page, those are the general, depreciation book, and maintenance groups, each of which represents a FastTab. Indented under each group control are the field controls. </p>
<p class="calibre1"><b class="calibre3">[ 200 ]</b></p>
<p class="calibre1"><a id="calibre_link-115"></a><img src="images/000317.jpg" alt="Image 218" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The <b class="calibre3">FIXED ASSET CARD</b> page, including the action ribbon, is displayed in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Control types</b></p>
<p class="calibre1">There are four primary types of page controls: container, group, field, and part. </p>
<p class="calibre1">Container, group, and field controls are used to define the content area of pages. Part controls are used to define FactBoxes and embedded subpages. When designing pages that may be used by different client types, such as the web client, we need to be aware that some controls operate differently or are not supported in all clients. Each customized page should be thoroughly tested in each client environment where it may be used. </p>
<p class="calibre1"><b class="calibre3">[ 201 ]</b></p>
<p class="calibre1"><a id="calibre_link-116"></a><img src="images/000339.png" alt="Image 219" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Container controls</b></p>
<p class="calibre1">Container controls can be one of three subtypes: ContentArea, FactBoxArea, or</p>
<p class="calibre1">RoleCenterArea. Container controls define the root-level primary structures within a page. All page types start with a container control. The RoleCenterArea container control can only be used on a Role Center page type. A page can only have one instance of each container subtype. </p>
<p class="calibre1"><b class="calibre3">group controls</b></p>
<p class="calibre1">The group controls provide the second level of structure within a page. The group controls are the home for fields. Almost every page has at least one group control. The following screenshot from page 5600 Fixed Asset Card, with all of the group controls collapsed, shows two container controls and three group controls. Also showing is a page part control that displays a page part as a FastTab:</p>
<p class="calibre1"><b class="calibre3">[ 202 ]</b></p>
<p class="calibre1"><a id="calibre_link-388"></a><img src="images/000358.jpg" alt="Image 220" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The properties of a group control are shown in the following screenshot:</p>
<p class="calibre1">Several of the group control properties are particularly significant because of their effect on all of the fields within the group. </p>
<p class="calibre1">Visible: This can be TRUE or FALSE, defaulting to TRUE. The Visible property<br>can be assigned a Boolean expression, which can be evaluated during processing. </p>
<p class="calibre1">This allows to dynamically change the visibility of a group of fields during the processing, based on some variable conditions (dynamic processing must occur<br>in either the OnInit, OnOpenPage, or OnAfterGetCurrRecord trigger, and the<br>variable must have its IncludeInDataSet property set to Yes). </p>
<p class="calibre1">Enabled: This can be TRUE or FALSE, defaulting to TRUE. The Enabled property<br>can be assigned a Boolean expression to allow dynamically changing the<br>enabling of a group of fields. </p>
<p class="calibre1">Editable: This can be TRUE or FALSE, defaulting to TRUE. The Editable<br>property can be assigned a Boolean expression to allow dynamically changing<br>the editability of a group of fields. </p>
<p class="calibre1"><b class="calibre3">[ 203 ]</b></p>
<p class="calibre1"><a id="calibre_link-389"></a><img src="images/000379.png" alt="Image 221" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">GroupType: This can be one of the five choices: group, repeater, cuegroup, </p>
<p class="calibre1">FixedLayout, or GridLayout. The GroupType property is visible on the page<br>designer screen in the column headed SubType (see the preceding page designer<br>screenshot):</p>
<p class="calibre1">group: This is used in card type pages as the general structure for<br>fields, which are then displayed in the sequence in which they<br>appear in the page designer group. </p>
<p class="calibre1">repeater: This is used in List-type pages as the structure within<br>which fields are defined and then displayed as repeated rows. </p>
<p class="calibre1">cuegroup: This is used for Role Center pages as the structure for<br>the actions that are the primary focus of a user’s work day. </p>
<p class="calibre1">cuegroup are found in page parts, typically having the word</p>
<p class="calibre1">Activities in their name and included in Role Center page<br>definitions. The following screenshot shows two<br>cuegroup instances defined in the page designer:</p>
<p class="calibre1"><b class="calibre3">[ 204 ]</b></p>
<p class="calibre1"><a id="calibre_link-473"></a><img src="images/000400.png" alt="Image 222" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">These two cuegroup instances are shown displayed in the<br>following Role Center screenshot:</p>
<p class="calibre1">FixedLayout: GroupType is used at the bottom of list pages, </p>
<p class="calibre1">following a repeater group. The FixedLayout group typically<br>contains totals or additional line-related detail fields. Many journal<br>pages, such as page 39&mdash;<b class="calibre3">General Journal</b>, page 40&mdash;<b class="calibre3">Item Journal</b>, </p>
<p class="calibre1">and page 201&mdash;<b class="calibre3">Job Journal</b> have FixedLayout groups. The item</p>
<p class="calibre1"><b class="calibre3">JournalFixedLayout</b> group only shows Item Description, </p>
<p class="calibre1">which is also available in a repeater column, but can easily display<br>other fields as well. A FixedLayout group can also display a<br>lookup or calculated value, like many of the statistics pages, for<br>example, page 151&mdash;<b class="calibre3">Customer Statistics</b> and page 152&mdash;<b class="calibre3">Vendor</b></p>
<p class="calibre1"><b class="calibre3">Statistics</b>. </p>
<p class="calibre1">GridLayout: GroupType provides additional formatting<br>capabilities to layout fields, row by row, column by column, </p>
<p class="calibre1">spanning rows or columns, and hiding or showing captions. Page</p>
<p class="calibre1">970&mdash;<b class="calibre3">Time Sheet Allocation</b> contains an example of the</p>
<p class="calibre1">GridLayout use. To learn more about the GridLayout use, search</p>
<p class="calibre1">Help for Gridlayout. </p>
<p class="calibre1"><b class="calibre3">[ 205 ]</b></p>
<p class="calibre1"><a id="calibre_link-390"></a><img src="images/000422.png" alt="Image 223" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">IndentationColumnName and IndentationControls: These properties allow<br>a group to be defined in which fields will be indented, as shown in the following screenshot of the <b class="calibre3">Chart of Accounts</b> page. Examples of pages that utilize the indentation properties include page 16&mdash;<b class="calibre3">Chart of Accounts</b> and page 18&mdash;<b class="calibre3">G/L</b></p>
<p class="calibre1"><b class="calibre3">Account List</b>:</p>
<p class="calibre1">FreezeColumnID: This freezes the identified column and all of the columns to<br>the left, so they remain in a fixed position while the columns to the right can<br>scroll horizontally. This is like freezing a pane in an Excel worksheet. Users can also freeze columns as part of the personalization. </p>
<p class="calibre1">ShowAsTree: This works together with the indentation property. ShowAsTree<br>allows an indented set of rows to be expanded or collapsed dynamically by the </p>
<p class="calibre1">user for easier viewing. Example pages that use this property are page</p>
<p class="calibre1">583&mdash;<b class="calibre3">XBRL Taxonomy Lines</b>, page 634&mdash;<b class="calibre3">Chart of Accounts Overview</b>, and page 5522&mdash;<b class="calibre3">Order Planning</b>. </p>
<p class="calibre1"><b class="calibre3">[ 206 ]</b></p>
<p class="calibre1"><a id="calibre_link-117"></a><img src="images/000444.jpg" alt="Image 224" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Field controls</b></p>
<p class="calibre1">All field controls appear in the same format in the page designer. The SubType column is empty and the SourceExpr column contains the data expression that will be displayed. </p>
<p class="calibre1">All of the field control properties are listed for each field, but individual properties only apply to the data type for which they make sense. For example, the DecimalPlaces property only applies to fields where the data type is decimal. The following is a subset screenshot of the properties for field controls:</p>
<p class="calibre1">We’ll review the field control properties that are more frequently used or that are more significant in terms of effect, as follows:</p>
<p class="calibre1">Visible, Enabled, and Editable: These have the same functionality as the<br>identically named group controls, but they only apply to individual fields. If the group control is set to FALSE, either statically (in the control definition within the page) or dynamically by an expression evaluated during processing, the group<br>control’s FALSE condition will take precedence over the equivalent field control setting. Precedence applies in the same way at the next, higher levels of<br>identically named properties at the page level, and then at the table level. For example, if a data field is set to non-editable in the table, that setting will take precedence over (override) other settings in a page, control group, or control. </p>
<p class="calibre1">HideValue: This allows the value of a field to be optionally displayed or hidden, based on an expression that evaluates to TRUE or FALSE. </p>
<p class="calibre1">CaptionandCaptionML: These define the caption that will be displayed for the<br>field (in English or the current system language if not English). </p>
<p class="calibre1">ShowCaption: This is set to Yes or No; it determines whether or not the caption<br>is displayed. </p>
<p class="calibre1"><b class="calibre3">[ 207 ]</b></p>
<p class="calibre1"><a id="calibre_link-386"></a><img src="images/000008.png" alt="Image 225" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">MultiLine: This must be set to TRUE if the field is to display multiple lines of text. </p>
<p class="calibre1">OptionCaption and OptionCaptionML: These set the text string options that<br>are displayed to the user. The captions that are set as page field properties will override those defined in the equivalent table field property. The default captions are those defined in the table. </p>
<p class="calibre1">DecimalPlaces: This applies to decimal fields only. If the number of decimal<br>places defined in the page is smaller than that defined in the table, the display is rounded accordingly. If the field definition is the smaller number, it controls the display. </p>
<p class="calibre1">Width: This allows setting a specific field display width&mdash;a number of characters. </p>
<p class="calibre1">This is especially useful for the SubType control of GridLayout. </p>
<p class="calibre1">ShowMandatory: This shows a red asterisk in the field display to indicate a<br>required (mandatory) data field. ShowManadatory can be based on an<br>expression that evaluates to TRUE or FALSE. This property does not enforce any<br>validation of the field. Validation is left to the developer. </p>
<p class="calibre1">ApplicationArea: This allows us to hide controls based on the Application</p>
<p class="calibre1">Area feature, which was introduced in Business Central. </p>
<p class="calibre1">This blog entry explains how the Application Area property is<br>implemented by Microsoft. You can check it out by clicking on the</p>
<p class="calibre1"><a href="https://markbrummel.wordpress.com/2016/11/19/nav2017-applicationarea-the-mistery-of-disapearing-controls/">following link: https:/​/​markbrummel.​wordpress.​com/​2016/​11/​19/</a></p>
<p class="calibre1"><a href="https://markbrummel.wordpress.com/2016/11/19/nav2017-applicationarea-the-mistery-of-disapearing-controls/">nav2017-​applicationarea-​the-​mistery-​of-​disapearing-​controls/</a>​. </p>
<p class="calibre1">QuickEntry: This allows the field to optionally receive focus or be skipped, </p>
<p class="calibre1">based on an expression that evaluates to TRUE or FALSE. </p>
<p class="calibre1">AccessByPermission: This determines the permission mask required for a user<br>to view or access this field. </p>
<p class="calibre1">Importance: This controls the display of a field. This property only applies to<br>individual (non-repeating) fields located within a FastTab. Importance can be set to Standard (the default), Promoted, or Additional, which are briefly<br>described here:</p>
<p class="calibre1">Standard: This is the normal display. Implementations of the<br>rendering routines for different targets may utilize this differently. </p>
<p class="calibre1">Promoted: If the property is set to Promoted and the page is on a<br>collapsed FastTab, then the field contents will be displayed on the</p>
<p class="calibre1">FastTab line. If the FastTab is expanded, the field will display<br>normally. </p>
<p class="calibre1"><b class="calibre3">[ 208 ]</b></p>
<p class="calibre1"><a id="calibre_link-387"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Additional: If the property is set to Additional and the FastTab<br>is collapsed, there is no effect on the display. If the FastTab is<br>expanded, then the user can determine whether or not the field is<br>displayed by clicking on the show more fields or show fewer fields<br>display control in the lower-right corner of the FastTab. </p>
<p class="calibre1">RowSpan and ColumnSpan: These are used in conjunction with the GridLayout<br>controls as layout parameters. </p>
<p class="calibre1">ControlAddIn: When the field represents a control add-in, this contains the<br>name and public token key of the control add-in. </p>
<p class="calibre1">ExtendedDatatype: This allows a text field to be categorized as a special data<br>type. The default value is None. If ExtendedDatatype is selected, it can be any<br>one of the following data types:</p>
<p class="calibre1">Phone No.: This displays a regionally appropriate phone number<br>format. </p>
<p class="calibre1">URL: This displays a formatted URL. </p>
<p class="calibre1">E-MailFilter: This is used on reports. </p>
<p class="calibre1">Ratio: This displays a progress bar. </p>
<p class="calibre1">Masked: This fills the field with bold dots in order to mask the<br>actual entry. The number of masking characters displayed is<br>independent of the actual field contents. The contents of a masked<br>field cannot be copied. If ExtendedDatatype is set with Phone</p>
<p class="calibre1">No., URL, or E-Mail data, an active icon is displayed on the page<br>following the text field, providing access to call the phone number, </p>
<p class="calibre1">access the URL in a browser, or invoke the email client. Setting</p>
<p class="calibre1">ExtendedDatatype will also define the validation that will<br>automatically be applied to the field. </p>
<p class="calibre1">Person: This allows rendering an image as a person in the web<br>client. </p>
<p class="calibre1">Resource: This is not used, according to Microsoft. </p>
<p class="calibre1">Image: This allows the display of an image on a cue for a field control in a<br>cuegroup control. It only applies to a cuegroup field of an integer data type. If no image is wanted, choose a value of None. </p>
<p class="calibre1"><b class="calibre3">[ 209 ]</b></p>
<p class="calibre1"><a id="calibre_link-118"></a><img src="images/000028.png" alt="Image 226" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Page part controls</b></p>
<p class="calibre1"><b class="calibre3">Page parts</b> are used for FactBoxes and subpages. Many of the properties of page parts are similar to the properties of other Business Central components and operate essentially the same way in a page part as they operate elsewhere. Those properties include ID, Name, Visible, Enabled, Editable, Caption, CaptionML, ToolTip, ToolTipML, and</p>
<p class="calibre1">Description. </p>
<p class="calibre1">Other properties that are specific to the page part controls are as follows:</p>
<p class="calibre1">SubPageView: This defines the table view that applies to named Subpage as<br>shown in the following screenshot of part:</p>
<p class="calibre1">SubPageLink: This defines the fields that link to the subpage and the link that is based on a constant, a filter, or another field. This is also shown in the preceding screenshot. </p>
<p class="calibre1">ProviderID: This contains the ID of another page part control within the current page. This enables us to link a subordinate part to a controlling parent part. For example, page 42&mdash;<b class="calibre3">Sales Order</b> uses this property to update <b class="calibre3">Sales Line</b> FactBox by defining a <b class="calibre3">ProviderID</b> link from FactBox to the <b class="calibre3">Sales Lines</b> FastTab. </p>
<p class="calibre1">PartType: This defines the type of part to be displayed in a FactBox. There are<br>three options, and each option also requires another related property to be<br>defined as follows:</p>
<p class="calibre1"><b class="calibre3">PartType option</b></p>
<p class="calibre1"><b class="calibre3">Required property</b></p>
<p class="calibre1"><b class="calibre3">Page</b></p>
<p class="calibre1">PagePartID</p>
<p class="calibre1"><b class="calibre3">System</b></p>
<p class="calibre1">SystemPartID</p>
<p class="calibre1"><b class="calibre3">Chart</b></p>
<p class="calibre1">ChartPartID</p>
<p class="calibre1"><b class="calibre3">[ 210 ]</b></p>
<p class="calibre1"><a id="calibre_link-119"></a><img src="images/000050.png" alt="Image 227" class="calibre2" /></p>
<p class="calibre1"><img src="images/000069.jpg" alt="Image 228" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The properties are further explained as follows:</p>
<p class="calibre1">PagePartID: This must contain the page object ID of a FactBox<br>part if PartTypeOption is set to Page. </p>
<p class="calibre1">SystemPartID: This must contain the name of a predefined<br>system part if PartTypeOption is set to System. The factavailable<br>choices are: Outlook, Notes, MyNotes, and RecordLinks. </p>
<p class="calibre1">ChartPartID: This must contain a chart ID if PartTypeOption is<br>set to Chart. The chart ID is a link to the selected entry in the chart<br>table (the 2000000078 table number). </p>
<p class="calibre1">UpdatePropagation: This allows us to update the parent page from the child</p>
<p class="calibre1">(subordinate) page. A value of Subpage updates the subpage only. A value of<br>both will cause the parent page to be updated and refreshed at the same time as<br>the subpage. </p>
<p class="calibre1">The Business Central chart control add-in provides significant additional<br>charting capability. Information can be found in the <b class="calibre3">Help</b> section, </p>
<p class="calibre1"> <i class="calibre4">Displaying Charts Using the Chart Control Add-In</i></p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/library/hh167009(v=nav.90).aspx">(https://msdn.microsoft.com/en-us/library/hh167009(v=nav.90).asp</a></p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/library/hh167009(v=nav.90).aspx">x</a>). </p>
<p class="calibre1"><b class="calibre3">Page control triggers</b></p>
<p class="calibre1">There are five triggers for each field control. The container, group, and part controls do not have associated triggers. The following screenshot shows page control triggers:</p>
<p class="calibre1"><b class="calibre3">[ 211 ]</b></p>
<p class="calibre1"><a id="calibre_link-120"></a><img src="images/000092.jpg" alt="Image 229" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The guideline for the use of these triggers is the same as the guideline for page triggers&mdash;if there is a choice, don’t put AL code in a control trigger. Not only will this make our code easier to upgrade in the future, but it will also make it easier to debug, and it will be easier for the developer following us to decipher our changes. </p>
<p class="calibre1"><b class="calibre3">Bound and unbound pages</b></p>
<p class="calibre1">Pages can be created as <b class="calibre3">bound</b> (associated with a specific table) or <b class="calibre3">unbound</b> (not specifically associated with any table). Typically, a card or list page will be bound, but the Role Center pages will be unbound. Other instances of unbound pages are rare. Unbound pages may be used to communicate status information or initiate a process. Examples of unbound pages are page 476&mdash;<b class="calibre3">Copy Tax Setup</b> and page 1040&mdash;<b class="calibre3">Copy Job</b>, both of which have a PageType property of StandardDialog. </p>
<p class="calibre1"><b class="calibre3">WDTU page enhancement &ndash; part 2</b></p>
<p class="calibre1">Now that we have an additional understanding of page structures, let’s do a little more enhancing of our <b class="calibre3">WDTU</b> application pages. We’ve decided that it will be useful to keep track of specific listener contacts, a fan list. First, we will need to create a table of fan information that we will save as Table with ID as 50110 and name it Radio Show Fan, which will look like the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 212 ]</b></p>
<p class="calibre1"><a id="calibre_link-391"></a><img src="images/000112.jpg" alt="Image 230" class="calibre2" /></p>
<p class="calibre1"><img src="images/000135.jpg" alt="Image 231" class="calibre2" /></p>
<p class="calibre1"><img src="images/000157.png" alt="Image 232" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">We want to be able to review the fan list as we scan the list, Radio Show List. This requires adding a FactBox area to the 50000 page. In turn, that requires a page part that will be displayed in the FactBox. The logical sequence is to create the page part first, then add the FactBox to the 50000 page. Because we just want a simple List Part with three columns, we can use the page wizard to create our page part, which we will save as Page 50110 - Radio Show Fan Factbox. ListPart, including just the Name, Email, and</p>
<p class="calibre1">Last Contacted fields. The following screenshot shows the new page snippets:</p>
<p class="calibre1">Next, we will use the page designer to add a FactBox area to the 50100 page, populate the FactBox area with our page part&mdash;the 50110 page, and set the properties for the page part to link to the highlighted record in the <b class="calibre3">Radio Show List</b> page as shown in the following screenshot:</p>
<p class="calibre1">If we run the 50100 page, we should see something like the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 213 ]</b></p>
<p class="calibre1"><a id="calibre_link-121"></a><img src="images/000179.png" alt="Image 233" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Before finishing this part of our enhancement effort, we will create a list page that we can use to view and maintain the data in the 50110 table in the future (assign it as the 50111</p>
<p class="calibre1">page&mdash;Radio Show Fans). </p>
<p class="calibre1">One other enhancement we can do now is promote some fields in <b class="calibre3">RADIO SHOW</b></p>
<p class="calibre1"><b class="calibre3">CARD</b> so they can be seen when FastTabs are collapsed. All we have to do is choose the fields we want to promote and then change the page control property of <b class="calibre3">Importance</b> to <b class="calibre3">Promoted</b>. If we chose the fields and promote No., Radio Show Type, Name, and Avg. </p>
<p class="calibre1">Listener Share, our card with collapsed FastTabs will look like the following screenshot; we don’t have any listener share data yet:</p>
<p class="calibre1"><b class="calibre3">Page actions</b></p>
<p class="calibre1">Actions are the menu items of Business Central. Action menus can be found in several locations. The primary location is the ribbon appearing at the top of most pages. Other locations for actions are the navigation pane, Role Center, cuegroups, and the action menu on FactBox page parts. </p>
<p class="calibre1"><b class="calibre3">[ 214 ]</b></p>
<p class="calibre1"><a id="calibre_link-366"></a><img src="images/000201.jpg" alt="Image 234" class="calibre2" /></p>
<p class="calibre1"><img src="images/000224.png" alt="Image 235" class="calibre2" /></p>
<p class="calibre1"><img src="images/000244.png" alt="Image 236" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Action designer, where actions are defined, is accessed from the page designer form by searching the actions part. When we search for this section on the <b class="calibre3">Fixed Asset</b> page (the 5600 page), we will see a list of actions, which are shown in the following screenshot as they appear in action designer:</p>
<p class="calibre1">The associated ribbon tabs for the preceding page action list are as follows:</p>
<p class="calibre1">First, the <b class="calibre3">Process</b> tab, as you can see in the following screenshot:</p>
<p class="calibre1">Second, the <b class="calibre3">Actions</b> tab is shown in this screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 215 ]</b></p>
<p class="calibre1"><a id="calibre_link-367"></a><img src="images/000267.jpg" alt="Image 237" class="calibre2" /></p>
<p class="calibre1"><img src="images/000286.png" alt="Image 238" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Third, the <b class="calibre3">Navigate</b> tab is shown in the following screenshot:</p>
<p class="calibre1">Finally, the <b class="calibre3">Report</b> tab is shown here:</p>
<p class="calibre1">There are two default ribbon tabs created for every ribbon: <b class="calibre3">Process</b> and <b class="calibre3">Actions</b>. Which actions appear by default is dependent on the page type. </p>
<p class="calibre1">Actions defined by the developer appear on a ribbon tab and in the tab submenu section based on a combination of the location of the action in the page actions structure and on the property settings of the individual action. There are a lot of possibilities, so it is important to follow some basic guidelines, some of which are listed here:</p>
<p class="calibre1">Maintain the look and feel of the standard product wherever feasible and<br>appropriate. </p>
<p class="calibre1">Put the actions on the <b class="calibre3">Process</b> tab that are expected to be used most. </p>
<p class="calibre1">Be consistent in organizing actions from tab to tab and page to page. </p>
<p class="calibre1">Provide the user with a complete set of action tools, but don’t provide so many<br>options that it’s hard to figure out which one to use. </p>
<p class="calibre1"><b class="calibre3">[ 216 ]</b></p>
<p class="calibre1"><a id="calibre_link-122"></a><img src="images/000307.png" alt="Image 239" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Page action types and subtypes</b></p>
<p class="calibre1">Page action entries can have one of three types: area, group, or action. At this time, separators don’t seem to have any effect in the rendered pages. A page action type uses the following indented hierarchical structure:</p>
<p class="calibre1"><b class="calibre3">Action types Description</b></p>
<p class="calibre1">area</p>
<p class="calibre1">Primary action grouping<br>group</p>
<p class="calibre1">Secondary action grouping<br>action</p>
<p class="calibre1">Action</p>
<p class="calibre1">Secondary groups can be set up within an action list for drop-down menus of<br>group<br>actions (a tertiary level)</p>
<p class="calibre1">action</p>
<p class="calibre1">The indentation indicates this is part of a drop-down menu<br>action</p>
<p class="calibre1">Action</p>
<p class="calibre1">An area action line type can have one of four subtype values, as shown in the following screenshot:</p>
<p class="calibre1">Those action options display in different sections of the ribbon as follows:</p>
<p class="calibre1">Actions in ReportsSubType will appear on the ribbon in a <b class="calibre3">Reports</b> tab</p>
<p class="calibre1">Actions in NavigationSubType will appear on the ribbon in a <b class="calibre3">Navigate</b> tab</p>
<p class="calibre1">Actions in ProcessingSubType will appear on the ribbon in a <b class="calibre3">Process</b> tab</p>
<p class="calibre1">Actions in CreationSubType will appear on the ribbon in a <b class="calibre3">New</b> tab</p>
<p class="calibre1"><b class="calibre3">[ 217 ]</b></p>
<p class="calibre1"><a id="calibre_link-123"></a><img src="images/000327.jpg" alt="Image 240" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Action groups</b></p>
<p class="calibre1">Action groups provide a submenu grouping of actions within the assigned tab. In the following screenshot, the page preview is highlighting the <b class="calibre3">Main Asset</b> submenu, which is the caption for the associated <b class="calibre3">ActionGroup</b>. In <b class="calibre3">RelatedInformationActionContainer</b>, we can see the other <b class="calibre3">ActionGroup</b>, <b class="calibre3">Fixed Asset</b>, <b class="calibre3">Insurance</b>, and <b class="calibre3">History</b> matching the submenu groups on the ribbon’s <b class="calibre3">Navigate</b> tab:</p>
<p class="calibre1">The following are the group properties:</p>
<p class="calibre1">Caption: This is displayed in the action designer. </p>
<p class="calibre1">Visible and Enabled: These are TRUE or FALSE, defaulting to TRUE. These<br>properties can be assigned Boolean expressions, which can be evaluated during<br>processing. </p>
<p class="calibre1">CaptionML: This is the action name displayed, depending on the language<br>option in use. </p>
<p class="calibre1">ToolTip and ToolTipML: This is for a helpful display for the user. </p>
<p class="calibre1"><b class="calibre3">[ 218 ]</b></p>
<p class="calibre1"><a id="calibre_link-368"></a><img src="images/000350.jpg" alt="Image 241" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Description: This is for internal documentation. </p>
<p class="calibre1">Image: This can be used to assign an icon to be displayed. The icon source is the Activity Button Icon Library, which can be viewed in detail in the  <i class="calibre4">Developer and</i> <i class="calibre4">IT-Pro</i> help:</p>
<p class="calibre1">The following are the action properties shown in the preceding screenshot:</p>
<p class="calibre1">Caption: This is displayed in the Action Designer. </p>
<p class="calibre1">CaptionML: This is the action name displayed, depending on the language<br>option in use. </p>
<p class="calibre1">Visible and Enabled: These are TRUE or FALSE, defaulting to TRUE. These<br>properties can be assigned Boolean expressions, which can be evaluated during<br>processing. </p>
<p class="calibre1">RunPageMode: This can be View (no modification), Edit (the default), or Create</p>
<p class="calibre1">(new). </p>
<p class="calibre1">ToolTip and ToolTipML: These are for a helpful display for the user. </p>
<p class="calibre1">Description: This is for internal documentation. </p>
<p class="calibre1">ApplicationArea: This allows us to hide controls based on the Application</p>
<p class="calibre1">Area feature introduced in Business Central. </p>
<p class="calibre1">Image: This can be used to assign an icon to be displayed. The icon source is the Action Icon Library. </p>
<p class="calibre1">Promoted: If Yes, show this action in the ribbon <b class="calibre3">Home</b> tab. </p>
<p class="calibre1">PromotedCategory: If Promoted is Yes, this defines the category in the <b class="calibre3">Home</b></p>
<p class="calibre1">tab in which to display this action. </p>
<p class="calibre1">PromotedIsBig: If Promoted is Yes, this indicates whether the icon is to be<br>large (Yes) or small (No&mdash;the default). </p>
<p class="calibre1"><b class="calibre3">[ 219 ]</b></p>
<p class="calibre1"><a id="calibre_link-124"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">Ellipsis: If Yes, this displays an ellipsis after the caption. </p>
<p class="calibre1">ShortCutKey: This provides a shortcut key combination for this action. </p>
<p class="calibre1">RunObject: This defines which object to run to accomplish the action. </p>
<p class="calibre1">RunPageView: This defines the table view for the page being run. </p>
<p class="calibre1">RunPageLink: This defines the field link for the object being run. </p>
<p class="calibre1">RunPageOnRec: This defines a linkage for the run object to the current record. </p>
<p class="calibre1">InFooterBar: This places the action icon in the page footer bar. This only works on pages with PageType of NavigatePage. </p>
<p class="calibre1">Gesture: This allows an action to be executed, swiping left or right using the<br>universal client. </p>
<p class="calibre1">To summarize a common design choice, individual ribbon actions can be promoted to the ribbon process tab based on two settings. First, set the Promoted property to Yes. Second, set the PromotedCategory property to define the category on the <b class="calibre3">Home</b> tab where the action is to be displayed. This promotion results in the action appearing twice in the ribbon, once where defined in the action structure hierarchy and once on the <b class="calibre3">Home</b> tab. See the preceding screenshot for example settings assigning the <b class="calibre3">Depreciation Books</b> action to the Process category in addition to appearing in the <b class="calibre3">Fixed Assets</b> category on the <b class="calibre3">Navigation</b> tab. </p>
<p class="calibre1"><b class="calibre3">Navigation pane button actions</b></p>
<p class="calibre1">In the navigation pane, on the left side of the web client display, there is a home button where actions can be assigned as part of the Role Center page definition. The navigation pane definition is part of the Role Center. When defining the actions in a Role Center page, we can include a group of actions in an <b class="calibre3">Area</b> group with <b class="calibre3">Embedding</b>. These actions will be displayed in the main menu on the navigation pane. </p>
<p class="calibre1">Additional navigation pane buttons can also easily be defined in a Role Center page action list. First, define an area with subtype of sections. Each group defined within this area will define a new navigation pane’s <b class="calibre3">Activity</b> button. The following screenshot is a combination image showing the RTC for the <b class="calibre3">Sales Orders</b> processor Role Center on the left (focused on the navigation pane) and the Action Designer contents that define the embedded buttons on the top. </p>
<p class="calibre1"><b class="calibre3">[ 220 ]</b></p>
<p class="calibre1"><a id="calibre_link-125"></a><img src="images/000369.jpg" alt="Image 242" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The actions showing on the right that aren’t visible in the navigation pane on the left are in submenus indicated by the small outline arrowheads to the far-left of several entries, including <b class="calibre3">Sales Order</b> and <b class="calibre3">Sales Quotes</b>. Business Central will automatically do some of this grouping for us based on the pages referenced by the actions, including CueGroup actions:</p>
<p class="calibre1"><b class="calibre3">Actions summary</b></p>
<p class="calibre1">The primary location where each user’s job role based actions should appear is the navigation pane. The Role Center action list provides detailed action menus for the <b class="calibre3">Home</b> button and any appropriate additional navigation pane button. Detailed page/task specific actions should be located in the ribbon at the top of each page. </p>
<p class="calibre1"><b class="calibre3">[ 221 ]</b></p>
<p class="calibre1"><a id="calibre_link-126"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">As mentioned earlier, a key design criterion for the Business Central web client is for a user to have access to the actions they need to get their job done; in other words, to tailor the system to the individual user roles. Our job as developers is to take full advantage of all of these options and make life easier for the user. In general, it’s better to go overboard in providing access to useful capabilities than to make the user search for the right tool or use several steps in order to get to it. The challenge is to not clutter up the first-level display with too many things, but still have the important user tools no more than one click away. </p>
<p class="calibre1"><b class="calibre3">Learning more</b></p>
<p class="calibre1">The following section gives a description of several excellent ways to learn more about pages. </p>
<p class="calibre1"><b class="calibre3">Patterns and creative plagiarism</b></p>
<p class="calibre1">When we want to create new functionality, the first task is to obviously create functional specifications. Once those are in hand, we should look for guidelines to follow. Some of the sources that are readily available are listed here:</p>
<p class="calibre1">The Business Central Design Patterns Wiki</p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/default.aspx">(https://community.dynamics.com/nav/w/designpatterns/default.aspx)</a></p>
<p class="calibre1">AL Coding Guidelines, as used internally by Microsoft in the development of</p>
<p class="calibre1">Business Central application functionality</p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/156.cal-coding-guidelines.aspx">(https://community.dynamics.com/nav/w/designpatterns/156.cal-coding-gu</a></p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/156.cal-coding-guidelines.aspx">idelines.aspx</a>) Blogs and other materials available in the Microsoft Dynamics Business Central<br>community (<a href="https://community.dynamics.com/nav/default.aspx">https://community.dynamics.com/nav/default.aspx</a>) Design Patterns on Mark Brummel’s blog</p>
<p class="calibre1"><a href="https://markbrummel.wordpress.com/category/nav-architecture-patterns-code/design-patterns/">(https://markbrummel.wordpress.com/category/nav-architecture-patterns-</a></p>
<p class="calibre1"><a href="https://markbrummel.wordpress.com/category/nav-architecture-patterns-code/design-patterns/">code/design-patterns/</a>) The Business Central system itself as distributed by Microsoft</p>
<p class="calibre1">It’s always good to start with an existing pattern or object that has capabilities similar to our requirements and study the existing logic and the code. In many lines of work, the term plagiarism is a nasty term. However, when it comes to modifying an existing system, plagiarism is a very effective research and design tool. This approach allows us to build on the hard work of the many skilled and knowledgeable people who have contributed to the Business Central product. In addition, this is working software. This eliminates at least some of the errors we would make if starting from scratch. </p>
<p class="calibre1"><b class="calibre3">[ 222 ]</b></p>
<p class="calibre1"><a id="calibre_link-127"></a><img src="images/000390.png" alt="Image 243" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">The book  <i class="calibre4">Learning Dynamics Business Central Patterns</i> explains in depth<br>how to implement Design Patterns in Dynamics Business Central</p>
<p class="calibre1"><a href="https://www.packtpub.com/big-data-and-business-intelligence/learning-dynamics-nav-patterns">(https://www.packtpub.com/big-data-and-business-intelligence/lea</a></p>
<p class="calibre1"><a href="https://www.packtpub.com/big-data-and-business-intelligence/learning-dynamics-nav-patterns">rning-dynamics-nav-patterns). </a></p>
<p class="calibre1">When designing modifications for Business Central, studying how the existing objects work and interact is often the fastest way to create new working models. We should allocate some time both for studying the material in the Business Central Design Patterns Wiki and for exploring the Business Central CRONUS demonstration system. </p>
<p class="calibre1">Search through the <b class="calibre3">CRONUS demonstration system</b> (or an available production system) in order to find one or more pages that have the feature we want to emulate (or a similar feature). If there are both complex and simple instances of pages that contain this feature, we should concentrate our research on the simple instance first. Make a test copy of the page. Read the code. Use the page preview feature. Run the page. Make a minor<br>modification. Preview again; then run it again. Continue this until our ability to predict the results of changes eliminates surprises or confusion. </p>
<p class="calibre1"><b class="calibre3">Experimenting on your own</b></p>
<p class="calibre1">If you have followed along with the exercises so far in this book, it’s time for you to do some experimenting on your own. No matter how much information someone else<br>describes, there is no substitute for personal hands-on experience. You will combine things in a new way from what was described here. You will either discover a new capability that you would not have learned otherwise or you will have an interesting problem to solve. </p>
<p class="calibre1">Either way, the result will be significantly more knowledge about pages in Business Central. </p>
<p class="calibre1">Don’t forget to make liberal use of the help information while you are experimenting. A majority of the available detailed Business Central documentation is in the help files that are built into the product. Some of the help material is a bit sparse, but it is being updated on a frequent basis. In fact, if you find something missing or something that you think is incorrect, please use the <b class="calibre3">documentation feedback</b> function built into the Business Central help system. The product team responsible for help pays close attention to the feedback they receive and use it to improve the product. Hence, we will all benefit from your feedback. </p>
<p class="calibre1"><b class="calibre3">[ 223 ]</b></p>
<p class="calibre1"><a id="calibre_link-128"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Experimentation</b></p>
<p class="calibre1">Start with the blank slate approach because that allows you to focus on specific features and functions. Because we’ve already gone through the mechanical procedures of creating new pages of the card and list types and using the page designer to add controls and modify control properties, we won’t detail those steps here. However, as you move the focus for experimentation from one feature to another, you may want to review what was covered in this chapter. </p>
<p class="calibre1">Let’s walk through some examples of experiments you could do now, then build on as you get more adventuresome. Each of the objects you create at this point should be assigned into an object number range that you are reserving for testing. Follow these steps: 1. Create new Table 50050 (try using 50009 if your license won’t allow 50050). </p>
<p class="calibre1">Do this by opening table 50104 in Visual Studio Code, and then save it as 50050</p>
<p class="calibre1">with the name Playlist Item Rate Test. </p>
<p class="calibre1">2. Create a List page for Table 50050 with at least three or four fields. </p>
<p class="calibre1">3. Enter a few test records into Table 50050, such as Playlist, Item, Rate, and</p>
<p class="calibre1">Test. This can done by running the page. </p>
<p class="calibre1">4. Change the Visible property of a field by setting it to False. </p>
<p class="calibre1">5. Save and run the page. </p>
<p class="calibre1">6. Confirm that the page looks as expected. Go into edit mode on the page. See<br>whether the field is still invisible. </p>
<p class="calibre1">7. Use the page in-client designer feature in order to add the invisible field; also remove a field that was previously visible. Exit the designer. View the page in<br>various modes, such as view, edit, new, and so on. </p>
<p class="calibre1">8. Go back into Visual Studio Code and design the page again. </p>
<p class="calibre1">9. One or two at a time, experiment with setting the <b class="calibre3">Editable</b>, <b class="calibre3">Caption</b>, <b class="calibre3">ToolTip</b>, and other control properties. </p>
<p class="calibre1">10. Don’t just focus on text fields. Experiment with other data types as well. Create a text field that is 200 characters long. Try out the <b class="calibre3">MultiLine</b> property. </p>
<p class="calibre1">11. After you get comfortable with the effect of changing individual properties, try changing multiple properties to see how they interact. </p>
<p class="calibre1"><b class="calibre3">[ 224 ]</b></p>
<p class="calibre1"><a id="calibre_link-365"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">When you feel you have thoroughly explored individual field properties in a list, try similar tests in a card page. You will find that some of the properties have one effect in a list, while they may have a different (or no) effect in the context of a card (or vice versa). </p>
<p class="calibre1">Test enough to find out. If you have some ”  <i class="calibre4">Aha! </i>” experiences, it means that you are really learning. </p>
<p class="calibre1">The next logical step is to begin experimenting with the group level controls. Add one or two to the test page, then begin setting the properties for that control, again experimenting with only one or two at a time, in order to understand very specifically what each one does. </p>
<p class="calibre1">Do some experimenting to find out which properties at the group level override the properties at the field level and which ones do not override them. </p>
<p class="calibre1">Once you’ve done group controls, do part controls. Build some FactBoxes using a variety of the different components that are available. Use the system components and some chart parts as well. There is a wealth of prebuilt parts that come with the system. Even if the parts that are supplied aren’t exactly right for the application, they can often be used as a model for the construction of custom parts. Remember that using a model can significantly reduce both the design and the debugging work when doing custom development. </p>
<p class="calibre1">After you feel that you have a grasp of the different types of controls in the context of cards and lists, consider checking out some of the other page types. Some of those won’t require too much in the way of new concepts. Examples of these are the List Plus, List Parts, Card Parts, and, to a lesser extent, even document pages. </p>
<p class="calibre1">You may now decide to learn by studying samples of the page objects that are part of the standard product. You could start by copying an object, such as page 22&mdash;Customer List, to another object number in your testing range and then begin to analyze how it is put together and how it operates. Again, you should tweak various controls and control properties in order to see how that affects the page. It’s a good idea to back up your work one way or another before making additional changes. An easy way to back up individual objects is to use Git and create multiple branches. The restore method is to go back to a previous branch. </p>
<p class="calibre1">Another excellent learning option is to choose one of the patterns that has a relationship with the area about which you want more knowledge. If, for example, you are going to create an application that has a new type of document, such as a radio program schedule, you should study the document pattern. You might also want to study create data from templates pattern. At this point, it has become obvious that there are a variety of sources and approaches to supplement the material in this text. </p>
<p class="calibre1"><b class="calibre3">[ 225 ]</b></p>
<p class="calibre1"><a id="calibre_link-129"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1"><b class="calibre3">Summary</b></p>
<p class="calibre1">You should now be relatively comfortable in the navigation of Business Central and with the use of Visual Studio Code. You should be able to use the page snippets as an advanced beginner. If you have taken full advantage of the various opportunities to create tables and pages, both with our guidance and experimentally on your own, you are beginning to become a Business Central developer. </p>
<p class="calibre1">We have reviewed different types of pages and worked with some of them. We reviewed all of the controls that can be used in pages and have worked with several of them. We also lightly reviewed page and control triggers. We’ve had a good introduction to page designing and a significant insight into the structure of some types of pages. With the knowledge gained, we have expanded our WDTU application system, enhancing our pages for data maintenance and inquiry. </p>
<p class="calibre1">In the next chapter, we will learn about the Business Central Query and Report Designer. </p>
<p class="calibre1">We will dig into the various triggers and controls that make up reports. We will also perform some query and report creation work to better understand what makes them tick and what we can do within the constraints of the query and report designer tools. </p>
<p class="calibre1"><b class="calibre3">Questions</b></p>
<p class="calibre1">1. Once a page has been developed using the Page Snippet, the developer has very little flexibility in the layout of the page. True or False? </p>
<p class="calibre1">2. Actions appear on the Role Center screen in several places. Choose two:</p>
<p class="calibre1">Address bar</p>
<p class="calibre1">Ribbon</p>
<p class="calibre1">Filter pane</p>
<p class="calibre1">Navigation pane</p>
<p class="calibre1">Command bar</p>
<p class="calibre1">3. A user can choose their Role Center when they log in. True or false? </p>
<p class="calibre1">4. An action can only appear in one place in the ribbon or in the navigator pane. </p>
<p class="calibre1">True or false? </p>
<p class="calibre1"><b class="calibre3">[ 226 ]</b></p>
<p class="calibre1"><a id="calibre_link-474"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">5. When developing a new page, the following page part types are available. </p>
<p class="calibre1">Choose two:</p>
<p class="calibre1">Chart part</p>
<p class="calibre1">Map part</p>
<p class="calibre1">Social part</p>
<p class="calibre1">System part</p>
<p class="calibre1">6. All page design and development is done within the Visual Studio Code. True or false? </p>
<p class="calibre1">7. Document pages are for word processing. True or false? </p>
<p class="calibre1">8. Two activity buttons are always present in the Navigation Pane. Which of the<br>following two are those? </p>
<p class="calibre1">Posted documents</p>
<p class="calibre1">Departments</p>
<p class="calibre1">Financial management</p>
<p class="calibre1">Home</p>
<p class="calibre1">9. The filter pane includes “Filter list by” and “Filter totals by” options. True or false? </p>
<p class="calibre1">10. The AL code place in pages should only be to control display characteristics, not to modify data. True or false? </p>
<p class="calibre1">11. Inheritance is the passing of property definition defaults from one level of object to another. If a field property is explicitly defined in a table, it cannot be less restrictively defined for that field displayed on a page. True or false? </p>
<p class="calibre1">12. Which of the following are true about the control property importance? Choose two:</p>
<p class="calibre1">Applies only to card and Card Part pages</p>
<p class="calibre1">Can affect FastTab displays</p>
<p class="calibre1">Has three possible values: Standard, Promoted, and Additional</p>
<p class="calibre1">Applies to decimal fields only</p>
<p class="calibre1">13. FactBoxes are delivered as part of the standard product. They cannot be modified nor can new FactBoxes be created. True or False? </p>
<p class="calibre1"><b class="calibre3">[ 227 ]</b></p>
<p class="calibre1"><a id="calibre_link-475"></a> <i class="calibre4">Pages - The Interactive Interface</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 4</i></p>
<p class="calibre1">14. RTC Navigation Pane entries always invoke which one of the following page<br>types? </p>
<p class="calibre1">Card</p>
<p class="calibre1">Document</p>
<p class="calibre1">List</p>
<p class="calibre1">Journal/worksheet</p>
<p class="calibre1">15. The page preview tool can be used as a drag and drop page layout design tool. </p>
<p class="calibre1">True or false? </p>
<p class="calibre1">16. Some field control properties can be changed dynamically as the object executes. </p>
<p class="calibre1">Which ones are they? Choose three:</p>
<p class="calibre1">Visible</p>
<p class="calibre1">HideValue</p>
<p class="calibre1">Editable</p>
<p class="calibre1">Multiline</p>
<p class="calibre1">DecimalPlaces</p>
<p class="calibre1">17. Which property is normally used in combination with the AutoSplitKey<br>property? Choose one:</p>
<p class="calibre1">SaveValues</p>
<p class="calibre1">SplitIncrement</p>
<p class="calibre1">DelayedInput</p>
<p class="calibre1">MultipleNewLines</p>
<p class="calibre1">18. Ribbon tabs and menu sections are predefined in Business Central and cannot be changed by the developer. True or false? </p>
<p class="calibre1">19. Inheritance between tables and pages operates two ways&mdash;tables can inherit<br>attributes from pages and pages can inherit from tables. True or false? </p>
<p class="calibre1">20. For the purpose of testing, pages can be run directly from the Visual Studio Code. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 228 ]</b></p>
<p class="calibre1"><a id="calibre_link-130"></a>5</p>
<p class="calibre1">Queries and Reports</p>
<p class="calibre1"> <i class="calibre4">“Data helps solve problems.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Anne Wojcicki</i></p>
<p class="calibre1"> <i class="calibre4">“The greatest value of a picture is when it forces us to notice what we never expected to</i> <i class="calibre4">see.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; John Tukey</i></p>
<p class="calibre1">In Microsoft Dynamics 365 Business Central, reports and queries are two ways to extract and output data for the purpose of presentation to a user (reports can also modify data). </p>
<p class="calibre1">Each of these objects use tools and processes that are Business Central-based and work on data extraction (XMLports, which can also extract and modify data, will be covered in</p>
<p class="calibre1"><a href="#calibre_link-243">Chapter 8, </a> <i class="calibre4">Advanced AL Development Tools</i>). In this chapter, we will focus on understanding the strengths of each of these tools and when and how they might be used. We will cover the Business Central side of both queries and reports in detail to describe how to obtain the data we need to present to our users. We will cover output formatting and consumption of that data in less detail. There are currently no Wizards available for either query building or report building, and therefore we must do this step by step using programming tools and our skills as designers and developers. </p>
<p class="calibre1">We will cover the following topics in this chapter:</p>
<p class="calibre1">Queries and reports</p>
<p class="calibre1">Report components&mdash;overview</p>
<p class="calibre1">Report data flow</p>
<p class="calibre1">Report components&mdash;detail</p>
<p class="calibre1">Creating and modifying reports</p>
<p class="calibre1"><a id="calibre_link-131"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Queries</b></p>
<p class="calibre1">Reports have always been available in Business Central as a data retrieval tool. Reports are used to process and/or manipulate the data through the INSERT, MODIFY, or DELETE</p>
<p class="calibre1">functions, with the option of presenting the data in a formatted, printable format. In older versions, data selection could only be done using AL code or DataItem properties to filter individual tables as datasets, and to perform loops to find the data that’s required for the purpose. Then, the query object was created with performance in mind. Instead of multiple calls to SQL to retrieve multiple datasets which would then be manipulated in AL, Queries allow us to utilize familiar Business Central tools to create advanced <b class="calibre3">T-SQL</b> queries. </p>
<p class="calibre1">A Business Central developer can utilize the new query object as a source of data both in Business Central and externally. Some of the external uses of Business Central queries are as follows:</p>
<p class="calibre1">A web service source for SOAP and OData</p>
<p class="calibre1">Feeding data to external reporting tools, such as Excel, SharePoint, and SSRS</p>
<p class="calibre1">Internally, Business Central queries can be used as follows:</p>
<p class="calibre1">A direct data source for charts. </p>
<p class="calibre1">As providers of data to which Cues (displayed in Role Centers) are bound. See</p>
<p class="calibre1">Microsoft Docs:  <i class="calibre4">Walkthrough: Creating a Cue Based on a Normal Field and a</i></p>
<p class="calibre1"> <i class="calibre4">Query</i><a href="https://docs.microsoft.com/en-us/dynamics-nav/walkthrough--creating-a-cue-based-on-a-normal-field-and-a-query"> (https:/​/​docs.​microsoft.​com/​en-​us/​dynamics-​nav/​walkthrough-​-</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics-nav/walkthrough--creating-a-cue-based-on-a-normal-field-and-a-query">creating-​a-​cue-​based-​on-​a-​normal-​field-​and-​a-​query</a>). </p>
<p class="calibre1">As a dataset variable in AL to be accessed by other object types (reports, pages, codeunits, and so on). See <a href="https://docs.microsoft.com/en-us/dynamics-nav/read-function--query-">https:/​/​docs.​microsoft.​com/​en-​us/​dynamics-​nav/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics-nav/read-function--query-">read-​function-​-​query-</a>​ for guidance on using the READ function to consume data from a query. </p>
<p class="calibre1">Query objects are more limited than SQL stored procedures. Queries are more similar to a SQL view. Some compromises in the design of query functionality were made for better performance. Data manipulation is not supported in queries. Variables, subqueries, and dynamic elements, such as building a query based on selective criteria, are not allowed within the query object. </p>
<p class="calibre1"><b class="calibre3">[ 230 ]</b></p>
<p class="calibre1"><a id="calibre_link-132"></a><img src="images/000411.png" alt="Image 244" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">The closest SQL Server objects that queries resemble are SQL views. One of the new features that allow Business Central to generate advanced T-SQL statements is the use of <b class="calibre3">SQL joins</b>. These include the following join methods for two tables, A and B: <b class="calibre3">Inner</b>: This query compares each row of table A with each row of table B to find all the pairs of rows that satisfy the join criteria. </p>
<p class="calibre1"><b class="calibre3">Full outer</b>: This join does not require each record in the two joined tables to have a matching record so that all records from both A and B will appear at least once. </p>
<p class="calibre1"><b class="calibre3">Left outer join</b>: In this join, every record from A will appear at least once, even if matching B is not found. </p>
<p class="calibre1"><b class="calibre3">Right outer join</b>: In this join, every record from B will appear at least once, even if matching A is not found. </p>
<p class="calibre1"><b class="calibre3">Cross join</b>: This join returns the Cartesian product of the sets of rows from A and B. The Cartesian product is a set made up of rows that includes the columns of<br>each row in A, along with the columns of each row in B for a number of rows; in<br>other words, it includes the columns of the rows in A, plus those in B. </p>
<p class="calibre1">Note that union join, which joins all records from A and B without the join<br>criteria, is not available at this time. </p>
<p class="calibre1"><b class="calibre3">Building a simple query</b></p>
<p class="calibre1">Sometimes, it is necessary to quickly retrieve detailed information from one or more ledgers that may contain hundreds of thousands to many millions of records. The query object is the perfect tool for such data selection as it is totally scalable and can retrieve selected fields from multiple tables at once. The following example (using Cronus data) will show the aggregated quantity per bin of lot-tracked items in stock. This query can be presented to a user by means of either a report or a page:</p>
<p class="calibre1">1. We will define the logic we need to follow and the data that’s required to support that logic, and then we will develop the query. It is necessary to know what<br>inventory is in stock, which also contains a lot number. This is accomplished<br>using the <b class="calibre3">Item Ledger Entry</b> table. </p>
<p class="calibre1">2. However, the <b class="calibre3">Item Ledger Entry</b> record does not contain any bin information. </p>
<p class="calibre1">This information is stored in the <b class="calibre3">Warehouse Ledger Entry</b> table. </p>
<p class="calibre1"><b class="calibre3">[ 231 ]</b></p>
<p class="calibre1"><a id="calibre_link-476"></a><img src="images/000432.jpg" alt="Image 245" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">3. The <b class="calibre3">Location Code</b>, <b class="calibre3">Item No. </b>, and <b class="calibre3">Lot No. </b> columns are used to match the <b class="calibre3">Item</b> <b class="calibre3">Ledger Entry</b> and <b class="calibre3">Warehouse Ledger Entry</b> records to make sure that the correct items are selected. </p>
<p class="calibre1">4. To determine which bins are designated as pick bins, the <b class="calibre3">Bin Type</b> records that are marked as <b class="calibre3">Pick</b> is equal to True need to be matched with the bins in</p>
<p class="calibre1"><b class="calibre3">Warehouse Ledger Entry</b>. </p>
<p class="calibre1">5. Lastly, <b class="calibre3">Quantity</b> on each <b class="calibre3">Warehouse Entry</b> needs to be summed per <b class="calibre3">Location</b> <b class="calibre3">Code</b>, <b class="calibre3">Zone Code</b>, <b class="calibre3">Bin Code</b>, <b class="calibre3">Item No. </b>, and <b class="calibre3">Lot No. </b> to show the amount that’s available in each bin. </p>
<p class="calibre1">Now that we have defined the necessary logic and data sources, we can create the desired query object, as follows:</p>
<p class="calibre1">1. In Visual Studio Code, we create a new .al file called query 50100 “Lot</p>
<p class="calibre1">Avail. by Bin”. We use the snippet query and select normal query. </p>
<p class="calibre1">2. Now, we define the primary DataItem. The first DataItem is the Item Ledger</p>
<p class="calibre1">Entry table. We can use IntelliSense to find the correct table. </p>
<p class="calibre1">3. After defining the first DataItem, we will add columns. column is a field from the DataItem table that will be output as an available field from the query dataset. </p>
<p class="calibre1">The other Type option is Filter, which allows us to use the source column as a<br>filter and does not output this column in the dataset. Use IntelliSense to add<br>the Item No. and Lot No. fields under Item Ledger Entry, as shown in the<br>following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 232 ]</b></p>
<p class="calibre1"><a id="calibre_link-372"></a><img src="images/000380.png" alt="Image 246" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">5. The next DataItem we need is the Warehouse_Entry table. We must join it to the Item Ledger Entry by filling in the DataItemLink property. Link the</p>
<p class="calibre1">Location Code, Item No., and Lot No. fields between the two tables, as<br>shown in the following screenshot:</p>
<p class="calibre1">The following steps will define the rest of the DataItems, columns, and filters for this query: 1. Select Entry No., Location Code, Zone Code, Bin Code, and Quantity as<br>columns under the Warehouse Entry DataItem. </p>
<p class="calibre1">2. Add a Bin table as the next DataItem. </p>
<p class="calibre1">3. Set the DataItem Link between the Bin and Warehouse Entry as the Bin table</p>
<p class="calibre1">Code field linked to the Bin Code field for the Warehouse Entry table. </p>
<p class="calibre1">4. Add the BinType table as the last DataItem for this query. Create a DataItem link between the Bin Type table’s Code field and the Bin table’s Bin Type Code<br>field. </p>
<p class="calibre1">5. Set the DataItem filter as Pick = CONST(true) to only show the quantities for bins that are enabled for picking. </p>
<p class="calibre1"><b class="calibre3">[ 233 ]</b></p>
<p class="calibre1"><a id="calibre_link-477"></a><img src="images/000037.jpg" alt="Image 247" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">6. For the dataset that’s returned by the query, we will only want the total quantity per combination of the Location, Zone, Bin, Item, and Lot number. For the<br>column where Quantity is in the Warehouse Entry DataItem, set the Method</p>
<p class="calibre1">Type column to Totals. The Method will default to Sum and the columns above</p>
<p class="calibre1">Quantity will be marked with Group By checked. This shows the grouping<br>criteria for the aggregation of the Quantity field, as shown in the following<br>screenshot:</p>
<p class="calibre1">This query can be utilized internally in Business Central as an indirect data source in a page or a report object. Although DataItems in pages and reports can only be database tables, we can define a query as a variable, and then use the query dataset result to populate a temporary SourceTable. In a page, we set the SourceTableTemporary property to Yes and then load the table via AL code located in the OnOpenPage trigger. </p>
<p class="calibre1"><b class="calibre3">[ 234 ]</b></p>
<p class="calibre1"><a id="calibre_link-373"></a><img src="images/000359.jpg" alt="Image 248" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">In our example, we use the Warehouse Entry table to define our temporary table because it contains all the fields in the query dataset. In the Page Properties, we set the SourceTableTemporary to Yes (if we neglect marking this table as temporary, we are quite likely to corrupt the live data in the Warehouse Entry table). In the OnOpenPage trigger, the query object (LotAvail) is filtered and opened. As long as the query object has a dataset line available for output, the query column values can be placed in the temporary record variable and are available for display, as shown in the following screenshot. Because this code is located in the OnOpenPage trigger, the temporary table is empty when this code begins execution. If the code were to be invoked from another trigger, the</p>
<p class="calibre1">Rec.DELETEALL statement would be needed at the beginning to clear any previously loaded data from the table:</p>
<p class="calibre1"><b class="calibre3">[ 235 ]</b></p>
<p class="calibre1"><a id="calibre_link-374"></a><img src="images/000075.jpg" alt="Image 249" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">As the query dataset is read, the temporary record dataset will be displayed on the page, as shown in the following screenshot:</p>
<p class="calibre1">When a query is used to supply data to a report, the Temporary property is defined to control stepping through the query results. Before the report read loop begins, the query is filtered and invoked so that it begins processing. As long as the query object continues to deliver records, the Temporary DataItem will continue looping. At the end of the query output, the report will proceed to its OnPostDataItem trigger processing, just as though it had completed processing a normal table rather than a query created dataset. This approach is a faster alternative to a design that would use several FlowFields, particularly if those FlowFields were only used in one or two periodic reports. </p>
<p class="calibre1">A similar approach to using a query to supply data to a report is described in Mark Brummel’s blog  <i class="calibre4">Tip #45</i></p>
<p class="calibre1"><a href="https://markbrummel.blog/2015/03/24/tip-45-nav2015-report-temporary-property/">(https://markbrummel.blog/2015/03/24/tip-45-nav2015-report-temporary-property/). </a></p>
<p class="calibre1"><b class="calibre3">[ 236 ]</b></p>
<p class="calibre1"><a id="calibre_link-133"></a><img src="images/000097.jpg" alt="Image 250" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Query and query component properties</b></p>
<p class="calibre1">There are several query properties we should review. Their descriptions follow. </p>
<p class="calibre1"><b class="calibre3">Query properties</b></p>
<p class="calibre1">The properties of the query object can be accessed by highlighting the first empty line after the object name and clicking on  <i class="calibre4">Ctrl</i> + spacebar. The properties of the query we created earlier will look like this:</p>
<p class="calibre1">We’ll review three of these properties:</p>
<p class="calibre1">OrderBy: This provides the capability to define a sort, data column by column, </p>
<p class="calibre1">and ascending or descending, giving the same result as if a key had been defined for the query result, but without the requirement for a key. </p>
<p class="calibre1">TopNumberOfRows: This allows for the specification of the number of data rows<br>that will be presented by the query. A blank or 0 value shows all rows. </p>
<p class="calibre1">Specifying a limit can make the query complete much faster. This property can<br>also be set dynamically from the AL code. </p>
<p class="calibre1">ReadState: This controls the state (committed or not) of data that is included<br>and the type of lock that is placed on the data read. </p>
<p class="calibre1"><b class="calibre3">[ 237 ]</b></p>
<p class="calibre1"><a id="calibre_link-134"></a><img src="images/000122.jpg" alt="Image 251" class="calibre2" /></p>
<p class="calibre1"><img src="images/000144.jpg" alt="Image 252" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">DataItem properties</b></p>
<p class="calibre1">A query line can be one of three types: DataItem, column, and filter. Each has its own property set:</p>
<p class="calibre1">Again, we’ll review a selected subset of these properties:</p>
<p class="calibre1">SqlJoinType: If enabled by the DataItemLinkType property, this property<br>allows the specification of one of five different SQL join types (inner, left outer, right outer, full outer, or cross join). More information is available in the Help sections. Look for the SqlJoinType property and  <i class="calibre4">SQL Advanced Options for Data</i> <i class="calibre4">Item Link Types</i>. </p>
<p class="calibre1">DataItemTableFilter: This provides the ability to define filters that will be<br>applied to the DataItem. </p>
<p class="calibre1"><b class="calibre3">Column properties</b></p>
<p class="calibre1">The following screenshot is a column property screen showing the Bin Code column for our simple query:</p>
<p class="calibre1">The properties shown in the preceding screenshot are as follows:</p>
<p class="calibre1">Method: Can be Sum, Count, Avg, Min, Max, Day, Month, or Year. The result in<br>the column will be based on the appropriate computation. See the  <i class="calibre4">Help</i> section for Method Property for more information. </p>
<p class="calibre1">ReverseSign: This reverses the sign of the column value for numeric data. </p>
<p class="calibre1"><b class="calibre3">[ 238 ]</b></p>
<p class="calibre1"><a id="calibre_link-135"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">ColumnFilter: This allows us to apply a filter to limit the rows in the query<br>result. Filtering here is similar to, but more complicated than, the filtering rules that apply to DataItemTableFilter. Static ColumnFilters can be<br>dynamically overridden and can also be combined with</p>
<p class="calibre1">DataItemTableFilters. See the  <i class="calibre4">Help</i> section for the ColumnFilter property for more detailed information. </p>
<p class="calibre1"><b class="calibre3">Reports</b></p>
<p class="calibre1">Some consider the standard library of reports that’s provided in the Business Central product distribution from Microsoft to be relatively simple in design and limited in its features. Others feel that the provided reports satisfy most needs because they are simple, but flexible. Their basic structure is easy to use. They are made much more powerful and flexible by taking advantage of Business Central’s filtering and SIFT capabilities. There is no doubt that the existing library can be used as a foundation for many of the special reports that customers require to match their own specific business management needs. </p>
<p class="calibre1">The fact is that Business Central’s standard reports are basic. To obtain more complex or more sophisticated reports, we must use features that are part of the product or feed processed data for external reporting tools such as Excel. Through creative use of these features, many different types of complex report logic may be implemented. </p>
<p class="calibre1">We’ll create our reports in this book with Microsoft Word. We’ll examine the data flow of a standard report and the concept of reports, which will be used for processing only (with no printed or displayed output). </p>
<p class="calibre1"><b class="calibre3">What is a report? </b></p>
<p class="calibre1">A <b class="calibre3">report</b> is a vehicle for organizing, processing, and displaying data in a format that’s suitable for outputting to the user. Reports may be displayed on-screen in <b class="calibre3">Preview</b> mode, output to a file in Word, Excel, or PDF format (or, when appropriately designed, output in HTML, CSV, or XML format), emailed to a user (or other consumers of this information), or printed to hard-copy&mdash;the old-fashioned way. All of the report screenshots in this book were taken from <b class="calibre3">Preview</b> mode reports. </p>
<p class="calibre1"><b class="calibre3">[ 239 ]</b></p>
<p class="calibre1"><a id="calibre_link-136"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">Once generated, the data contents of a report are static. When a Business Central report is output in <b class="calibre3">Preview</b> mode, the report can have interactive capabilities. Those capabilities only affect the presentation of the data; they do not change the actual data that’s included in the report dataset. Interactive capabilities include dynamic sorting, visible/hidden options, and detail/summary expand/collapse functions. All of the specifications for the data selection criteria for a report must be done at the beginning of the report run, before the report view is generated. Business Central also allows dynamic functionality so that you can drill down into the underlying data, drill through to a page, and even drill through into another report. </p>
<p class="calibre1">In Business Central, report objects can be classified as processing only, such as report 795</p>
<p class="calibre1">Adjust Cost - Item Entries, by setting the correct report property, that is, by setting the ProcessingOnly property to Yes. A processing only report will not display data to the user&mdash;it will simply process and update data in the tables. Report objects are convenient to use for processing because the report’s automatic <b class="calibre3">read-process-write</b> loop and the built-in request page reduce coding that would otherwise be required. A report can add, change, or delete data in tables, regardless of whether the report is processing only or a typical report that generates output for viewing. </p>
<p class="calibre1">In general, reports are associated with one or more tables. A report can be created without being externally associated with any table, but that is an exception. Even if a report is associated with a particular table, it can freely access and display data from other referenced tables. </p>
<p class="calibre1"><b class="calibre3">Four Business Central report designers</b></p>
<p class="calibre1">Any Business Central report design project uses at least two Report Designer tools. The first is the Report Designer, which is part of the Visual Studio Code development environment. </p>
<p class="calibre1">The second is the developer’s choice of Visual Studio, the SQL Server Report Builder, Microsoft Word. Refer to the Microsoft Dynamics 365 Business Central development environment requirements for more information about the choice of tools for handling RDLC report layouts for Business Central. We must also be careful to make sure that we obtain the proper version of the report tool and that it’s compatible with the Business Central version we are using. The SQL Server Report Builder is installed by default during the Business Central system’s installation. There is also a free version of Visual Studio, the Community Edition, which is available at</p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/visual-studio-community-vs.aspx">https://msdn.microsoft.com/en-us/visual-studio-community-vs.aspx</a>. </p>
<p class="calibre1"><b class="calibre3">[ 240 ]</b></p>
<p class="calibre1"><a id="calibre_link-403"></a><img src="images/000162.png" alt="Image 253" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">For our work, we will use a combination of Visual Studio Code and Microsoft Word. </p>
<p class="calibre1">The option of using Microsoft Word is aimed at the goal of allowing customers to be more self-sufficient in handling quick, simple changes in format while requiring less technical expertise. </p>
<p class="calibre1">The report development process for a Business Central report begins with<br>a data definition in Visual Studio Code. All the data structure, working<br>data elements, data flow, and AL logic are defined there. We must start in</p>
<p class="calibre1">Visual Studio Code to create or modify report objects. Once all of the<br>elements of the dataset definition and request page are in place, the<br>development work proceeds to the SQL Report Builder, Visual Studio, or</p>
<p class="calibre1">Word, where the display layout work is done, including any desired<br>dynamic options. </p>
<p class="calibre1">When a report layout is created, SQL Report Builder or Visual Studio (whichever tool you are using) builds a definition of the report layout in the XML-structured</p>
<p class="calibre1"><b class="calibre3">Report Definition Language Client-Side</b> (<b class="calibre3">RDLC</b>). If Word is used to build a Business Central report layout, the result is a custom XML part that is used to map the data into a report at runtime. </p>
<p class="calibre1">Business Central allows us to create reports of many types with different  <i class="calibre4">look and</i> <i class="calibre4">feel</i> attributes. The consistency of the report’s look and feel does not have the same level of design importance as it has for pages. Patterns may have been developed that relate to reports, so before starting a new format of report, it is best to check if there is an applicable pattern. </p>
<p class="calibre1">Good design practice dictates that enhancements should integrate seamlessly, both in process and appearance, unless there is an overwhelming justification for being different. </p>
<p class="calibre1">There are still many opportunities for reporting creativity. The tools that are available within Business Central to access and manipulate data for reports are very powerful. Of course, there is always the option to output report results to other processing and presentation tools, such as Excel or third-party products. Outputting a report to Excel allows the user to take advantage of the full Excel toolset to further manipulate and analyze the reported data. </p>
<p class="calibre1"><b class="calibre3">[ 241 ]</b></p>
<p class="calibre1"><a id="calibre_link-137"></a><img src="images/000184.png" alt="Image 254" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Business Central report types</b></p>
<p class="calibre1">The standard Business Central application uses only a few of the possible report styles, most of which are in a relatively basic format. The following are the types of reports that are included in Business Central:</p>
<p class="calibre1"><b class="calibre3">List</b>: This is a formatted list of data. A standard list is the <b class="calibre3">Inventory - List</b> report (report 701):</p>
<p class="calibre1"><b class="calibre3">[ 242 ]</b></p>
<p class="calibre1"><a id="calibre_link-328"></a><img src="images/000206.png" alt="Image 255" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Document</b>: This is formatted similarly to a pre-printed form, where a page (or several pages) contains a header, detail, and footer section with dynamic content. </p>
<p class="calibre1">Examples of document reports include customer invoice, packing list (even<br>though it’s called a list, it’s a document report), purchase order, and accounts payable cheque. The following screenshot is a customer <b class="calibre3">Sales-Invoice</b> document report preview:</p>
<p class="calibre1"><b class="calibre3">[ 243 ]</b></p>
<p class="calibre1"><a id="calibre_link-331"></a><img src="images/000231.png" alt="Image 256" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">List and document report types are defined based on their layouts. The following three report types are defined based on their usage rather than their layouts, and are as follows: <b class="calibre3">Transaction</b>: This provides a list of ledger entries for a particular master table. </p>
<p class="calibre1">For example, a Transaction list of Item Ledger entries for all of the items<br>matching a particular criteria, or a list of General Ledger entries for some specific accounts, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 244 ]</b></p>
<p class="calibre1"><a id="calibre_link-329"></a><img src="images/000250.jpg" alt="Image 257" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Test</b>: These reports are printed from journal tables prior to posting the<br>transactions. Test reports are used to pre-validate data before it’s posted. The following screenshot is a <b class="calibre3">Test</b> report for a <b class="calibre3">General Journal - Test</b> batch: <b class="calibre3">Posting</b>: These reports are printed as an audit trail as part of a post and print process. Posting report printing is controlled by the user’s choice of either a <b class="calibre3">Posting Only</b> option or a <b class="calibre3">Post and Print</b> option. The posting portions of both options work the same. Post and print runs a report that is selected in the<br>application’s setup (in the applicable Templates page in columns that are hidden by default). This type of posting audit trail report, which is often needed by<br>accountants, can be regenerated completely and accurately at any time. </p>
<p class="calibre1"><b class="calibre3">[ 245 ]</b></p>
<p class="calibre1"><a id="calibre_link-138"></a><img src="images/000277.jpg" alt="Image 258" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">The default setup uses the same report that you would use as a transaction</p>
<p class="calibre1">(history) report, similar in format to the <b class="calibre3">G/L Register</b> that’s shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Report types summarized</b></p>
<p class="calibre1">The following table describes the different basic types of reports that are available in Business Central:</p>
<p class="calibre1"><b class="calibre3">Type</b></p>
<p class="calibre1"><b class="calibre3">Description</b></p>
<p class="calibre1">List</p>
<p class="calibre1">This is used to list volumes of similar data in a tabular format, such as a list of Sales Order Lines, a list of Customers, or a list of General Ledger Entries. </p>
<p class="calibre1">This is used in  <i class="calibre4">record-per-page header</i> plus  <i class="calibre4">line item detail</i> dual layout Document<br>situations, such as a Sales Invoice, a Purchase Order, a Manufacturing</p>
<p class="calibre1">Work Order, or a Customer Statement. </p>
<p class="calibre1">This generally presents a list of transactions in a nested list format, such as</p>
<p class="calibre1">Transaction<br>a list of General Ledger Entries grouped by G/L Account, Physical</p>
<p class="calibre1">Inventory Journal Entries grouped by Item, or Salesperson To-Do List by</p>
<p class="calibre1">Salesperson. </p>
<p class="calibre1">This prints in a list format as a pre-validation test and data review, prior to</p>
<p class="calibre1">Test<br>a Journal Posting run. A Test Report option can be found on any Journal<br>page, such as the General Journal, Item Journal, or the Jobs Journal. Test<br>reports show errors that must be corrected prior to posting. </p>
<p class="calibre1"><b class="calibre3">[ 246 ]</b></p>
<p class="calibre1"><a id="calibre_link-139"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">This prints in a list format as a record of which data transactions were</p>
<p class="calibre1">Posting<br>posted into permanent status, that is, moved from a journal to a ledger. A</p>
<p class="calibre1">posting report can be archived at the time of original generation or<br>regenerated as an audit trail of posting activity. </p>
<p class="calibre1">Processing</p>
<p class="calibre1">This type of report only processes data and does not generate a report<br>only<br>output. It has the ProcessingOnly report property set to Yes. </p>
<p class="calibre1">Many reports in the standard system don’t fit neatly within the preceding categories, but are variations or combinations. Of course, this is also true of many custom reports. </p>
<p class="calibre1"><b class="calibre3">Report naming</b></p>
<p class="calibre1">Simple reports are often named the same as the table with which they are primarily associated, plus a word or two describing the basic purpose of the report. Common key report purpose names include the words Journal, Register, List, Test, and Statistics. Some examples include <b class="calibre3">General Journal </b>- <b class="calibre3">Test</b>, <b class="calibre3">G/L Register</b>, and <b class="calibre3">Customer</b> - <b class="calibre3">Order Detail</b>. </p>
<p class="calibre1">When there are conflicts between naming based on the associated tables and naming based on the use of the data, the usage context should take precedence in naming reports, just as it does with pages. One absolute requirement for names is that they must be unique; no duplicate names are allowed for a single object type. Remember, the <b class="calibre3">caption</b> (what shows on the printed report heading) is not the same as the <b class="calibre3">name</b> (the internal name of the report object). Each one is a different report property. </p>
<p class="calibre1"><b class="calibre3">Report components &ndash; overview</b></p>
<p class="calibre1">What we generally refer to as the report or report object that’s created with SQL Server Report Builder or Visual Studio Report Designer is technically referred to as an <b class="calibre3">RDLC</b></p>
<p class="calibre1"><b class="calibre3">Report</b>. (From here on out, we will focus on the Visual Studio report layout tool. The tools are somewhat different, but the end results are basically the same.) An RDLC Report includes information that describes the logic to be followed when processing the data (the data model), the dataset structure that is generated by Visual Studio Code, and the output layout that’s designed with Visual Studio. RDLC Reports are stored in the Business Central database. Word report XML layouts are also stored in the Business Central database. </p>
<p class="calibre1">Business Central allows there to be multiple RDLC and Word formats for a single report. </p>
<p class="calibre1">We will use the term “report” when we are referring to the output, the description, or the object. </p>
<p class="calibre1"><b class="calibre3">[ 247 ]</b></p>
<p class="calibre1"><a id="calibre_link-140"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">Reports share some attributes with pages, including aspects of the designer, features of various controls, some of the triggers, and even some of the properties. Where those parallels exist, we should take notice of them. Where there is consistency in the Business Central toolset, it is easier to learn and use. </p>
<p class="calibre1"><b class="calibre3">Report structure</b></p>
<p class="calibre1">The overall structure of a Business Central RDLC Report consists of the following elements: Report properties</p>
<p class="calibre1">Report triggers</p>
<p class="calibre1">Request page:Request page properties</p>
<p class="calibre1">Request page triggers</p>
<p class="calibre1">Request page controls:</p>
<p class="calibre1">Request page control triggers</p>
<p class="calibre1">DataItems:</p>
<p class="calibre1">DataItem properties</p>
<p class="calibre1">DataItem triggers</p>
<p class="calibre1">Data columns:Data column properties</p>
<p class="calibre1">SSRB (RDLC) layout:</p>
<p class="calibre1">SSRB (RDLC) controls:</p>
<p class="calibre1">SSRB (RDLC) control properties</p>
<p class="calibre1">Word layout: Word layout template</p>
<p class="calibre1">Word controls:Word control properties</p>
<p class="calibre1"><b class="calibre3">[ 248 ]</b></p>
<p class="calibre1"><a id="calibre_link-141"></a><img src="images/000298.png" alt="Image 259" class="calibre2" /></p>
<p class="calibre1"><img src="images/000318.png" alt="Image 260" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Report data overview</b></p>
<p class="calibre1">Report components, report properties and triggers, request page properties and triggers, and DataItems and their properties and triggers define the data flow and overall logic for processing the data. Another set of components, Data Fields and working storage<b class="calibre3">, </b> are defined as being subordinate to the DataItems (or request page). These are all designed and defined in Visual Studio Code. </p>
<p class="calibre1">Data Fields are defined in this book as the fields that are contained in the</p>
<p class="calibre1">DataItems (application tables). Working Storage (also referred to as<br>working data or variables) fields are defined in this book as the data<br>elements that are defined within a report (or other object) for use in that<br>object. The contents of working storage data elements aren’t permanently<br>stored in the database. All of these are collectively referred to in the</p>
<p class="calibre1">Business Central  <i class="calibre4">Help</i> as columns. </p>
<p class="calibre1">These components define the data elements that are made available to Visual Studio as a dataset, which will be used in the layout and delivery of results to the user. In addition, labels (text literals) for display can be defined separately from any DataItem, but are also included in the dataset that’s passed to Visual Studio. Labels must be <b class="calibre3">Common Language</b> <b class="calibre3">Specification</b> (<b class="calibre3">CLS</b>) compliant names, which means labels can contain only alpha, decimal, and underscore characters, and must not begin with an underscore. If the report is to be used in a multi-language environment, the CaptionML label must be properly defined to support the alternate languages. </p>
<p class="calibre1">Visual Studio cannot access any data elements that are not defined within<br>the Report Designer. Each data element that’s passed in the dataset, </p>
<p class="calibre1">whether it’s a Data Field or working data, must be associated with a</p>
<p class="calibre1">DataItem (except for labels). </p>
<p class="calibre1">The <b class="calibre3">Report Request</b> page displays when a report is invoked. Its purpose is to allow users to enter information to control the report. Control information that’s entered through a request page may include filters, control dates, other parameters and specifications, as well as formatting or processing options to use for this report run. The request page appears once at the beginning of a report, at runtime. </p>
<p class="calibre1"><b class="calibre3">[ 249 ]</b></p>
<p class="calibre1"><a id="calibre_link-142"></a><img src="images/000336.jpg" alt="Image 261" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">The following screenshot shows a sample request page, the one associated with the <b class="calibre3">CUSTOMER LIST</b> (report 101):</p>
<p class="calibre1"><b class="calibre3">Report layout overview</b></p>
<p class="calibre1">The report layout is designed in Microsoft Word using data elements that are defined in dataset DataItems by the Report Designer, and then made available to Microsoft Word. The report layout includes the page header, body, and page footer. </p>
<p class="calibre1">Within the report body, there can be none, one, or more detail rows. There can also be header and footer rows. The detail rows are the definition of the primary, repeating data display. </p>
<p class="calibre1">All of the report formatting is controlled in Microsoft Word. The font, field positioning, and graphics are all defined as part of the report layout. The same is true for pagination control, headings and footers, some totaling, column-width control, color, and many other display details. </p>
<p class="calibre1">Of course, if the display target changes dramatically, for example, from a desktop workstation display to a browser on a phone, the appearance of the report layout will change dramatically as well. One of the advantages of the Business Central reporting layout toolset is to support the required flexibility. Because we must expect significant variability in our user’s output devices (desktop video, browser, tablet, phone), we should design and test accordingly. </p>
<p class="calibre1"><b class="calibre3">[ 250 ]</b></p>
<p class="calibre1"><a id="calibre_link-143"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Report data flow</b></p>
<p class="calibre1">One of the principal advantages of the Business Central report is its built-in data flow structure. At the beginning of any report, we will define the DataItems (the tables) that the report will process. We can create a processing-only report that has no DataItems (if no looping through database data is required), but that situation often calls for a code unit to be used. In a report, Business Central automatically creates a data flow process for each DataItem or table reference. This automatically-created data flow provides specific triggers and processing events for each DataItem, as follows:</p>
<p class="calibre1">Preceding the DataItem</p>
<p class="calibre1">After reading each record of the DataItem</p>
<p class="calibre1">Following the end of the DataItem</p>
<p class="calibre1">The underlying <b class="calibre3">black-box</b> report logic (the part we can’t see or affect) automatically loops through the named tables, reading and processing one record at a time. Therefore, any time we need a process that steps through a set of data one record at a time, it is often easier to use a report object. </p>
<p class="calibre1">The reference to a database table in a report is referred to as a DataItem. The report data flow structure allows us to nest DataItems to create a hierarchical grandparent, parent, and child structure. If DataItem2 is nested within DataItem1, and related to DataItem1, then for each record in DataItem1, all of the related records in DataItem2 will be processed. </p>
<p class="calibre1">The following example uses tables from our WDTU system. The design is for a report to list all the scheduled instances of a Radio Show Playlist DataItem grouped by Radio</p>
<p class="calibre1">Show, which in turn is grouped by Radio Show Type. Thus, Radio Show Type is the<br>primary table (DataItem1). For each Radio Show Type, we want to list all the Radio Shows of that type (DataItem2). And for each Radio Show, we want to list all the scheduled instances of that show that have been recorded in the Playlist Header</p>
<p class="calibre1">(DataItem3). </p>
<p class="calibre1">Open Visual Studio Code and create a new file with the .al extension called Report 50102 “Demo”. In Object Designer, select the Report object type and click the <b class="calibre3">New</b> button. </p>
<p class="calibre1">On the <b class="calibre3">Report Dataset Designer</b> screen, we will first enter the table name, Radio Show Type (or table number 50101), as we can see in the following screenshot. The DataItem Name, to which the AL code will refer to, is DataItem1 in our example. Then, we will enter the second table, Radio Show, which is automatically indented relative to the DataItem above it, that is, the superior or parent DataItem. This indicates the nesting of the processing of the indented (child) DataItem within the processing of the superior (parent) DataItem. </p>
<p class="calibre1"><b class="calibre3">[ 251 ]</b></p>
<p class="calibre1"><a id="calibre_link-478"></a><img src="images/000360.png" alt="Image 262" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">For our example, we have renamed the DataItems to better illustrate report data flow. The normal behavior would be for the Name in the right column to default to the table name shown in the left column (for example, the name for Radio Show would be &lt;Radio Show&gt; by default). This default DataItem name would only need to be changed if the same table appeared twice within the DataItem list. If there were a second instance of Radio Show, for example, we could simply give it the name RadioShow2, but it would be much better to give it a name describing its purpose in context. </p>
<p class="calibre1">For each record in the parent DataItem, the indented DataItem will be fully processed, dependent on the filters and the defined relationships between the superior and indented tables. In other words, the visible indentation is only part of the necessary parent-child definition. </p>
<p class="calibre1">For our example, we will enter a third table, Playlist Header, and our example name of DataItem3, as shown in the following screenshot:</p>
<p class="calibre1">The following diagram shows the data flow for the preceding DataItem structure. The chart boxes are intended to show the nesting that results from the indentation of the DataItems in the preceding screenshot. The Radio Show DataItem is indented under the Radio Show Type DataItem. This means that for every processed Radio Show Type record, all of the selected Radio Show records will be processed. The same logic applies to the Playlist Header records and Radio Show records, that is, for each Radio Show record processed, all selected Playlist Header records are processed:</p>
<p class="calibre1"><b class="calibre3">[ 252 ]</b></p>
<p class="calibre1"><a id="calibre_link-370"></a><img src="images/000381.png" alt="Image 263" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">The blocks visually illustrate how DataItem nesting controls the data flow. As we can see, the full range of processing for <b class="calibre3">Data Item 2</b> occurs for each <b class="calibre3">Data Item 1</b> record. In turn, the full range of processing for <b class="calibre3">Data Item 3</b> occurs for each <b class="calibre3">Data Item 2</b> record. </p>
<p class="calibre1">In Business Central, report processing occurs in two separate steps: the first tied primarily to what has been designed in Visual Studio Code, and the second tied to what has been designed in Microsoft Word. The data processing that’s represented in the preceding diagram all occurs in the first step, yielding a complete dataset that contains all the data that is to be rendered for output. </p>
<p class="calibre1"><b class="calibre3">[ 253 ]</b></p>
<p class="calibre1"><a id="calibre_link-144"></a><img src="images/000401.jpg" alt="Image 264" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Report components &ndash; detail</b></p>
<p class="calibre1">Earlier, we reviewed a list of the components of a report object. Now, we’ll review detailed information about each of those components. Our goal here is to understand how the pieces of the report puzzle fit together. </p>
<p class="calibre1"><b class="calibre3">Report properties</b></p>
<p class="calibre1">A subset of the Report Designer’s report properties are shown in the following screenshot. </p>
<p class="calibre1">Some of these properties have essentially the same purpose as similarly named properties in pages and other objects:</p>
<p class="calibre1">The properties in the preceding screenshot are defined as follows:</p>
<p class="calibre1">Caption: This is the name that is displayed for this report; Caption defaults to Name. </p>
<p class="calibre1">CaptionML: This is the Caption translation for a defined alternative language. </p>
<p class="calibre1">Description: This is for internal documentation. </p>
<p class="calibre1">UseRequestPage: This can either be Yes or No, and controls whether or not the<br>report will begin with a Request Page so that user parameters can be entered. </p>
<p class="calibre1">UseSystemPrinter: This determines whether the default printer for the report<br>should be the defined system printer, or whether Business Central should check<br>for a setup-defined user/report printer definition. More on user/report printer<br>setup can be found in the Business Central application help. </p>
<p class="calibre1"><b class="calibre3">[ 254 ]</b></p>
<p class="calibre1"><a id="calibre_link-371"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">EnableExternalImages: If Yes, this allows links to external (non-embedded)</p>
<p class="calibre1">images on the report. Such images can be outside the Business Central database. </p>
<p class="calibre1">EnableHyperLinks: If Yes, this allows links to other URLs, including other<br>reports or pages. </p>
<p class="calibre1">EnableExternalAssemblies: If Yes, this allows for the use of external custom<br>functions as part of the report. </p>
<p class="calibre1">ProcessingOnly: This is set to Yes when the report object is being used only to<br>process data and no reporting output is to be generated. If this property is set to Yes, then that overrides any other property selections that would apply in a<br>report-generating situation. </p>
<p class="calibre1">ShowPrintStatus: If this property is set to Yes and the ProcessingOnly<br>property is set to No, then a <b class="calibre3">Report Progress</b> window, including a <b class="calibre3">Cancel</b> button, is displayed. When ProcessingOnly is set to Yes, if we want a <b class="calibre3">Report Progress</b> window, we must create our own dialog box. </p>
<p class="calibre1">TransactionType: This can be in one of four basic options: Browse, Snapshot, </p>
<p class="calibre1">UpdateNoLocks, and Update. These control the record locking behavior that<br>will be applied in this report. The default is UpdateNoLocks. This property is<br>generally only used by advanced developers. </p>
<p class="calibre1">Permissions: This provides report-specific setting of permissions, which are the rights to access data tables, subdivided into Read, Insert, Modify, and Delete. </p>
<p class="calibre1">This allows the developer to define report and processing permissions that<br>override the user-by-user permissions security setup. </p>
<p class="calibre1">PaperSourceFirstPage, PaperSourceDefaultPage, and</p>
<p class="calibre1">PaperSourceLastPage: These give us a choice of paper source tray. </p>
<p class="calibre1">PreviewMode: This specifies the choice of the default <b class="calibre3">Normal</b> or <b class="calibre3">Print Layout</b>, causing the report to open in either the interactive view, allowing for<br>manipulation, or in the fixed format, on which it will appear on a printer. </p>
<p class="calibre1">DefaultLayout: This specifies whether the report will default to using either the Word or the RDLC layout. </p>
<p class="calibre1">WordMergeDataItem: This defines the table on which the outside processing<br>loop will occur for a Word layout, which is equivalent to the first DataItem’s<br>effect on an RDLC layout. </p>
<p class="calibre1">PDFFontEmbedding: This specifies whether the font will be embedded in<br>generated PDF files from the report. </p>
<p class="calibre1"><b class="calibre3">[ 255 ]</b></p>
<p class="calibre1"><a id="calibre_link-145"></a><img src="images/000419.png" alt="Image 265" class="calibre2" /></p>
<p class="calibre1"><img src="images/000440.png" alt="Image 266" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Microsoft Word &ndash; report properties</b></p>
<p class="calibre1">The Word properties window is available from the ribbon on top of the screen:</p>
<p class="calibre1">In the <b class="calibre3">Layout</b> ribbon, we can set <b class="calibre3">Margins</b>, <b class="calibre3">Orientation</b>, and paper <b class="calibre3">Size</b>. Other properties such as <b class="calibre3">Font</b>, styles, and effects can be set directly from the <b class="calibre3">Home</b> ribbon: Another way to access property details is to highlight the element of interest, and then right-click and select the <b class="calibre3">Properties</b> option for that element. This opens up a control-specific <b class="calibre3">Properties</b> window that includes a menu of choices of property categories to access. </p>
<p class="calibre1">In the following screenshot, the <b class="calibre3">Font</b> properties are open, and the available options for the <b class="calibre3">Font</b> properties are displayed:</p>
<p class="calibre1"><b class="calibre3">[ 256 ]</b></p>
<p class="calibre1"><a id="calibre_link-146"></a><img src="images/000009.png" alt="Image 267" class="calibre2" /></p>
<p class="calibre1"><img src="images/000029.jpg" alt="Image 268" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">Some may feel it’s easier to find and change all of the properties’ options here. </p>
<p class="calibre1"><b class="calibre3">Report triggers</b></p>
<p class="calibre1">The following screenshot shows the Report Designer’s report triggers, all of which are available in a report:</p>
<p class="calibre1"><b class="calibre3">[ 257 ]</b></p>
<p class="calibre1"><a id="calibre_link-147"></a><img src="images/000047.jpg" alt="Image 269" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">Descriptions for the report triggers are as follows:</p>
<p class="calibre1">OnInitReport(): This executes once when the report is opened. </p>
<p class="calibre1">OnPreReport(): This executes once after the request page completes. All the</p>
<p class="calibre1">DataItem processing follows this trigger. </p>
<p class="calibre1">OnPostReport(): This trigger executes once at the end of all of the other report processing, if the report completes normally. If the report terminates with an<br>error, this trigger does not execute. All of the DataItem processing precedes this trigger. </p>
<p class="calibre1"><b class="calibre3">Request page properties</b></p>
<p class="calibre1">The request page properties are a subset of page properties, which are covered in detail in</p>
<p class="calibre1"><a href="#calibre_link-91">Chapter 4, </a> <i class="calibre4">Pages &ndash; The Interactive Interface</i>. Usually, most of these properties are not changed, simply because the extra capability is not needed. An exception is the</p>
<p class="calibre1">SaveValues property which, when set to Yes, causes entered values to be retained and redisplayed when the page is invoked another time. A screenshot of a subset of the request page properties follows:</p>
<p class="calibre1"><b class="calibre3">Request page triggers</b></p>
<p class="calibre1">Request pages have a full complement of triggers, thus allowing complex pre-report processing logic. Because of their comparatively simplistic nature, request pages seldom need to take advantage of these trigger capabilities. The following screenshot shows the triggers of a request page:</p>
<p class="calibre1"><b class="calibre3">[ 258 ]</b></p>
<p class="calibre1"><a id="calibre_link-148"></a><img src="images/000066.jpg" alt="Image 270" class="calibre2" /></p>
<p class="calibre1"><img src="images/000088.jpg" alt="Image 271" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">DataItem properties</b></p>
<p class="calibre1">The following screenshot shows the properties of a report DataItem:</p>
<p class="calibre1">The following are descriptions of frequently used report DataItem properties:</p>
<p class="calibre1">DataItemTableView: This is the definition of the fixed limits to be applied to<br>the DataItem (the key, ascending or descending sequence, and what filters to<br>apply to this field). </p>
<p class="calibre1"><b class="calibre3">[ 259 ]</b></p>
<p class="calibre1"><a id="calibre_link-479"></a><img src="images/000113.png" alt="Image 272" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">If we don’t define a key in DataItemTableView, then the users can<br>choose a key to control the data sequence during processing. If we do<br>define a key in the DataItem properties and, in the ReqFilterFields<br>property, we do not specify any filter Fieldnames to be displayed, this</p>
<p class="calibre1">DataItem will not have a FastTab displayed as part of the Request Page. </p>
<p class="calibre1">This will stop the user from filtering this DataItem, unless we provide the<br>capability in AL code. </p>
<p class="calibre1">DataItemLinkReference: This names the parent DataItem to which this one is<br>linked. </p>
<p class="calibre1">DataItemLink: This identifies the field-to-field linkage between this DataItem<br>and its parent DataItem. That linkage acts as a filter because only the records in this table that have a value that matches with the linked field in the parent</p>
<p class="calibre1">DataItem will be processed. If no field linkage filter is defined, all the records in the child table will be processed for each record that’s processed in its parent table. </p>
<p class="calibre1">ReqFilterFields: This property allows us to choose certain fields to be named<br>in the report request page to make it easier for the user to access them as filter fields. So long as the report request page is activated for a DataItem, the user can choose any available field in the table to filter, regardless of what is specified here. </p>
<p class="calibre1">CalcFields: This names the FlowFields that are to be calculated for each record<br>that’s processed. Because FlowFields do not contain data, they have to be<br>calculated to be used. When a FlowField is displayed on a page, Business Central automatically does the calculation. When a FlowField is to be used in a report, </p>
<p class="calibre1">we must instigate the calculation. This can either be done here in this property or explicitly within AL code. </p>
<p class="calibre1">MaxIteration: This can be used to limit the number of iterations the report will make through this DataItem. For example, we would set this to 7 to make the<br>virtual date table process one week’s data. </p>
<p class="calibre1">PrintOnlyIfDetail: This should only be used if this DataItem has a child</p>
<p class="calibre1">DataItem, that is, one indented/nested below it. If PrintOnlyIfDetail is Yes, </p>
<p class="calibre1">then controls associated with this DataItem will only print when data is<br>processed for the child DataItem. </p>
<p class="calibre1">UseTemporary: This specifies that a temporary table is supplying the dataset to<br>populate the columns for this DataItem. </p>
<p class="calibre1"><b class="calibre3">[ 260 ]</b></p>
<p class="calibre1"><a id="calibre_link-149"></a><img src="images/000132.png" alt="Image 273" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">DataItem triggers</b></p>
<p class="calibre1">Each DataItem has the following triggers available:</p>
<p class="calibre1">The DataItem triggers are where most of the flow logic is placed for a report. Developer defined functions may be freely added but, generally, they will be called from within the following three triggers:</p>
<p class="calibre1">OnPreDataItem(): This is the logical place for any preprocessing to take place<br>that can’t be handled in report or DataItem properties or in the two report<br>preprocessing triggers. </p>
<p class="calibre1">OnAfterGetRecord(): This is the data  <i class="calibre4">read and process</i> loop. The code that’s placed here has full access to the data of each record, one record at a time. This trigger is repetitively processed until the logical end of table is reached for this DataItem. This is where we would typically access data in related tables. This<br>trigger is represented on our report data flow diagram as any one of the boxes<br>labeled Data Item processing Loop. </p>
<p class="calibre1">OnPostDataItem(): This executes after all the records in this DataItem are<br>processed, unless the report is terminated by means of a user canceled by<br>execution of an AL BREAK or QUIT function, or by an error. </p>
<p class="calibre1"><b class="calibre3">Creating a report in Business Central</b></p>
<p class="calibre1">Because our Business Central report layouts will all be developed in Microsoft Word, our familiarity with Visual Studio Code will only get us part way to having Business Central report development expertise. We’ve covered most of the basics of the Visual Studio Code part of Business Central report development. Now, we need to dig into the Microsoft Word part. If you are already a Microsoft Word expert, you won’t need to spend much time on this part of the book. If you know little or nothing about the Microsoft Word layout tools, you will need to experiment and practice. </p>
<p class="calibre1"><b class="calibre3">[ 261 ]</b></p>
<p class="calibre1"><a id="calibre_link-150"></a><img src="images/000154.png" alt="Image 274" class="calibre2" /></p>
<p class="calibre1"><img src="images/000180.png" alt="Image 275" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Learn by experimentation</b></p>
<p class="calibre1">One of the most important learning tools available is experimentation. Report development is one area where experimentation will be extremely valuable. We need to know which Report layouts, control settings, and field formats work well for our needs and which do not. The best way to find out is by experimentation. </p>
<p class="calibre1">Create a variety of test reports, beginning with the very simple, and make them<br>progressively more complex. Document what you learn as you make discoveries. You will end up with your own personal report development  <i class="calibre4">Help</i> documentation. Once we’ve created a number of simple reports from scratch, we should modify test copies of some of the standard reports that are part of the Business Central system. </p>
<p class="calibre1">We must always make sure that we are working on test copies, not the<br>originals! </p>
<p class="calibre1">Some reports will be relatively easy to understand, and others that are very complex will be difficult to understand. The more we test, the better we will be able to determine which standard Business Central report designs can be borrowed for our work, and where we are better off starting from scratch. Of course, we should always check to see if there is a pattern that is applicable to the situation that we are working on. </p>
<p class="calibre1"><b class="calibre3">Report building &ndash; phase 1</b></p>
<p class="calibre1">Our goal is to create a report for our WDTU data that will give us a list of all the scheduled radio show instances that have been organized within Radio Show by Radio Show Type, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 262 ]</b></p>
<p class="calibre1"><a id="calibre_link-480"></a><img src="images/000202.jpg" alt="Image 276" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">An easy way to recreate the preceding screenshot is to simply use IntelliSense. Type the letter D in the <b class="calibre3">Code</b> window, enter a name, and then the target table name (in this case, Radio Show Type, then Radio Show, and then Playlist Header). </p>
<p class="calibre1">Before we go any further, let’s make sure we’ve got some test data in our tables. To enter data, we can use the pages we built earlier. The specifics of our test data aren’t critical. We simply need a reasonable distribution of data so that our report test will be meaningful. The following triple screenshot provides an example minimal set of data:</p>
<p class="calibre1"><b class="calibre3">[ 263 ]</b></p>
<p class="calibre1"><a id="calibre_link-321"></a><img src="images/000220.jpg" alt="Image 277" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">Since the Visual Studio Code part of our report design is relatively simple, we can do it as part of our phase 1 effort. It’s simple because we aren’t building any processing logic, and we don’t have any complex relationships to address. We just want to create a nice, neat, nested list of data. </p>
<p class="calibre1">The next step is to define the data fields we want to be available for processing and outputting by Microsoft Word:</p>
<p class="calibre1">Each of the subordinate nested DataItems must be properly linked to its parent DataItem. </p>
<p class="calibre1">The Playlist Header DataItem is joined to the Radio Show DataItem by the “Radio Show No.” and “No.” fields. The Radio Show DataItem is joined to the Radio Show Type DataItem by the “Radio ShowType” and Radio Show Type fields, that is, “Code”. </p>
<p class="calibre1">The Radio Show portion of the dataset that’s returned is limited by setting the</p>
<p class="calibre1">PrintOnlyIfDetail value to true, as shown in the following screenshot. This choice will cause the Radio Show record to not be sent to output for reporting if no subordinate Playlist Header records are associated with that Radio Show:</p>
<p class="calibre1"><b class="calibre3">[ 264 ]</b></p>
<p class="calibre1"><a id="calibre_link-151"></a><img src="images/000246.png" alt="Image 278" class="calibre2" /></p>
<p class="calibre1"><img src="images/000268.png" alt="Image 279" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">The other data that we can pass to Microsoft Word are the labels. Labels will be used later as captions in the report and are enabled for multi-language support. Let’s create a title label that we will hand over the fence to Microsoft Word. Go to the end of the .al file and type L or use  <i class="calibre4">Ctrl</i> + spacebar:</p>
<p class="calibre1">Now that we have our AL dataset definition completed, we should compile, build, and publish our work before doing anything else. Then, before we begin our Microsoft Word work, it’s a good idea to check that we don’t have some hidden error that will get in our way later. The easiest way to do that is just to run what we have now. What we expect to see is a basic <b class="calibre3">Request Page</b> display, allowing us to run a report with no layout defined. </p>
<p class="calibre1"><b class="calibre3">Report building &ndash; phase 2</b></p>
<p class="calibre1">As we mentioned earlier, there are several tools we can use for Business Central report layout development. The specific screen appearance depends somewhat on which tool is being used. </p>
<p class="calibre1"><b class="calibre3">[ 265 ]</b></p>
<p class="calibre1"><a id="calibre_link-481"></a><img src="images/000289.png" alt="Image 280" class="calibre2" /></p>
<p class="calibre1"><img src="images/000308.jpg" alt="Image 281" class="calibre2" /></p>
<p class="calibre1"><img src="images/000328.jpg" alt="Image 282" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">To begin our report development work in Microsoft Word, we must build our AL dataset definition. Then, we need to navigate to the generated Word document and use the right mouse button to select <b class="calibre3">Open Externally</b> to open up Microsoft Word. We will see the following screen:</p>
<p class="calibre1">To design reports with Microsoft Word, the <b class="calibre3">Developer</b> tab needs to be</p>
<p class="calibre1"><a href="#calibre_link-2">exposed, as explained in Chapter 1</a>,  <i class="calibre4">Introduction to Business Central</i>. </p>
<p class="calibre1">On the right-hand side of the screen is the <b class="calibre3">XML Mapping</b>, which can be activated from the <b class="calibre3">Developer</b> ribbon:</p>
<p class="calibre1"><b class="calibre3">[ 266 ]</b></p>
<p class="calibre1"><a id="calibre_link-322"></a><img src="images/000351.png" alt="Image 283" class="calibre2" /></p>
<p class="calibre1"><img src="images/000372.png" alt="Image 284" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">Let’s start by adding the report name to our layout. Expand <b class="calibre3">NavWordReportXMLPart</b> and then expand labels. Right-click on the <b class="calibre3">ReportTitle</b> menu and then click on <b class="calibre3">Insert Content</b> <b class="calibre3">Control</b>, as shown in the following screenshot:</p>
<p class="calibre1">Next, we will add some fields to the page header. First, we will expand two of the categories in the <b class="calibre3">XML Mapping</b> panel, which is on the right-hand side of our layout screen. </p>
<p class="calibre1">The two categories we want to expand are RadioShowType and RadioShow, which contain the data elements that are passed from our report dataset, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 267 ]</b></p>
<p class="calibre1"><a id="calibre_link-152"></a><img src="images/000412.jpg" alt="Image 285" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">At this point, it’s a good time to save our work and test to see what we have done so far: 1. Click on the top-left <b class="calibre3">File</b> menu option, the disc icon, or  <i class="calibre4">Ctrl</i> +  <i class="calibre4">S</i> to save the design as a Word file. </p>
<p class="calibre1">2. Click on the <b class="calibre3">File</b> menu option, then on <b class="calibre3">Exit</b> or the <b class="calibre3">X</b> box at the top-right of the screen (or  <i class="calibre4">Alt</i> +  <i class="calibre4">F4</i>) to return to Visual Studio Code. </p>
<p class="calibre1">3. Build and publish your project. </p>
<p class="calibre1">Now, <b class="calibre3">Run</b> the report. The <b class="calibre3">Preview</b> output should look something like the following: This isn’t especially impressive, but it’s not bad if this is your first try at creating a Business Central report. </p>
<p class="calibre1">We could experiment with various properties of the heading fields, choosing different fonts, bolding, colors, and so on. As we only have a small number of simple fields to display (and could recreate our report if we have to do so), this is a good time to learn more about some of the report appearance capabilities that Microsoft Word provides. </p>
<p class="calibre1"><b class="calibre3">Report building &ndash; phase 3</b></p>
<p class="calibre1">Finally, we are ready to lay out the data display portion of our <b class="calibre3">Radio Shows by Type</b> report. The first step of this phase is to lay out the fields of our controlling DataItem data in such a way that we can properly group the subordinate DataItems’ data. </p>
<p class="calibre1"><b class="calibre3">[ 268 ]</b></p>
<p class="calibre1"><a id="calibre_link-482"></a><img src="images/000433.jpg" alt="Image 286" class="calibre2" /></p>
<p class="calibre1"><img src="images/000002.jpg" alt="Image 287" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">Once again, open the Microsoft Word layout from Visual Studio Code. Put the cursor on a new row at the end of the document and insert a table with two rows and a few columns, as shown in the following screenshot:</p>
<p class="calibre1">Select the second row in the Microsoft Word table and make it a repeater by clicking on the RadioShow DataItem in the XML Mapping pane and selecting <b class="calibre3">Repeating</b>:</p>
<p class="calibre1"><b class="calibre3">[ 269 ]</b></p>
<p class="calibre1"><a id="calibre_link-323"></a><img src="images/000022.png" alt="Image 288" class="calibre2" /></p>
<p class="calibre1"><img src="images/000041.png" alt="Image 289" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">In the second-row columns, we will select the fields from <b class="calibre3">XML Mapping</b>, as shown in the following screenshot:</p>
<p class="calibre1">In the first-row columns, we will add captions. If you want to, you can make the table look nicer by using the design options in the Microsoft Word ribbon:</p>
<p class="calibre1"><b class="calibre3">[ 270 ]</b></p>
<p class="calibre1"><a id="calibre_link-153"></a><img src="images/000060.jpg" alt="Image 290" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">If we save the Word document and publish our solution, we can run the report. The result should look as follows:</p>
<p class="calibre1"><b class="calibre3">Modifying an existing report with Report Designer or</b></p>
<p class="calibre1"><b class="calibre3">Word</b></p>
<p class="calibre1">The basic process we must follow to modify an existing report is the same, regardless of whether the report is one of the standard reports that comes with Business Central or a custom report that we are enhancing in some way. An important discipline to follow in all cases where we are modifying a report that has been in production is  <i class="calibre4">not</i> to work on the original, but on a copy. In fact, if this is a standard report we are customizing, we should leave the original copy alone and do all our work on a copy. Not only is this safer because we will eliminate the possibility of creating problems in the original version, but it will make upgrading easier later on. Even when working on a new custom report, it is good practice to save intermediate copies for backup. This allows you to return to a previous working step should the next development step not go as planned. </p>
<p class="calibre1"><b class="calibre3">[ 271 ]</b></p>
<p class="calibre1"><a id="calibre_link-154"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">While it is certainly possible to add a new layout to an existing dataset without disturbing the original material in Business Central, the potential for a mistake to occur when creating a production problem is why best practice dictates working on a copy, not the original. </p>
<p class="calibre1">Just like report construction, report modification requires the use of two toolsets. Any modification that is done to the processing logic or the definition of the data that’s available for report output must be done using Visual Studio Code. Modification to the layout of a report can be done using Visual Studio, just like we’ve been doing, the SQL Server Report Builder or, when a Word layout is available, using Microsoft Word. Each report can have either or both an RDLC and a Word layout, but for those reports that are unlikely to need modification by a non-programmer, a Word layout will probably not be worth the effort that’s required to create it. </p>
<p class="calibre1">All Business Central report layouts can be modified by a developer using Visual Studio because all standard reports have been developed with RDLC layouts. A small number of standard reports also have Word layouts available in the initial distribution of Business Central. These include reports 1304, 1305, 1306, and 1307. It is likely that future releases of Business Central will have additional report layouts available in Word format. In the meantime, if we want other reports, whether they be standard or custom, to have Word layout options available, we will have to create those ourselves. The primary advantage of having Word layout options for reports is to allow for the modification of the layouts by a trained user or developer using only Word. As the modifications must still conform to good (and correct) report layout practices, appropriate training, careful work, and considerable common sense are needed to make such modifications, even though the tool is Microsoft Word. </p>
<p class="calibre1"><b class="calibre3">Request page</b></p>
<p class="calibre1">A request page is a page that is executed at the beginning of a report. Its presence or absence is under the developer’s control. A request page looks similar to what’s shown in the following screenshot, which is based on one of the standard system reports, that is, the <b class="calibre3">CUSTOMER - ORDER DETAIL</b> report, report 108:</p>
<p class="calibre1"><b class="calibre3">[ 272 ]</b></p>
<p class="calibre1"><a id="calibre_link-325"></a><img src="images/000129.png" alt="Image 291" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">There are three FastTabs in this page. The <b class="calibre3">Customer</b> and <b class="calibre3">Sales Order Line</b> FastTabs are tied to the data tables associated with this report. These FastTabs allow the user to define both data filters and flow filters to control report processing. The <b class="calibre3">Options</b> FastTab exists because the software developer wanted to allow some additional user options for this report. </p>
<p class="calibre1"><b class="calibre3">[ 273 ]</b></p>
<p class="calibre1"><a id="calibre_link-155"></a><img src="images/000151.png" alt="Image 292" class="calibre2" /></p>
<p class="calibre1"><img src="images/000173.jpg" alt="Image 293" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Adding a request page option</b></p>
<p class="calibre1">Because we have defined the default sort sequences (DataItemTableView), except for the first DataItem, and we have not defined any requested filters (ReqFilterFields), the default request page for our report has only one DataItem FastTab. Since we have not defined any processing options that would require user input before the report is generated, we have no <b class="calibre3">Options</b> FastTab. </p>
<p class="calibre1">Our goal now is to allow the user to optionally input text that will be printed at the top of the report. This could be a secondary report heading, instructions on interpreting the report, or some other communications to the report reader. To add this capability, perform the following steps:</p>
<p class="calibre1">1. Open Report 50101 in Visual Studio Code. </p>
<p class="calibre1">2. Add a global variable named UserComment with a data type of Text. We will<br>not define the Length field, as shown in the following screenshot; this will allow the user to enter a comment of any length:</p>
<p class="calibre1">3. Add this variable as a data column to be passed to Visual Studio. The column<br>must be a subordinate of the DataItem. We do not need a caption defined as we<br>will use the variable name for this field in the report layout, as shown in the<br>following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 274 ]</b></p>
<p class="calibre1"><a id="calibre_link-326"></a><img src="images/000195.jpg" alt="Image 294" class="calibre2" /></p>
<p class="calibre1"><img src="images/000215.png" alt="Image 295" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">4. Add the request page to the report, as displayed in the following screenshot: 5. Access Microsoft Word through <b class="calibre3">Open Externally</b>. </p>
<p class="calibre1">6. Add a text box to the layout design surface, just below the report title, stretching the box out as far as the report layout allows. </p>
<p class="calibre1">7. Expand the <b class="calibre3">XML Mapping</b> in the <b class="calibre3">Developer</b> ribbon. </p>
<p class="calibre1">8. Add the UserComment field to the new space, as shown in the following<br>screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 275 ]</b></p>
<p class="calibre1"><a id="calibre_link-327"></a><img src="images/000238.png" alt="Image 296" class="calibre2" /></p>
<p class="calibre1"><img src="images/000261.png" alt="Image 297" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">9. Save the Word document and exit Microsoft Word. Then, publish the project. </p>
<p class="calibre1">10. Run <b class="calibre3">Report 50101</b>. </p>
<p class="calibre1">In the request page, the user can enter their comment, as shown in the following screenshot: The report heading then shows the comment in whatever font, color, or other display attribute the developer has defined:</p>
<p class="calibre1">Because we didn’t specify a maximum length on our UserComment field, we can type in as much information as we want. Try it out; type in an entire paragraph for a test. </p>
<p class="calibre1"><b class="calibre3">[ 276 ]</b></p>
<p class="calibre1"><a id="calibre_link-156"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Processing-only reports</b></p>
<p class="calibre1">One of the report properties we reviewed earlier was <b class="calibre3">ProcessingOnly</b>. If that property is set to Yes, then the report object will not output a dataset for displaying or printing&mdash;it will simply process the data we program it to process. The beauty of this capability is that we can use the built-in processing loop of the Business Central report object, along with its sorting and filtering capabilities, to create a variety of data updating routines with minimal programming. Use of report objects also gives us access to the request page to allow user input and guidance for the run. We could create the same functionality using code unit objects and by programming all of the loops, filtering, user interface request pages, and so on, ourselves. However, with a <b class="calibre3">processing-only</b> report, Business Central gives us a lot of help, and makes it possible to create some powerful routines with minimal effort. </p>
<p class="calibre1">At the beginning of the run of a processing-only report, there is very little user interface variation compared to a normal printing report. The processing-only request page looks much like it would for a printing report, except that the choices to <b class="calibre3">Print</b> and <b class="calibre3">Preview</b> are not available. Everything else looks the same. Of course, we have the big difference of no visible output at the end of processing. </p>
<p class="calibre1"><b class="calibre3">Creative report plagiarism and patterns</b></p>
<p class="calibre1"><a href="#calibre_link-91">In the same fashion as we discussed regarding pages in Chapter 4, </a> <i class="calibre4">Pages &ndash; The Interactive</i> <i class="calibre4">Interface</i>, when we want to create a new report of a type that we haven’t made recently (or at all), it’s a good idea to find another report that is similar in an important way and study it. We should also check if there is a Business Central pattern defined for an applicable category of report. As the minimum, in both of these investigations, we will learn how the developers of Business Central solved a data flow, totaling, or filtering challenge. In the best case, we will find a model that we can follow closely, respectfully plagiarizing (copying) a working solution, thus saving ourselves much time and effort. </p>
<p class="calibre1">Often, it is useful to look at two or three of the standard Business Central reports for similar functions to see how they are constructed. There is no sense in reinventing the design for a report of a particular type when someone else has already invented a version of it. Not only that, but they have provided us with the plans and given us the AL code, as well as the complete structure of the existing report object. </p>
<p class="calibre1"><b class="calibre3">[ 277 ]</b></p>
<p class="calibre1"><a id="calibre_link-157"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">When it comes to modifying a system such as Business Central, plagiarism is a very effective research and design tool. In the case of reports, our search for a model may be based on any of several key elements. We may be looking for a particular data flow approach and find that the Business Central developers used the Integer table for some DataItems (as many reports do). </p>
<p class="calibre1">We may need a way to provide some creative filtering, similar to what is done in an area of the standard product. We might want to provide user options to print either detailed or a couple of different levels of totaling, with a layout that looks good, no matter which choice the user makes. We may be dealing with all three of these design needs in the same report. </p>
<p class="calibre1">In such a case, it is likely that we are using multiple Business Central reports as our models: one for this feature, another for that feature, and so forth. </p>
<p class="calibre1">If we have a complicated, application-specific report to create, we may not be able to directly model our report on a model that already exists. However, often, we can still find ideas in standard reports that we can apply to our new design. We will almost always be better off using a model rather than inventing a totally new approach. </p>
<p class="calibre1">If our design concept is too big a leap from what was done previously, we should consider what we might change in our design so that we can build on the strengths of AL and existing Business Central routines. Creating entirely new approaches may be very satisfying (when it works) but, too often, the extra costs exceed the incremental benefits. </p>
<p class="calibre1"><b class="calibre3">Summary</b></p>
<p class="calibre1">In this chapter, we focused on the structural and layout aspects of Business Central report objects. We studied the primary structural components, data, and format, along with the request page. We also experimented with some of the tools and modestly expanded our WDTU application. </p>
<p class="calibre1">In the next chapter, we will begin exploring the key tools that pull the pieces of the Visual Studio Code developer experience and the AL programming language together. </p>
<p class="calibre1"><b class="calibre3">[ 278 ]</b></p>
<p class="calibre1"><a id="calibre_link-158"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1"><b class="calibre3">Questions</b></p>
<p class="calibre1">1. The following are defined in Visual Studio Code (choose three):</p>
<p class="calibre1">DataItems</p>
<p class="calibre1">Field display editing</p>
<p class="calibre1">Request Page</p>
<p class="calibre1">Database updating</p>
<p class="calibre1">2. Reports can be set to ProcessingOnly status dynamically by AL code. True or<br>false? </p>
<p class="calibre1">3. Reports are fixed displays of data that’s extracted from the system, designed only for hardcopy output. True or false? </p>
<p class="calibre1">4. Business Central report data flow includes a structure that makes “child” </p>
<p class="calibre1">DataItems fully processed for each record that’s processed in the “parent” </p>
<p class="calibre1">DataItem. What is the visible indication that this structure exists in a report</p>
<p class="calibre1">Dataset Designer form (choose one)? </p>
<p class="calibre1">Nesting</p>
<p class="calibre1">Indentation</p>
<p class="calibre1">Linking</p>
<p class="calibre1">5. Queries can be designed to directly feed the Visual Studio Report Designer. True or false? </p>
<p class="calibre1">6. Union Joins are available using a special setup parameter. True or false? </p>
<p class="calibre1">7. A report that only does processing and generates no printed output can be<br>defined. True or false? </p>
<p class="calibre1">8. Which of the following are properties of queries (choose two)? </p>
<p class="calibre1">TopNumberOfRows</p>
<p class="calibre1">FormatAs</p>
<p class="calibre1">OrderBy</p>
<p class="calibre1">FilterReq</p>
<p class="calibre1">9. Business Central has four Report Designers. Reports can be created using any<br>one of these by itself. True or false? </p>
<p class="calibre1">10. Business Central queries can directly generate OData and CSV files and are cloud compatible. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 279 ]</b></p>
<p class="calibre1"><a id="calibre_link-483"></a> <i class="calibre4">Queries and Reports</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 5</i></p>
<p class="calibre1">11. Which of the following are Business Central Report Types (choose three)? </p>
<p class="calibre1">List</p>
<p class="calibre1">Document</p>
<p class="calibre1">Invoice</p>
<p class="calibre1">Posting</p>
<p class="calibre1">12. Queries cannot have multiple DataItems on the same indentation level. True or false? </p>
<p class="calibre1">13. Report formatting in Word has all the capabilities of report formatting in Visual Studio. True or false? </p>
<p class="calibre1">14. Business Central reports can be run for testing directly from Visual Studio<br>with  <i class="calibre4">Alt</i> +  <i class="calibre4">R</i>. True or false? </p>
<p class="calibre1">15. Repeater rows are used in Microsoft Word tables to display multiple records<br>from a dataset. True or false? </p>
<p class="calibre1">16. Queries are used to support what items (choose two)? </p>
<p class="calibre1">Charts</p>
<p class="calibre1">Pages</p>
<p class="calibre1">Cues</p>
<p class="calibre1">Data Sorting</p>
<p class="calibre1">17. Most reports can be initially created using the Report Wizard. True or false? </p>
<p class="calibre1">18. Interactive capabilities that are available after a report is displayed include what (choose two)? </p>
<p class="calibre1">Font definition</p>
<p class="calibre1">Data Show/Hide</p>
<p class="calibre1">Sorting by columns</p>
<p class="calibre1">Data filtering</p>
<p class="calibre1">19. DataItem parent-child relationships that are defined in Visual Studio Code must also be considered in the SQL Server Report Builder in order to have data display properly in a parent-child format. True or false? </p>
<p class="calibre1">20. Users can create Word report layouts based on an existing dataset and put them into production without having access to a Developer’s license. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 280 ]</b></p>
<p class="calibre1"><a id="calibre_link-159"></a>6</p>
<p class="calibre1">Introduction to AL</p>
<p class="calibre1"> <i class="calibre4">“Programs must be written for people to read, and only incidentally for machines to execute.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Harold Abelson and Julie Sussman</i></p>
<p class="calibre1"> <i class="calibre4">“The details are not the details. They make the design.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Charles Eames</i></p>
<p class="calibre1">So far, we have reviewed the basic objects of Business Central, such as tables, data fields, pages, queries, and reports. For each of these, we reviewed triggers in various areas, the purpose of which are to be containers for AL code. When triggers are fired (invoked), the AL code within is executed. </p>
<p class="calibre1">In this chapter, you’ll start learning the AL programming language, though many of the things we will cover you should already know about from your experience programming in other languages. Some of the basic AL syntax and procedure definitions can be found in the Business Central help, as well as in Microsoft Docs for Microsoft Dynamics 365 Business Central. </p>
<p class="calibre1">As with most programming languages, we have considerable flexibility to define our own model for our code structure. However, when we are inserting new code within the existing code, it’s always a good idea to utilize the model and follow the structure that exists in the original code. </p>
<p class="calibre1"><a id="calibre_link-160"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The goal of this chapter is to help us to productively use the development tools and be comfortable in AL. We’ll focus on the tools and processes that we will use the most often. </p>
<p class="calibre1">We will also review concepts that we can apply to more complex tasks down the road. In this chapter, we will cover the following topics:</p>
<p class="calibre1">Understanding Visual Studio Code</p>
<p class="calibre1">AL syntax, operators, and built-in procedures</p>
<p class="calibre1">AL naming conventions</p>
<p class="calibre1">Input/output procedures</p>
<p class="calibre1">Creating custom procedures</p>
<p class="calibre1">Basic process flow structures</p>
<p class="calibre1"><b class="calibre3">Understanding Visual Studio Code</b></p>
<p class="calibre1">With a few exceptions, all of the development for Business Central applications takes place within Visual Studio Code. Exceptions include the use of Microsoft Word (or Microsoft SQL</p>
<p class="calibre1">Server) for reporting, as we saw in <a href="#calibre_link-130">Chapter 5, </a> <i class="calibre4">Queries and Reports</i>, plus the work we may do in the JavaScript language to create compatible add-ins. While it is possible, development using a text editor is only appropriate for special cases, such as making modifications to existing objects, which is done by an advanced developer. </p>
<p class="calibre1">As an <b class="calibre3">Integrated Development Environment</b> (<b class="calibre3">IDE</b>), Visual Studio Code provides us with a rich set of tools for our AL development work. While Visual Studio Code is not as fully featured as Microsoft’s Visual Studio, it is intended to be a cross-platform, modern development toolkit. Most importantly, Visual Studio Code is the most popular IDE and chances are you are already familiar with it. </p>
<p class="calibre1"><b class="calibre3">Explorer</b></p>
<p class="calibre1">All Business Central object development work starts from within Visual Studio Code in the <b class="calibre3">EXPLORER</b>. After opening a project folder, you should be able to see the following screen:</p>
<p class="calibre1"><b class="calibre3">[ 282 ]</b></p>
<p class="calibre1"><a id="calibre_link-484"></a><img src="images/000301.jpg" alt="Image 298" class="calibre2" /></p>
<p class="calibre1"><img src="images/000322.jpg" alt="Image 299" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The type of object that we’ll be working on is chosen by the object definition, which we can view by clicking on one of the files in the menus, as shown in the following screenshot: It is considered a best practice to apply logical naming to your files so that you can see which object type and ID is used without having to open each individual file. </p>
<p class="calibre1"><b class="calibre3">[ 283 ]</b></p>
<p class="calibre1"><a id="calibre_link-161"></a><img src="images/000345.jpg" alt="Image 300" class="calibre2" /></p>
<p class="calibre1"><img src="images/000366.jpg" alt="Image 301" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">Starting a new object</b></p>
<p class="calibre1">When we select <b class="calibre3">New File</b> from the <b class="calibre3">File</b> menu, we get a blank file to create a new object, as shown in the following screenshot:</p>
<p class="calibre1">The fastest way to define a skeleton object is to use snippets. To enable the snippets, we must first save our new file using the .al file extension. </p>
<p class="calibre1">This forces us to think about file naming before defining the object, but we can always rename the file after the object’s declaration is done. </p>
<p class="calibre1">To start using snippets after saving the file, we simply type the letter t and wait for IntelliSense to show the list of available snippets:</p>
<p class="calibre1"><b class="calibre3">[ 284 ]</b></p>
<p class="calibre1"><a id="calibre_link-162"></a><img src="images/000385.jpg" alt="Image 302" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">Once we select a snippet, the cursor automatically takes us to the first variable we have to populate. We can use the  <i class="calibre4">Tab</i> key to move through the fields one by one:</p>
<p class="calibre1"><b class="calibre3">Object designer navigation</b></p>
<p class="calibre1">In many places in the various designers within Visual Studio Code, there are standard keyboard shortcuts available. Some of these are as follows:</p>
<p class="calibre1"> <i class="calibre4">Ctrl</i> +  <i class="calibre4">N</i> to create a new empty file</p>
<p class="calibre1"> <i class="calibre4">Ctrl</i> +  <i class="calibre4">O</i> to open an existing file</p>
<p class="calibre1"> <i class="calibre4">Ctrl</i> + spacebar to access AL IntelliSense, which shows us what we can do for the object that we are working on</p>
<p class="calibre1"> <i class="calibre4">F5</i> to publish the project</p>
<p class="calibre1"> <i class="calibre4">Ctrl</i> +  <i class="calibre4">Shift</i> +  <i class="calibre4">B</i> to do an on-the-fly build (very useful for error checking as we go) <i class="calibre4">Ctrl</i> +  <i class="calibre4">/ </i> to comment or uncomment code and properties</p>
<p class="calibre1"> <i class="calibre4">Ctrl </i>+  <i class="calibre4">X</i>,  <i class="calibre4">Ctrl </i>+  <i class="calibre4">C</i>, and  <i class="calibre4">Ctrl </i>+ <i class="calibre4"> V</i> in normal Windows mode for deletion (or cut), copy, and paste, respectively</p>
<p class="calibre1"><b class="calibre3">[ 285 ]</b></p>
<p class="calibre1"><a id="calibre_link-163"></a><img src="images/000406.png" alt="Image 303" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">We can cut, copy, and paste AL code&mdash;even procedures&mdash;relatively freely<br>within an object, from object to object, or to a text-friendly tool (for<br>example, Word or Excel) much as if we were using a text editor. The<br>source and target objects don’t need to be of the same type. </p>
<p class="calibre1">The easiest way to copy a complete object is to create a new version. You<br>can do this as follows: open the object that you’re working on. Click<br>on <b class="calibre3">File</b> | <b class="calibre3">Save As</b> for the object, assign a new object number, and change the object name (no duplicate object names are allowed). A quick</p>
<p class="calibre1">(mouseless) way to do a <b class="calibre3">Save As</b> is by pressing  <i class="calibre4">Alt </i>+  <i class="calibre4">F</i>, then pressing the  <i class="calibre4">A</i> key&mdash;continuously hold down the  <i class="calibre4">Alt </i> key while pressing first  <i class="calibre4">F</i> and then  <i class="calibre4">A</i>. </p>
<p class="calibre1"><b class="calibre3">Some AL naming conventions</b></p>
<p class="calibre1">In the previous chapters, we discussed naming conventions for tables, pages, and reports. </p>
<p class="calibre1">In general, the naming guidelines for Business Central objects and AL encourage<br>consistency, common sense, and readability. Use meaningful names. These make the system more intuitive to the users and more self-documenting. </p>
<p class="calibre1">When we name variables, we must try to keep the names as self-documenting as possible. </p>
<p class="calibre1">We should differentiate between similar, but different, variable meanings, such as Cost (cost from the vendor) and Amount (selling price to the customer). Embedded spaces, periods, or other special characters should be avoided (even though we find some violations of this in the base product). If we want to use special characters for the benefit of the user, we should put them in the caption, not in the name. If possible, we will stick to letters and numbers in our variable names. We should always avoid Hungarian naming styles (see</p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-6.0/aa260976(v=vs.60)">https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-6</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-6.0/aa260976(v=vs.60)">.0/aa260976(v=vs.60)</a>); keep names simple and descriptive. </p>
<p class="calibre1">There are a number of reasons to keep variable names simple. Other software products that we may interface with may have limitations on variable names. Some special characters have special meanings to other software or in another human language. In Business Central, symbols such as ? and * are wildcards and must be avoided in variable names. </p>
<p class="calibre1">The $ symbol has a special meaning in other software. SQL Server adds its own special characters to Business Central names, and the resultant combinations can get quite confusing (not just to us, but to the software). The same can be said for the names that are constructed by the internal RDLC generator, which replaces spaces and periods with underscores. </p>
<p class="calibre1"><b class="calibre3">[ 286 ]</b></p>
<p class="calibre1"><a id="calibre_link-164"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">When we are defining multiple instances of a table, we should either differentiate clearly by name (for example, Item and NewItem) or by a descriptive suffix (for example, Item, ItemForVarient, and ItemForLocation). In the very common situation where a name is a compound combination of words, begin each abbreviated word with a capital letter (for example, NewCustBalDue). </p>
<p class="calibre1">Avoid creating variable names that are common words that might be reserved words (for example, Page, Column, Number, and Integer). Visual Studio Code will sometimes not warn us that we have used a reserved word, and we may find our logic and the automatic logic working at very mysterious cross purposes. </p>
<p class="calibre1">Do not start variables with a prefix, x, which is used in some automatically created variables, such as xRec. We should make sure that we can clearly differentiate between working storage variable names and the field names originating in tables. Sometimes, Visual Studio Code will allow us to have a global name, local name, and/or record variable name, all with the same literal name. If we do this, we are practically guaranteeing a variable misidentification bug where the compiler uses a different variable than what we intended to be referenced. </p>
<p class="calibre1">When defining a temporary table, preface the name logically, for example, with Temp. In general, use meaningful names that help in identifying the type and purpose of the item being named. When naming a new procedure, we should be reasonably descriptive. Don’t name two procedures that are located in different objects with the same name. It will be too easy to get confused later. </p>
<p class="calibre1">In short, be careful, be consistent, be clear, and use common sense. </p>
<p class="calibre1"><b class="calibre3">Variables</b></p>
<p class="calibre1">As we’ve gone through examples showing various aspects of Visual Studio Code and AL, we’ve seen and referred to variables in a number of situations. Some of the following are obvious, but for clarity’s sake, we’ll summarize them here. </p>
<p class="calibre1"><a href="#calibre_link-68">In Chapter 3</a>,  <i class="calibre4">Data Types and Fields</i>, we reviewed various data types for variables that are</p>
<p class="calibre1"><a href="#calibre_link-68">defined within objects (referred to in Chapter 3, </a> <i class="calibre4">Data Types and Fields</i>, as working storage data). Working storage consists of all of the variables that are defined for use within an object, but whose contents disappear when the object closes. Working storage data types, as discussed in <a href="#calibre_link-68">Chapter 3</a>,  <i class="calibre4">Data Types and Fields</i>, are those that can be defined in either the AL</p>
<p class="calibre1">global variables or AL local variables tabs. Variables can also be defined in several other places in a Business Central object. </p>
<p class="calibre1"><b class="calibre3">[ 287 ]</b></p>
<p class="calibre1"><a id="calibre_link-165"></a><img src="images/000427.png" alt="Image 304" class="calibre2" /></p>
<p class="calibre1"><img src="images/000451.png" alt="Image 305" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">AL Globals</b></p>
<p class="calibre1">Global variables are defined on the var section of each object in AL. </p>
<p class="calibre1">Global variables should be avoided. Dynamics Business Central legacy<br>code has inherited many of them from the MS-DOS era of the product</p>
<p class="calibre1">(called Navision or Navigator) when local variables were not available. </p>
<p class="calibre1">Global text constants are defined as variables. The primary purpose of the text constants area is to allow for easier translation of messages from one language to another. By putting all message text in this one place in each object, a standardized process can be defined for language translation. </p>
<p class="calibre1">Procedures are most often defined at the end of an AL file. The following screenshot provides an example of this:</p>
<p class="calibre1"><b class="calibre3">AL Locals</b></p>
<p class="calibre1">Local identifiers only exist if they’re defined within the range of a procedure or trigger. This is true if the trigger is a developer-defined procedure, one of the default system triggers, or a standard application-supplied procedure. </p>
<p class="calibre1">Procedure-local identifiers and return values are declared in the definition of the procedure. </p>
<p class="calibre1"><b class="calibre3">[ 288 ]</b></p>
<p class="calibre1"><a id="calibre_link-166"></a><img src="images/000014.png" alt="Image 306" class="calibre2" /></p>
<p class="calibre1"><img src="images/000038.png" alt="Image 307" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The <b class="calibre3">Variables</b> and <b class="calibre3">Text Constants</b> tabs for <b class="calibre3">AL Locals</b> are the same in use to the <b class="calibre3">AL</b></p>
<p class="calibre1"><b class="calibre3">Globals</b> when using the var keyword. The declaration of the <b class="calibre3">AL Locals</b> form can be seen in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Special working storage variables</b></p>
<p class="calibre1">Some working storage variables have additional attributes to be considered. </p>
<p class="calibre1"><b class="calibre3">Temporary tables</b></p>
<p class="calibre1">Temporary tables were discussed in <a href="#calibre_link-38">Chapter 2</a>,  <i class="calibre4">Tables</i>. Let’s take a quick look at how one is defined. Defining a temporary table begins just like any other variable definition of the Record data type. To make it temporary, we add the temporary keyword after the table name, as shown in the following screenshot:</p>
<p class="calibre1">We can use a temporary table just as though it were a permanent table, with some specific differences:</p>
<p class="calibre1">The table only contains the data we add to it during this instance of the object in which it resides. </p>
<p class="calibre1">We cannot change any aspect of the definition of the table, except by changing<br>the permanent table. </p>
<p class="calibre1"><b class="calibre3">[ 289 ]</b></p>
<p class="calibre1"><a id="calibre_link-316"></a><img src="images/000058.png" alt="Image 308" class="calibre2" /></p>
<p class="calibre1"><img src="images/000079.png" alt="Image 309" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">Processing for a temporary table is done wholly in the client system, in a user-</p>
<p class="calibre1">specific instance of the business logic. It is, therefore, inherently a single user. </p>
<p class="calibre1">A properly utilized temporary table reduces network traffic and eliminates any<br>locking issues for that table. It is often much faster than processing the same data in a permanent database-resident table because both data transmission and<br>physical storage I/O are significantly reduced. </p>
<p class="calibre1">In some cases, it’s a good idea to copy the database table data into a<br>temporary table for repetitive processing within an object. This can give<br>us a significant speed advantage for a particular task by updating data in<br>the temporary table, then copying it back out to the database table at the<br>end of processing. </p>
<p class="calibre1">When using temporary tables, we need to be very careful that references<br>from the AL code in the temporary table, such as data validations, don’t<br>inappropriately modify permanent data elsewhere in the database. We<br>must also remember that, if we forget to properly mark the table as<br>temporary, we will likely corrupt production data with our processing. </p>
<p class="calibre1"><b class="calibre3">Arrays</b></p>
<p class="calibre1">Arrays of up to 10 dimensions containing up to a total of 1,000,000 elements in a single variable can be created in a Business Central object. Defining an array is done simply by setting the Array keyword of a variable. An example is shown in the following screenshot, which defines a record array of three rows, with 99 elements in each row:</p>
<p class="calibre1">The comma separates the dimensions of the array. The numbers indicate the maximum number of elements of each of the dimensions. An array variable such as</p>
<p class="calibre1">TotalCountArray is referred to in AL as follows:</p>
<p class="calibre1">The 15th entry in the first row is TotalCountArray[1,15]</p>
<p class="calibre1">The last entry in the last row is TotalCountArray[3,99]</p>
<p class="calibre1"><b class="calibre3">[ 290 ]</b></p>
<p class="calibre1"><a id="calibre_link-383"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">An array of a complex data type, such as a record, may behave differently than a single instance of the data type, especially when passed as a parameter to a procedure. In such a case, we must make sure that the code is thoroughly tested so that we aren’t surprised by unexpected results. </p>
<p class="calibre1"><b class="calibre3">Initialization</b></p>
<p class="calibre1">When an object is initiated, the variables in that object are automatically initialized. </p>
<p class="calibre1">Booleans are set to False. Numeric variables are set to zero. Text and code data types are set to the empty string. Dates are set to 0D (the undefined date) and times are set to 0T (the undefined time). The individual components of complex variables are appropriately initialized. The system also automatically initializes all system-defined variables. </p>
<p class="calibre1">Of course, once the object is active, through our code and property settings, we can do whatever additional initialization we wish. If we wish to initialize variables at intermediate points during processing, we can use any of several approaches. First, we will reset a Record variable (for example, the TempRadioShowLedger temporary table defined in the preceding example) with the RESET procedure, then initialize it with the INIT procedure in statements in the form, as follows:</p>
<p class="calibre1">TempRadioShowLedger.RESET; </p>
<p class="calibre1">TempRadioShowLedger.INIT; </p>
<p class="calibre1">The RESET procedure makes sure that all of the previously set filters on this table are cleared. The INIT procedure makes sure that all of the fields, except those in the primary key, are set either to their InitValue, property value or to their data type default value. </p>
<p class="calibre1">The primary key fields must be explicitly set by the AL code. </p>
<p class="calibre1">For all types of data, including complex data types, we can initialize fields with the CLEAR</p>
<p class="calibre1">or CLEARALL procedure in a statement in the following form:</p>
<p class="calibre1">CLEAR(TotalArray[1,1]); </p>
<p class="calibre1">CLEAR(TotalArray); </p>
<p class="calibre1">CLEAR(“Shipment Code”); </p>
<p class="calibre1">The first example would clear a single element of the array&mdash;the first element in the first row. Since this variable is an Integer data type, the element would be set to Integer zero when cleared. The second example would clear the entire array. In the third example, a variable defined as a Code data type would simply be set to an empty string. </p>
<p class="calibre1"><b class="calibre3">[ 291 ]</b></p>
<p class="calibre1"><a id="calibre_link-167"></a><img src="images/000098.png" alt="Image 310" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">System-defined variables</b></p>
<p class="calibre1">Business Central also provides us with some variables automatically, such as Rec, xRec, CurrPage, CurrReport, and CurrXMLport. What variables are provided is dependent on the object that we are operating on. Descriptions of some of these can be found in the help titled  <i class="calibre4">System-Defined Variables</i></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics-nav/system-defined-variables">(https://docs.microsoft.com/en-us/dynamics-nav/system-defined-variables</a>). </p>
<p class="calibre1"><b class="calibre3">AL programming</b></p>
<p class="calibre1">Many of the things that we do during development in Visual Studio Code might not be called programming by some people as it doesn’t involve writing AL code statements. </p>
<p class="calibre1">However, so long as these activities contribute to the definition of the object and affect the processing that occurs, we’ll include them in our broad definition of AL programming. </p>
<p class="calibre1">These activities include setting properties at the object and DataItem levels, creating request pages in reports, defining controls and their properties, defining report data structures and their properties, creating source expressions, defining procedures, and, of course, writing AL statements in all of the places where we can put AL. We will focus on programming primarily as it relates to tables, reports, and codeunits. </p>
<p class="calibre1">We will touch on programming for pages and XMLports. In the case of reports, AL</p>
<p class="calibre1">statements can reside only in the components that are developed within the report designer. </p>
<p class="calibre1">Business Central objects are generally consistent in structure. Most have some properties and triggers. Pages and reports have controls, though the tools that define the controls in each are specific to the individual object type. Reports have a built-in DataItem looping logic. XMLports also have DataItem looping logic, but those are structured differently from reports; for example, reports can have multiple DataItems at 0 level and XMLports can only have one node at 0 level. All of the object types that we are considering can contain AL code in one or more places. All of these can contain procedure definitions that can be called either internally or externally (if not marked as local). Remember, good design practice says that any procedures designed as a  <i class="calibre4">library</i> or reusable procedures that are called from a variety of objects should be placed in a codeunit or, in some circumstances, in the primary table. </p>
<p class="calibre1">Don’t forget that our fundamental coding work should focus on tables and<br>procedure libraries as much as possible, as these are the foundation of the</p>
<p class="calibre1">Business Central system. </p>
<p class="calibre1"><b class="calibre3">[ 292 ]</b></p>
<p class="calibre1"><a id="calibre_link-168"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">Non-modifiable procedures</b></p>
<p class="calibre1">A procedure is a defined set of logic that performs a specific task. Similar to many other programming languages, AL includes a set of prewritten procedures that are available to us to perform a wide variety of different tasks. The underlying logic for some of these procedures is hidden and not modifiable. These non-modifiable procedures are supplied as part of the AL programming language. Some simple examples of non-modifiable<br>procedures are as follows:</p>
<p class="calibre1">DATE2DMY: Supply a date to this procedure and, depending on a calling<br>parameter, it will return the integer value of the day, month, or year of that date STRPOS: Supply a string variable and a string constant to this procedure and it<br>will return the position of the first instance of that constant within the variable, or a zero, if the constant is not present in the string that’s contained in the variable GET: Supply a value and a table to this procedure and it will read the record in the table with a primary key value equal to the supplied value if a matching<br>record exists</p>
<p class="calibre1">INSERT: This procedure will add a record to a table</p>
<p class="calibre1">MESSAGE: Supply a string and optional variables and this procedure will display<br>a message to the operator</p>
<p class="calibre1">Such procedures are the heart of AL tools. There are over one hundred of them. On the whole, they are designed around the essential purpose of a Business Central<br>system&mdash;business and financial applications data processing. These procedures are not modifiable; they operate according to their predefined rules. For development purposes, they act as basic language components. </p>
<p class="calibre1"><b class="calibre3">Modifiable procedures</b></p>
<p class="calibre1">In addition to the prewritten language component procedures, there are a large number of prewritten application component procedures. The difference between the two types is that the code implementing the latter is visible and modifiable through cloning, though we should be extremely cautious about making such clones. </p>
<p class="calibre1">An example of an application component procedure might be one to handle the task of processing a customer’s shipping address to eliminate empty lines and standardize the layout based on user-defined setup parameters. Such a procedure would logically be placed in a codeunit and hence made available to any routine that needs this capability. </p>
<p class="calibre1"><b class="calibre3">[ 293 ]</b></p>
<p class="calibre1"><a id="calibre_link-169"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">In fact, this procedure exists. It is called SalesHeaderShipTo and is located in the Format Address codeunit. We can explore the following codeunits for some procedures we might find useful to use or that we can borrow logic from. This is not an all-inclusive list, as there are many procedures in other codeunits that we may find useful in a future development project, either to be used directly or as templates to design our own, similar procedure. </p>
<p class="calibre1">Many library codeunits have the words Management or Mgt in their name:</p>
<p class="calibre1"><b class="calibre3">Object number</b></p>
<p class="calibre1"><b class="calibre3">Name</b></p>
<p class="calibre1">356</p>
<p class="calibre1">DateComprMgt</p>
<p class="calibre1">358</p>
<p class="calibre1">DateFilter-Calc</p>
<p class="calibre1">359</p>
<p class="calibre1">PeriodFormManagement</p>
<p class="calibre1">365</p>
<p class="calibre1">Format Address</p>
<p class="calibre1">397</p>
<p class="calibre1">Mail</p>
<p class="calibre1">5052</p>
<p class="calibre1">AttachmentManagement</p>
<p class="calibre1">5054</p>
<p class="calibre1">WordManagement</p>
<p class="calibre1">6224</p>
<p class="calibre1">XML DOM Management</p>
<p class="calibre1">The prewritten application procedures, generally, have been provided to address the needs of the Business Central developers working at Microsoft. However, we can use them too. </p>
<p class="calibre1">Our challenge will be to find out whether they exist and to understand how they work. </p>
<p class="calibre1">There is very little documentation of these application component procedures. A</p>
<p class="calibre1">feature has been added to the AL editor to help us in our review of such procedures. If we highlight the procedure reference in the in-line code and right-click it, we are given the option to <b class="calibre3">Go to definition</b>. This allows us to easily find the procedure’s code and review it. </p>
<p class="calibre1">One significant aspect of these application procedures is the fact that they are written in AL, and their construction is totally exposed. In theory, they can be cloned, though this is not advisable. If we decide to change one of these procedures, we should choose events. </p>
<p class="calibre1">If no events exist, we can either request events or, much better, clone them into our own library codeunit, creating a new version and making any modifications to the new version while leaving the original untouched. </p>
<p class="calibre1"><b class="calibre3">Custom procedures</b></p>
<p class="calibre1">We can also create our own custom procedures to meet any need. The most common reason to create a new procedure is to provide a single, standardized instance of logic to perform a specific task. When we need to use the same logic in more than one place, we should consider creating a callable procedure. </p>
<p class="calibre1"><b class="calibre3">[ 294 ]</b></p>
<p class="calibre1"><a id="calibre_link-170"></a><img src="images/000123.png" alt="Image 311" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">We should also create a new procedure when we’re modifying standard Business Central processes through events. Our procedure then becomes an event subscriber. </p>
<p class="calibre1">If a new procedure is going to be used in several objects, it should be housed in our library codeunit (we may choose to have multiple library codeunits for the purpose of clarity or project management). If a new procedure is only for use in a single object, then it can be resident in that object. This latter option also has the advantage of allowing the new procedure direct access to the global variables within the object being modified, if necessary. </p>
<p class="calibre1"><b class="calibre3">Creating a procedure</b></p>
<p class="calibre1">Let’s take a quick look at how a procedure can be created. We’ll use the small date formula app we created in <a href="#calibre_link-68">Chapter 3, </a> <i class="calibre4">Data Types and Fields</i>, and add a new codeunit, Codeunit 50141. We will call it Date Formula Management. </p>
<p class="calibre1">When working on projects with larger teams, creating more codeunits is<br>advised so that you have a better chance of each developer working on<br>separate objects. </p>
<p class="calibre1">We will create our new codeunit by simply clicking on <b class="calibre3">New File</b> in the <b class="calibre3">File</b> menu, then choosing <b class="calibre3">File | Save As</b>, and entering Codeunit 50141 Date Formula Mgt. We will select the codeunit snippet and populate the variables. </p>
<p class="calibre1">Now comes the important part&mdash;designing and coding our new procedure. When we had the procedure operating as a local procedure inside the table where it was called, we didn’t worry about passing data back and forth. We simply used the data fields that were already present in the table and treated them as global variables, which they were. Now that our procedure will be external to the object that it was called from, we have to pass data values back and forth. Here’s the basic calling structure of our procedure:</p>
<p class="calibre1">Output := Procedure (Input Parameter1, Input Parameter2)</p>
<p class="calibre1">In other words, we need to feed two values into our new callable procedure and accept a Return value on completion of the procedure being processed. </p>
<p class="calibre1"><b class="calibre3">[ 295 ]</b></p>
<p class="calibre1"><a id="calibre_link-485"></a><img src="images/000145.png" alt="Image 312" class="calibre2" /></p>
<p class="calibre1"><img src="images/000166.png" alt="Image 313" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The result of the function should be similar to the following:</p>
<p class="calibre1">Press  <i class="calibre4">Ctrl</i> +  <i class="calibre4">Shift</i> +  <i class="calibre4">B</i> to check whether we have a clean build. If we get an error, we must do the traditional programmer thing: find it, fix it, and rebuild. Repeat until we get a clean build. </p>
<p class="calibre1">Finally, we will return Table 50140 to our test to complete the changes that are necessary so that we can use the external procedure rather than the internal procedure. We have two obvious choices for doing this. One is to replace the internal formula in our existing internal procedure with a call to our external procedure. This approach results in fewer object changes. </p>
<p class="calibre1">The other choice is to replace each of our internal procedure calls with a call to the external procedure. This approach may be more efficient at runtime because, when we need the external procedure, we will invoke it in one step rather than two. We will walk through the first option here and then you should try the second option on your own. </p>
<p class="calibre1">Which option is the best? It depends on our criteria. Such a decision comes down to a matter of identifying the best criteria on which to judge the design options, then applying that criteria. Remember, whenever feasible, simple is good. </p>
<p class="calibre1">For the first approach (calling our new codeunit resident procedure), we must add our new Codeunit 50141 Date Formula Mgt variable to Table 50140. After designing the<br>table, navigate to the procedure and add a new line between the procedure declaration and the Begin keyword. Add the local variable, as shown in the following screenshot (it’s good practice to define variables as local unless global access is required):</p>
<p class="calibre1"><b class="calibre3">[ 296 ]</b></p>
<p class="calibre1"><a id="calibre_link-171"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The two lines of code that called the internal procedure, CalculateNewDate, must be changed to call the external procedure. The syntax for that call is as follows:</p>
<p class="calibre1">Global/LocalVariable :=</p>
<p class="calibre1">Global/LocalObjectName.ProcedureName(Parameter1,Parameter2,…). </p>
<p class="calibre1">Based on that, the new line of code should be as follows:</p>
<p class="calibre1">“Date Result” := DateFormMgt.CalculateNewDate(“Date Formula to</p>
<p class="calibre1">Test”,“Reference Date for Calculation”); </p>
<p class="calibre1">If all has gone well, we should be able to build our application. When that step works successfully, we can run the page and experiment with different reference dates and date formulas, just like we did back in Chapter 3,  <i class="calibre4">Data Types and Fields</i>. We should get the same results for the same entries that we saw before. </p>
<p class="calibre1">When you try out the other approach of replacing each of the calls to the internal procedure by directly calling the external procedure, you will want to do the following:</p>
<p class="calibre1">Either define the Date Formula Management codeunit as a global variable or as<br>a local variable for each of the triggers where you are calling the external<br>procedure</p>
<p class="calibre1">Delete the now unused internal CalculateNewDate procedure</p>
<p class="calibre1">We should now have a better understanding of the basics of constructing both internal and external procedures and some of the optional design features that are available to us for building procedures. </p>
<p class="calibre1"><b class="calibre3">AL syntax</b></p>
<p class="calibre1">AL syntax is relatively simple and straightforward. The basic structure of most AL</p>
<p class="calibre1">statements is essentially similar to what you learned with other programming languages. </p>
<p class="calibre1">AL is modeled on Pascal and tends to use many of the same special character and syntax practices as Pascal. </p>
<p class="calibre1"><b class="calibre3">[ 297 ]</b></p>
<p class="calibre1"><a id="calibre_link-172"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">Assignment and punctuation</b></p>
<p class="calibre1">Assignment is represented with a colon followed by an equal sign, the combination being treated as a single symbol. The evaluated value of the expression, to the right of the assignment symbol, is assigned to the variable on the left-hand side, as shown in the following line of code:</p>
<p class="calibre1">“Phone No.” := ‘312-555-1212’; </p>
<p class="calibre1">All statements are terminated with a semicolon. Multiple statements can be placed on a single program line, but that makes the code hard for others to read. </p>
<p class="calibre1">Fully qualified data fields are prefaced with the name of the record variable that they are a part of (see the preceding code line as an example of where the record variable is named Phone No.). The same structure applies to fully qualified procedure references; the procedure name is prefaced with the name of the object that they are defined in. </p>
<p class="calibre1">Single quotes are used to surround string literals (see the phone number string in the preceding line of code). </p>
<p class="calibre1">Double quotes are used to surround an identifier (for example, a variable or a procedure name) that contains any character other than numerals or upper and lowercase letters. For example, the Phone No. field name in the preceding line of code is constructed as “Phone No.” because it contains a space and a period. Other examples would be “Post Code” (contains a space), “E-Mail” (contains a dash), and “No.” (contains a period). </p>
<p class="calibre1">Parentheses are used much the same as in other language&mdash;to indicate sets of expressions that will be interpreted according to their parenthetical groupings. The expressions are interpreted in sequence, first by the innermost parenthetical group, then the next level, and so forth. The expression  <i class="calibre4">(A / (B + (C * (D + E))))</i> would be evaluated as follows: 1. Summing ( <i class="calibre4">D</i> +  <i class="calibre4">E)</i> into Result1. </p>
<p class="calibre1">2. Multiplying Result1 times  <i class="calibre4">C</i>, yielding Result2. </p>
<p class="calibre1">3. Adding Result2 to  <i class="calibre4">B</i>, yielding Result3. </p>
<p class="calibre1">4. Dividing  <i class="calibre4">A</i> by Result3. </p>
<p class="calibre1"><b class="calibre3">[ 298 ]</b></p>
<p class="calibre1"><a id="calibre_link-173"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">Brackets [ ] are used to indicate the presence of subscripts for indexing array variables. A text string can be treated as an array of characters, and we can use subscripts with the string name to access individual character positions within the string, but not beyond the terminating character of the string. For example, Address[1] represents the leftmost character in the Address text variable contents. </p>
<p class="calibre1">Brackets are also used for IN (in range) expressions, as shown in the following code snippet:</p>
<p class="calibre1">Boolean := SearchValue IN[SearchTarget]</p>
<p class="calibre1">In this line, SearchValue and SearchTarget are text variables. </p>
<p class="calibre1">Statements can be continued on multiple lines without any special punctuation; however, we can’t split a variable or literal across two lines. Because the AL code editor limits lines to 132 characters long, this capability is often used. The following example shows two instances that are interpreted in exactly the same manner by the compiler:</p>
<p class="calibre1">ClientRec.“Phone No.” := ‘312’ + ‘-‘ + ‘555’ + ‘-‘ + ‘1212’; </p>
<p class="calibre1">ClientRec.“Phone No.” := ‘312’ +</p>
<p class="calibre1">‘-‘ + ‘555’ +</p>
<p class="calibre1">‘-‘ + ‘1212’; </p>
<p class="calibre1"><b class="calibre3">Expressions</b></p>
<p class="calibre1">Expressions in AL are made up of four elements&mdash;constants, variables, operators, and procedures. We could include a fifth element, expressions, because an expression may include a subordinate expression within it. As we become more experienced in coding AL, we will find that the capability of nesting expressions can be both a blessing and a curse, depending on the specific use and readability of the result. </p>
<p class="calibre1">We can create complex statements that will conditionally perform important control actions and operate in much the same way that a person would think about a task. We can also create complex statements that are very difficult for a person to understand. These are tough to debug and sometimes almost impossible to deal with in a modification. </p>
<p class="calibre1">One of our responsibilities is to be able to tell the difference so that we can write code that makes sense in operation, but is also easy to read and understand. </p>
<p class="calibre1"><b class="calibre3">[ 299 ]</b></p>
<p class="calibre1"><a id="calibre_link-174"></a><img src="images/000185.png" alt="Image 314" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">According to the Business Central Docs, an AL expression</p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/library/dd301381(v=nav.90).aspx">(https://msdn.microsoft.com/en-us/library/dd301381(v=nav.90).aspx) is a group of</a></p>
<p class="calibre1">characters (data values, variables, arrays, operators, and procedures) that can be evaluated with the result that has an associated data type. The following are two code statements that accomplish the same result in slightly different ways. They each assign a literal string to a text data field. In the first one, the right-hand side is a literal data value. In the second, the right-hand side of the := assignment symbol is an expression:</p>
<p class="calibre1">ClientRec.“Phone No.” := ‘312-555-1212’; </p>
<p class="calibre1">ClientRec.“Phone No.” := ‘312’ + ‘-‘ + ‘555’ + ‘-‘ + ‘1212’; </p>
<p class="calibre1"><b class="calibre3">Operators</b></p>
<p class="calibre1">Now, we’ll review AL operators grouped by category. Depending on the data types we are using with a particular operator, we may need to know the type conversion rules by defining the allowed combinations of operator and data types for an expression. The Business Central docs provides good information on type conversion rules. Search for the phrase type Conversion to learn more. </p>
<p class="calibre1">Before we review the operators that can be categorized, let’s discuss some operators that don’t fit well into any of the categories. These include the following:</p>
<p class="calibre1"><b class="calibre3">[ 300 ]</b></p>
<p class="calibre1"><a id="calibre_link-364"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">Explanations regarding the use of the operator symbols in the preceding table are as follows:</p>
<p class="calibre1">The symbol represented by a single dot or period doesn’t have a given name in<br>the Business Central documentation, so we’ll call it the member symbol or dot<br>operator (as it is referred to in the MSDN Visual Basic Developer<br>documentation). It indicates that a field is a member of a table</p>
<p class="calibre1">(TableName.FieldName), a control is a member of a page</p>
<p class="calibre1">(PageName.ControlName) or report (ReportName.ControlName), or a<br>procedure is a member of an object (Objectname.ProcedureName). </p>
<p class="calibre1">Parentheses ( ) and brackets [ ] can be considered operators based on the<br>effect their use has on the results of an expression. We discussed their use in the context of parenthetical grouping and indexing using brackets, as well as with<br>the IN procedure earlier. Parentheses are also used to enclose the parameters in a procedure call, as shown in the following code snippet:</p>
<p class="calibre1">Objectname.ProcedureName(Param1,Param2,Param3); </p>
<p class="calibre1">The scope operator is a two character sequence consisting of two colons in a<br>row, ::. The scope operator is used to allow AL code to refer to a specific option value using the text descriptive value rather than the integer value that is<br>actually stored in the database. For example, in our AL database table, Radio</p>
<p class="calibre1">Show , we have an option field defined, called Frequency, with option string<br>values of (blank), Hourly, Daily, Weekly, and Monthly. Those values will be<br>stored as integers 0, 1, 2, 3, or 4, but we can use the strings to refer to them in code, which makes our code more self-documenting. The scope operator allows<br>us to refer to Frequency::Hourly (rather than 1) and Frequency::Monthly</p>
<p class="calibre1">(rather than 4). These constructs are translated by the compiler as 1 and 4, </p>
<p class="calibre1">respectively. If we want to type fewer characters when entering code, we could<br>enter just enough of the option string value to be unique, letting the compiler<br>automatically fill in the rest when we next save, compile, close, and reopen the object. In a similar fashion, we can refer to objects in the [Object</p>
<p class="calibre1">Type::“Object Name”] format to be translated into the object number, as shown in the following code snippet:</p>
<p class="calibre1">PAGE.RUN(PAGE::“Bin List”); is equivalent to  PAGE.RUN(7303); </p>
<p class="calibre1"><b class="calibre3">[ 301 ]</b></p>
<p class="calibre1"><a id="calibre_link-175"></a><img src="images/000207.png" alt="Image 315" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The range operator is a two character sequence, “..”, with two dots in a row. </p>
<p class="calibre1">This operator is very widely used in Business Central, not only in AL code</p>
<p class="calibre1">(including CASE statements and IN expressions), but also in filters that are<br>entered by users. The English lowercase alphabet can be represented by the<br>range  <i class="calibre4">a..z</i>, the set of single digit numbers by the range -9..9 (that is, minus 9 dot dot 9), and all of the entries starting with the letter  <i class="calibre4">a</i> (lowercase) by a..a*. Don’t underestimate the power of the range operator. </p>
<p class="calibre1"><b class="calibre3">Arithmetic operators and procedures</b></p>
<p class="calibre1">The arithmetic operators include the following set of operators:</p>
<p class="calibre1">As we can see, in the <b class="calibre3">Data Types</b> column, these operators can be used on various data types. Numeric types include Integer, Decimal, Boolean, and Character data<br>types. Text and Code are both String data. </p>
<p class="calibre1">Sample statements using DIV and MOD are shown in the following code, where BigNumber is an integer containing 200:</p>
<p class="calibre1">DIVIntegerValue := BigNumber DIV 60; </p>
<p class="calibre1">The contents of DIVIntegerValue, after executing the preceding statement, will be 3: MODIntegerValue := BigNumber MOD 60; </p>
<p class="calibre1"><b class="calibre3">[ 302 ]</b></p>
<p class="calibre1"><a id="calibre_link-176"></a><img src="images/000233.png" alt="Image 316" class="calibre2" /></p>
<p class="calibre1"><img src="images/000254.png" alt="Image 317" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The contents of MODIntegerValue, after executing the preceding statement, will be 20. </p>
<p class="calibre1">The syntax for these DIV and MOD statements is as follows:</p>
<p class="calibre1">IntegerQuotient := IntegerDividend DIV IntegerDivisor; </p>
<p class="calibre1">IntegerModulus := IntegerDividend MOD IntegerDivisor; </p>
<p class="calibre1"><b class="calibre3">Boolean operators</b></p>
<p class="calibre1">Boolean operators only operate on expressions that can be evaluated as Boolean. These are shown in the following table:</p>
<p class="calibre1">The result of an expression based on a Boolean operator will also be Boolean. </p>
<p class="calibre1"><b class="calibre3">Relational operators and procedures</b></p>
<p class="calibre1">The relational operators are listed in the following screenshot. Each of these is used in an expression of the following format:</p>
<p class="calibre1">Expression RelationalOperator Expression</p>
<p class="calibre1">An example is  <i class="calibre4">(Variable1 + 97) &gt; ((Variable2 * 14.5) / 57.332)</i>. The following operators can be used:</p>
<p class="calibre1"><b class="calibre3">[ 303 ]</b></p>
<p class="calibre1"><a id="calibre_link-177"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">We will spend a little extra time on the IN operator, because this can be very handy and is not documented elsewhere. The term Valueset in the <b class="calibre3">Evaluation</b> column for IN refers to a list of defined values. It would be reasonable to define Valueset as a container of a defined set of individual values, expressions, or other value sets. Some examples of IN, as used in the standard Business Central product code, are as follows:</p>
<p class="calibre1">GLEntry.“Posting Date” IN [0D,WORKDATE]</p>
<p class="calibre1">Description[I+2] IN [‘0’..‘9’]</p>
<p class="calibre1">“Gen. Posting Type” IN [“Gen. Posting Type”::Purchase, “Gen. Posting Type”::Sale]</p>
<p class="calibre1">SearchString IN [”,’=&gt;&lt;’]</p>
<p class="calibre1">No[i] IN [‘5’..‘9’]</p>
<p class="calibre1">“FA Posting Date” IN [01010001D..12312008D]</p>
<p class="calibre1">Here is another example of what the IN operator, as used in an expression, might look like: TestString IN [‘a’..‘d’,‘j’,‘q’,‘l’..‘p’]; </p>
<p class="calibre1">If the value of TestString were a or m, then this expression would evaluate to TRUE. If the value of TestString were z, then this expression would evaluate to FALSE. Note that the data type of the search value must be the same as the data type of Valueset. </p>
<p class="calibre1"><b class="calibre3">Precedence of operators</b></p>
<p class="calibre1">When expressions are evaluated by the AL compiler, the parsing routines use a predefined precedence hierarchy to determine what operators to evaluate first, what to evaluate second, and so forth. This precedence hierarchy is provided in the Business Central Docs section,  <i class="calibre4">C/AL Operators &ndash; Operator Hierarchy</i><a href="https://msdn.microsoft.com/en-us/dynamics-nav/c-al-operators"> (https:/​/​msdn.​microsoft.​com/​en-​us/</a></p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/dynamics-nav/c-al-operators">dynamics-​nav/​c-​al-​operators), but for convenience, the information is repeated here:</a></p>
<p class="calibre1"><b class="calibre3">[ 304 ]</b></p>
<p class="calibre1"><a id="calibre_link-178"></a><img src="images/000272.png" alt="Image 318" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">For complex expressions, we should always freely use parentheses to make sure that the expressions are evaluated the way we intend them to be. </p>
<p class="calibre1"><b class="calibre3">Frequently used AL procedures</b></p>
<p class="calibre1">It’s time to learn about more of the standard procedures that are provided by Microsoft. We will focus on the following short list of frequently used procedures: MESSAGE, ERROR, CONFIRM, and STRMENU. </p>
<p class="calibre1"><b class="calibre3">[ 305 ]</b></p>
<p class="calibre1"><a id="calibre_link-179"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">There is a group of procedures in AL called Dialog procedures. The purpose of these procedures is to allow communication, that is, dialog, between the system and the user. In addition, the Dialog procedures can be useful for quick and simple testing/debugging. To make it easier for us to proceed with our next level of AL development work, we’ll take time now to learn about these four dialog procedures. None of these procedures will operate if the AL code is running on the Business Central job queue as it has no GUI available. To handle that situation in previous versions of Business Central, the Dialog procedure statements had to be conditioned with the GUIALLOWED procedure to check whether or not the code was running in a GUI allowed environment. If the code was being used in a web service or API, it would not be GUIALLOWED. However, in Business Central, API and web services simply ignore Dialog procedures. </p>
<p class="calibre1">In each of these procedures, data values can be inserted through the use of a substitution string. The substitution string is the % (percent sign) character, followed by numbers 1</p>
<p class="calibre1">through 10, located within a message text string. This could look like the following code snippet, assuming that the local currency was defined as USD:</p>
<p class="calibre1">MESSAGE(‘A message + a data element to display = %1’, “OrderAmount”); </p>
<p class="calibre1">If the OrderAmount value was $100.53, the output from the preceding code would be as follows:</p>
<p class="calibre1">A message + a data element to display = $100.53</p>
<p class="calibre1">We can have up to ten substitution strings in one dialog procedure. The use of substitution strings and their associated display values is optional. We can use any one of the dialog procedures simply to display a completely predefined text message with nothing that is variable. Use of text constant for the message is recommended as it makes maintenance and multi-language enabling easier. </p>
<p class="calibre1"><b class="calibre3">The MESSAGE procedure</b></p>
<p class="calibre1">MESSAGE is easy to use for the display of transient data and can be placed almost anywhere in our AL code. All it requires of the user is acknowledgement that the message has been read. The disadvantage of messages is that they are not displayed until either the object completes its run or pauses for some other external action. Plus, if we inadvertently create a situation that generates hundreds or thousands of messages, there is no graceful way to terminate their display once they are displaying. </p>
<p class="calibre1"><b class="calibre3">[ 306 ]</b></p>
<p class="calibre1"><a id="calibre_link-180"></a><img src="images/000293.png" alt="Image 319" class="calibre2" /></p>
<p class="calibre1"><img src="images/000314.png" alt="Image 320" class="calibre2" /></p>
<p class="calibre1"><img src="images/000335.png" alt="Image 321" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">It’s common to use MESSAGE as the elementary trace tool. We can program the display of messages to occur only under particular circumstances and use them to view either the flow of processing (by outputting simple identifying codes from different points in our logic) or to view the contents of particular data elements through multiple processing cycles. </p>
<p class="calibre1">To display information to the user without interrupting them in their<br>work, notifications can be used. You can learn more about notifications<br>via the following MSDN article:</p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/dynamics-nav/notifications-developing">https://msdn.microsoft.com/en-us/dynamics-nav/notifications-deve</a></p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/dynamics-nav/notifications-developing">loping. </a></p>
<p class="calibre1">MESSAGE has the a syntax of MESSAGE (String [, Value1] , …]), where there are<br>as many ValueX entries as there are %X substitution strings (up to ten). </p>
<p class="calibre1">Here is a sample debugging message:</p>
<p class="calibre1">MESSAGE(‘Loop %1, Item No. %2’,LoopCounter,“Item No.”); </p>
<p class="calibre1">The display would look as follows (when the counter was 14 and the Item No. was</p>
<p class="calibre1">BX0925):</p>
<p class="calibre1">When MESSAGE is used for debugging, make sure that all messages are<br>removed before releasing the object to production. </p>
<p class="calibre1"><b class="calibre3">The ERROR procedure</b></p>
<p class="calibre1">When an ERROR procedure is invoked, the execution of the current process terminates, the message is immediately displayed, and the database returns to the status it had following the last (implicit or explicit) COMMIT procedure as though the process that was calling the ERROR procedure had not run at all. </p>
<p class="calibre1"><b class="calibre3">[ 307 ]</b></p>
<p class="calibre1"><a id="calibre_link-486"></a><img src="images/000356.png" alt="Image 322" class="calibre2" /></p>
<p class="calibre1"><img src="images/000377.png" alt="Image 323" class="calibre2" /></p>
<p class="calibre1"><img src="images/000402.png" alt="Image 324" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">We can use the ERROR procedure in combination with the MESSAGE</p>
<p class="calibre1">procedure to assist in repetitive testing. MESSAGE procedures can be<br>placed in code to show what is happening with an ERROR procedure that’s<br>been placed just prior to where the process would normally complete. </p>
<p class="calibre1">Because the ERROR procedure rolls back all database changes, this<br>technique allows us to run through multiple tests against the same data<br>without any time-consuming backup and restoration of our test data. The<br>enhanced testing procedurality that’s built into Business Central can<br>accomplish the same things in a much more sophisticated fashion, but<br>sometimes there’s room for a temporary, simple approach. </p>
<p class="calibre1">An ERROR procedure call is formatted almost exactly like a MESSAGE call. ERROR has the syntax, ERROR (String [, Value1] ,…]), where there are as many ValueX entries as there are %X substitution strings (up to ten). If the preceding MESSAGE call was an ERROR</p>
<p class="calibre1">procedure instead, the code line would be as follows:</p>
<p class="calibre1">ERROR(‘Loop %1, Item No. %2’,LoopCounter,“Item No.”); </p>
<p class="calibre1">The display would look as follows:</p>
<p class="calibre1">We can increase the ease of ERROR message recognition by including the word ERROR in our message, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 308 ]</b></p>
<p class="calibre1"><a id="calibre_link-181"></a><img src="images/000423.png" alt="Image 325" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">Even in the best of circumstances, it is difficult for a system to communicate clearly with users. Sometimes, our tools, in their effort to be flexible, make it too easy for developers to take the easy way out and communicate poorly or not at all. For example, an ERROR</p>
<p class="calibre1">statement of the ERROR(”) form will terminate the run and roll back all data processing without even displaying a message at all. An important part of our job, as developers, is to ensure that our systems communicate clearly and completely. </p>
<p class="calibre1"><b class="calibre3">The CONFIRM procedure</b></p>
<p class="calibre1">A third dialog procedure is the CONFIRM procedure. A CONFIRM procedure call causes processing to stop until the user responds to the dialog. In CONFIRM, we will include a question in our text because the procedure provides <b class="calibre3">Yes</b> and <b class="calibre3">No</b> button options. The application logic can then be conditioned on the user’s response. </p>
<p class="calibre1">We can also use CONFIRM as a simple debugging tool to control the path<br>the processing will take. Display the status of data or processing flow and<br>then allow the operator to make a choice (<b class="calibre3">Yes</b> or <b class="calibre3">No</b>) that will influence what happens next. Execution of a CONFIRM procedure will also cause any<br>pending MESSAGE procedure output values to be displayed before the</p>
<p class="calibre1">CONFIRM procedure displays. Combined with MESSAGE and ERROR, </p>
<p class="calibre1">creative use of CONFIRM can add to our elementary debugging/diagnostic<br>toolkit. </p>
<p class="calibre1">CONFIRM has the following syntax:</p>
<p class="calibre1">BooleanValue :=  CONFIRM(String [, Default]  [, Value1]  ,…)</p>
<p class="calibre1">When we do not specify a value for Default, the system will choose FALSE (which<br>displays as <b class="calibre3">No</b>). We should almost always choose the Default option as it will do no damage if accepted inadvertently by an inattentive user. The Default choice is FALSE, which is often the safest choice (but TRUE may be specified by the programmer). There are as many ValueX entries as there are %X substitution strings (up to ten). </p>
<p class="calibre1">If we just code OK := CONFIRM(String), the default choice will be False. </p>
<p class="calibre1">A CONFIRM procedure call with a similar content to the preceding examples might look like the following sample for the code and the display:</p>
<p class="calibre1">Answer := CONFIRM(‘Loop %1, Item No. %2\OK to<br>continue?’,TRUE,LoopCounter,“Item No.”); </p>
<p class="calibre1"><b class="calibre3">[ 309 ]</b></p>
<p class="calibre1"><a id="calibre_link-182"></a><img src="images/000441.jpg" alt="Image 326" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The output screen is shown in the following screenshot:</p>
<p class="calibre1">In typical usage, the CONFIRM procedure is part of, or is referred to, by a conditional statement that uses the Boolean value that’s returned by the CONFIRM procedure. </p>
<p class="calibre1">An additional feature for on-screen dialogs is the use of the backslash (\) that’s embedded in the text. This forces a new line in the displayed message. This works throughout Business Central screen display procedures. </p>
<p class="calibre1">To display a backslash on-screen, we must put two of them in our message text string, (\). </p>
<p class="calibre1"><b class="calibre3">The STRMENU procedure</b></p>
<p class="calibre1">A fourth dialog procedure is the STRMENU procedure. A STRMENU procedure call also causes processing to pause while the user responds to the dialog. The advantage of the STRMENU</p>
<p class="calibre1">procedure is its ability to provide several choices, rather than just two (<b class="calibre3">Yes</b> or <b class="calibre3">No</b>). A common use is to provide an option menu in response to the user pressing a command button. </p>
<p class="calibre1">STRMENU has the following syntax:</p>
<p class="calibre1">IntegerValue := STRMENU(StringVariable of Options separated by commas</p>
<p class="calibre1">[, OptionDefault][, Instruction])</p>
<p class="calibre1"><b class="calibre3">[ 310 ]</b></p>
<p class="calibre1"><a id="calibre_link-487"></a><img src="images/000010.png" alt="Image 327" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">IntegerValue will contain the user’s selection entry, and OptionDefault is an integer representing which option will be selected by default when the menu displays. If we do not provide an OptionDefault value, the first option that’s listed will be used as the default. </p>
<p class="calibre1">Instruction is a text string that will display the preceding list of options. If the user responds with <b class="calibre3">Cancel</b> or presses the  <i class="calibre4">Esc</i> key, the value that’s returned by the procedure is 0. </p>
<p class="calibre1">Use of the STRMENU procedure eliminates the need to use a Page object when asking the user to select from a limited set of options. It can also be utilized from within a report or codeunit when calling a page would restrict processing choices. </p>
<p class="calibre1">If we phrase our instruction as a question rather than simply an explanation, then we can use STRMENU as a multiple choice inquiry to the user. </p>
<p class="calibre1">Here is an example of STRMENU with the instruction phrased as a question:</p>
<p class="calibre1">OptionNo := STRMENU(‘Blue,Plaid,Yellow,Hot Pink,Orange,Unknown’,6, </p>
<p class="calibre1">‘Which of these is not like the others?’); </p>
<p class="calibre1">The output screen is shown in the following screenshot:</p>
<p class="calibre1">Setting the default to 6 caused the sixth option (<b class="calibre3">Unknown</b>) to be the active selection when the menu is displayed. </p>
<p class="calibre1"><b class="calibre3">[ 311 ]</b></p>
<p class="calibre1"><a id="calibre_link-183"></a><img src="images/000030.png" alt="Image 328" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">Record procedures</b></p>
<p class="calibre1">Now, we will review some of the procedures that we commonly use in record processing. </p>
<p class="calibre1"><b class="calibre3">The SETCURRENTKEY procedure</b></p>
<p class="calibre1">The syntax for SETCURRENTKEY is as follows:</p>
<p class="calibre1">[BooleanValue :=] Record.SETCURRENTKEY(FieldName1,[FieldName2], … )</p>
<p class="calibre1">Because Business Central is based on the SQL Server database, SETCURRENTKEY simply determines the order in which the data will be presented for processing. The actual choice of the index to be used for the query is made by the SQL Server Query Analyzer. For this reason, it is very important that the data and resources available to the SQL Server Query Analyzer are well maintained. This includes maintaining the statistics that are used by the Query Analyzer, as well as making sure that efficient index options have been defined. </p>
<p class="calibre1">Even though SQL Server picks the actual index, the developer’s choice of the appropriate SETCURRENTKEY parameter can have a major affect on performance. </p>
<p class="calibre1">The fields that are used in the SETCURRENTKEY command do not have to<br>match a key in the table definition. You can also use FlowFields as fields<br>for SETCURRENTKEY, but expect slower performance when doing this. </p>
<p class="calibre1">The indexes that are defined in the SQL Server do not have to be the same as those defined in the AL table definition. For example, we can add additional indexes in the SQL Server and not in AL, disable indices in the SQL Server but leave the matching keys enabled in AL, and so on. Any maintenance of the SQL Server indices should be done through the Business Central table designer using the Business Central keys and properties, not directly in SQL</p>
<p class="calibre1">Server. Even though the system may operate without a problem, any mismatch between the application system and the underlying database system makes maintenance and upgrades more difficult and error-prone. </p>
<p class="calibre1">Business Central-defined keys are no longer required to support SIFT indexes because SQL</p>
<p class="calibre1">Server can dynamically create the required indices. However, depending on dynamic indices for larger datasets, they can lead to bad performance. Good design is still our responsibility as developers. </p>
<p class="calibre1"><b class="calibre3">[ 312 ]</b></p>
<p class="calibre1"><a id="calibre_link-184"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">The SETRANGE procedure</b></p>
<p class="calibre1">The SETRANGE procedure provides the ability to set a simple range filter on a field. The SETRANGE syntax is as follows:</p>
<p class="calibre1">Record.SETRANGE(FieldName [,From-Value] [,To-Value]); </p>
<p class="calibre1">Prior to applying its range filter, the SETRANGE procedure removes any filters that were previously set for the defined field (filtering procedures are defined in more detail in the next chapter). If SETRANGE is executed with only one value, that one value will act as both the From and To values. If SETRANGE is executed without any From or To values, it will clear the filters on the field. This is a common use of SETRANGE. Some examples of the SETRANGE procedure in code are as follows:</p>
<p class="calibre1">Clear the filters on Item.No.:</p>
<p class="calibre1">Item.SETRANGE(“No.”); </p>
<p class="calibre1">Filter to get only items with No. from 1300 through 1400:</p>
<p class="calibre1">Item.SETRANGE(“No.”,‘1300’,‘1400’); </p>
<p class="calibre1">Alternatively, you can use the variable values from LowVal through HiVal:</p>
<p class="calibre1">Item.SETRANGE(“No.”,LowVal,HiVal); </p>
<p class="calibre1">To be effective in a query, SETRANGE must be called before the OPEN, SAVEASXML, and SAVEASCSV procedures. </p>
<p class="calibre1"><b class="calibre3">The SETFILTER procedure</b></p>
<p class="calibre1">SETFILTER is similar to, but much more flexible than, the SETRANGE procedure because it supports the application of any of the supported Business Central filter procedures to table fields. The SETFILTER syntax is as follows:</p>
<p class="calibre1">Record.SETFILTER(FieldName, FilterExpression [Value],…); </p>
<p class="calibre1"><b class="calibre3">[ 313 ]</b></p>
<p class="calibre1"><a id="calibre_link-185"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The FilterExpression consists of a string (text or code) in standard Business Central filter format, including any of the operators (&lt;, &gt;, *, &amp;, |, and =) in any legal combination. </p>
<p class="calibre1">Replacement fields (%1, %2, …, %9) are used to represent the values that will be inserted into FilterExpression by the compiler to create an operating filter that’s formatted as though it were entered from the keyboard. Just like SETRANGE, prior to applying its filter, the SETFILTER procedure clears any filters that were previously set for the defined field, as in the following example:</p>
<p class="calibre1">Filter to get only items with No. from 1300 through 1400:</p>
<p class="calibre1">Item.SETFILTER(“No.”,’%1..%2’,‘1300’,‘1400’); </p>
<p class="calibre1">Alternatively, you can do this with any of the variable values of LowVal, MedVal, or HiVal:</p>
<p class="calibre1">Item.SETFILTER”No.”,’%1|%2|%3’,LowVal,MedVal,HiVal); </p>
<p class="calibre1">To be effective in a query, SETFILTER must be called before the OPEN, SAVEASXML, and SAVEASCSV procedures. </p>
<p class="calibre1"><b class="calibre3">The GET procedure</b></p>
<p class="calibre1">GET is the basic data retrieval procedure in AL. GET retrieves a single record based on the primary key only. It has the following syntax:</p>
<p class="calibre1">[BooleanValue :=] Record.GET ( [KeyFieldValue1] [,KeyFieldValue2] ,…)</p>
<p class="calibre1">The parameter for the GET procedure is the primary key value (or all of the values, if the primary key consists of more than one field). </p>
<p class="calibre1">Assigning the GET procedure result to BooleanValue is optional. If the GET procedure is not successful (no record found) and the statement is not part of an IF statement, the process will terminate with a runtime error. Typically, therefore, the GET procedure is encased in an IF statement, which is structured like so:</p>
<p class="calibre1">IF Customer.GET(NewCustNo) THEN … </p>
<p class="calibre1"><b class="calibre3">[ 314 ]</b></p>
<p class="calibre1"><a id="calibre_link-186"></a><img src="images/000089.png" alt="Image 329" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">GET data retrieval is not constrained by filters, except for security filters</p>
<p class="calibre1">(see help,  <i class="calibre4"> How to: Set Security Filters</i> at</p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/library/hh166853(v=nav.90).aspx">https://msdn.microsoft.com/en-</a></p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/library/hh166853(v=nav.90).aspx">us/library/hh166853(v=nav.90).aspx). If there is a matching record in</a></p>
<p class="calibre1">the table, GET will retrieve it. </p>
<p class="calibre1"><b class="calibre3">FIND procedures</b></p>
<p class="calibre1">The FIND family of procedures is the general purpose data retrieval procedure in AL. It is much more flexible than GET, and therefore more widely used. GET has the advantage of being faster as it operates only on unfiltered direct access through the primary key, looking for a single uniquely keyed entry. There are two forms of FIND procedures in AL, one a remnant from a previous database structure and the other designed specifically to work efficiently with SQL Server. Both are supported, and we will find both in standard code. </p>
<p class="calibre1">The older version of the FIND procedure has the following syntax:</p>
<p class="calibre1">[BooleanValue :=] RecordName.FIND ( [Which] ). </p>
<p class="calibre1">The newer SQL Server-specific members of the FIND procedure family have slightly different syntax, as we will see shortly. </p>
<p class="calibre1">Just like the GET procedure, assigning the FIND procedure result to a Boolean value is optional. However, in almost all of the cases, FIND is embedded in a condition that controls subsequent processing appropriately. Either way, it is important to structure our code to handle the instance where FIND is not successful. </p>
<p class="calibre1">FIND differs from GET in several important ways, some of which are as follows:</p>
<p class="calibre1">FIND operates under the limits of whatever filters are applied on the subject field. </p>
<p class="calibre1">FIND presents the data in the sequence of the key that is currently selected by<br>default or by AL code. </p>
<p class="calibre1">When FIND is used, the index that’s used for the data reading is controlled by the SQL Server Query Analyzer. </p>
<p class="calibre1">Different variations of the FIND procedure are designed specifically for use in<br>different situations. This allows coding to be optimized for better SQL Server<br>performance. All of the FIND procedures are described further in the help<br>section,  <i class="calibre4">C/AL Database Functions and Performance on SQL Server</i>, at <a href="https://msdn.microsoft.com/en-us/library/dd355237.aspx">https:/​/​msdn. </a></p>
<p class="calibre1"><a href="https://msdn.microsoft.com/en-us/library/dd355237.aspx">microsoft.​com/​en-​us/​library/​dd355237.​aspx</a>. </p>
<p class="calibre1"><b class="calibre3">[ 315 ]</b></p>
<p class="calibre1"><a id="calibre_link-187"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The forms of FIND are as follows:</p>
<p class="calibre1">FIND(‘-‘): This finds the first record in a table that satisfies the defined filter and current key. </p>
<p class="calibre1">FINDFIRST: This finds the first record in a table that satisfies the defined filter and defined key choice. Conceptually, it is equivalent to FIND(‘-‘) for a single record read but better for SQL Server when a filter or range is applied. </p>
<p class="calibre1">FIND(‘+’): This finds the last record in a table that satisfies the defined filter and defined key choice. Often, this is not an efficient option for SQL Server<br>because it causes it to read a set of records when, many times, only a single<br>record is needed. The exception is when a table is to be processed in reverse<br>order. Then, it is appropriate to use FIND(‘+’) with SQL Server. </p>
<p class="calibre1">FINDLAST: This finds the last record in a table that satisfies the defined filter and current key. It is conceptually equivalent to FIND(‘+’) but, often, much better<br>for SQL Server as it reads a single record, not a set of records. </p>
<p class="calibre1">FINDSET: This is the most efficient way to read a set of records from SQL Server for sequential processing within a specified filter and range. FINDSET allows you to define the standard size of the read record cache as a setup parameter but, </p>
<p class="calibre1">normally, it defaults to reading 50 records (table rows) for the first server call. </p>
<p class="calibre1">The syntax includes two optional True/False parameters, as follows:</p>
<p class="calibre1">FINDSET([ForUpdate][, UpdateKey]); </p>
<p class="calibre1">The first parameter controls whether or not the read is in preparation for an<br>update and the second parameter is TRUE when the first parameter is TRUE and<br>the update is of key fields. FINDSET clears any FlowFields in the records that are read. </p>
<p class="calibre1"><b class="calibre3">FIND ([Which]) options and the SQL Server alternatives</b></p>
<p class="calibre1">Let’s review the FIND procedure option’s syntax variations:</p>
<p class="calibre1">[BooleanValue :=] RecordName.FIND ( [Which] )</p>
<p class="calibre1">The [Which] parameter allows you to specify which record is searched for, relative to the defined key values. The defined key values are the set of values currently in the fields of the active key in the memory-resident record of the RecordName table. </p>
<p class="calibre1"><b class="calibre3">[ 316 ]</b></p>
<p class="calibre1"><a id="calibre_link-345"></a><img src="images/000114.png" alt="Image 330" class="calibre2" /></p>
<p class="calibre1"><img src="images/000136.png" alt="Image 331" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The following table lists the Which parameter options and prerequisites:</p>
<p class="calibre1">The second table lists the FIND options, which are specific to SQL Server, as follows: For all FIND options, the results always respect the applied filters. </p>
<p class="calibre1"><b class="calibre3">[ 317 ]</b></p>
<p class="calibre1"><a id="calibre_link-488"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The FIND(‘-‘) procedure is sometimes used as the first step of reading a set of data, such as reading all of the sales invoices for a single customer. In such a case, the NEXT procedure is used to trigger all subsequent data reads after the sequence is initiated with FIND(‘-‘). </p>
<p class="calibre1">Generally, FINDSET should be used rather than FIND(‘-‘); however, FINDSET only works to read forward, not in reverse. We should use FINDFIRST if only the first record in the specified range is of interest. </p>
<p class="calibre1">One form of the typical C/SIDE database read loop is as follows:</p>
<p class="calibre1">IF MyData.FIND(‘-‘) THEN</p>
<p class="calibre1">REPEAT</p>
<p class="calibre1">Processing logic here</p>
<p class="calibre1">UNTIL MyData.NEXT = 0; </p>
<p class="calibre1">The same processing logic using the FINDSET procedure is as follows:</p>
<p class="calibre1">IF MyData.FINDSET THEN</p>
<p class="calibre1">REPEAT</p>
<p class="calibre1">Processing logic here</p>
<p class="calibre1">UNTIL MyData.NEXT = 0; </p>
<p class="calibre1">We will discuss the REPEAT-UNTIL control structure in more detail in the next chapter. </p>
<p class="calibre1">Essentially, it does what it says;  <i class="calibre4">repeat the following logic until the defined condition is true</i>. For the FIND-NEXT read loop, the NEXT procedure provides both the definition of how the read loop will advance through the table and when the loop is to exit. </p>
<p class="calibre1">When DataTable.NEXT = 0, it means there are no more records to be read. We have<br>reached the end of the available data, based on the filters and other conditions that apply to our reading process. </p>
<p class="calibre1">The specific syntax of the NEXT procedure is DataTable.NEXT(Step). DataTable is the name of the table being read. Step defines the number of records Business Central will move forward (or backward) per read. The default Step is 1, meaning that Business Central moves ahead one record at a time, reading every record. A Step of 0 works the same as a Step of 1. If the Step is set to 2, Business Central will move ahead two records at a time and the process will only be presented with every other record. </p>
<p class="calibre1">Step can also be negative, in which case Business Central moves backward through the table. This would allow us to execute a FIND(‘+’) procedure for the end of the table, then a NEXT(-1) procedure to read backwards through the data. This is very useful if, for example, we need to read a table sorted ascending by date and want to access the most recent entries first. </p>
<p class="calibre1"><b class="calibre3">[ 318 ]</b></p>
<p class="calibre1"><a id="calibre_link-188"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">Conditional statements</b></p>
<p class="calibre1">Conditional statements are the heart of process flow structure and control. </p>
<p class="calibre1"><b class="calibre3">The BEGIN-END compound statement</b></p>
<p class="calibre1">In AL, there are instances where the syntax only allows the use of a single statement. </p>
<p class="calibre1">However, a design may require the execution of several (or many) code statements. </p>
<p class="calibre1">AL provides at least two ways to address this need. One method is to have the single statement call a procedure that contains multiple statements. </p>
<p class="calibre1">However, inline coding is often more efficient to run and understand. So, AL provides a syntax structure to define a compound statement or block of code. A compound statement containing any number of statements can be used in place of a single code statement. </p>
<p class="calibre1">A compound statement is enclosed by the reserved words BEGIN and END. The compound statement structure looks like this:</p>
<p class="calibre1">BEGIN</p>
<p class="calibre1">&lt;Statement 1&gt;; </p>
<p class="calibre1">&lt;Statement 2&gt;; </p>
<p class="calibre1">.. </p>
<p class="calibre1">&lt;Statement n&gt;; </p>
<p class="calibre1">END</p>
<p class="calibre1">The AL code contained within a BEGIN-END block should be indented by two characters, as shown in the preceding pseudocode snippet, to make it obvious that it is a block of code. </p>
<p class="calibre1"><b class="calibre3">IF-THEN-ELSE statement</b></p>
<p class="calibre1">IF is the basic conditional statement of most programming languages. It operates in AL</p>
<p class="calibre1">much the same as how it works in other languages. The basic structure is as follows: IF a conditional expression is true, THEN execute Statement-1 or (if condition is not true) execute Statement-2. The ELSE portion is optional. The syntax is as follows:</p>
<p class="calibre1">IF &lt;Condition&gt; THEN &lt;Statement-1&gt; [ ELSE &lt;Statement-2&gt; ]</p>
<p class="calibre1"><b class="calibre3">[ 319 ]</b></p>
<p class="calibre1"><a id="calibre_link-189"></a><img src="images/000158.png" alt="Image 332" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">Note that the statements within an IF statement do not have terminating semicolons, unless they are contained in a BEGIN-END framework. IF statements can be nested so that conditionals are dependent on the evaluation of other conditionals. Obviously, you need to be careful with such constructs, because it is easy to end up with convoluted code structures that are difficult to debug and difficult for the developers following us to understand. In the next chapter, we will review the CASE statement that can make some complicated conditionals much easier to format and understand. </p>
<p class="calibre1">As we work with Business Central AL code, we will see that, often, &lt;Condition&gt; is really an expression built around a standard AL procedure. This approach is frequently used when the standard syntax for the procedure is Boolean value, procedure<br>expression. Some examples are as follows:</p>
<p class="calibre1">IF Customer.FIND(‘-‘) THEN… ELSE… </p>
<p class="calibre1">IF CONFIRM(‘OK to update?’,TRUE) THEN… ELSE… </p>
<p class="calibre1">IF TempData.INSERT THEN… ELSE… </p>
<p class="calibre1">IF Customer.CALCFIELDS(Balance,Balance(LCY)) THEN… </p>
<p class="calibre1"><b class="calibre3">Indenting code</b></p>
<p class="calibre1">Since we have just discussed the BEGIN-END compound statements and the IF conditional statements, which also are compound (that is, containing multiple expressions), this seems like a good time to discuss indenting code. </p>
<p class="calibre1">In AL, the standard practice for indenting subordinate, contained, or continued lines is relatively simple. Always indent such lines by two characters, except where there are left and right parentheses to be aligned. </p>
<p class="calibre1">To indent a block of code two characters at a time with the Business</p>
<p class="calibre1">Central AL code editor, select them and click on the  <i class="calibre4">Tab</i> key. To remove<br>the indentation one character at a time, select the code and click on</p>
<p class="calibre1"> <i class="calibre4">Shift </i>+  <i class="calibre4">Tab</i>. </p>
<p class="calibre1"><b class="calibre3">[ 320 ]</b></p>
<p class="calibre1"><a id="calibre_link-190"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">In the following examples, the parentheses are not required in all of the instances, but they don’t cause any problems and can make the code easier to read. </p>
<p class="calibre1">Some examples are as follows:</p>
<p class="calibre1">IF (A &lt;&gt; B) THEN</p>
<p class="calibre1">A := A + Count1</p>
<p class="calibre1">ELSE</p>
<p class="calibre1">B := B + Count2; </p>
<p class="calibre1">Or here’s another:</p>
<p class="calibre1">IF (A &lt;&gt; B) THEN</p>
<p class="calibre1">A := A + Count1; </p>
<p class="calibre1">Or check out this example:</p>
<p class="calibre1">IF (A &lt;&gt; B)THEN BEGIN</p>
<p class="calibre1">A := A + Count1; </p>
<p class="calibre1">B := A + Count2; </p>
<p class="calibre1">IF (C &gt; (A * B)) THEN</p>
<p class="calibre1">C := A * B; </p>
<p class="calibre1">END ELSE</p>
<p class="calibre1">B := B + Count2; </p>
<p class="calibre1"><b class="calibre3">Some simple coding modifications</b></p>
<p class="calibre1">Now, we’ll add some AL code to objects we’ve created for our WDTU application. </p>
<p class="calibre1"><b class="calibre3">Adding field validation to a table</b></p>
<p class="calibre1"><a href="#calibre_link-91">In Chapter 4</a>,  <i class="calibre4">Pages &ndash; The Interactive Interface</i>, we created the 50110 “Radio Show Fan” table. We’ve decided that we want to be able to use this list for promotional activities, such as having drawings for concert tickets. Of course, we want to send the tickets to the winners at their mailing addresses. We didn’t include these fields originally in our table design, so we must add them now. </p>
<p class="calibre1"><b class="calibre3">[ 321 ]</b></p>
<p class="calibre1"><a id="calibre_link-379"></a><img src="images/000176.jpg" alt="Image 333" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">To keep our design consistent with the standard product, we will model these fields after the equivalent ones in the 18 - Customer table. Our updated table, 50110, will look as follows:</p>
<p class="calibre1">Part of modeling our 50110 “Radio Show Fan” table fields on those in the 18 -</p>
<p class="calibre1">Customer table is faithfully copying the applicable properties. For example, the TableRelation property for the Post Code field in table 18 contains the following lines of code, which we should include for the Post Code field in table 50010:</p>
<p class="calibre1">PostCode.ValidatePostCode(City, “Post Code”, County, “Country/Region Code”, (CurrFieldNo &lt;&gt; 0) AND GUIALLOWED); </p>
<p class="calibre1">When a Radio Show Fan record is added or the Post Code field is changed, we would like to update the appropriate address information. We will see that PostCode is a reference to the record, that is, the Post Code table. To learn as much as we can about how this procedure works, how we should call it, and what information is available from the Post Code table (table 225), we will look at the Post Code table field list. </p>
<p class="calibre1"><b class="calibre3">[ 322 ]</b></p>
<p class="calibre1"><a id="calibre_link-380"></a><img src="images/000198.png" alt="Image 334" class="calibre2" /></p>
<p class="calibre1"><img src="images/000221.png" alt="Image 335" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">First, here’s the field list in table 225 “Post Code”:</p>
<p class="calibre1">Here’s the signature for the ValidatePostCode procedure:</p>
<p class="calibre1">By doing some analysis of what we have dissected, we can see that the ValidatePostCode procedure call uses five calling parameters. There is no return value. The procedure avoids the need to a return value by passing four of the parameters  <i class="calibre4">by reference</i> (not  <i class="calibre4">by value</i>), as we can tell by the var keyword on the parameters. </p>
<p class="calibre1"><b class="calibre3">[ 323 ]</b></p>
<p class="calibre1"><a id="calibre_link-489"></a><img src="images/000245.png" alt="Image 336" class="calibre2" /></p>
<p class="calibre1"><img src="images/000264.jpg" alt="Image 337" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">We conclude that we can just copy the code from the Post Code table OnValidate trigger in the Customer table into the equivalent trigger in our Fan table. This will give us the Post Code maintenance we want. The result looks as follows (the</p>
<p class="calibre1">CurrFieldNo variable is a system-defined variable left over from previous versions and has been retained for compatibility reasons):</p>
<p class="calibre1">We can test our work by running the 50111 Radio Show Fans page. All we need to do is add the fields to the page and move to the Post Code field, click on it, and choose an entry from the displayed list of codes. The result should be the population of the Post Code field, the Country/Region Code field, and the City field. If we fill in the new data fields for some Fan records, our Radio Show Fan table should look as follows:</p>
<p class="calibre1">We’ve accomplished our goal. The way we’ve done it may seem disappointing. It didn’t feel like we really designed a solution or wrote any code. What we did was find where in Business Central the same problem had already been solved, figured out how that solution worked, cloned it into our object, and we were done. </p>
<p class="calibre1">Each time we start this approach, we should look at the defined patterns</p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/105.nav-design-patterns-repository.aspx">(https://community.dynamics.com/nav/w/designpatterns/105.nav-design-patterns-re</a></p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/105.nav-design-patterns-repository.aspx">pository.aspx</a>) to see whether any patterns fit our situation. The benefit of starting with a pattern is that the general structural definition is defined for how this procedure should be done within Business Central. Whether you find a matching pattern or not, the next step is to find and study applicable AL code within Business Central. </p>
<p class="calibre1"><b class="calibre3">[ 324 ]</b></p>
<p class="calibre1"><a id="calibre_link-191"></a><img src="images/000285.png" alt="Image 338" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">Obviously, this approach doesn’t work every time. However, every time it does work, it is a small triumph of efficiency. This helps us to keep the structure of our solution consistent with the standard product and allows us to reuse existing code constructs and minimize the debugging effort and chances of production problems. In addition, our modifications are more likely to work, even if the standard base application procedure changes in a future version. </p>
<p class="calibre1"><b class="calibre3">Adding code to a report</b></p>
<p class="calibre1">Most reports require some embedded logic to process user selected options, calculate values, or access data in related tables. To illustrate some possibilities, we will extend our WDTU application to add a new report. </p>
<p class="calibre1">To support promotions giving away posters, concert tickets, and so on, we must further enhance the Radio Show Fan table and create a new report to generate mailing<br>information from it. Our first step is to create a new dataset in the Visual Studio Code IDE. </p>
<p class="calibre1">We should define the data fields we want to include for mailings (including a global variable of CountryName), then save and compile the result as a report called 50102 “Fan Promotion List”, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 325 ]</b></p>
<p class="calibre1"><a id="calibre_link-192"></a><img src="images/000306.jpg" alt="Image 339" class="calibre2" /></p>
<p class="calibre1"><img src="images/000331.png" alt="Image 340" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">Laying out the new Report Heading</b></p>
<p class="calibre1">Next, we will begin the design of the report layout in Microsoft Word. If we build our application, a Word template will be created, which we can open externally. </p>
<p class="calibre1">We will add a report header by simply creating it with a default style, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">Saving and testing</b></p>
<p class="calibre1">At this point, it’s time to save and test what we’ve done so far. Exit from Microsoft Word. </p>
<p class="calibre1">Save the report layout changes. Build and publish your application and run the report using the search. </p>
<p class="calibre1">This first test is very simple (assuming it works). The <b class="calibre3">Report Request Page</b> will appear in the web client. Click on <b class="calibre3">Preview</b> to see the report display on-screen. The layout shown in the preceding screenshot will result in the following report page (or something similar):</p>
<p class="calibre1"><b class="calibre3">[ 326 ]</b></p>
<p class="calibre1"><a id="calibre_link-193"></a><img src="images/000352.png" alt="Image 341" class="calibre2" /></p>
<p class="calibre1"><img src="images/000373.png" alt="Image 342" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">Lookup-related table data</b></p>
<p class="calibre1">Once we have a successful test of the report (heading only), we’ll move on to laying out the body of the report. As we think through the data, we will want to include a mailing address, such as name, address, a second address, city, country name, and post code, and realize that our table data includes country code, not country name. So, we will look up the country name from the Country/Region table (table 9). Let’s take care of that now. </p>
<p class="calibre1">First, we’ll add a couple of global variables to our report. One of them will allow us to access the Country/Region table, and the other will act as a holding place for the country name data we get from that table, as shown in the following screenshot:</p>
<p class="calibre1">Each time we read a Radio Show Fan record, we’ll look up the country name for that fan and store it in CountryName by entering the following code snippet:</p>
<p class="calibre1">Now, we can add the CountryName variable to the list of data elements attached to the DataItem Radio Show Fan so that it will be included in the data that’s passed to Microsoft Word and, when the report is run, to the report viewer. </p>
<p class="calibre1">While what we’ve done will probably work most of the time, how could it be made better? </p>
<p class="calibre1">For one thing, shouldn’t we handle the situation where there is no Country/Region code in the fan record? Do we really need to move the country name to a global variable instead of simply reporting it directly from the Country/Region record? </p>
<p class="calibre1"><b class="calibre3">[ 327 ]</b></p>
<p class="calibre1"><a id="calibre_link-194"></a><img src="images/000393.jpg" alt="Image 343" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">Both of these issues could be handled better. Look up the GET procedure in help to see what should be done in terms of error handling. Additionally, after we work through the report as we’re doing so here, we can enhance it by eliminating use of the CountryName global variable. For now, let’s just move on and complete an initial version of our report by creating the rest of our report layout in Microsoft Word. </p>
<p class="calibre1"><b class="calibre3">Laying out the new report Body</b></p>
<p class="calibre1">Open the report layout in Microsoft Word. From the ribbon, we’ll grab a table and drag it into the layout work area for the report body. The table should contain five columns and two rows. </p>
<p class="calibre1">We will add the data fields from the XML mapping into each of the data row text boxes (the bottom row). In the top row, we will type captions. We will make the second row a repeating row:</p>
<p class="calibre1"><b class="calibre3">Saving and testing</b></p>
<p class="calibre1">After we lay out, save and exit, update, and save and build, it’s time to do another test run of our report in process. If we simply preview it without doing any filtering, we should see all of our test data address information (complete with country name), as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 328 ]</b></p>
<p class="calibre1"><a id="calibre_link-195"></a><img src="images/000415.jpg" alt="Image 344" class="calibre2" /></p>
<p class="calibre1"><img src="images/000434.png" alt="Image 345" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">Handling user entered report options</b></p>
<p class="calibre1">Part of our report design includes allowing the user to choose fans based on some simple demographic data, such as age and gender. We’ll need to add two more fields to our Radio Show Fan table definition, one for Gender and the other for Birth Date, from which we can calculate the fan’s age, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 329 ]</b></p>
<p class="calibre1"><a id="calibre_link-381"></a><img src="images/000003.png" alt="Image 346" class="calibre2" /></p>
<p class="calibre1"><img src="images/000023.png" alt="Image 347" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">This back and forth process of updating one object, then a different one, </p>
<p class="calibre1">then yet another, is typical of the Business Central development process<br>most of the time. Exceptions are those cases where either the task is so<br>simple we think of everything the first time through, or the cases where<br>we create a completely documented, full-featured design before any<br>development starts (but nobody thinks of everything, there are always<br>changes; our challenge is to keep the changes under control). </p>
<p class="calibre1">An advantage to the more flexible approach we are following is that it<br>allows us to view (and share with others) intermediate versions of the<br>application as it is developed. Design issues can be addressed as they<br>come up, and overlooked features can be considered midstream. Two<br>downsides are the very real possibility of scope creep (the project growing<br>uncontrollably) and poorly organized code. Scope creep can be controlled<br>by good project management. If the first pass through results in poorly<br>organized code, then a thoughtful refactoring is appropriate, cleaning up<br>the code while retaining the design. </p>
<p class="calibre1">For the user to choose which Fan demographics will be used to filter the Fan data for a particular promotion, we will have to create a request page for entry of the desired criteria. </p>
<p class="calibre1">This, in turn, requires the definition of a set of global variables in our Report object to support the request page data entry fields and as working variables for the age calculation and Fan selection. We’ve decided that, if Fan fits any of the individual criteria, we will include them. This makes our logic simpler. Our final global variable list in report 50102</p>
<p class="calibre1">looks as follows:</p>
<p class="calibre1"><b class="calibre3">[ 330 ]</b></p>
<p class="calibre1"><a id="calibre_link-196"></a><img src="images/000044.jpg" alt="Image 348" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1"><b class="calibre3">Defining the Request Page</b></p>
<p class="calibre1">Now, let’s define the requestpage. Click on <b class="calibre3">View</b> | <b class="calibre3">Request Page</b> and make the entries necessary to describe the page’s contents, as shown in the following screenshot: <b class="calibre3">Finishing the processing code</b></p>
<p class="calibre1">Next, we will create the AL code to calculate a fan’s age (in years) based on their birth date and the current WORKDATE. The logic is simple&mdash;subtract the birthdate from the WORKDATE. </p>
<p class="calibre1">This gives a number of days. So, we will divide by 365 (not worrying about leap years) and round down to integer years (if someone is 25 years, 10 months, and 2 days old, we will just consider them 25). In the following code, we did the division as though the result were a decimal field. However, because our math is done in integers, we could have used the simpler expression:</p>
<p class="calibre1">FanAge := ((WORKDATE - “Birth Date”) DIV 365); </p>
<p class="calibre1">Finally, we’ll write the code to check each Fan record data against our selection criteria, determining whether we want to include that fan in our output data (SelectThisFan set to True). This code will select each fan who fits any of the checked criteria; there is no combination logic here. </p>
<p class="calibre1"><b class="calibre3">[ 331 ]</b></p>
<p class="calibre1"><a id="calibre_link-197"></a><img src="images/000061.png" alt="Image 349" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">The following is our commented AL code for report 50102:</p>
<p class="calibre1">After this version of the report is successfully tested, enhance it. Make the report support choosing any of the options (as it is now) or, at the user option, choose a combination of age range plus gender. Hint: add additional check boxes to allow the user to control which set of logic will be applied. We should also change the code to use CASE statements (rather than IF statements). CASE statements often provide an easier to understand view of the logic. </p>
<p class="calibre1"><b class="calibre3">Testing the completed report</b></p>
<p class="calibre1">After we save and compile our report, we’ll run it again. Now, we will get an expanded request option page. After this, we check-marked a couple of the selection criteria, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 332 ]</b></p>
<p class="calibre1"><a id="calibre_link-490"></a><img src="images/000083.jpg" alt="Image 350" class="calibre2" /></p>
<p class="calibre1"><img src="images/000104.jpg" alt="Image 351" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">Now, let’s preview our report. Using the sample data we previously illustrated, our report output shows two records in the following screenshot; one selected on the basis of Gender and the other on Age:</p>
<p class="calibre1"><b class="calibre3">[ 333 ]</b></p>
<p class="calibre1"><a id="calibre_link-198"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">At this point, we have a report that runs and is useful. It can be enhanced to support more complex selection criteria. As usual, there are a number of different ways to accomplish essentially the same result. Some of those paths would be significantly different for the developer, but nearly invisible to the user. Some might not even matter to the next developer who has to work on this report. What is important at this point is that the result works reliably, provides the desired output, operates with reasonable speed, and does not cost too much to create or maintain. If all of these goals are met, most of the other differences are usually not very important. </p>
<p class="calibre1"><b class="calibre3">Summary</b></p>
<p class="calibre1"> <i class="calibre4">“Furniture or gold can be taken away from you, but knowledge and a new language can</i> <i class="calibre4">easily be taken from one place to the other, and nobody can take them away from you.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; David Schwarzer</i></p>
<p class="calibre1">In this chapter, we covered Visual Studio Code navigation. We covered a number of AL</p>
<p class="calibre1">language areas, including procedures and how they may be used, variables of various types (both development and system), basic AL syntax, expressions, and operators. Some of the essential AL procedures that we covered included user dialogs, SETRANGE filtering, GET, variations of FIND, and BEGIN-END for code structures, plus IF-THEN for basic process flow control. Finally, we got some hands-on experience by adding validation code to a table and creating a new report that included embedded AL code and a request page. </p>
<p class="calibre1">In the next chapter, we will expand our exploration and practice using AL. We will learn about additional AL procedures, flow control structures, input/output procedures, and filtering. </p>
<p class="calibre1"><b class="calibre3">Questions</b></p>
<p class="calibre1">1. All Business Central objects can contain AL code&mdash;true or false? </p>
<p class="calibre1">2. Which object type has to be designed outside of Visual Studio Code? Choose one: Page</p>
<p class="calibre1">XmlPort</p>
<p class="calibre1">Table</p>
<p class="calibre1">Report</p>
<p class="calibre1"><b class="calibre3">[ 334 ]</b></p>
<p class="calibre1"><a id="calibre_link-491"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">3. All AL Assignment statements include the symbol&mdash;true or false? </p>
<p class="calibre1">4. One setting defines how parameters are passed to procedures, that is, whether a parameter is passed by reference or by value. Choose that one setting identity:</p>
<p class="calibre1">DataType</p>
<p class="calibre1">Subtype</p>
<p class="calibre1">Var</p>
<p class="calibre1">Value</p>
<p class="calibre1">5. In Visual Studio Code, we can use wizards to get started with object<br>definitions&mdash;true or false? </p>
<p class="calibre1">6. The AL code cannot be inserted into the RDLC generated by the Visual Studio</p>
<p class="calibre1">Report Designer (or the SQL Server Report Builder)&mdash;true or false? </p>
<p class="calibre1">7. When a table definition is changed, the fields should always be added to all<br>pages&mdash;true or false? </p>
<p class="calibre1">8. Object numbers and names are so flexible that we can (and should) choose our<br>own approach to numbering and naming&mdash;true or false? </p>
<p class="calibre1">9. BEGIN-END are always required in IF statements&mdash;true or false? </p>
<p class="calibre1">10. All Business Central development work starts from Visual Studio Code&mdash;true or false? </p>
<p class="calibre1">11. Modifiable procedures include which of the following? Choose two:</p>
<p class="calibre1">Application management</p>
<p class="calibre1">DATE2MDY</p>
<p class="calibre1">Mail</p>
<p class="calibre1">STRLEN</p>
<p class="calibre1">12. Report heading text can either be typed in manually or brought into Word<br>through label parameters&mdash;true or false? </p>
<p class="calibre1">13. Whenever possible, the controlling logic to manage data should be resident<br>within the tables&mdash;true or false? </p>
<p class="calibre1"><b class="calibre3">[ 335 ]</b></p>
<p class="calibre1"><a id="calibre_link-492"></a> <i class="calibre4">Introduction to AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 6</i></p>
<p class="calibre1">14. Filter wildcards include which three of the following? </p>
<p class="calibre1">? </p>
<p class="calibre1">::</p>
<p class="calibre1">*</p>
<p class="calibre1">^</p>
<p class="calibre1">@</p>
<p class="calibre1">15. Choice of the proper version of the FIND statement can make a significant<br>difference in processing speed&mdash;true or false? </p>
<p class="calibre1">16. When we are working in Visual Studio Code to change AL code, the object<br>designer automatically backs up our work every few minutes so that we don’t<br>have to&mdash;true or false? </p>
<p class="calibre1">17. When an ERROR statement is executed, the user is given the choice to terminate processing, cause a rollback, or to ignore the error and continue processing&mdash;true or false? </p>
<p class="calibre1">18. Arithmetic operators and procedures include which of the following? Choose<br>two:</p>
<p class="calibre1">*</p>
<p class="calibre1">&gt; </p>
<p class="calibre1">=</p>
<p class="calibre1">/</p>
<p class="calibre1"><b class="calibre3">[ 336 ]</b></p>
<p class="calibre1"><a id="calibre_link-199"></a>7</p>
<p class="calibre1">Intermediate AL</p>
<p class="calibre1"> <i class="calibre4">“You need to “listen deeply”&mdash;listen past what people say they want to hear to what they</i> <i class="calibre4">need.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Jon Meads</i></p>
<p class="calibre1"> <i class="calibre4">“People’s behavior makes sense if you think about it in terms of their goals, needs, and</i> <i class="calibre4">motives.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Thomas Mann</i></p>
<p class="calibre1">In the previous chapter, you learned enough AL to create a basic operational set of code. In this chapter, you will learn more AL functions and pick up a few more good habits along the way. If you are getting started as a professional Business Central developer, the built-in AL functions represent a significant portion of the knowledge that you will need on a day-to-day basis. If you are a manager or consultant needing to know what Business Central can do for your business or your customer, an understanding of these functions will help you too. </p>
<p class="calibre1">Our goal is to competently manage I/O, create moderately complex program logic<br>structures, and understand data filtering and sorting as handled in Business Central and AL. Because the functions and features in AL are designed for business and financial applications, we can do a surprising amount of ERP work in Business Central with a relatively small number of language constructs. </p>
<p class="calibre1"><a id="calibre_link-200"></a><img src="images/000128.png" alt="Image 352" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">Keep in mind that anything discussed in this chapter relates only indirectly to those portions of Business Central objects that contain no AL, for example, Microsoft <b class="calibre3">SQL Server</b> <b class="calibre3">Report Builder</b> (<b class="calibre3">SSRB</b>) and Microsoft Word report layouts. This chapter’s goals are to accomplish the following:</p>
<p class="calibre1">Review some AL development basics</p>
<p class="calibre1">Learn about a variety of useful (and widely used) AL functions</p>
<p class="calibre1">Better understand filtering</p>
<p class="calibre1">Apply what you’ve learned to expand your WDTU application using some of the</p>
<p class="calibre1">AL development tools</p>
<p class="calibre1"><a href="#calibre_link-2">As described in Chapter 1, </a> <i class="calibre4">Introduction to Business Central</i>, all internal Business Central logic development is done in AL and all AL development is done in Visual Studio Code. </p>
<p class="calibre1">Some user interface design is done using Microsoft Word. It is also possible to integrate JavaScript objects for a variety of purposes. </p>
<p class="calibre1"><b class="calibre3">IntelliSense</b></p>
<p class="calibre1">As an IDE, Visual Studio Code contains a number of tools designed to make our AL</p>
<p class="calibre1">development effort easier. One of these is IntelliSense. When we are in one of the areas where AL code is supported, the IntelliSense menu window can be accessed via  <i class="calibre4">Ctrl</i> +</p>
<p class="calibre1">spacebar:</p>
<p class="calibre1">IntelliSense is a very useful multi-purpose tool for the developer. It serves the following purposes:</p>
<p class="calibre1">As a quick reference to the available AL functions</p>
<p class="calibre1">Documentation of the syntax of those functions</p>
<p class="calibre1">Access Microsoft Docs for more information on those functions</p>
<p class="calibre1">As a source of variable names or function structures to paste into our code</p>
<p class="calibre1"><b class="calibre3">[ 338 ]</b></p>
<p class="calibre1"><a id="calibre_link-201"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The use of IntelliSense for reference purposes is especially helpful, not only when we are a beginning AL developer, but also after we have become experienced developers. It is a guide to the inventory of available code tools with some very handy built-in programming aids. </p>
<p class="calibre1">The second use of IntelliSense is as a symbol table. The symbol table for our object is visible in the left column of IntelliSense’s display. The displayed symbol set (the variable set) is context sensitive. It will include all system-defined symbols, and all our global and local symbols from the function that had focus at the time we accessed IntelliSense. Although it would be useful, there is no way within the symbol menu to see all local variables in one view. The local symbols will be at the top of the list, but we have to know the name of the first global symbol to determine the scope of a particular variable (that is, if an entry appears in the symbol list before the first global, it is a local variable; otherwise, it’s global). </p>
<p class="calibre1">The third use for IntelliSense is as a code template with a paste function option available, as well as a list of available snippets. The snippets start with the letter t and can most often be found at the end of the list or simply by pressing the letter t. </p>
<p class="calibre1"><b class="calibre3">Internal documentation</b></p>
<p class="calibre1">When we are creating or modifying software, we should always document what we have done. It is often difficult for developers to spend much time (time equals money) on documentation because many don’t enjoy doing it, and the benefits to customers are difficult to quantify in advance. A reasonable goal is to provide enough documentation so that a knowledgeable person can later understand what we have done, as well as the reasons why. </p>
<p class="calibre1">If we choose good variable names, the AL code will tend to be self-documenting. If we lay our code out neatly, use indentation consistently, and localize logical elements in functions, then the flow of our code should be easy to read. We should also include comments that describe the functional reason for the change. This will help the next person working in this code not only be able to follow the logic of the code, but to understand the business reasons for that code. </p>
<p class="calibre1">In the case of a brand-new function, a simple statement of purpose is often all that is necessary. In the case of a modification, it is extremely useful to have comments providing a functional definition of what the change is intended to accomplish, as well as a description of what has been changed. If there is external documentation of the change, including a design specification, the comments in the code should refer back to this external documentation. </p>
<p class="calibre1"><b class="calibre3">[ 339 ]</b></p>
<p class="calibre1"><a id="calibre_link-493"></a><img src="images/000148.jpg" alt="Image 353" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">In any case, the primary focus should be on the functional reason for the change, not just the technical reason. Any good programmer can study the code and understand what changed, but without the documentation describing why the change was made, the task of the next person to maintain or upgrade that code will be made much more difficult. </p>
<p class="calibre1">Inline comments can be done in two ways. The most visible way is to use a // character sequence (two forward slashes). The text that follows the slashes on that line will be treated as a comment by the compiler&mdash;it will be ignored. If the comment spans multiple physical lines, each line of the comment must also be preceded by two forward slashes. </p>
<p class="calibre1">In the following screenshot, we have used // to place comments inline to identify a change: A second way to place a comment within code is to surround the comment with a matched pair of braces { }. As braces are less visible than the slashes, we should use // when our comment is relatively short. If we decide to use { }, it’s a good idea to insert a // comment, at least at the beginning and end of the material inside the braces to make the comments more visible. It is also highly recommended to put each of the braces on a separate line to make them more obvious. Some experienced developers recommend using // on all<br>removed code lines to make the deletions easier to spot later. </p>
<p class="calibre1">Consider the following lines of code as an example:</p>
<p class="calibre1">{//CDM.07.02 start deletion &ndash;&ndash;&ndash;&ndash;-</p>
<p class="calibre1">//CDM.07.02 Replace validation with a call to an external function</p>
<p class="calibre1">…miscellaneous AL validation code</p>
<p class="calibre1">//CDM.07.02 end deletion &ndash;&ndash;&ndash;&ndash;- }</p>
<p class="calibre1"><b class="calibre3">[ 340 ]</b></p>
<p class="calibre1"><a id="calibre_link-202"></a><img src="images/000170.jpg" alt="Image 354" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">If, as part of a modification, we delete code that is part of the original distribution, we should leave the original statements in place, but commented out so that the old code is inoperative (an exception to this may apply if a source code control system that tracks all changes is in use). The same concept applies when we change the existing code; leave the original code in place commented out with the new version being inserted, as shown in the following screenshot. This approach does not necessarily apply to the code that we created originally:</p>
<p class="calibre1">Yet another approach, one that is especially suitable for modifications that exceed a small number of lines of code or that will be called from multiple places, is to create a new function for the modification. Name the function so that its purpose is obvious, and then call the function from the point of use. In this case, that function might be named something such as CheckDatePrizeLastWon. In this case, the function would only have one line of code (not a good example), and we would pass in the Last Prize Date value. The<br>function would return a Boolean value, telling us whether the individual was eligible for a new prize. </p>
<p class="calibre1"><b class="calibre3">Source code management</b></p>
<p class="calibre1">Instead of documenting within the code, many developers choose to use source code management tools, such as GitHub or Microsoft DevOps. </p>
<p class="calibre1">Tools such as these allow you to create change requests and connect changed code to these requests. Once the change is validated, it is connected to the documentation, automatically creating a knowledge database outside of the source code. This keeps the source code clean and readable. </p>
<p class="calibre1"><b class="calibre3">[ 341 ]</b></p>
<p class="calibre1"><a id="calibre_link-203"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">Validation functions</b></p>
<p class="calibre1">AL includes a number of utility functions that are designed to facilitate data validation or initialization. Some of these functions are as follows:</p>
<p class="calibre1">TESTFIELD</p>
<p class="calibre1">FIELDERROR</p>
<p class="calibre1">INIT</p>
<p class="calibre1">VALIDATE</p>
<p class="calibre1">We will discuss these functions more in the following sections. </p>
<p class="calibre1"><b class="calibre3">TESTFIELD</b></p>
<p class="calibre1">The TESTFIELD function is widely used in standard Business Central code. With</p>
<p class="calibre1">TESTFIELD, we can test a variable value and generate an error message in a single statement if the test fails. The syntax is as follows:</p>
<p class="calibre1">Record.TESTFIELD (Field, [Value])</p>
<p class="calibre1">If Value is specified and the field does not equal that value, the process terminates with an error condition, and an error message is issued. </p>
<p class="calibre1">If no Value is specified, the field contents are checked for values of zero or blank. If the field is zero or blank, then an error message is issued. </p>
<p class="calibre1">The advantage of TESTFIELD is ease of use and consistency in code, and in the message displayed. The disadvantage is the error message is not as informative as a careful developer would provide. </p>
<p class="calibre1"><b class="calibre3">[ 342 ]</b></p>
<p class="calibre1"><a id="calibre_link-204"></a><img src="images/000192.png" alt="Image 355" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The following screenshot of the TESTFIELD function usage is from Table 18 -</p>
<p class="calibre1">Customer. This code checks to make sure that the <b class="calibre3">Sales Order</b> field’s Status is equal to the option value Open before allowing the value of the <b class="calibre3">Sell-to Customer No. </b> field to be entered:</p>
<p class="calibre1">TESTFIELD(State,Status::Open); </p>
<p class="calibre1">An example of the error message that is generated when attempting to change the <b class="calibre3">Sell-to</b> <b class="calibre3">Customer No. </b> field when Status is not equal to the option value Open is as follows: <b class="calibre3">FIELDERROR</b></p>
<p class="calibre1">Another function, which is very similar to the TESTFIELD function, is FIELDERROR. </p>
<p class="calibre1">However, where TESTFIELD performs a test and terminates with either an error or an OK</p>
<p class="calibre1">result, FIELDERROR presumes that the test was already performed and the field failed the test. FIELDERROR is designed to display an error message and then terminate the process. </p>
<p class="calibre1">This approach is followed in much of the standard Business Central logic, especially in the posting codeunits (for example, codeunits 12, 80, and 90). The syntax is as follows: TableName.FIELDERROR(FieldName[,OptionalMsgText]); </p>
<p class="calibre1">If we include our own message text by defining a text constant in the variable section (so that the message can be multilingual), we will have the following line of code:</p>
<p class="calibre1">Text001    must be greater than Start Time</p>
<p class="calibre1">Then, we can reference the text constant in code as follows:</p>
<p class="calibre1">IF Rec.“End Time” &lt;= “Start Time” THEN</p>
<p class="calibre1">Rec.FIELDERROR(“End Time”,Text001); </p>
<p class="calibre1"><b class="calibre3">[ 343 ]</b></p>
<p class="calibre1"><a id="calibre_link-349"></a><img src="images/000214.jpg" alt="Image 356" class="calibre2" /></p>
<p class="calibre1"><img src="images/000239.jpg" alt="Image 357" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The result is an error message from FIELDERROR, as shown in the following screenshot: An error message that simply identifies the data field, but does not reference a message text, is as follows, with the record key information displayed:</p>
<p class="calibre1">Because the error message begins with the name of the field, we will need to be careful that our text constant is structured to make the resulting error message easy to read. </p>
<p class="calibre1">If we don’t include our own message text, the default message comes in two flavors. The first instance is the case where the referenced field is not empty. Then, the error message presumes that the error is due to a wrong value, as shown in the previous screenshot. In this case, where the referenced data field is empty, the error message logic presumes that the field should not be empty, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 344 ]</b></p>
<p class="calibre1"><a id="calibre_link-205"></a><img src="images/000262.jpg" alt="Image 358" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">INIT</b></p>
<p class="calibre1">The INIT function initializes a record in preparation for its use, typically in the course of building a record entry to insert in a table. The syntax is as follows:</p>
<p class="calibre1">Record.INIT; </p>
<p class="calibre1">All the data fields in the record are initialized as follows:</p>
<p class="calibre1">Fields that have an InitValue property defined are initialized to the specified<br>value. </p>
<p class="calibre1">Fields that do not have a defined InitValue are initialized to the default value for their data type. </p>
<p class="calibre1">Primary key fields and timestamps are not automatically initialized. If they<br>contain values, those will remain. If new values are desired, they must be<br>assigned in code. </p>
<p class="calibre1"><b class="calibre3">VALIDATE</b></p>
<p class="calibre1">The syntax of the VALIDATE function is as follows:</p>
<p class="calibre1">Record.VALIDATE (Field [, Value])</p>
<p class="calibre1">VALIDATE will fire the OnValidate trigger of Record.Field. If we have specified a Value, it is assigned to the field and the field validations are invoked. </p>
<p class="calibre1"><b class="calibre3">[ 345 ]</b></p>
<p class="calibre1"><a id="calibre_link-206"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">If we don’t specify a Value, then the field validations are invoked using the field value that already exists in the field. This function allows us to easily centralize our code design around the table&mdash;one of Business Central’s strengths. </p>
<p class="calibre1">For example, if we were to code and change Item.“Base Unit of Measure” from one unit of measure to another, the code should make sure that the change is valid. We should get an error if the new unit of measure has any quantity other than 1, because quantity equals 1 is a requirement of the Base Unit of Measurement field. Making the unit of measure change with a simple assignment statement would not catch a quantity value error. </p>
<p class="calibre1">The following are two forms of using VALIDATE that give the same end result:</p>
<p class="calibre1">Item.VALIDATE(“Base Unit of Measure”,‘Box’)</p>
<p class="calibre1">Item.“Base Unit of Measure” := ‘Box’; </p>
<p class="calibre1">Item.VALIDATE(“Base Unit of Measure”); </p>
<p class="calibre1"><b class="calibre3">Date and time functions</b></p>
<p class="calibre1">Business Central provides a considerable number of date and time functions. In the following sections, we will cover several of those that are more commonly used, especially in the context of accounting date-sensitive activity:</p>
<p class="calibre1">TODAY, TIME, and CURRENTDATETIME functions</p>
<p class="calibre1">WORKDATE function</p>
<p class="calibre1">DATE2DMY, DATE2DWY, DMY2DATE, DWY2DATE, and CALCDATE functions</p>
<p class="calibre1"><b class="calibre3">TODAY, TIME, and CURRENTDATETIME</b></p>
<p class="calibre1">TODAY retrieves the current system date, as set in the operating system. TIME retrieves the current system time, as set in the operating system. CURRENTDATETIME retrieves the current date and time in the DATETIME format, which is stored in UTC international time (formerly referenced as <b class="calibre3">GMT</b> or <b class="calibre3">Greenwich Mean Time</b>) and then displayed in local time. If we are using the Windows client, these use the time setting in the Business Central client. If the system operates in multiple time zones at one time, search Microsoft Dynamics</p>
<p class="calibre1">Business Central Help on the time zone for several references on how to deal with multiple time zones. </p>
<p class="calibre1"><b class="calibre3">[ 346 ]</b></p>
<p class="calibre1"><a id="calibre_link-207"></a><img src="images/000283.jpg" alt="Image 359" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The syntax for each of these is as follows:</p>
<p class="calibre1">DateField := TODAY; </p>
<p class="calibre1">TimeField := TIME; </p>
<p class="calibre1">DateTimeField := CURRENTDATETIME; </p>
<p class="calibre1">These are often used for date- and time-stamping transactions or for filling in default values in fields of the appropriate data type. For data-entry purposes, the current system date can be entered by simply typing the letter T or the word TODAY in the date-entry field (this is not a case-sensitive entry). Business Central will automatically convert that entry into the current system date. </p>
<p class="calibre1">The undefined date in Business Central is represented by the earliest valid DATETIME in SQL Server, which is January 1, 1753 00:00:00:000. The undefined date in Business Central is represented as  <i class="calibre4">0D</i> (zero  <i class="calibre4">D</i>, as in days), with subsequent dates handled through December 31, 9999. A date outside this range will result in a runtime error. </p>
<p class="calibre1">The Microsoft Dynamics Business Central undefined time ( <i class="calibre4">0T</i>) is represented by the same value as an undefined date ( <i class="calibre4">0D</i>) is represented. </p>
<p class="calibre1">If a two-digit year is entered or stored as a date and has a value of 30 to 99, it is assumed to be in the 1900s. If the two-digit date is in the range of 00 to 29, then it is treated as a 2000s date. </p>
<p class="calibre1"><b class="calibre3">WORKDATE</b></p>
<p class="calibre1">Many standard Business Central routines default dates to the work date rather than to the system date. When a user logs into the system, the work date is initially set equal to the system date. However, at any time, the operator can set the work date to any date by accessing the application menu and clicking on <b class="calibre3">Set Work Date… </b>, and then entering the new work date:</p>
<p class="calibre1"><b class="calibre3">[ 347 ]</b></p>
<p class="calibre1"><a id="calibre_link-340"></a><img src="images/000304.jpg" alt="Image 360" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The user can also click on the <b class="calibre3">Work Date</b> displayed in the status bar at the bottom of the RTC. The following screenshot shows how to set the work date:</p>
<p class="calibre1">For data-entry purposes, the current work date can be entered by the operator by simply typing the letter w or W or the word WORKDATE in the date entry field. Business Central will automatically convert that entry into the current work date. </p>
<p class="calibre1">The syntax to access the current WorkDate value from within AL code is as follows: DateField := WORKDATE; </p>
<p class="calibre1">The syntax to set the WORKDATE to a new date from within AL code is as follows:</p>
<p class="calibre1">WORKDATE(newdate); </p>
<p class="calibre1"><b class="calibre3">[ 348 ]</b></p>
<p class="calibre1"><a id="calibre_link-208"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">DATE2DMY function</b></p>
<p class="calibre1">DATE2DMY allows us to extract the sections of a date (day of the month, month, and year) from a Date field. The syntax is as follows:</p>
<p class="calibre1">IntegerVariable := DATE2DMY ( DateField, ExtractionChoice )</p>
<p class="calibre1">IntegerVariable and DateField are just as their names imply. The ExtractionChoice parameter allows us to choose which value (day, month, or year) will be assigned to the IntegerVariable field. The following table provides the DATE2DMY extraction choices: <b class="calibre3">DATE2DMY extraction choice</b></p>
<p class="calibre1"><b class="calibre3">Integer value result</b></p>
<p class="calibre1">1</p>
<p class="calibre1">2-digit day (1&ndash;31)</p>
<p class="calibre1">2</p>
<p class="calibre1">2-digit month (1&ndash;12)</p>
<p class="calibre1">3</p>
<p class="calibre1">4-digit year</p>
<p class="calibre1"><b class="calibre3">DATE2DWY function</b></p>
<p class="calibre1">DATE2DWY allows us to extract the sections of a date (day of the week, week of the year, and year) from a DateField in exactly the same fashion as DATE2DMY. The ExtractionChoice parameter allows us to choose which value (day, week, or year) will be assigned to IntegerVariable, as shown in the following table:</p>
<p class="calibre1"><b class="calibre3">DATE2DWY extraction choice</b></p>
<p class="calibre1"><b class="calibre3">Integer value result</b></p>
<p class="calibre1">1</p>
<p class="calibre1">2-digit day (1&ndash;7 for Monday to Sunday)</p>
<p class="calibre1">2</p>
<p class="calibre1">2-digit week (1&ndash;53)</p>
<p class="calibre1">3</p>
<p class="calibre1">4-digit year</p>
<p class="calibre1"><b class="calibre3">DMY2DATE and DWY2DATE functions</b></p>
<p class="calibre1">DMY2DATE allows us to create a date from integer values (or defaults) representing the day of the month, month of the year, and the four-digit year. If an optional parameter (MonthValue or YearValue) is not specified, the corresponding value from the system date is used. The syntax is as follows:</p>
<p class="calibre1">DateVariable := DMY2DATE ( DayValue [, MonthValue] [, YearValue] )</p>
<p class="calibre1"><b class="calibre3">[ 349 ]</b></p>
<p class="calibre1"><a id="calibre_link-209"></a><img src="images/000323.png" alt="Image 361" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The only way to have the function use work date values for month and year is to extract those values and then use them explicitly. An example is as follows:</p>
<p class="calibre1">DateVariable := DMY2DATE(22,DATE2MDY(WORKDATE,2),DATE2MDY(WORKDATE,3))</p>
<p class="calibre1">This example also illustrates how expressions can be built up of nested<br>expressions and functions. We have WORKDATE within DATE2MDY within</p>
<p class="calibre1">DMY2DATE. </p>
<p class="calibre1">DWY2DATE operates similarly to DMY2DATE, allowing us to create a date from integer values representing the day of the week (from 1 to 7 representing Monday to Sunday), week of the year (from 1 to 53), followed by the four-digit year. The syntax is as follows:</p>
<p class="calibre1">DateVariable := DWY2DATE ( DayValue [, WeekValue] [, YearValue] )</p>
<p class="calibre1">An interesting result can occur for week 53 because it can span two years. By default, such a week is assigned to the year in which it has four or more days. In that case, the year of the result will vary, depending on the day of the week in the parameters (in other words, the year of the result may be one year greater than the year specified in the parameters). This is a perfect example of why thorough testing of our code is always appropriate. </p>
<p class="calibre1"><b class="calibre3">CALCDATE</b></p>
<p class="calibre1">CALCDATE allows us to calculate a date value that’s been assigned to a date data type variable. The calculation is based on DateExpression that’s been applied to a base date (reference date). If we don’t specify BaseDateValue, the current system date is used as the default date. We can specify BaseDateValue either in the form of a variable of data type date or as a date constant. </p>
<p class="calibre1">The syntax for CALCDATE is as follows:</p>
<p class="calibre1">DateVariable := CALCDATE ( DateExpression [, BaseDateValue])</p>
<p class="calibre1">There are a number of ways in which we can build a DateExpression. The rules for the CALCDATE function, DateExpression, are similar to the rules for DateFormula, which are</p>
<p class="calibre1"><a href="#calibre_link-68">described in Chapter 3</a>,  <i class="calibre4">Data Types and Fields</i>. </p>
<p class="calibre1">If there is a CW, CM, CP, CQ, or CY (current week, current month, current period, current quarter, or current year, respectively) parameter in an expression, then the result will be evaluated based on the BaseDateValue. If we have more than one of these in our<br>expression, the results are unpredictable. Any such expression should be thoroughly tested before being released to users. </p>
<p class="calibre1"><b class="calibre3">[ 350 ]</b></p>
<p class="calibre1"><a id="calibre_link-210"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">If DateExpression is stored in a DateFormula variable (or a text or code variable with the DateFormula property set to Yes), then the DateExpression will be language<br>independent. Also, if we create our own DateExpression in the form of a string constant within our inline AL code, surrounding the constant with &lt; &gt; delimiters as part of the string, it will make the constant language independent. Otherwise, the DateExpression constant will be language dependent. </p>
<p class="calibre1">Regardless of how we have constructed our DateExpression, it is important to test it carefully and thoroughly before moving on. Incorrect syntax will result in a runtime error. </p>
<p class="calibre1">One easy way to test it is by using a report whose sole task is to evaluate our expression and display the result. If we want to try different base dates, we can use the request page, accept the BaseDateValue as input, then calculate and display the DateVariable in the OnValidate trigger. </p>
<p class="calibre1">Some sample CALCDATE expression evaluations are as follows:</p>
<p class="calibre1">(‘&lt;CM&gt;’,031017D) will yield 03/31/2017, that is, the last day of the current month for the date 3/10/2017</p>
<p class="calibre1">(‘&lt;-WD2&gt;’,031216D) will yield 03/08/2016, that is, the WeekDay #2 (the<br>prior Tuesday) before the date 3/12/2016</p>
<p class="calibre1">(‘&lt;CM+1D&gt;’,BaseDate), where BaseDate equals 03/10/17, will yield</p>
<p class="calibre1">04/01/2017, that is, the last day of the month of the base date plus one day (the first day of the month following the base date)</p>
<p class="calibre1"><b class="calibre3">Data conversion and formatting functions</b></p>
<p class="calibre1">Some data-type conversions are handled in the normal process flow by Business Central without any particular attention on part of the developer, such as code to text and character to text. Some data-type conversions can only be handled through AL functions. Formatting is included because it can also include a data-type conversion. Rounding does not do a data-type conversion, but it does result in a change in format (the number of decimal places). Let’s review the following functions:</p>
<p class="calibre1">ROUND function</p>
<p class="calibre1">FORMAT function</p>
<p class="calibre1">EVALUATE function</p>
<p class="calibre1"><b class="calibre3">[ 351 ]</b></p>
<p class="calibre1"><a id="calibre_link-211"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">ROUND</b></p>
<p class="calibre1">The ROUND function allows us to control the rounding precision for a decimal expression. </p>
<p class="calibre1">The syntax for the ROUND function is as follows:</p>
<p class="calibre1">DecimalResult := ROUND (Number [, Precision] [, Direction] )</p>
<p class="calibre1">Here, Number is rounded, Precision spells out the number of digits of decimal precision, and Direction indicates whether to round up, round down, or round to the nearest number. Some examples of Precision values are shown in the following table:</p>
<p class="calibre1"><b class="calibre3">Precision value</b></p>
<p class="calibre1"><b class="calibre3">Rounding effect</b></p>
<p class="calibre1">100</p>
<p class="calibre1">To a multiple of 100</p>
<p class="calibre1">1</p>
<p class="calibre1">To an integer format</p>
<p class="calibre1">01</p>
<p class="calibre1">To two decimal places (the US default)</p>
<p class="calibre1">0.01</p>
<p class="calibre1">Same as .01</p>
<p class="calibre1">.0001</p>
<p class="calibre1">To four decimal places</p>
<p class="calibre1">If no Precision value is specified, the rounding default is controlled by a value set in General Ledger <b class="calibre3">Setup</b> in the <b class="calibre3">Appln. Rounding Precision</b> field on the <b class="calibre3">Application</b> tab. If no value is specified, rounding will default to two decimal places. If the precision value is, for example, .04 rather than .01, the rounding will be done to multiples of 4 at the number of decimal places specified. </p>
<p class="calibre1">The options available for the direction value are shown in the following table:</p>
<p class="calibre1"><b class="calibre3">Direction value (a text</b></p>
<p class="calibre1"><b class="calibre3">value)</b></p>
<p class="calibre1"><b class="calibre3">Rounding effect</b></p>
<p class="calibre1">‘=’ </p>
<p class="calibre1">Round to the nearest (mathematically correct and the default)</p>
<p class="calibre1">‘&gt;’ </p>
<p class="calibre1">Round up</p>
<p class="calibre1">‘&lt;’ </p>
<p class="calibre1">Round down</p>
<p class="calibre1">Consider the following statement:</p>
<p class="calibre1">DecimalValue := ROUND (1234.56789,0.001,’&lt;’)</p>
<p class="calibre1"><b class="calibre3">[ 352 ]</b></p>
<p class="calibre1"><a id="calibre_link-212"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">This would result in a DecimalValue containing 1234.567. Let’s check out the following statements:</p>
<p class="calibre1">DecimalValue := ROUND (1234.56789,0.001,’=’)</p>
<p class="calibre1">DecimalValue := ROUND (1234.56789,0.001,’&gt;’)</p>
<p class="calibre1">These both result in a DecimalValue containing 1234.568. </p>
<p class="calibre1"><b class="calibre3">FORMAT function</b></p>
<p class="calibre1">The FORMAT function allows you to convert an expression of any data type (for example, integer, decimal, date, option, time, Boolean) into a formatted string. The syntax is as follows:</p>
<p class="calibre1">StringField := FORMAT( ExpressionToFormat [, OutputLength]</p>
<p class="calibre1">[, FormatString or FormatNumber])</p>
<p class="calibre1">The formatted output of the ExpressionToFormat will be assigned to the output<br>of StringField. The optional parameters control the conversion according to a complex set of rules. These rules can be found in Microsoft Docs for the FORMAT function and FORMAT property. Whenever possible, we should always apply FORMAT in its simplest form. </p>
<p class="calibre1">The best way to determine the likely results of a FORMAT expression is to test it through a range of the values to be formatted. We should make sure that we include the extremes of the range of possible values in our testing. </p>
<p class="calibre1">The optional OutputLength parameter can be zero (the default), a positive integer, or a negative integer. The typical OutputLength value is either zero, in which case the defined format is fully applied, or it is a value designed to control the maximum character length and padding of the formatted string result. </p>
<p class="calibre1">The last optional parameter has two mutually exclusive sets of choices. One set, represented by an integer FormatNumber, allows the choice of a particular predefined (standard) format, of which there are four to nine choices depending on the</p>
<p class="calibre1">ExpressionToFormat data type. The format parameter of the number 9 is used for</p>
<p class="calibre1">XMLport data exporting. Use of the optional number 9 parameter will convert AL format data types into XML standard data types. The other set of choices allows us to build our own format expression. </p>
<p class="calibre1"><b class="calibre3">[ 353 ]</b></p>
<p class="calibre1"><a id="calibre_link-213"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The Microsoft Docs information for the FORMAT property provides a relatively complete description of the available tools from which we can build our own format expression. </p>
<p class="calibre1">Even though the FORMAT function is non-executable, an erroneous FORMAT function will result in a runtime error that will terminate the execution of the process. Thus, to avoid production crashes, it is very important that we thoroughly test any code where FORMAT is used. </p>
<p class="calibre1"><b class="calibre3">EVALUATE function</b></p>
<p class="calibre1">The EVALUATE function is essentially the reverse of the FORMAT function, allowing for the conversion of a string value into the defined data type. The syntax of the EVALUATE</p>
<p class="calibre1">function is as follows:</p>
<p class="calibre1">[ BooleanVariable := ] EVALUATE ( ResultVariable, </p>
<p class="calibre1">StringToBeConverted [, 9]</p>
<p class="calibre1">The handling of a runtime error can be done by specifying BooleanVariable or including EVALUATE in an expression to deal with an error, such as an IF statement. The</p>
<p class="calibre1">ResultVariable data type will determine what data conversion the EVALUATE function will attempt. The format of the data in StringToBeConverted must be compatible with the data type of ResultVariable; otherwise, a runtime error will occur. </p>
<p class="calibre1">The optional parameter, number 9, is only used for XMLport data exporting. Use of the optional number 9 parameter will convert Business Central format data types into XML</p>
<p class="calibre1">standard data types. This deals with the fact that several equivalent XML data types are represented differently at the base system level, that is, under the covers. The Business Central data types for an EVALUATE result can include decimal, Boolean, DateTime, date, time, integer, and duration. </p>
<p class="calibre1"><b class="calibre3">FlowField and SumIndexField functions</b></p>
<p class="calibre1"><a href="#calibre_link-68">In Chapter 3</a>,  <i class="calibre4">Data Types and Fields</i>, we discussed SumIndexFields and FlowFields in the context of table, field, and key definition. To recap briefly, SumIndexFields are defined in the screen where the table keys are defined. They allow for the very rapid calculation of values in filtered data. In most ERP and accounting software systems, the calculation of group totals, periodic totals, and so on requires time consuming-processing of all the data to be totaled. </p>
<p class="calibre1"><b class="calibre3">[ 354 ]</b></p>
<p class="calibre1"><a id="calibre_link-494"></a><img src="images/000346.png" alt="Image 362" class="calibre2" /></p>
<p class="calibre1"><img src="images/000367.png" alt="Image 363" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">SIFT allows a Business Central system to respond almost instantly with totals in any area where the SumIndexField was defined and is maintained. In fact, use of SIFT totals combined with Business Central’s retention of detailed data supports totally flexible ad hoc queries of the form “What were our sales for red widgets between the dates<br>of November 15th through December 24th?”. And the answer is returned almost instantly! SumIndexFields are the basis of FlowFields that have a method of Sum or Average; such a FlowField must refer to a data element that is defined as a</p>
<p class="calibre1">SumIndexField. </p>
<p class="calibre1">When we access a record that has a SumIndexField defined, there is no visible evidence of the data sum that SumIndexField represents. When we access a record that contains FlowFields, the FlowFields are empty virtual data elements until they are calculated. When a FlowField is displayed in a page or report, it is automatically calculated by Business Central; the developer doesn’t need to do so. However, in any other scenario, the developer is responsible for calculating FlowFields using the CALCFIELDS function. </p>
<p class="calibre1">FlowFields are one of the key areas where Business Central systems are subject to significant processing bottlenecks. Even with the improved design, it is still critical that the table keys used for the SumIndexField definition are designed with efficient processing in mind. Sometimes, as part of a performance tuning effort, it’s necessary to revise existing keys or add new keys to improve FlowField performance. </p>
<p class="calibre1">Note that even though we can manage indexes in SQL Server<br>independently of the Business Central key definitions, having two<br>different definitions of keys for a single table may make our system more<br>difficult to support in the long run because the SQL Server resident<br>changes aren’t always readily visible to the Business Central developer. </p>
<p class="calibre1">In addition to being careful about the SIFT-key structure design, it is also important not to define any SumIndexFields that are not necessary. Each additional SumIndexField adds additional processing requirements and, thus, adds to the processing load of the system. </p>
<p class="calibre1">Including SumIndexFields in a list page display is almost always a bad<br>idea, because each SumIndexField instance must be calculated as it is<br>displayed. Applicable functions include CALCFIELDS, CALCSUMS, and</p>
<p class="calibre1">SETAUTOCALCFIELDS. </p>
<p class="calibre1"><b class="calibre3">[ 355 ]</b></p>
<p class="calibre1"><a id="calibre_link-214"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">CALCFIELDS function</b></p>
<p class="calibre1">The syntax for CALCFIELDS is as follows:</p>
<p class="calibre1">[BooleanField := ] Record.CALCFIELDS ( FlowField1 [, FlowField2] ,…)</p>
<p class="calibre1">Executing the CALCFIELDS function will cause all the specified FlowFields to be calculated. </p>
<p class="calibre1">Specification of the BooleanField allows us to handle any runtime error that may occur. </p>
<p class="calibre1">Any runtime errors for CALCFIELDS usually result from a coding error or a change in a table key structure. </p>
<p class="calibre1">The FlowField calculation takes into account the filters (including FlowFilters) that are currently applied to the record (we need to be careful not to overlook this). After the CALCFIELDS execution, the included FlowFields can be used similarly to any other data fields. The CALCFIELDS must be executed for each cycle through the subject table. </p>
<p class="calibre1">Whenever the contents of a BLOB field are to be used, CALCFIELDS is used to load the contents of the BLOB field from the database into memory. </p>
<p class="calibre1">When the following conditions are true, CALCFIELDS uses dynamically maintained SIFT</p>
<p class="calibre1">data:</p>
<p class="calibre1">The Business Central key contains the fields that are used in the filters that were defined for the FlowField</p>
<p class="calibre1">The SumIndexFields on the operative key contain the fields that are provided<br>as parameters for calculation</p>
<p class="calibre1">The MaintainSIFTIndex property on the key is set to Yes; this is the default<br>setting</p>
<p class="calibre1">If all these conditions are not true and CALCFIELDS is invoked, we will not get a runtime error, but SQL Server will calculate the requested totals the hard way &ndash; by reading all the necessary records. This could be very slow and inefficient, and should not be used for frequently processed routines or large datasets. On the other hand, if the table does not contain a lot of data or the SIFT data will not be used very often, it may be better to have the MaintainSIFTIndex property set to No. </p>
<p class="calibre1"><b class="calibre3">[ 356 ]</b></p>
<p class="calibre1"><a id="calibre_link-215"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">SETAUTOCALCFIELDS function</b></p>
<p class="calibre1">The syntax for SETAUTOCALCFIELDS is as follows:</p>
<p class="calibre1">[BooleanField := ] Record.SETAUTOCALCFIELDS</p>
<p class="calibre1">( FlowField1 [, FlowField2] [, FlowField3]…)</p>
<p class="calibre1">When SETAUTOCALCFIELDS for a table is inserted in code in front of record retrieval, the specified FlowFields are automatically calculated as the record is read. This is more efficient than performing CALCFIELDS on the FlowFields after the record has been read. </p>
<p class="calibre1">If we want to end the automatic FlowField calculation to a record, call the function without any parameters:</p>
<p class="calibre1">[BooleanField := ] Record.SETAUTOCALCFIELDS()</p>
<p class="calibre1">An automatic FlowField calculation equivalent to SETAUTOCALCFIELDS is automatically set for the system record variables, Rec and xRec. </p>
<p class="calibre1"><b class="calibre3">CALCSUMS function</b></p>
<p class="calibre1">The CALCSUMS function is conceptually similar to CALCFIELDS for the calculation of Sums only. However, CALCFIELDS operates on FlowFields and CALCSUMS operates directly on the record where the SumIndexFields are defined for the keys. This difference means that we must specify the proper key, plus any filters to apply when using CALCSUMS (the applicable key and filters to apply are already defined in the properties for the FlowFields). </p>
<p class="calibre1">The syntax for CALCSUMS is as follows:</p>
<p class="calibre1">[ BooleanField := ] Record.CALCSUMS ( SumIndexField1 [,SumIndexField2]</p>
<p class="calibre1">,…)</p>
<p class="calibre1">Prior to a statement of this type, we should specify a key that has the SumIndexFields defined (to maximize the probability of good performance). Before executing the CALCSUMS</p>
<p class="calibre1">function, we also need to specify any filters that we want to apply to the Record from which the sums are to be calculated. The SumIndexFields calculations take into account the filters that are currently applied to the record. </p>
<p class="calibre1"><b class="calibre3">[ 357 ]</b></p>
<p class="calibre1"><a id="calibre_link-216"></a><img src="images/000388.png" alt="Image 364" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">Executing the CALCSUMS function will cause the specified SumIndexFields totals to be calculated. Specification of the BooleanField allows us to handle any runtime error that may occur. Runtime errors for CALCSUMS usually result from a coding error or a change in a table key structure. If possible, CALCSUMS uses the defined SIFT. Otherwise, SQL Server creates totals on the fly. </p>
<p class="calibre1">Before the execution of CALCSUMS, SumIndexFields contain only the data from the<br>individual record that was read. After the execution of CALCSUMS, the included</p>
<p class="calibre1">SumIndexFields contain the totals that were calculated by the CALCSUMS function (these totals are only in memory, not in the database). These totals can then be used the same as data in any field; however, if we want to access the individual record’s original data for that field, we must either save a copy of the record before executing the CALCSUMS or we must reread the record. The CALCSUMS must be executed for each read cycle through the subject table. </p>
<p class="calibre1"><b class="calibre3">Comparing CALCFIELDS and CALCSUMS</b></p>
<p class="calibre1">In the Sales Header record, there are FlowFields defined for Amount and</p>
<p class="calibre1">“AmountIncludingVAT”. These FlowFields are all based on Sums of entries in the SalesLine table. The CalcFormula for Amount is</p>
<p class="calibre1">Sum(“SalesLine”.AmountWHERE(DocumentType=FIELD(DocumentType),DocumentNo</p>
<p class="calibre1">.=FIELD(No.))). </p>
<p class="calibre1">CALCSUMS can be used on any integer, big integer, or decimal field with<br>any filter on any table, but for larger datasets, creating a key with a</p>
<p class="calibre1">SumIndexField is recommended. </p>
<p class="calibre1">To calculate a TotalOrderAmount value while referencing the Sales Header table, the code can be as simple as this:</p>
<p class="calibre1">“Sales Header”.CALCFIELDS (Amount); </p>
<p class="calibre1">To use TotalOrderAmount := “Sales Header”.Amount; to calculate the same value from code directly referencing the Sales Line table, the required code is similar to the following (assuming a Sales Header record has already been read):</p>
<p class="calibre1">“Sales Line”.SETRANGE(“Document Type”,“Sales Header”.“Document Type”); </p>
<p class="calibre1">“Sales Line”.SETRANGE(“Document No.”,“Sales Header”.“No.”); </p>
<p class="calibre1">“Sales Line”.CALCSUMS(Amount); </p>
<p class="calibre1">TotalOrderAmount := “Sales Line”.Amount; </p>
<p class="calibre1"><b class="calibre3">[ 358 ]</b></p>
<p class="calibre1"><a id="calibre_link-217"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">Flow control functions</b></p>
<p class="calibre1">Process flow control functions are the functions that execute the decision-making and resultant logic branches in executable code. IF-THEN-ELSE, as discussed in <a href="#calibre_link-159">Chapter 6, </a></p>
<p class="calibre1"> <i class="calibre4">Introduction to AL</i>, is also a member of this class of functions. Here, we will discuss the following:</p>
<p class="calibre1">REPEAT-UNTIL</p>
<p class="calibre1">WHILE-DO</p>
<p class="calibre1">FOR-TO and FOR-DOWNTO</p>
<p class="calibre1">CASE-ELSE</p>
<p class="calibre1">WITH-DO</p>
<p class="calibre1">QUIT, BREAK, EXIT, and SKIP</p>
<p class="calibre1"><b class="calibre3">REPEAT-UNTIL</b></p>
<p class="calibre1">REPEAT-UNTIL allows us to create a repetitive code loop, which REPEATs a block of code UNTIL a specific conditional expression evaluates to TRUE. In that sense, REPEAT-UNTIL</p>
<p class="calibre1">defines a block of code, operating somewhat like the BEGIN-END compound statement structure that we covered in <a href="#calibre_link-159">Chapter 6, </a> <i class="calibre4">Introduction to AL</i>. REPEAT tells the system to keep reprocessing the block of code, while the UNTIL serves as the exit doorman, checking whether the conditions for ending the processing are true. Because the exit condition is not evaluated until the end of the loop, a REPEAT-UNTIL structure will always process at least once through the contained code. </p>
<p class="calibre1">REPEAT-UNTIL is very important in Business Central because it is often part of the data input cycle, along with the FIND-NEXT structure, which will be covered shortly. </p>
<p class="calibre1">Here is an example of the REPEAT-UNTIL structure to process and sum data in the 10-element array CustSales:</p>
<p class="calibre1">LoopCount := 0; </p>
<p class="calibre1">REPEAT</p>
<p class="calibre1">LoopCount := LoopCount + 1; </p>
<p class="calibre1">TotCustSales := TotCustSales + CustSales[LoopCount]; </p>
<p class="calibre1">UNTIL LoopCount = 10; </p>
<p class="calibre1"><b class="calibre3">[ 359 ]</b></p>
<p class="calibre1"><a id="calibre_link-218"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">WHILE-DO</b></p>
<p class="calibre1">A WHILE-DO control structure allows us to create a repetitive code loop that will DO</p>
<p class="calibre1">(execute) a block of code WHILE a specific conditional expression evaluates to TRUE. WHILE-DO is different from REPEAT-UNTIL, both because it may need a BEGIN-END structure to define the block of code to be executed repetitively (REPEAT-UNTIL does not), and because it has different timings for the evaluation of the exit condition. </p>
<p class="calibre1">The syntax of the WHILE-DO control structure is as follows:</p>
<p class="calibre1">WHILE &lt;Condition&gt; DO &lt;Statement&gt; </p>
<p class="calibre1">The Condition can be any Boolean expression that evaluates to TRUE or FALSE. The Statement can be simple or the most complex compound BEGIN-END statement. Most</p>
<p class="calibre1">WHILE-DO loops will be based on a BEGIN-END block of code. The Condition will be evaluated at the beginning of the loop. When it evaluates to FALSE, the loop will terminate. </p>
<p class="calibre1">Thus, a WHILE-DO loop can be exited without processing. </p>
<p class="calibre1">A WHILE-DO structure to process data in the 10-element array CustSales is as follows: LoopCount := 0; </p>
<p class="calibre1">WHILE LoopCount &lt; 10</p>
<p class="calibre1">DO BEGIN</p>
<p class="calibre1">LoopCount := LoopCount + 1; </p>
<p class="calibre1">TotCustSales := TotCustSales + CustSales[LoopCount]; </p>
<p class="calibre1">END; </p>
<p class="calibre1">In Business Central, REPEAT-UNTIL is much more frequently used than WHILE-DO. </p>
<p class="calibre1"><b class="calibre3">FOR-TO or FOR-DOWNTO</b></p>
<p class="calibre1">The syntax for FOR-TO and FOR-DOWNTO control statements are as follows:</p>
<p class="calibre1">FOR &lt;Control Variable&gt; := &lt;Start Number&gt; TO &lt;End Number&gt; DO &lt;Statement&gt; FOR &lt;Control Variable&gt; := &lt;Start Number&gt; DOWNTO &lt;End Number&gt; DO &lt;Statement&gt; A FOR control structure is used when we wish to execute a block of code a specific number of times. </p>
<p class="calibre1"><b class="calibre3">[ 360 ]</b></p>
<p class="calibre1"><a id="calibre_link-219"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The Control Variable is an integer variable. Start Number is the beginning count for the FOR loop and End Number is the final count for the loop. If we wrote the FOR</p>
<p class="calibre1">LoopCount := 5 TO 7 DO [block of code] statement, then [block of code]</p>
<p class="calibre1">would be executed three times. </p>
<p class="calibre1">FOR-TO increments the Control Variable. FOR-DOWNTO decrements the Control</p>
<p class="calibre1">Variable. </p>
<p class="calibre1">We must be careful not to manipulate the Control Variable in the middle of our loop. </p>
<p class="calibre1">Doing so will likely yield unpredictable results. </p>
<p class="calibre1"><b class="calibre3">CASE-ELSE statement</b></p>
<p class="calibre1">The CASE-ELSE statement is a conditional expression, which is very similar to IF-THEN-ELSE, except that it allows more than two choices of outcomes for the evaluation of the controlling expression. The syntax of the CASE-ELSE statement is as follows:</p>
<p class="calibre1">CASE &lt;ExpressionToBeEvaluated&gt; OF</p>
<p class="calibre1">&lt;Value Set 1&gt; : &lt;Action Statement 1&gt;; </p>
<p class="calibre1">&lt;Value Set 2&gt; : &lt;Action Statement 2&gt;; </p>
<p class="calibre1">&lt;Value Set 3&gt; : &lt;Action Statement 3&gt;; </p>
<p class="calibre1">… </p>
<p class="calibre1">… </p>
<p class="calibre1">&lt;Value Set n&gt; : &lt;Action Statement n&gt;; </p>
<p class="calibre1">[ELSE &lt;Action Statement n + 1&gt;; </p>
<p class="calibre1">END; </p>
<p class="calibre1">The ExpressionToBeEvaluated must not be a record. The data type of the Value Set must be able to be automatically converted into the data type of the</p>
<p class="calibre1">ExpressionToBeEvaluated. Each Value Set must be an expression, a set of values, or a range of values. The following example illustrates a typical instance of a CASE-ELSE</p>
<p class="calibre1">statement:</p>
<p class="calibre1">CASE Customer.“Salesperson Code” OF</p>
<p class="calibre1">‘2’,‘5’,‘9’: Customer.“Territory Code” := ‘EAST’; </p>
<p class="calibre1">‘16’..‘20’: Customer.“Territory Code” := ‘WEST’; </p>
<p class="calibre1">‘N’: Customer.“Territory Code” := ‘NORTH’; </p>
<p class="calibre1">‘27’..‘38’: Customer.“Territory Code” := ‘SOUTH’; </p>
<p class="calibre1">ELSE Customer.“Territory Code” := ‘FOREIGN’; </p>
<p class="calibre1">END; </p>
<p class="calibre1"><b class="calibre3">[ 361 ]</b></p>
<p class="calibre1"><a id="calibre_link-339"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">In the preceding code example, we can see several alternatives for the Value Set. The first line (EAST) Value Set contains a list of values. If “Salesperson Code” is equal to ‘2’, </p>
<p class="calibre1">‘5’, or ‘9’, the EAST value will be assigned to Customer.“Territory Code”. The second line, (WEST) Value Set, is a range, any value from ‘16’ through ‘20’. The third line, (NORTH) Value Set, is just a single value (‘N’). If we look through the standard Business Central code, we will see that a single value is the most frequently used CASE</p>
<p class="calibre1">structure in Business Central. In the fourth line of our example (SOUTH), the Value Set is again a range (‘27’..‘38’). If nothing in any Value Set matches</p>
<p class="calibre1">ExpressionToBeEvaluated, the ELSE clause will be executed, which sets</p>
<p class="calibre1">Customer.“TerritoryCode” equal to ‘FOREIGN’. </p>
<p class="calibre1">An example of an IF-THEN-ELSE statement equivalent to the preceding CASE-ELSE</p>
<p class="calibre1">statement is as follows:</p>
<p class="calibre1">IF Customer.“Salesperson Code” IN [‘2’,‘5’,‘9’] THEN</p>
<p class="calibre1">Customer.“Territory Code” := ‘EAST’ </p>
<p class="calibre1">ELSE IF Customer.“Salesperson Code” IN [‘16’..‘20’] THEN</p>
<p class="calibre1">Customer.“Territory Code” := ‘WEST’ </p>
<p class="calibre1">ELSE IF Customer.“Salesperson Code” = ‘N’ THEN</p>
<p class="calibre1">Customer.“Territory Code” := ‘NORTH’ </p>
<p class="calibre1">ELSE IF Customer.“Salesperson Code” IN [‘27’..‘38’] THEN</p>
<p class="calibre1">Customer.“Territory Code” := ‘SOUTH’ </p>
<p class="calibre1">ELSE Customer.“Territory Code” := ‘FOREIGN’; </p>
<p class="calibre1">The following is a slightly less intuitive example of the CASE-ELSE statement. In this instance, ExpressionToBeEvaluated is a simple TRUE and the Value Set statements are all conditional expressions. The first line containing a Value Set expression that evaluates to TRUE will be the line whose Action Statement is executed. The rules of execution and flow in this instance are the same as in the previous example:</p>
<p class="calibre1">CASE TRUE OF Salesline.Quantity &lt; 0:</p>
<p class="calibre1">BEGIN</p>
<p class="calibre1">CLEAR(Salesline.“Line Discount %”); </p>
<p class="calibre1">CredTot := CredTot - Salesline.Quantity; </p>
<p class="calibre1">END; </p>
<p class="calibre1">Salesline.Quantity &gt; QtyBreak[1]:</p>
<p class="calibre1">Salesline.“Line Discount %” := DiscLevel[1]; </p>
<p class="calibre1">Salesline.Quantity &gt; QtyBreak[2]:</p>
<p class="calibre1">Salesline.“Line Discount %” := DiscLevel[2]; </p>
<p class="calibre1">Salesline.Quantity &gt; QtyBreak[3]:</p>
<p class="calibre1">Salesline.“Line Discount %” := DiscLevel[3]; </p>
<p class="calibre1">Salesline.Quantity &gt; QtyBreak[4]:</p>
<p class="calibre1">Salesline.“Line Discount %” := DiscLevel[4]; </p>
<p class="calibre1"><b class="calibre3">[ 362 ]</b></p>
<p class="calibre1"><a id="calibre_link-220"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">ELSE</p>
<p class="calibre1">CLEAR(Salesline.“Line Discount %”); </p>
<p class="calibre1">END; </p>
<p class="calibre1"><b class="calibre3">WITH-DO statement</b></p>
<p class="calibre1">When we are writing code referring to fields within a record, the most specific syntax for field references is the fully qualified [ RecordName.FieldName ] reference. When referring to the City field in the Customer record, use the Customer.City reference. </p>
<p class="calibre1">In many AL instances, the record name qualifier is implicit because the compiler assumes a default record qualifier based on code context. This happens automatically for variables within a page bounded to a table. The bound table becomes the implicit record qualifier for fields referenced in the page object. In a table object, the table is the implicit record qualifier for fields referenced in the AL in that object. In report and XMLport objects, the DataItem record is the implicit record qualifier for the fields referenced within the triggers of that DataItem, such as OnAfterGetRecord and OnAfterImportRecord. </p>
<p class="calibre1">In all other AL code, the only way to have an implicit record qualifier is to use the WITH-DO</p>
<p class="calibre1">statement. WITH-DO is widely used in the base product in codeunits and processing reports. </p>
<p class="calibre1">The WITH-DO syntax is as follows:</p>
<p class="calibre1">WITH &lt;RecordQualifier&gt; DO &lt;Statement&gt; </p>
<p class="calibre1">Typically, the DO portion of this statement will be followed by a BEGIN-END code block, thus allowing a compound statement. The scope of the WITH-DO statement is terminated by the end of the DO statement. </p>
<p class="calibre1">When we execute a WITH-DO statement, RecordQualifier becomes the implicit record qualifier that’s used by the compiler until the end of that statement or until that qualifier is overridden by a nested WITH-DO statement. A fully qualified syntax would require the following form:</p>
<p class="calibre1">Customer.Address := ‘189 Maple Avenue’; </p>
<p class="calibre1">Customer.City := ‘Chicago’; </p>
<p class="calibre1">The WITH-DO syntax takes advantage of the implicit record qualification, making the code easier to write and, hopefully, easier to read; for example, take a look at the following lines of code:</p>
<p class="calibre1">WITH Customer DO</p>
<p class="calibre1">BEGIN</p>
<p class="calibre1">Address := ‘189 Maple Avenue’; </p>
<p class="calibre1"><b class="calibre3">[ 363 ]</b></p>
<p class="calibre1"><a id="calibre_link-221"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">City := ‘Chicago’; </p>
<p class="calibre1">END; </p>
<p class="calibre1">Best practice says that WITH-DO statements should only be used in functions within a codeunit or a report. </p>
<p class="calibre1">WITH-DO statements nested one within another are legal code, but are not used in standard Business Central. They are also not recommended because they can easily confuse the developer, resulting in bugs. The same comments apply to nesting a WITH-DO statement within a function where there is an automatic implicit record qualifier, such as in a table, report, or XMLport. </p>
<p class="calibre1">Of course, wherever the references to record variables other than the implicit one occur within the scope of WITH-DO, we must include the specific qualifiers. This is particularly important when there are variables with the same name (for example, City) in multiple tables that might be referenced in the same set of AL logic. </p>
<p class="calibre1">Some developers maintain that it is always better to use fully qualified variable names to reduce the possibility of inadvertent reference errors. This approach also eliminates any possible misinterpretation of variable references by a maintenance developer who works on this code later. </p>
<p class="calibre1"><b class="calibre3">QUIT, BREAK, EXIT, and SKIP functions</b></p>
<p class="calibre1">This group of AL functions also controls process flow. Each acts to interrupt flow in different places and with different results. To get a full appreciation for how these functions are used, we should review them in code in Business Central. </p>
<p class="calibre1"><b class="calibre3">QUIT function</b></p>
<p class="calibre1">The QUIT function is the ultimate processing interrupt for report or XMLport objects. When QUIT is executed, processing immediately terminates, even for the OnPostObject triggers. </p>
<p class="calibre1">No database changes are committed. QUIT is often used in reports to terminate processing when the report logic determines that no useful output will be generated by further processing. </p>
<p class="calibre1">The syntax of the QUIT function is as follows:</p>
<p class="calibre1">CurrReport.QUIT; </p>
<p class="calibre1">CurrXMLport.QUIT; </p>
<p class="calibre1"><b class="calibre3">[ 364 ]</b></p>
<p class="calibre1"><a id="calibre_link-222"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">BREAK function</b></p>
<p class="calibre1">The BREAK function terminates the DataItem in which it occurs. BREAK can only be used in DataItem triggers in reports and XMLports. It can be used to terminate the sequence of processing one DataItem segment of a report while allowing subsequent DataItem<br>processing to continue. </p>
<p class="calibre1">The BREAK syntax is as follows:</p>
<p class="calibre1">CurrReport.BREAK; </p>
<p class="calibre1">CurrXMLport.BREAK; </p>
<p class="calibre1"><b class="calibre3">EXIT function</b></p>
<p class="calibre1">EXIT is used to end the processing within an AL trigger. EXIT works the same, regardless of whether it is executed within a loop. It can be used to end the processing of the trigger or to pass a return value from a local function. A return value cannot be used for system-defined triggers or local functions that don’t have a return value defined. If EXIT is used without a return value, a default return value of zero is returned. </p>
<p class="calibre1">The syntax for EXIT is as follows:</p>
<p class="calibre1">EXIT([&lt;ReturnValue&gt;])</p>
<p class="calibre1"><b class="calibre3">SKIP function</b></p>
<p class="calibre1">When executed, the SKIP function will skip the remainder of the processing in the current record cycle of the current trigger. Unlike BREAK, it does not terminate the DataItem processing completely. It can be used only in the OnAfterGetRecord trigger of a report or XMLport object. In reports, when the results of processing in the OnAfterGetRecord trigger are determined not to be useful for output, the SKIP function is used to terminate that single iteration of the trigger, without interfering with any subsequent processing. </p>
<p class="calibre1">The SKIP syntax can be either of the following:</p>
<p class="calibre1">CurrReport.SKIP; </p>
<p class="calibre1">CurrXMLport.SKIP; </p>
<p class="calibre1"><b class="calibre3">[ 365 ]</b></p>
<p class="calibre1"><a id="calibre_link-223"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">Input and output functions</b></p>
<p class="calibre1">In the previous chapter, you learned about the basics of the FIND function. You learned about FIND(‘-‘) to read from the beginning of a selected set of records, FINDSET to read a selected set of records, and FIND(‘+’) to begin reading at the far end of the selected set of records. Now we will review additional functions that are generally used with FIND</p>
<p class="calibre1">functions in typical production code. While we are designing code that uses the MODIFY</p>
<p class="calibre1">and DELETE record functions, we need to consider possible interactions with other users on the system. There might be someone else modifying and deleting records in the same table that our application is updating. </p>
<p class="calibre1">We may want to utilize the LOCKTABLE function to gain total control of the data briefly while updating it. We can find more information on LOCKTABLE in the online  <i class="calibre4">AL Reference</i> <i class="calibre4">Guide</i><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-dev-overview"> help (https:/​/​docs.​microsoft.​com/​en-​us/​dynamics365/​business-​central/​dev-</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-dev-overview">itpro/​developer/​devenv-​dev-​overview). The SQL Server database supports </a><b class="calibre3">record level</b> <b class="calibre3">locking</b>. There are a number of factors that we should consider when coding data locking in our processes. It is worthwhile reading all of the AL reference guide material that’s found by doing a search for LOCKTABLE, particularly,  <i class="calibre4">Locking in Microsoft SQL Server</i>. </p>
<p class="calibre1"><b class="calibre3">NEXT function with FIND or FINDSET</b></p>
<p class="calibre1">The syntax defined for the NEXT function is as follows:</p>
<p class="calibre1">IntegerValue := Record.NEXT ( ReadStepSize )</p>
<p class="calibre1">The full assignment statement format is rarely used to set an IntegerValue. In addition, there is no documentation for the usage of a non-zero IntegerValue. When</p>
<p class="calibre1">IntegerValue goes to zero, it means a NEXT record was not found. </p>
<p class="calibre1">If the ReadStepSize value is negative, the table will be read in reverse; if ReadStepSize is positive (the default), then the table will be read forward. The size of the value in ReadStepSize controls which records should be read. For example, if ReadStepSize is 2</p>
<p class="calibre1">or -2, then every second record will be read. If ReadStepSize is 10 or -10, then every tenth record will be read. The default value is 1, in which case, every record will be read and the read direction will be forward. </p>
<p class="calibre1"><b class="calibre3">[ 366 ]</b></p>
<p class="calibre1"><a id="calibre_link-224"></a><img src="images/000428.png" alt="Image 365" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">In a typical data-read loop, the first read is a FIND or FINDSET function, followed by a REPEAT-UNTIL loop. The exit condition is the UNTILRecord.NEXT=0; expression. The AL</p>
<p class="calibre1">for FINDSET and FIND(‘-‘) are structured alike. </p>
<p class="calibre1">The full AL syntax for this typical loop looks as follows:</p>
<p class="calibre1">IF CustRec.FIND(‘-‘) THEN</p>
<p class="calibre1">REPEAT</p>
<p class="calibre1">&lt;Block of AL logic&gt; </p>
<p class="calibre1">UNTIL CustRec.NEXT = 0; </p>
<p class="calibre1"><b class="calibre3">INSERT function</b></p>
<p class="calibre1">The purpose of the INSERT function is to add new records to a table. The syntax for the INSERT function is as follows:</p>
<p class="calibre1">[BooleanValue :=] Record.INSERT ( [ TriggerControlBoolean ] )</p>
<p class="calibre1">If BooleanValue is not used and the INSERT function fails (for example, if the insertion would result in a duplicate primary key), the process will terminate with an error. </p>
<p class="calibre1">Generally, we should handle a detected error in code using the BooleanValue and<br>supplying our own error-handling logic, rather than allow a default termination. </p>
<p class="calibre1">The TriggerControlBoolean value controls whether or not the table’s OnInsert trigger fires when the INSERT occurs. The default value is FALSE. If we let the default FALSE</p>
<p class="calibre1">control, we run the risk of not performing error checking that the table’s designer assumed would be run when a new record was added. </p>
<p class="calibre1">When we are reading a table, and we also need to INSERT records into<br>that same table, the INSERT should be done to a separate instance of the<br>table. We can use either a global or local variable for that second instance. </p>
<p class="calibre1">If we INSERT into the same table we are reading, we run the risk of<br>reading the new records as part of our processing (likely a very confusing<br>action). We also run the risk of changing the sequence of our processing<br>unexpectedly due to the introduction of new records into our dataset. </p>
<p class="calibre1">While the database access methods are continually improved by</p>
<p class="calibre1">Microsoft, and this warning may be overcautious, it is better to be safe<br>than sorry. </p>
<p class="calibre1"><b class="calibre3">[ 367 ]</b></p>
<p class="calibre1"><a id="calibre_link-225"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">MODIFY function</b></p>
<p class="calibre1">The purpose of the MODIFY function is to modify (update) existing data records. The syntax for MODIFY is as follows:</p>
<p class="calibre1">[BooleanValue :=] Record.MODIFY ( [ TriggerControlBoolean ] )</p>
<p class="calibre1">If BooleanValue is not used and MODIFY fails, for example, if another process changes the record after it was read by this process, then the process will terminate with an error statement. The code should either handle a detected error or gracefully terminate the process. The TriggerControlBoolean value controls whether the table’s OnModify<br>trigger fires when this MODIFY occurs. The default value is FALSE, which would not perform any OnModify processing. MODIFY cannot be used to cause a change in a primary key field. In that case, the RENAME function must be used. </p>
<p class="calibre1">System-based checking can be performed to make sure that a MODIFY is done using the current version of the data record. This is done by making sure that another process hasn’t modified and committed the record after it was read by this process. Our logic should refresh the record using the GET function, then change any values, and then call the MODIFY</p>
<p class="calibre1">function. </p>
<p class="calibre1"><b class="calibre3">Rec and xRec</b></p>
<p class="calibre1">In the Table and Page objects, the system automatically provides us with the system variables, Rec and xRec. Until a record has been updated by MODIFY, Rec represents the current record data in process and xRec represents the record data before it was modified. </p>
<p class="calibre1">By comparing field values in Rec and xRec, we can determine whether changes have been made to the record in the current process cycle. Rec and xRec records have all the same fields in the same structure as the table to which they relate. </p>
<p class="calibre1"><b class="calibre3">DELETE function</b></p>
<p class="calibre1">The purpose of the DELETE function is to delete existing data records. The syntax for DELETE is as follows:</p>
<p class="calibre1">[BooleanValue :=] Record.DELETE ( [ TriggerControlBoolean ] )</p>
<p class="calibre1"><b class="calibre3">[ 368 ]</b></p>
<p class="calibre1"><a id="calibre_link-226"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">If DELETE fails and the BooleanValue option is not used, the process will terminate with an error statement. Our code should handle any detected error or terminate the process gracefully, as appropriate. </p>
<p class="calibre1">The TriggerControlBoolean value is TRUE or FALSE, and it controls whether the table’s OnDelete trigger fires when this DELETE occurs. The default value is FALSE. If we let the default FALSE prevail, we run the risk of not performing error checking that the table’s designer assumed would be run when a record was deleted. </p>
<p class="calibre1">In Business Central, there is check to make sure that a DELETE is using the current version of the record and to make sure that another process hasn’t modified and committed the record after it was read by this process. </p>
<p class="calibre1"><b class="calibre3">MODIFYALL function</b></p>
<p class="calibre1">MODIFYALL is the high-volume version of the MODIFY function. If we have a group of records in which we wish to modify one field in all of these records to the same new value, we should use MODIFYALL. It is controlled by the filters that are applied at the time of invoking. The other choice for doing a mass modification would be to have a FIND-NEXT</p>
<p class="calibre1">loop in which we modified each record, one at a time. The advantage of MODIFYALL is that it allows the developer and the system to optimize code for the volume update. Any system optimization will be a function of what SQL statements are generated by the AL compiler. </p>
<p class="calibre1">The syntax for MODIFYALL is as follows:</p>
<p class="calibre1">Record.MODIFYALL (FieldToBeModified,NewValue</p>
<p class="calibre1">[,TriggerControlBoolean ] )</p>
<p class="calibre1">The TriggerControlBoolean value, a TRUE or FALSE entry, controls whether the table’s OnModify trigger fires when this MODIFY occurs. The default value is FALSE, which would result in the OnValidate field trigger not being executed. In a typical situation, a filter or series of filters would be applied to a table, followed by the MODIFYALL function. A simple example where we will reassign all Territory Code for a particular Salesperson to NORTH is as follows:</p>
<p class="calibre1">Customer.RESET ; </p>
<p class="calibre1">Customer.SETRANGE(“Salesperson Code”,‘DAS’); </p>
<p class="calibre1">Customer.MODIFYALL(“Territory Code”,‘NORTH’,TRUE); </p>
<p class="calibre1"><b class="calibre3">[ 369 ]</b></p>
<p class="calibre1"><a id="calibre_link-227"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">DELETEALL function</b></p>
<p class="calibre1">DELETEALL is the high-volume version of the DELETE function. If we have a group of records that we wish to delete, use DELETEALL. The other choice would be a FIND-NEXT</p>
<p class="calibre1">loop, in which we delete each record, one at a time. The advantage of DELETEALL is that it allows the developer and the system to optimize code for the volume deletion. Any system optimization will be a function of what SQL statements are generated by the AL compiler. </p>
<p class="calibre1">The syntax for DELETEALL is as follows:</p>
<p class="calibre1">Record.DELETEALL ( [,TriggerControlBoolean] )</p>
<p class="calibre1">The TriggerControlBoolean value, a TRUE or FALSE entry, controls whether the table’s OnDelete trigger fires when this DELETE occurs. The default value is FALSE. If the TriggerControlBoolean value is TRUE, then the OnDelete trigger will fire for each record that’s deleted. In that case, there is little to no speed advantage for DELETEALL</p>
<p class="calibre1">versus the use of a FIND-DELETE-NEXT loop. </p>
<p class="calibre1">In a typical situation, a filter or series of filters would be applied to a table, followed by the DELETEALL function, similar to the preceding example. Like MODIFYALL, DELETEALL</p>
<p class="calibre1">respects the filters that are set and does not do any referential integrity error checking. </p>
<p class="calibre1"><b class="calibre3">Filtering</b></p>
<p class="calibre1">Few other systems have filtering implemented as comprehensively as Business Central, nor do they have it tied so neatly to the detailed retention of historical data. The result of Business Central’s features is that even the most basic implementation of Business Central includes very powerful data analysis capabilities that are available to the end user. </p>
<p class="calibre1">As developers, we should appreciate the fact that we cannot anticipate every need of any user, let alone anticipate all the needs of all users. We know we should give the users as much freedom as possible to allow them to selectively extract and review data from their system. Wherever feasible, users should be given the opportunity to apply their own filters so that they can determine the optimum selection of data for their particular situation. On the other hand, freedom, here as everywhere, is a double-edged sword. With the freedom to decide just how to segment our data, comes the responsibility for figuring out what constitutes a good segmentation to address the problem at hand. </p>
<p class="calibre1"><b class="calibre3">[ 370 ]</b></p>
<p class="calibre1"><a id="calibre_link-228"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">As experienced application software designers and developers, we have presumably considerable insight into good ways to analyze and present the data. On that basis, it may be appropriate for us to provide some predefined selections. In some cases, constraints of the data structure allow only a limited set of options to make sense. In such a case, we should provide specific accesses to data (through pages and/or reports). However, we should allow more sophisticated users to access and manipulate the data flexibly on their own. </p>
<p class="calibre1">When applying filters using any of these options, be very conscious of the table key that will be activated when the filter takes effect. In a table containing a lot of data, filtering on a field that is not very high in the currently active key (in other words, near the beginning of the key field sequence) may result in poor (or even very poor) response time for the users. </p>
<p class="calibre1">In the same context, in a system suffering from a poor response time during processing, we should first investigate the relationships of active keys to applied filters, as well as how the keys are maintained. This may require SQL Server expertise, in addition to Business Central expertise. </p>
<p class="calibre1">Both the SETCURRENTKEY and SETRANGE functions are important in the context of data</p>
<p class="calibre1"><a href="#calibre_link-159">filtering. These were reviewed in Chapter 6</a>,  <i class="calibre4">Introduction to AL</i>, so we won’t review them again here. </p>
<p class="calibre1"><b class="calibre3">The SETFILTER function</b></p>
<p class="calibre1">SETFILTER allows us to define and apply any filter expression that could be created manually, including various combinations of ranges, AL operators, and even wild cards. </p>
<p class="calibre1">The SETFILTER syntax is as follows:</p>
<p class="calibre1">Record.SETFILTER ( Field, FilterString [, FilterValue1], … ] ); </p>
<p class="calibre1">SETFILTER also can be applied to Query objects with similar syntax:</p>
<p class="calibre1">Query.SETFILTER ( ColumnName, FilterString</p>
<p class="calibre1">[, FilterValue1], … ] ); </p>
<p class="calibre1">FilterString can be a literal, such as ‘1000..20000’ or ‘A*|B*|C*’, but this is not good practice. Optionally (and preferably), we can use variable tokens in the form of %1, %2, %3, and so forth, representing variables (but not operators) such as FilterValue1, </p>
<p class="calibre1">FilterValue2, and so forth to be substituted in the filter string at runtime. This construct allows us to create filters whose data values can be defined dynamically at runtime. A new SETFILTER replaces any previous filtering in the same filter group (this will be discussed in more detail shortly) on that field or column prior to setting the new filter. </p>
<p class="calibre1"><b class="calibre3">[ 371 ]</b></p>
<p class="calibre1"><a id="calibre_link-229"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">A pair of SETFILTER examples are as follows:</p>
<p class="calibre1">Customer.SETFILTER(“Salesperson Code”,‘KKS’|‘RAM’|‘CDS’); </p>
<p class="calibre1">Customer.SETFILTER(“Salesperson Code”,’%1|%2|%3’,SPC1,SPC2,SPC3); </p>
<p class="calibre1">If SPC1 equals ‘KKS’, SPC2 equals ‘RAM’, and SPC3 equals ‘CDS’, these two examples would have the same result. Obviously, the second option allows a degree of flexibility which is not provided by the first option because in the second option, the variables could be assigned other values. </p>
<p class="calibre1"><b class="calibre3">The COPYFILTER and COPYFILTERS functions</b></p>
<p class="calibre1">These functions allow you to copy the filters of a single field or all the filters on a record (table) and apply those filters to another record. Their syntax is as follows:</p>
<p class="calibre1">FromRecord.COPYFILTER(FromField, ToRecord.ToField)</p>
<p class="calibre1">The From and To fields must be of the same data type. The From and To tables do not have to be of the same format:</p>
<p class="calibre1">ToRecord.COPYFILTERS(FromRecord)</p>
<p class="calibre1">Note that the COPYFILTER field-based function begins with the FromRecord variable, while the COPYFILTERS record-based function begins with the ToRecord variable. </p>
<p class="calibre1">ToRecord and FromRecord must be different instances of the same table. </p>
<p class="calibre1"><b class="calibre3">The GETFILTER and GETFILTERS functions</b></p>
<p class="calibre1">These functions allow us to retrieve the filters on a single field or all the filters on a record (table) and assign the result to a text variable. Their syntax is as follows:</p>
<p class="calibre1">ResultString := FilteredRecord.GETFILTER(FilteredField)</p>
<p class="calibre1">ResultString := FilteredRecord.GETFILTERS</p>
<p class="calibre1">Similar functions exist for query objects. Those syntaxes are as follows:</p>
<p class="calibre1">ResultString := FilteredQuery.GETFILTER(FilteredColumn)</p>
<p class="calibre1">ResultString := FilteredQuery.GETFILTERS</p>
<p class="calibre1"><b class="calibre3">[ 372 ]</b></p>
<p class="calibre1"><a id="calibre_link-230"></a><img src="images/000017.png" alt="Image 366" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The text contents of the ResultString will contain an identifier for each filtered field and the currently applied value of the filter. GETFILTERS is often used to retrieve the filters on a table and print them as part of a report heading. The ResultString will look similar to the following:</p>
<p class="calibre1">Customer:.No.: 10000..999999, Balance: &gt;0</p>
<p class="calibre1"><b class="calibre3">The FILTERGROUP function</b></p>
<p class="calibre1">The FILTERGROUP function can change or retrieve the filter group that is applied to a table. </p>
<p class="calibre1">A filter group contains a set of filters that were previously applied to the table by the SETFILTER or SETRANGE functions, or as table properties defined in an object. The FILTERGROUP syntax is as follows:</p>
<p class="calibre1">[CurrentGroupInteger ] := Record.FILTERGROUP ([NewGroupInteger])</p>
<p class="calibre1">Using just the Record.FILTERGROUP([NewFilterGroupInteger]) portion sets the<br>active filter group. </p>
<p class="calibre1">Filter groups can also be used to filter query DataItems. All the currently defined filter groups are active and apply in combination (in other words, they are logically ANDed, resulting in a logical intersection of the sets). The only way to eliminate the effect of a filter group is to remove the filters in a group. </p>
<p class="calibre1">The default filter group for Business Central is 0 (zero). Users have access to the filters in this filter group. Other filter groups, numbered up through 6, have assigned Business Central uses. We should not redefine the use of any of these filter groups, but use higher numbers for any custom filter groups in our code. </p>
<p class="calibre1">Check out Microsoft Docs for FILTERGROUP function and</p>
<p class="calibre1">Understanding Query Filters for more information (<a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/methods-auto/recordref/recordref-filtergroup-method">https:/​/​docs. </a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/methods-auto/recordref/recordref-filtergroup-method">microsoft.​com/​en-​us/​dynamics365/​business-​central/​dev-​itpro/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/methods-auto/recordref/recordref-filtergroup-method">developer/​methods-​auto/​recordref/​recordref-​filtergroup-​method</a>) One use of a filter group is to assign a filter that the user cannot see is operative and cannot change. Our code could change the filter group, set a special filter, and then return the active filter group to its original state. The following lines of code are an example of this: Rec.FILTERGROUP(42); </p>
<p class="calibre1">Rec.SETFILTER(Customer.“Salesperson Code”,MySalespersonID); </p>
<p class="calibre1">Rec.FILTERGROUP(0); </p>
<p class="calibre1"><b class="calibre3">[ 373 ]</b></p>
<p class="calibre1"><a id="calibre_link-231"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">This could be used to apply special application-specific permissions to a particular system function, such as filtering out access to customers by salesperson so that each salesperson can only examine data for their own customers. </p>
<p class="calibre1"><b class="calibre3">The MARK function</b></p>
<p class="calibre1">A mark on a record is an indicator that disappears when the current session ends and which is only visible to the process that is setting the mark. The MARK function sets the mark. The syntax is as follows:</p>
<p class="calibre1">[BooleanValue := ] Record.MARK ( [SetMarkBoolean] )</p>
<p class="calibre1">If the optional BooleanValue and assignment operator (:=) are present, the MARK function will give us the current MARK status (TRUE or FALSE) of the record. If the optional SetMarkBoolean parameter is present, the record will be marked (or unmarked) according to that value (TRUE or FALSE). The default value for SetMarkBoolean is FALSE. The MARK</p>
<p class="calibre1">functions should be used carefully, and only when a simpler solution is not readily available. Marking records can cause significant performance problems on large datasets. </p>
<p class="calibre1"><b class="calibre3">CLEARMARKS function</b></p>
<p class="calibre1">CLEARMARKS clears all the marks from the specified record, that is, from the particular instance of the table in this instance of the object. The syntax is as follows:</p>
<p class="calibre1">Record.CLEARMARKS</p>
<p class="calibre1"><b class="calibre3">The MARKEDONLY function</b></p>
<p class="calibre1">MARKEDONLY is a special filtering function that can apply a mark-based filter. </p>
<p class="calibre1">The syntax for MARKEDONLY is as follows:</p>
<p class="calibre1">[BooleanValue := ] Record.MARKEDONLY</p>
<p class="calibre1">( [SeeMarkedRecordsOnlyBoolean] )</p>
<p class="calibre1"><b class="calibre3">[ 374 ]</b></p>
<p class="calibre1"><a id="calibre_link-232"></a><img src="images/000036.png" alt="Image 367" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">If the optional BooleanValue parameter is defined, it will be assigned a TRUE or FALSE</p>
<p class="calibre1">value to tell us whether the special MARKEDONLY filter is active. Omitting the</p>
<p class="calibre1">BooleanValue parameter, MARKEDONLY will set the special filter, depending on the value of SeeMarkedRecordsOnlyBoolean. If that value is TRUE, it will filter to show only marked records; if that value is FALSE, it will remove the marked filter and show all records. The default value for SeeMarkedRecordsOnlyBoolean is FALSE. </p>
<p class="calibre1">Although it may not seem logical, there is no option to see only the unmarked records. </p>
<p class="calibre1">For additional information on the MARKEDONLY function, refer to the<br>following blog entry: <a href="https://markbrummel.wordpress.com/2014/03/07/tip-36-using-mark-and-markedonly-in-the-role-tailored-client/">https:/​/​markbrummel.​wordpress.​com/​2014/​03/​07/</a></p>
<p class="calibre1"><a href="https://markbrummel.wordpress.com/2014/03/07/tip-36-using-mark-and-markedonly-in-the-role-tailored-client/">tip-​36-​using-​mark-​and-​markedonly-​in-​the-​role-​tailored-​client/</a>​. </p>
<p class="calibre1"><b class="calibre3">The RESET function</b></p>
<p class="calibre1">This function allows us to RESET, that is, clear, all filters that are currently applied to a record. RESET also sets the current key back to the primary key, removes any marks, and clears all internal variables in the current instance of the record. Filters in FILTERGROUP 1</p>
<p class="calibre1">are not reset. The syntax is FilteredRecord.RESET;. </p>
<p class="calibre1"><b class="calibre3">InterObject communication</b></p>
<p class="calibre1">There are several ways for communicating between objects during Business Central processing. We will review some of the more commonly used ways in the following<br>sections. </p>
<p class="calibre1"><b class="calibre3">Communicating through data</b></p>
<p class="calibre1">The most widely used and simplest communication method is through data tables. For example, the No. Series table is the central control for all document numbers. Each object that assigns numbers to a document (for example, order, invoice, shipment, and so on) uses codeunit 396, NoSeriesManagement, to access the No. Series table for the next number to use, and then updates the No. Series table so that the next object needing to assign a number to the same type of document will have the updated information. </p>
<p class="calibre1"><b class="calibre3">[ 375 ]</b></p>
<p class="calibre1"><a id="calibre_link-233"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">Communicating through function parameters</b></p>
<p class="calibre1">When an object calls a function in another object, information is generally passed through the calling and return parameters. The calling and return parameter specifications are defined when the function is developed. The generic syntax for a function call is as follows:</p>
<p class="calibre1">[ReturnValue := ] FunctionName ( [ Parameter1 ] [ ,Parameter2 ] ,…)</p>
<p class="calibre1">The rules for including or omitting the various optional fields are specific to the local variables that are defined for each individual function. As developers, when we design the function, we define the rules and thereby determine just how communications with the function will be handled. It is obviously important to define complete and consistent parameter passing rules prior to beginning a development project. </p>
<p class="calibre1"><b class="calibre3">Communication via object calls</b></p>
<p class="calibre1">Sometimes, we need to create an object, which in turn calls other objects. We may simply want to allow the user to be able to run a series of processes and reports, but only enter the controlling parameters once. Our user interface object will be responsible for invoking the subordinate objects after having communicated setup and filter parameters. </p>
<p class="calibre1">An important set of standard functions has been designed for various modes and<br>circumstances of invoking other objects. Examples of these functions are SETTABLEVIEW, SETRECORD, and GETRECORD (there are others as well). There are also instances where we will need to build our own data-passing function. </p>
<p class="calibre1">To properly manage these relatively complex processes, we need to be familiar with the various versions of the RUN and RUNMODAL functions. We will also need to understand the meaning and effect of a single instance or multiple instances of an object. Briefly, key differences between invoking a page or report object from within another object through RUN versus RUNMODAL are as follows:</p>
<p class="calibre1">RUN will clear the instance of the invoked object every time the object completes, which means that all of the internal variables are initialized. This clearing<br>behavior does not apply to a codeunit object; state will be maintained across<br>multiple calls to RUN. </p>
<p class="calibre1"><b class="calibre3">[ 376 ]</b></p>
<p class="calibre1"><a id="calibre_link-234"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">RUNMODAL does not clear the instance of the invoked object, so internal global<br>variables are not reinitialized each time the object is called. The object can be reinitialized using CLEAR(Object). </p>
<p class="calibre1">RUNMODAL does not allow any other object to be active in the same user session<br>while it is running, whereas RUN allows another object instance to run in parallel with the object instance initiated by RUN. </p>
<p class="calibre1">Covering these topics in more detail is too advanced for this book, but once you have mastered the material covered here, you should study the information in the Microsoft Docs section relative to this topic. There is also pattern documentation on this topic, which is defined at</p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/108.posting-routine-select-behaviour">https://community.dynamics.com/nav/w/designpatterns/108.posting-routine-select-</a></p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/108.posting-routine-select-behaviour">behaviour. </a></p>
<p class="calibre1"><b class="calibre3">Enhancing the WDTU application</b></p>
<p class="calibre1">Now that we have some new tool to work with, let’s enhance our WDTU application. This time, our goal is to implement functionality to allow the program manager to plan the playlist schedules for radio shows. The process, from the user’s point of view, will essentially be as follows:</p>
<p class="calibre1">1. Call up Playlist document page that displays header, details, and FactBox<br>workspaces. </p>
<p class="calibre1">2. Enter Playlist Header using the Radio Show table data. </p>
<p class="calibre1">3. Enter Playlist Line using the resource table DJ data; the Radio Show table<br>data for news, weather, or sports shows; and the Item table data for music, PSAs, and advertisements. </p>
<p class="calibre1">4. The FactBox will display the required program-element fields from Radio</p>
<p class="calibre1">Show/Playlist Header. These will include news (yes or no), weather (yes or<br>no), sports (yes or no), and Number of required PSAs and advertisements. </p>
<p class="calibre1">5. The FactBox will also track each of the five possible required elements. </p>
<p class="calibre1">Since this development effort is an exercise to learn more about developing Business Central applications, we have some specific Business Central AL components we want to use so that we can learn more about them. Among those are the following:</p>
<p class="calibre1">Create a CASE statement as well as a multipart IF statement for contrast</p>
<p class="calibre1">Add code to the OnValidate trigger of fields in a table</p>
<p class="calibre1">Implement a lookup into a related table to access needed data</p>
<p class="calibre1"><b class="calibre3">[ 377 ]</b></p>
<p class="calibre1"><a id="calibre_link-235"></a><img src="images/000055.jpg" alt="Image 368" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">Cause FlowFields to be processed for display</p>
<p class="calibre1">Implement a FactBox to display Radio Show requirements for news, sports, </p>
<p class="calibre1">weather, PSAs, and advertisements</p>
<p class="calibre1">Create a new function, passing a parameter in and getting results passed back</p>
<p class="calibre1">As with any application enhancement, there will be a number of auxiliary tasks we’ll have to accomplish to get the job done. These include adding some new fields to one or more tables. Not surprisingly, adding new data fields often leads to adding the new fields to one or more pages for maintenance or display. We’ll have to create some test data in order to test our modifications. It’s not unusual in the course of an enhancement to also find that other changes are needed to support the new functionality. </p>
<p class="calibre1"><b class="calibre3">Modifying table fields</b></p>
<p class="calibre1">Because we want the Business Central tables to be the core of the design and to host as much of the processing as makes sense, we will start our enhancement work with table modifications. </p>
<p class="calibre1">The first table modification is to add the data fields to the Playlist Header, as shown in the following screenshot, to support the definition and tracking of various program segment requirements. In the Radio Show table, each show has requirements defined for a specific number of PSAs and advertisements, and for the presence of news, sports, and weather spots. The Playlist Header needs this requirement information stored, along with the associated TSA and advertisement counts for this show instance. We will obtain the news, sports, and weather line counts by means of a function call:</p>
<p class="calibre1"><b class="calibre3">[ 378 ]</b></p>
<p class="calibre1"><a id="calibre_link-408"></a><img src="images/000074.jpg" alt="Image 369" class="calibre2" /></p>
<p class="calibre1"><img src="images/000096.jpg" alt="Image 370" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">Because Playlist Line includes an Option field that identifies the PSA and<br>advertisement records, we will use a FlowField to calculate the counts for each of those line types. We will construct the FlowField definition for the PSA Count field, starting in the properties section of the field:</p>
<p class="calibre1">Go through the same sequence for the Ads Count field. </p>
<p class="calibre1">The only additional change we want to make to the Playlist Line table is to ensure that the Duration field is not editable. We do this so that the Start Time and End Time entries define Duration rather than the other way around. Making the Duration field non-editable is done by simply setting the field’s Editable property to false:</p>
<p class="calibre1"><b class="calibre3">[ 379 ]</b></p>
<p class="calibre1"><a id="calibre_link-236"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">Adding validation logic</b></p>
<p class="calibre1">We need validation logic for both our Playlist tables, that is, Header and Line. We will start with Playlist Header validation. </p>
<p class="calibre1"><b class="calibre3">Playlist Header validation</b></p>
<p class="calibre1">The Playlist Header data fields are as follows:</p>
<p class="calibre1">No.: This is the ID number for this instance of a radio show; its contents are user</p>
<p class="calibre1">-defined</p>
<p class="calibre1">Radio Show No.: This is selected from the Radio Show table</p>
<p class="calibre1">Description: This is displayed by means of a FlowField from the Radio Show<br>table</p>
<p class="calibre1">Broadcast Date: This is the show’s scheduled broadcast date; it also serves as<br>the posting date for any data analysis filtering</p>
<p class="calibre1">Start Time: This is the show’s scheduled broadcast start time</p>
<p class="calibre1">End Time: This is the show’s scheduled broadcast end time</p>
<p class="calibre1">Duration: This is the show’s broadcast length, displayed by means of a</p>
<p class="calibre1">FlowField from the Radio Show table</p>
<p class="calibre1">PSAs Required and Ads Required: These show whether PSAs and<br>advertisements are required for broadcast during the show; they are copied from<br>the Radio Show table, but are editable by the user</p>
<p class="calibre1">News Required, Sports Required, and Weather Required: This checks<br>whether each of these program segments are required during the show; they are<br>copied from the Radio Show table, but are editable by the user</p>
<p class="calibre1">When the user chooses the Radio Show to be scheduled, we want the five different feature requirements fields in the Playlist Header to be filled in by AL logic, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 380 ]</b></p>
<p class="calibre1"><a id="calibre_link-495"></a><img src="images/000121.png" alt="Image 371" class="calibre2" /></p>
<p class="calibre1"><img src="images/000140.png" alt="Image 372" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">Even though the Radio Show No. was entered in the data field, our validation code needs to read the Radio Show record (here, defined as the local variable RadioShow). Once we have read the Radio Show record, we can assign all five show feature requirements fields from the Radio Show record into the Playlist Header record. </p>
<p class="calibre1">Then, because two fields in the Playlist Header record are lookup FlowFields, we need to Update the page after the entry of the Radio Show No.. The update is done through a CurrPage.UPDATE command, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 381 ]</b></p>
<p class="calibre1"><a id="calibre_link-237"></a><img src="images/000167.png" alt="Image 373" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">The next validation we need is to calculate the End Time show as soon as the Start Time is entered. The calculation is simple: add the length of the show to the Start Time. We have defined the Duration field in the Playlist Header to be a lookup reference to the source field in the Radio Show record. As a result, to calculate with that field, we would need to use a CALCFIELDS function first. Instead, we’ll obtain the show length from the Radio Show record:</p>
<p class="calibre1">Now we can see that we have one of those situations that we sometimes encounter when developing a modification. It might have been better to have the Duration field of Playlist Header be a Normal data field rather than a FlowField. If this is the only place where we will use Duration from Playlist Header for calculation or assignment, then the current design is fine. Otherwise, perhaps we should change the Duration field to a Normal field and assign Run Time from RadioShow to it at the same time the several requirements fields are assigned. At this point, though, for the purposes of our WDTU</p>
<p class="calibre1">scenario, we will stick with what we have already created. </p>
<p class="calibre1"><b class="calibre3">Creating the Playlist subpage</b></p>
<p class="calibre1"><a href="#calibre_link-38">In Chapter 2</a>,  <i class="calibre4">Tables</i>, a homework assignment was to create the 50003 Playlist Document page. We should have used the snippet to create that page, giving us something such as this:</p>
<p class="calibre1"><b class="calibre3">[ 382 ]</b></p>
<p class="calibre1"><a id="calibre_link-496"></a><img src="images/000211.jpg" alt="Image 374" class="calibre2" /></p>
<p class="calibre1"><img src="images/000232.png" alt="Image 375" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">Another necessary part of a document page is the subpage. Our subpage can be created using the snippet based on table 50003, Playlist Line. The result will be as follows:</p>
<p class="calibre1"><b class="calibre3">[ 383 ]</b></p>
<p class="calibre1"><a id="calibre_link-407"></a><img src="images/000255.png" alt="Image 376" class="calibre2" /></p>
<p class="calibre1"><img src="images/000276.jpg" alt="Image 377" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">To make the document work the way we are used to having Business Central document forms work, we will need to set some properties for this new page. See the bold properties circled in the following screenshot:</p>
<p class="calibre1">We have set the DelayedInsert and AutoSplitKey properties to true. These settings will allow the Playlist Line to not be saved until the primary key fields are all entered (DelayedInsert), and will support the easy insertion of new entries between two existing lines (AutoSplitKey). </p>
<p class="calibre1">Finally, we will need to connect our new Playlist subpage ListPart page 50109 to the Playlist document page 50104 to give us a basic and complete document page. All we need to do to accomplish that is add a new Part line to page 50104, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 384 ]</b></p>
<p class="calibre1"><a id="calibre_link-238"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">Playlist Line validations</b></p>
<p class="calibre1">The Playlist Line data fields are as follows:</p>
<p class="calibre1">Document No.: This is the automatically assigned link to the No. field in the<br>parent Playlist record (the automatic assignment is based on the page, </p>
<p class="calibre1">Playlist Subpage properties, which we’ll take care of when working on the</p>
<p class="calibre1">Playlist pages)</p>
<p class="calibre1">Line No.: This is an automatically assigned number (based on page properties), </p>
<p class="calibre1">and the rightmost field in the Playlist Line primary key</p>
<p class="calibre1">Type: This is a user-selected Option that defines whether this entry is a</p>
<p class="calibre1">Resource, such as an announcer; a Show, such as a news show; or an Item, such<br>as a recording to play on the air</p>
<p class="calibre1">No.: This is the ID number of the selected entry in its parent table</p>
<p class="calibre1">DataFormat: This is information from the Item table for a show or recording</p>
<p class="calibre1">Description: This is assigned from the parent table, but can be edited by the<br>user</p>
<p class="calibre1">Duration, Start Time and End Time: This is information about a show or<br>recording that indicates the length and its position within the schedule of this Radio Show</p>
<p class="calibre1">The source of contents of the No., DataFormat, Description, and time-related fields of the record depend on the Type field. If the Type is Resource, the fields are filled in from the Resource table; for Item, from the Item table; for Show, from the Radio Show table. </p>
<p class="calibre1">To support this, our OnValidate code looks at the Type entry and uses a CASE statement to choose which set of actions to take. </p>
<p class="calibre1"><b class="calibre3">[ 385 ]</b></p>
<p class="calibre1"><a id="calibre_link-497"></a><img src="images/000297.png" alt="Image 378" class="calibre2" /></p>
<p class="calibre1"><img src="images/000319.jpg" alt="Image 379" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">First, we will build the basic CASE statement, as shown in the following code screenshot, and compile it. That way, we can ensure that we’ve got all the components of the structure in place and only need to fill in the logic for each of the option choices:</p>
<p class="calibre1">Next, we must add a variable for each of the tables from which we will pull the<br>data Resource, Item, and Show. The use of IntelliSense makes it much easier to find the correct field names for each of the variables we want to select to assign to the Playlist Line record fields:</p>
<p class="calibre1"><b class="calibre3">[ 386 ]</b></p>
<p class="calibre1"><a id="calibre_link-406"></a><img src="images/000340.jpg" alt="Image 380" class="calibre2" /></p>
<p class="calibre1"><img src="images/000361.jpg" alt="Image 381" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">When we are all done constructing the CASE statement, it should look like this:</p>
<p class="calibre1">The last set of OnValidate code we need to add is to calculate the End Time from the supplied Start Time and Duration (or Start Time from the End Time and Duration), as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 387 ]</b></p>
<p class="calibre1"><a id="calibre_link-239"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">Obviously, the design could be expanded to have the Duration value be user editable, along with an appropriate change in the AL logic. After our initial work on the Playlist functionality is completed, making that change would be a good exercise for you, as would be the addition of the “housekeeping” commands to clear out fields that are not used by the assigned record Type, such as clearing the DataFormat field for a RadioShow record. </p>
<p class="calibre1"><b class="calibre3">Creating a function for our FactBox</b></p>
<p class="calibre1">For this application, we want our FactBox to display information relating to the specific radio show we are scheduling. The information to be displayed includes the five show segment requirements and the status of fulfillment (counts) of those requirements by the data that’s entered into date. The requirements come from the Playlist Header fields: PSAs required, advertisements required, news required, sports required, and weather required. The counts come from summing up data in the Playline Line records for a show. We can use the Playlist Header field’s PSA count and ad count for those two counts. These counts can be obtained through the FlowField property definitions we defined earlier for these two fields. </p>
<p class="calibre1">For the other three counts, we must read through the Playlist Line and sum up each of the counts. To accomplish that, we’ll create a function that we can call from the FactBox page. Since our new function is local to the Playlist Header and Playlist Line tables, we will define the function in the Playlist Header (table 50102). </p>
<p class="calibre1">The logic of our counting process is described in the following pseudocode:</p>
<p class="calibre1">1. Filter the Playlist Line table for Radio Show we are scheduling and for<br>segment entries (Playlist Line) that represent shows</p>
<p class="calibre1">2. Look up the Radio Show record for each of those records</p>
<p class="calibre1">3. Using the data from the Radio Show record, look up the Radio Show Type<br>code</p>
<p class="calibre1">4. In the Radio Show Type record, use the news, weather, or sports fields to<br>determine which Playlist Line counter should be incremented</p>
<p class="calibre1">Based on this logic, we must have local variables defined for the three tables: Playlist Line, Radio Show, and Radio Show Type. </p>
<p class="calibre1"><b class="calibre3">[ 388 ]</b></p>
<p class="calibre1"><a id="calibre_link-405"></a><img src="images/000382.png" alt="Image 382" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">Translating our pseudocode into executable AL, our function looks as follows:</p>
<p class="calibre1">In the process of writing this code, we noticed another design flaw. We defined the type of Radio Show with code that allows users to enter their choice of text strings. We just wrote code that depends on the contents of that text string being specific values. A better design would be to have the critical field be an Option data type so that we can depend on the choices being members of a predefined set. However, the Code field is our primary key field, and we probably shouldn’t use an Option field as the primary key. We will continue with our example with the design as is, but you should consider how to improve it. Making that improvement will be excellent practice. </p>
<p class="calibre1"><b class="calibre3">[ 389 ]</b></p>
<p class="calibre1"><a id="calibre_link-240"></a><img src="images/000403.png" alt="Image 383" class="calibre2" /></p>
<p class="calibre1"><img src="images/000424.png" alt="Image 384" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">Creating a FactBox page</b></p>
<p class="calibre1">All the hard work is now done. We just have to define a FactBox page and add it to the Playlist page. We can create a FactBox page using the snippet to define a CardPart: Our FactBox will contain the fields from the Playlist Header that relate to two of the five required show segments, that is, the <b class="calibre3">PSA Count</b> and <b class="calibre3">Ad Count</b> fields, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 390 ]</b></p>
<p class="calibre1"><a id="calibre_link-498"></a><img src="images/000445.jpg" alt="Image 385" class="calibre2" /></p>
<p class="calibre1"><img src="images/000011.png" alt="Image 386" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">Once we exit the <b class="calibre3">Card Part Page Wizard</b> and go into the page designer, we will have a page layout that looks as follows:</p>
<p class="calibre1">At this point, we will need to add the logic to take advantage of the NWSRequired function that we created earlier. This function is designed to return the count of the segment type that’s identified in the calling parameter. Since a line on a page can be an expression, we can simply code the function calls right on the page lines with an appropriate caption defined, as we can see in the following screenshot. We will intersperse the Count lines for a consistent appearance on the page, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 391 ]</b></p>
<p class="calibre1"><a id="calibre_link-404"></a><img src="images/000031.png" alt="Image 387" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">We will save the new FactBox page as page 50112, named Playlist FactBox. </p>
<p class="calibre1">One final development step is required. We must connect the new FactBox Card Part to Playlist Document. All that is required is to define the FactBox area and add our FactBox as an element in that area:</p>
<p class="calibre1">Multiple FactBoxes can be part of a primary page. If we look at page 21 &ndash; <b class="calibre3">Customer Card</b>, we will see a FactBox area with eight FactBoxes, of which two are system parts. </p>
<p class="calibre1">The end result of our development effort is shown in the following screenshot when we run page 50104&mdash;Playlist with some sample test data, which we entered by running the<br>various tables:</p>
<p class="calibre1"><b class="calibre3">[ 392 ]</b></p>
<p class="calibre1"><a id="calibre_link-241"></a><img src="images/000093.png" alt="Image 388" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1"><b class="calibre3">Summary</b></p>
<p class="calibre1">In this chapter, we covered a number of practical tools and topics regarding AL coding and development. We started by reviewing methods and then we dived into a long list of functions that we will need on a frequent basis. </p>
<p class="calibre1">We covered a variety of selected data-centric functions, including some for computation and validation, some for data conversion, and others for date handling. Next, we reviewed functions that affect the flow of logic and the flow of data, including FlowFields and SIFT, processing flow control, input and output, and filtering. Finally, we put a number of these to work in an enhancement for our WDTU application. </p>
<p class="calibre1"><b class="calibre3">[ 393 ]</b></p>
<p class="calibre1"><a id="calibre_link-242"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">In the next chapter, we will move from the details of the functions to the broader view of AL development integration into the standard Business Central code, as well as debugging techniques. </p>
<p class="calibre1"><b class="calibre3">Questions</b></p>
<p class="calibre1">1. Which three of the following are valid date-related Business Central functions? </p>
<p class="calibre1">DATE2DWY</p>
<p class="calibre1">CALCDATE</p>
<p class="calibre1">DMY2DATE</p>
<p class="calibre1">DATE2NUM</p>
<p class="calibre1">2. RESET is used to clear the current sort key setting from a record. True or false? </p>
<p class="calibre1">3. Which functions can be used to cause FlowFields to be calculated? Choose two: CALCSUMS</p>
<p class="calibre1">CALCFIELDS</p>
<p class="calibre1">SETAUTOCALCFIELDS</p>
<p class="calibre1">SUMFLOWFIELD</p>
<p class="calibre1">4. Which of the following functions should be used within a<br>report’s OnAfterGetRecord trigger to end processing just for a single iteration<br>of the trigger? Choose one:</p>
<p class="calibre1">EXIT</p>
<p class="calibre1">BREAK</p>
<p class="calibre1">QUIT</p>
<p class="calibre1">SKIP</p>
<p class="calibre1">5. The WORKDATE value can be set to a different value from the system date. True or false? </p>
<p class="calibre1">6. Only one FactBox is allowed on a page. True or false? </p>
<p class="calibre1">7. Braces {} are used as a special form of a repeating CASE statement. True or false? </p>
<p class="calibre1">8. Which of the following is not a valid AL flow control combination? Choose one: 1. REPEAT-UNTIL</p>
<p class="calibre1">2. DO-UNTIL</p>
<p class="calibre1">3. CASE-ELSE</p>
<p class="calibre1">4. IF-THEN</p>
<p class="calibre1"><b class="calibre3">[ 394 ]</b></p>
<p class="calibre1"><a id="calibre_link-499"></a> <i class="calibre4">Intermediate AL</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 7</i></p>
<p class="calibre1">9. A FILTERGROUP function should not be used in custom code. True or false? </p>
<p class="calibre1">10. The REPEAT - UNTIL looping structure is most often used to control data<br>reading processes. True or false? </p>
<p class="calibre1">11. Which of the following formats of MODIFY will cause the table’s OnModify trigger to fire? Choose one:</p>
<p class="calibre1">MODIFY</p>
<p class="calibre1">MODIFY(TRUE)</p>
<p class="calibre1">MODIFY(RUN)</p>
<p class="calibre1">MODIFY(READY)</p>
<p class="calibre1">12. Marking a group of records creates a special index; therefore, marking is<br>especially efficient. True or false? </p>
<p class="calibre1">13. A CASE statement structure should never be used in place of a<br>nested IF statement structure. True or false? </p>
<p class="calibre1">14. An average FlowField requires which of the following? </p>
<p class="calibre1">A record key</p>
<p class="calibre1">SQL Server database</p>
<p class="calibre1">An integer variable</p>
<p class="calibre1">A decimal variable</p>
<p class="calibre1">15. The TESTFIELD function can be used to assign new values to a variable. True or false? </p>
<p class="calibre1">16. The VALIDATE function can be used to assign new values to a variable. True or false? </p>
<p class="calibre1">17. The AL Symbol Menu can be used for several of the following purposes. Choose two:</p>
<p class="calibre1">Find applicable functions</p>
<p class="calibre1">Test coded functions</p>
<p class="calibre1">Use entries as a template for function syntax and arguments</p>
<p class="calibre1">Translate text constants into a support language</p>
<p class="calibre1">18. Documentation cannot be integrated into in-line AL code. True or false? </p>
<p class="calibre1">19. If MAINTAINSIFTINDEX is set to NO and CALCFIELDS is invoked, the process will terminate with an error. True or false? </p>
<p class="calibre1">20. SETRANGE is often used to clear all filtering from a single field. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 395 ]</b></p>
<p class="calibre1"><a id="calibre_link-243"></a>8</p>
<p class="calibre1">Advanced AL Development</p>
<p class="calibre1">Tools</p>
<p class="calibre1"> <i class="calibre4">Quality isn’t something you lay on top of subjects and objects like tinsel on a Christmas</i> <i class="calibre4">tree. Quality must be in the heartwood. </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Robert Pirsig, paraphrased</i></p>
<p class="calibre1"> <i class="calibre4">Often when you think you’re at the end of something, you’re at the beginning of</i> <i class="calibre4">something else. </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Fred Rogers</i></p>
<p class="calibre1">Business Central is extremely flexible and suitable for addressing many types of problems, there are a lot of choices for advanced Business Central topics. We’ll try to cover those that will be most helpful in an effort to put together a complete implementation. </p>
<p class="calibre1">First, we will review the overall structure of Business Central as an application software system, aiming for a basic understanding of the process flow of the system, along with some of the utility functions built into the standard product. Before designing modifications for Business Central, it is important to have a good understanding of the structural  <i class="calibre4">style</i> of the software, so that our enhancements are designed for a better fit. </p>
<p class="calibre1">Secondly, we will review some special components of the Business Central system that will allow us to accomplish more at a lower cost. These resources include features such as XMLports and web services that we can build on, and they will help us use standard interface structures to connect with the world outside of the Business Central system. </p>
<p class="calibre1">Fortunately, Business Central has a good supply of such features. </p>
<p class="calibre1"><a id="calibre_link-244"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">The topics we will cover in this chapter include the following:</p>
<p class="calibre1">Role Center pages</p>
<p class="calibre1">The Search and Action menus</p>
<p class="calibre1">XMLports</p>
<p class="calibre1">Web services and OData</p>
<p class="calibre1"><b class="calibre3">Business Central process flow</b></p>
<p class="calibre1">Primary data, such as sales orders, purchase orders, production orders, and financial transactions, flow through the Business Central system, as follows:</p>
<p class="calibre1"><b class="calibre3">Initial setup</b>: This is where the essential master data, reference data, and control and setup data is entered. Most of this preparation is done when the system (or a new application) is prepared for production use. </p>
<p class="calibre1"><b class="calibre3">Transaction entry</b>: Transactions are entered into documents and then transferred as part of a posting sequence into a Journal table, or data may be entered<br>directly into a Journal table. Data is preliminarily validated as it is entered, with master and auxiliary data tables being referenced as appropriate. The entry can<br>be via manual keying, an automated transaction generation process, or an import<br>function that brings in transaction data from another system. </p>
<p class="calibre1"><b class="calibre3">Validate</b>: This step provides for additional data validation processing of a set of one or more transactions, often in batches, prior to submitting it to Posting. </p>
<p class="calibre1"><b class="calibre3">Post</b>: This step posts a Journal batch that includes completing transaction data validation, adding entries to one or more Ledger tables, and perhaps also<br>updating a Register table and document history. </p>
<p class="calibre1"><b class="calibre3">Utilize</b>: This is where we access the data via pages, queries, and/or reports, including those that feed web services and other consumers of data. At this point, total flexibility exists. Whatever tools are appropriate for users’ needs should be used, whether internal to Business Central or external (external tools are often referred to as <b class="calibre3">Business Intelligence</b> (<b class="calibre3">BI</b>) tools). Business Central’s built-in capabilities for data manipulation, extraction, and presentation should not be<br>overlooked. </p>
<p class="calibre1"><b class="calibre3">Maintenance</b>: This is the continued maintenance of all Business Central data, as appropriate. </p>
<p class="calibre1"><b class="calibre3">[ 397 ]</b></p>
<p class="calibre1"><a id="calibre_link-336"></a><img src="images/000115.png" alt="Image 389" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">The following diagram provides a simplified picture of the flow of application data through a Business Central system:</p>
<p class="calibre1">As you can see, many of the transaction types include additional reporting, multiple ledgers to update, and even auxiliary processing. However, this represents the basic data flow in Business Central whenever a Journal table and a Ledger table are involved. </p>
<p class="calibre1">When we enhance an existing Business Central functional area, such as Jobs or Service Management, we may need to enhance related process flow elements by adding new fields to journals, ledgers, posted documents, and so on. </p>
<p class="calibre1">When we create a new functional area, we will likely want to replicate the standard Business Central process flow in some form for the new application’s data. For example, for our WDTU application, we will handle the entry of playlists in the same fashion<br>as Journal is entered. A day’s playlists would be similar to a Journal batch in another application. After a day’s shows have been broadcast, the completed playlist will be posted into the Radio Show ledger as a permanent record of the broadcasts. </p>
<p class="calibre1"><b class="calibre3">[ 398 ]</b></p>
<p class="calibre1"><a id="calibre_link-245"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Initial setup and data preparation</b></p>
<p class="calibre1">Data must be maintained as new master data becomes available or when various system operating parameters and other elements change. The standard approach for Business Central data entry allows records to be entered that have just enough information to define the primary key fields, but not necessarily enough to support processing. This allows for a great deal of flexibility in the timing and responsibility for entry and completeness of new data. This approach applies to both setup data entry and ongoing production transaction data entry. </p>
<p class="calibre1">For example, a sales person might initialize a new customer entry with a name, address, and phone number, just entering the data to which they have easy access. At this point, there is not enough information recorded to process orders for this new customer. At a later time, someone in the accounting department can set up posting groups, payment terms, and other control data that should not be controlled by the sales department. With this additional data, the new customer record is ready for production use. </p>
<p class="calibre1">The Business Central data entry approach allows the system to be updated on an<br>incremental basis as the data arrives, providing an operational flexibility many systems lack. This works because often, data comes into an organization on a piecemeal basis. The other side of this flexibility is the added responsibility for users to ensure that partially updated information is completed in a timely fashion. For a user organization that can’t manage this, it may be necessary to create special procedures, or even system<br>customizations that enforce the necessary discipline. </p>
<p class="calibre1"><b class="calibre3">Transaction entry</b></p>
<p class="calibre1">Transactions are entered into a Journal table. Data is preliminarily validated as it is entered; master and auxiliary data tables are referenced as appropriate. Data validation is one of more powerful existing feature in Business Central like FlowFields. Validations are based on the evaluation of the individual transaction data, plus the related master records and associated reference tables; for example, lookups being satisfied, application or system setup parameter constraints being met, and so on. </p>
<p class="calibre1"><b class="calibre3">Testing and posting the Journal batch</b></p>
<p class="calibre1">Any additional validations that are needed to ensure the integrity and completeness of the transaction data prior to being posted are done either in pre-post routines or directly in the posting processes. The actual posting of a Journal batch occurs after the transaction data is completely validated. </p>
<p class="calibre1"><b class="calibre3">[ 399 ]</b></p>
<p class="calibre1"><a id="calibre_link-246"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Depending on the specific application, when Journal transactions don’t pass muster during this final validation stage, either the individual transaction is bypassed while acceptable transactions are posted, or the entire Journal batch is rejected until the identified problem is resolved. </p>
<p class="calibre1">The posting process adds entries to one or more ledgers, and sometimes to a document history table. When a Journal Entry is posted to a ledger, it becomes part of the permanent accounting record. Most data cannot be changed or deleted once it resides in a ledger (an example exception would be the due date on a payable). </p>
<p class="calibre1">Register tables may also be updated during posting, recording the ID number ranges of ledger entries posted, when they are posted, and in what batches. This adds to the transparency of the Business Central application system for audits and analysis. </p>
<p class="calibre1">In general, Business Central follows the standard accounting practice of requiring ledger revisions to be made by posting reversing entries, rather than by deletion of problem entries. The overall result is that Business Central is a very auditable system, a key requirement for a variety of government, legal, and certification requirements for information systems. </p>
<p class="calibre1"><b class="calibre3">Utilizing and maintaining the data</b></p>
<p class="calibre1">The data in a Business Central system can be accessed by means of pages, queries, and/or reports, providing total flexibility. Whatever tools are available to the developer or the user, and are appropriate, should be used. There are some very good tools in Business Central for data manipulation, extraction, and presentation. Among other things, these include the SIFT/FlowField functionality, the pervasive filtering capability (including the ability to apply filters to subordinate data structures), and the Navigate function. Business Central includes the ability to create page parts for graphing, with a wide variety of predefined chart page parts included as part of the standard distribution. We can also create our own chart parts using tools delivered with the system or available from blogs or MSDN. </p>
<p class="calibre1">The Business Central database design approach could be referred to as a <b class="calibre3">rational</b> <b class="calibre3">normalization</b>. Business Central isn’t constrained by a rigid normalized data structure, where every data element appears only once. The Business Central data structure is normalized, so long as that principle doesn’t get in the way of processing speed. Where processing speed or user convenience is improved by duplicating data across tables, Business Central does so. In addition, the duplication of master file data into transactions allows for the one-time modification of data when appropriate, such as a ship-to address in a Sales Order. That data duplication often greatly simplifies data access for analysis. </p>
<p class="calibre1"><b class="calibre3">[ 400 ]</b></p>
<p class="calibre1"><a id="calibre_link-247"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Data maintenance</b></p>
<p class="calibre1">As with any database-oriented application software, the ongoing maintenance of master data, reference data, and setup and control data is required. In Business Central, the maintenance of data uses many of the same data preparation tools that were initially used to set up the system. </p>
<p class="calibre1"><b class="calibre3">Role Center pages</b></p>
<p class="calibre1">One of the key features of Business Central is the Role Tailored user experience, centered on Role Centers tied to user work roles. The Role Tailored approach provides a single point of entry and access into the system for each user through their assigned Role Center. Each user’s Role Center acts as their home page. Each Role Center focuses on the tasks needed to support its users’ jobs throughout the day. Primary tasks are front and center, while the <b class="calibre3">ACTIONS</b> ribbon and <b class="calibre3">Search</b> menu provide easy access to other functions, making them only a click or two away. </p>
<p class="calibre1">The standard Business Central distribution from Microsoft contains more than two dozen different Role Center pages, identified for user roles such as Bookkeeper, Sales Manager, Shop Supervisor, Purchasing Agent, and so on (page 9011 is identified as Foundation, rather than as a <b class="calibre3">Role Center</b>, or <b class="calibre3">RC</b>). Some localized Business Central distributions may have additional Role Center pages included. It is critical to realize that the Role Centers supplied out of the box are not generally intended to be used directly out of the box. </p>
<p class="calibre1">The Role Center pages should be used as templates for custom Role Centers tailored to the specific work role requirements of the individual customer implementation. </p>
<p class="calibre1">One of the very critical tasks of implementing a new system is to analyze the work flow and responsibilities of the system’s intended users and configure Role Centers to fit the users. In some cases, the supplied Role Centers can be used with minimal tailoring. Sometimes, it will be necessary to create completely new Role Centers. Even then, we will often be able to start with a copy of an existing Role Center page, which we will modify as required. In any case, it is important to understand the structure of the Role Center page and how it is built. </p>
<p class="calibre1"><b class="calibre3">Role Center structure</b></p>
<p class="calibre1">The following screenshot shows page 9006&mdash;Order Processor Role Center:</p>
<p class="calibre1"><b class="calibre3">[ 401 ]</b></p>
<p class="calibre1"><a id="calibre_link-500"></a><img src="images/000137.jpg" alt="Image 390" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">[ 402 ]</b></p>
<p class="calibre1"><a id="calibre_link-376"></a><img src="images/000203.png" alt="Image 391" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">The components of the Role Center highlighted in the preceding screenshot are as follows: 1. Action ribbon</p>
<p class="calibre1">2. Navigation pane</p>
<p class="calibre1">3. Activity pane</p>
<p class="calibre1">4. Headlines (headline is introduced from Business Central and is not available in previous versions)</p>
<p class="calibre1">5. Cues (in Cue Groups)</p>
<p class="calibre1">6. Page parts</p>
<p class="calibre1">7. System part</p>
<p class="calibre1">We need to understand the construction of a Role Center page so that we are prepared to modify an existing Role Center or create a new one. First, we’ll take a look at page 9006</p>
<p class="calibre1">“Order Processor Role Center” in the Page Designer:</p>
<p class="calibre1">The Role Center page layout should look familiar, because it’s very similar in structure to the pages we’ve designed previously. What is specific to a Role Center page? There is a container control of the rolecenter area. This is required for a Role Center page. </p>
<p class="calibre1">Note that the PageType is rolecenter, and there is no SourceTable. </p>
<p class="calibre1"><b class="calibre3">[ 403 ]</b></p>
<p class="calibre1"><a id="calibre_link-248"></a><img src="images/000225.png" alt="Image 392" class="calibre2" /></p>
<p class="calibre1"><img src="images/000247.png" alt="Image 393" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Role Center headlines page</b></p>
<p class="calibre1">We’ll take a quick look at the first part control’s properties. The part property is page 1441 “Headline RC Order Processor”:</p>
<p class="calibre1">Headline pages are used to show KPI information to the users and they are the first thing the users see when opening Business Central. </p>
<p class="calibre1">There is a special PageType property called HeadLinePart, and the RefreshOnActivate property is used to make sure new information is displayed when the Role Center updates. </p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-create-role-center-headline">More information can be found on Microsoft Docs, at https:/​/​docs. </a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-create-role-center-headline">microsoft.​com/​en-​us/​dynamics365/​business-​central/​dev-​itpro/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-create-role-center-headline">developer/​devenv-​create-​role-​center-​headline. </a></p>
<p class="calibre1"><b class="calibre3">[ 404 ]</b></p>
<p class="calibre1"><a id="calibre_link-249"></a><img src="images/000269.png" alt="Image 394" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Role Center activities page</b></p>
<p class="calibre1">We’ll take a quick look at the next part control’s properties. The page property is page 9060 “SO Processor Activities”:</p>
<p class="calibre1">In the previous screenshot, you can see the various properties of the part control. </p>
<p class="calibre1"><b class="calibre3">Cue groups and cues</b></p>
<p class="calibre1">Now, we’ll focus on page 9060&mdash;SO Processor Activities. Designing that page, we<br>see the following layout. Comparing the controls we see there to those of the Role Center, we can see that this page part is the source of the <b class="calibre3">Activities</b> section of the Role Center page. </p>
<p class="calibre1">In the properties of the SO Processor Activities page, we can see that this is a PageType property of CardPart tied to SourceTable, which is Sales Cue. </p>
<p class="calibre1">There are three cuegroup controls&mdash;ForRelease, Sales Orders Released Not</p>
<p class="calibre1">Shipped, and Returns. In each cuegroup control, there are the field controls for the individual cues:</p>
<p class="calibre1"><b class="calibre3">[ 405 ]</b></p>
<p class="calibre1"><a id="calibre_link-378"></a><img src="images/000290.png" alt="Image 395" class="calibre2" /></p>
<p class="calibre1"><img src="images/000311.jpg" alt="Image 396" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">An individual cue is displayed as an iconic shortcut to a filtered list through a FlowField, or to a query or other data source through a Normal field. The stack of papers in the cue icon resulting from a filtered value represents an idea of the number of records in that list. The actual number of entries is also displayed next to the icon (see the <b class="calibre3">Sales Orders - Open</b> example in the following screenshot). </p>
<p class="calibre1">The Stack image is the default icon for a Cue and changes automatically, </p>
<p class="calibre1">based on the data. If required, the icon can be changed into any of several<br>hundred other images. A very useful tool for finding these images can be<br>found on Mibuso, </p>
<p class="calibre1"><a href="https://mibuso.com/downloads/dynamics-nav-image-library">at https://mibuso.com/downloads/dynamics-nav-image-library. </a></p>
<p class="calibre1"><b class="calibre3">[ 406 ]</b></p>
<p class="calibre1"><a id="calibre_link-501"></a><img src="images/000332.jpg" alt="Image 397" class="calibre2" /></p>
<p class="calibre1"><img src="images/000353.jpg" alt="Image 398" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">The purpose of this type of cue is to provide a single-click point of access to a specific user task. The set of these cues is intended to represent the full set of primary activities for a user, based on their work role:</p>
<p class="calibre1">Business Central provides another cue format (like the <b class="calibre3">AVERAGE DAYS DELAYED</b> cue in the preceding screenshot), which is based on a calculated value stored in a Normal field. </p>
<p class="calibre1">Next, we want to design the referenced table, Sales Cue, to see how it is constructed:</p>
<p class="calibre1"><b class="calibre3">[ 407 ]</b></p>
<p class="calibre1"><a id="calibre_link-377"></a><img src="images/000374.png" alt="Image 399" class="calibre2" /></p>
<p class="calibre1"><img src="images/000394.jpg" alt="Image 400" class="calibre2" /></p>
<p class="calibre1"><img src="images/000416.jpg" alt="Image 401" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">As you can see in the preceding screenshot, there is a simply structured table, with an integer field for each of the action cues and a decimal field for the information cue, all of which were displayed in the Role Center we are analyzing. There is also a key field, two fields identified as date filters, and a field identified as a Responsibility Center filter. </p>
<p class="calibre1">The design pattern used for cue tables is the Singleton Pattern, which can<br>be found on the Microsoft Design Patterns Wiki</p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/282.cue-table">(https://community.dynamics.com/nav/w/designpatterns/282.cue-tab</a></p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/282.cue-table">le</a>). </p>
<p class="calibre1">When we display the properties of one of these integer fields, Sales Orders - Open, we find it is a FlowField providing a count of Sales Orders with a status of Open:</p>
<p class="calibre1">If we inspect each of the other integer fields in this table, we will find a similar FlowField setup. Each is defined to fit the specific cue to which it’s tied. If we think about what the cues show (a count) and how FlowFields work (a calculation based on a range of data records), we can see this is a simple, direct method of providing the information necessary to support cue displays. Clicking on the action cue (the count) opens up the list of records being counted. The information cue is tied to a decimal field, which is computed by means of a function, as shown in the following screenshot, in the cue table that is invoked from the Role Center page when the cue is displayed:</p>
<p class="calibre1">This brings us to the end of the Role Center structure. Next, we will discuss the system part. </p>
<p class="calibre1"><b class="calibre3">[ 408 ]</b></p>
<p class="calibre1"><a id="calibre_link-250"></a><img src="images/000437.png" alt="Image 402" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">System part</b></p>
<p class="calibre1">Now that we have covered the components of the <b class="calibre3">Activities</b> portion of the Role Center page, let’s take a look at the other components. </p>
<p class="calibre1">Returning to page 9006 in the Page Designer, we can examine the properties of the system part control. This page part property is the one that incorporates a view of the user’s notes data into the Role Center. Take a look at the following screenshot:</p>
<p class="calibre1">Looking at this control’s properties, we see a PartType of systempart and a link to MyNotes, which displays as My Notifications. </p>
<p class="calibre1"><b class="calibre3">Page parts</b></p>
<p class="calibre1">Let’s look at the second group in page 9006, the group that defines the column appearing in the Role Center page:</p>
<p class="calibre1"><b class="calibre3">[ 409 ]</b></p>
<p class="calibre1"><a id="calibre_link-502"></a><img src="images/000039.png" alt="Image 403" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">As you can see, there are nine page parts and a system part defined. </p>
<p class="calibre1"><b class="calibre3">[ 410 ]</b></p>
<p class="calibre1"><a id="calibre_link-251"></a><img src="images/000395.png" alt="Image 404" class="calibre2" /></p>
<p class="calibre1"><img src="images/000018.jpg" alt="Image 405" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Page parts not visible</b></p>
<p class="calibre1">If we look at the display of the Role Center page generated by this layout again, we will see a chart (Trailing Sales Orders), followed by two list parts (My Items and Report InBox). The My Job Queue page part does not appear. This page part is defined by the developer, with the Visible property equal to FALSE:</p>
<p class="calibre1">This causes it not to display unless the Role Center page is customized by the user (or an administrator or a developer) and the part is added to the visible part list. </p>
<p class="calibre1"><b class="calibre3">Page parts for user data</b></p>
<p class="calibre1">Three of the page parts in Role Center page 9006 provide data that is specific to the individual user. They track My data, information important to the user who is logged in. </p>
<p class="calibre1">When we design any one of the pages, we can open the page properties to find out what table the page is tied to. Then, viewing any of those tables in the table designer, we will see that a highly ranked field is User ID. An example is the My Item table, which is shown here:</p>
<p class="calibre1"><b class="calibre3">[ 411 ]</b></p>
<p class="calibre1"><a id="calibre_link-252"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">The User ID allows the data to be filtered to present user-specific information to each user. </p>
<p class="calibre1">In some cases, this data can be updated directly in the Role Center page part; for example, in My Customers and My Items. In other cases, such as My Job Queue, the data is<br>updated elsewhere and is only viewed in the Role Center page part. If our users need to track other information in a similar manner, such as My Service Contracts, we can readily plagiarize the approach used in the standard page parts. </p>
<p class="calibre1"><b class="calibre3">Navigation pane and action menus</b></p>
<p class="calibre1">The last major Role Center page components we’ll review are the navigation pane and the action ribbon. Even though there are two major parts of the Role Center page that provide access to action choices, they both are defined in the <b class="calibre3">Action Designer</b> section of the <b class="calibre3">Page</b> <b class="calibre3">Designer</b>. </p>
<p class="calibre1">The display of Action Controls in a Role Center page is dependent on a combination of the definition of the controls in the Action Designer, certain properties of the page, and the configuration/personalization of the page. Many of the default Role Centers provided with the product are configured as examples of possibilities of what can be done. Even if one of the default Role Centers seems to fit our customer’s requirements exactly, we should create a copy of that Role Center page as another page object and reconfigure it. This way, we can document how that page was set up and make any necessary tweaks. </p>
<p class="calibre1">We’ll start with Role Center page 9006 because it is used as the default Role Center and is used in so many other examples. Copy page 9006 into page 50020&mdash;WDTU Role</p>
<p class="calibre1">Center by using the copy/paste utility from <b class="calibre3">Go To Definition</b> | <b class="calibre3">Save As… </b>, and with a new page object ID of 50020 and an object name of WDTU Role Center. </p>
<p class="calibre1">Once we have the new page saved, in order to use this page as a Role Center, we must create a profile for the page. This is done within the RTC and is typically a system administrator task. Invoke the RTC and click on the <b class="calibre3">Departments</b> menu button in the navigator pane. Then, click on <b class="calibre3">Administrator: Application Setup</b> | <b class="calibre3">Role Tailored Client</b> |</p>
<p class="calibre1"><b class="calibre3">Lists: Profiles</b>. </p>
<p class="calibre1"><b class="calibre3">[ 412 ]</b></p>
<p class="calibre1"><a id="calibre_link-375"></a><img src="images/000146.png" alt="Image 406" class="calibre2" /></p>
<p class="calibre1"><img src="images/000168.png" alt="Image 407" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Click on the <b class="calibre3">New</b> icon and create a new profile, like this one:</p>
<p class="calibre1">For the purpose of easy access to this Role Center for testing, we could also checkmark the <b class="calibre3">Default Role Center</b> box. Then, when we invoke the client, our test Role Center will be the one that displays (if no other profile is assigned to this user). Another approach to testing is to assign our user ID to use this profile. In order to test all of the aspects of the Role Center page, we must launch it as the assigned Role Center for the active user. </p>
<p class="calibre1">A major area where action choices are presented in a Role Center (and also in other page types) is the ribbon. The ribbon for the standard page 9006&mdash;Order Processor Role Center, as delivered from Microsoft, looks like the following screenshot:</p>
<p class="calibre1">We can see the different action choices present in the ribbon. </p>
<p class="calibre1"><b class="calibre3">[ 413 ]</b></p>
<p class="calibre1"><a id="calibre_link-253"></a><img src="images/000190.png" alt="Image 408" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Action Designer</b></p>
<p class="calibre1">The actions for a page are defined and maintained in the action section. Open our new page 50120&mdash;WDTU Role Center in the Page Designer, then search for action to view the current set of actions defined for this page. </p>
<p class="calibre1">For our newly created page 50120, cloned from page 9006, the Action Designer contents look like the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 414 ]</b></p>
<p class="calibre1"><a id="calibre_link-254"></a><img src="images/000212.png" alt="Image 409" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Whether they are actually displayed, how they are displayed, and where they are displayed are all controlled by a combination of the following factors:</p>
<p class="calibre1">The structure of the controls within the action list</p>
<p class="calibre1">The properties of the individual actions</p>
<p class="calibre1">The customizations/personalizations that have been applied by a developer, </p>
<p class="calibre1">administrator, or user</p>
<p class="calibre1">Each action belongs to an area. In hierarchical order, the area can be Embedding, Sections, Creation, or Processing. The specific area entry of each actions entry determines the area, ribbon, or navigation pane in which the subordinate groups of actions will appear:</p>
<p class="calibre1">If the area entry is embedding, the indented subordinate actions will appear in the navigation pane. All the other areas will cause their subordinate actions to appear in the Role Center ribbon. </p>
<p class="calibre1"><b class="calibre3">Creating a WDTU Role Center ribbon</b></p>
<p class="calibre1">If we were creating a Role Center to be used in a real production environment, we would likely be defining a new activities page, new cues, a new or modified cue table, new FactBoxes, and so on. However, since our primary purpose here is learning, we’ll take the shortcut of piggybacking on the existing role center and simply add our WDTU actions to the foundation of that existing Role Center. </p>
<p class="calibre1"><b class="calibre3">[ 415 ]</b></p>
<p class="calibre1"><a id="calibre_link-503"></a><img src="images/000234.jpg" alt="Image 410" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">There are several steps to be taken to define our WDTU Role Center ribbon using the developer tools. The steps we need to take for our WDTU actions are as follows:</p>
<p class="calibre1">1. Define one or more new ribbon categories for the WDTU actions</p>
<p class="calibre1">2. Create the WDTU action controls in the Action Designer</p>
<p class="calibre1">3. Assign the WDTU action controls to the appropriate ribbon categories</p>
<p class="calibre1">4. Finalize any look and feel items</p>
<p class="calibre1">Let’s add the following functions to the WDTU portion of the Action Ribbon:</p>
<p class="calibre1">Radio Show list page</p>
<p class="calibre1">Playlist page</p>
<p class="calibre1">To add an action, access the page&mdash;<b class="calibre3">Action Designer</b> screen, go the bottom of the list of existing actions, and add a new group for WDTU operations. Then, we add a line using the action snippet. Alternatively, we can copy/paste an existing action. </p>
<p class="calibre1">We connect the action to Page Radio Show List. Next, we will define the caption and image to represent this menu option. Let’s do the same thing for one of the Playlist Document List pages, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 416 ]</b></p>
<p class="calibre1"><a id="calibre_link-255"></a><img src="images/000256.png" alt="Image 411" class="calibre2" /></p>
<p class="calibre1"><img src="images/000278.png" alt="Image 412" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">The resulting ribbon looks like the following screenshot:</p>
<p class="calibre1">Having gone over the Role Center pages, we will now discuss XMLports. </p>
<p class="calibre1"><b class="calibre3">XMLports</b></p>
<p class="calibre1"><b class="calibre3">XML</b> (<b class="calibre3">eXtensible Markup Language)</b> is a structured text format developed to describe data to be shared by dissimilar systems. XML has become a standard for communications between systems. To make handling XML-formatted data simpler and more error resistant, Business Central provides XMLports, a data import/export object. In addition to processing XML-formatted data, XMLports can also handle a wide variety of other text file formats, including CSV files, generic flat files, and so on. XML-formatted data is text based, with each piece of information structured in one of two basic formats: elements or attributes. An element is the overall logical unit of information, while an attribute is a property of an element. They are formatted as follows:</p>
<p class="calibre1">&lt;Tag&gt;elementvalue&lt;/Tag&gt; (an <b class="calibre3">element</b> format)</p>
<p class="calibre1">&lt;Tag AttribName=“attribute datavalue”&gt; (an <b class="calibre3">attribute</b> format)) Elements can be nested, but must not overlap. Element and attribute<br>names are case-sensitive. Names cannot start with a number, punctuation<br>character, or the letters xml (upper or lowercase), and cannot contain<br>spaces. An attribute value must always be enclosed in single or double<br>quotation marks. Some references suggest that elements should be used<br>for data and attributes for metadata. Complex data structures are built of<br>combinations of these two formats. </p>
<p class="calibre1"><b class="calibre3">[ 417 ]</b></p>
<p class="calibre1"><a id="calibre_link-504"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">For example, let’s consider the following code:</p>
<p class="calibre1">&lt;Table Name=‘Sample XML format’&gt; </p>
<p class="calibre1">&lt;Record&gt; </p>
<p class="calibre1">&lt;DataItem1&gt;12345&lt;/DataItem1&gt; </p>
<p class="calibre1">&lt;DataItem2&gt;23456&lt;/DataItem2&gt; </p>
<p class="calibre1">&lt;/Record&gt; </p>
<p class="calibre1">&lt;Record&gt; </p>
<p class="calibre1">&lt;DataItem1&gt;987&lt;/DataItem1&gt; </p>
<p class="calibre1">&lt;/Record&gt; </p>
<p class="calibre1">&lt;Record&gt; </p>
<p class="calibre1">&lt;DataItem1&gt;22233&lt;/DataItem1&gt; </p>
<p class="calibre1">&lt;DataItem2&gt;7766&lt;/DataItem2&gt; </p>
<p class="calibre1">&lt;/Record&gt; </p>
<p class="calibre1">&lt;/Table&gt; </p>
<p class="calibre1">In this instance, we have a set of data identified as Table with an attribute of Name equal to</p>
<p class="calibre1">‘SampleXMLformat’, which contains three Record instances, each Record containing data in one or two fields named DataItem1 and DataItem2. The data is in a clearly structured text format, so it can be read and processed by any system prepared to read this particular XML format. If the field tags are well designed, the data is easily interpretable by humans, as well. The key to a successful exchange of data using XML is the sharing and common interpretation of the format between the transmitter and recipient. </p>
<p class="calibre1">XML is a standard format, in the sense that the data structure options are clearly defined. It is very flexible, in the sense that the identifying tag names (in &lt; &gt; brackets) and the related data structures are totally open-ended in how they can be defined and processed. The specific structure and the labels are whatever the communicating parties decide they should be. The rules of XML only determine how the basic syntax should operate. </p>
<p class="calibre1">XML data structures can be as simple as a flat file consisting of a set of identically formatted records or as complex as a sales order structure with headers containing a variety of data items, combined with associated detail lines containing their own assortments of data items. An XML data structure can be as complicated as the application requires. </p>
<p class="calibre1"><a href="http://www.w3.org">XML standards are maintained by the W3C, whose website is at www.w3.org</a>. There are many other useful websites for basic XML information. </p>
<p class="calibre1"><b class="calibre3">[ 418 ]</b></p>
<p class="calibre1"><a id="calibre_link-256"></a><img src="images/000299.png" alt="Image 413" class="calibre2" /></p>
<p class="calibre1"><img src="images/000320.png" alt="Image 414" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">XMLport components</b></p>
<p class="calibre1">Although in theory, XMLports can operate in both an import and an export mode, in practice, individual XMLport objects tend to be dedicated to either import or export. This allows the internal logic to be simpler. XMLports utilize a process of looping through and processing data, similar to that of report objects. </p>
<p class="calibre1">The components of XMLports are as follows:</p>
<p class="calibre1">Let’s take a look at the properties first. </p>
<p class="calibre1"><b class="calibre3">XMLport properties</b></p>
<p class="calibre1">XMLport properties are shown in the following screenshot of the properties of the XMLport object 9170:</p>
<p class="calibre1"><b class="calibre3">[ 419 ]</b></p>
<p class="calibre1"><a id="calibre_link-409"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Descriptions of the individual properties are as follows:</p>
<p class="calibre1">Caption: This is the name that is displayed for the XMLport; it defaults to the<br>contents of the Name property. </p>
<p class="calibre1">CaptionML: The Caption translation for a defined alternative language. </p>
<p class="calibre1">Direction: This defines whether this XMLport can only Import, Export, or</p>
<p class="calibre1">&lt;Both&gt;; the default is &lt;Both&gt;. </p>
<p class="calibre1">DefaultFieldsValidation: This defines the default value (Yes or No) for the</p>
<p class="calibre1">FieldValidate property for individual XMLport data fields. The default for<br>this field is Yes, which will set the default for individual field FieldValidate properties to Yes. </p>
<p class="calibre1">Encoding (or TextEncoding): This defines the character encoding option to be<br>used: UTF-8<b class="calibre3"> </b>(ASCII compatible), UTF-16 (not ASCII compatible), or ISO-8859-2</p>
<p class="calibre1">(for certain European languages written in Latin characters). UTF-16 is the<br>default. This is inserted into the heading of the XML document. </p>
<p class="calibre1">The TextEncoding option is only available if the Format property is Fixed Text<br>or Variable Text. In this case, a character coding option of <b class="calibre3">MS-DOS</b> is available and is the default. </p>
<p class="calibre1">XMLVersionNo: This defines to which version of XML the document conforms, </p>
<p class="calibre1">Version1.0 or 1.1. The default is Version1.0. This is inserted into the<br>heading of the XML document. </p>
<p class="calibre1">Format/Evaluate: This can be C/SIDE Format/Evaluate (the default) or</p>
<p class="calibre1">XMLFormat Evaluate. This property defines whether the external text data is</p>
<p class="calibre1">(for imports) or will be (for exports) XML data types or C/SIDE data types. In<br>each case, the default processing for all fields will be appropriate to the defined data type. If the external data does not fit in either of these categories, then the XML data fields must be processed through a temporary table. The temporary<br>table processing approach reads the external data into text data fields, with data conversion logic done in C/AL into data types that can then be stored in the</p>
<p class="calibre1">Business Central database. Very limited additional information on this is<br>available in the online help in temporary property (XMLports). </p>
<p class="calibre1">UseDefaultNamespace and DefaultNamespace: These properties are provided<br>to support compatibility with other systems that require the XML document to<br>be in a specific namespace, such as the use of a web service as a reference within Visual Studio. UseDefaultNamespace defaults to No. A default namespace in<br>the form of <b class="calibre3">URN</b> (short for <b class="calibre3">Uniform Resource Name</b>, or, in this case, a <b class="calibre3">Namespace Identifier</b>), concluding with the object number of the XMLport, is supplied for the DefaultNamespace property. This property is only active if the</p>
<p class="calibre1">Format property is XML. </p>
<p class="calibre1"><b class="calibre3">[ 420 ]</b></p>
<p class="calibre1"><a id="calibre_link-505"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Namespaces: This property takes you to a new screen where you can set up<br>multiple namespaces for the XMLport, including a prefix. </p>
<p class="calibre1">InlineSchema: This property defaults to No. An inline schema allows the XML</p>
<p class="calibre1">schema document (an XSD) to be embedded within the XML document. This can<br>be used by setting the property to Yes when exporting an XML document, which<br>will add the schema to that exported document. This property is only active if the Format property is XML. </p>
<p class="calibre1">UseLax: This property defaults to No. Some systems may add information to the</p>
<p class="calibre1">XML document, which is not defined in the XSD schema used by the XMLport. </p>
<p class="calibre1">When this property is set to Yes, that extraneous material will be ignored, rather than resulting in an error. This property is only active if the Format property is XML. </p>
<p class="calibre1">Format: This property has the options of XML, Variable Text, or Fixed Text. </p>
<p class="calibre1">It defaults to XML. This property controls the import/export data format that the XMLport will process. Choosing XML means that the processing will only deal<br>with a properly formatted XML file. Choosing Variable Text means that the<br>processing will only deal with a file formatted with delimiters set up as defined in the FieldDelimiter, FieldSeparator, RecordSeparator, and</p>
<p class="calibre1">TableSeparator properties, such as CSV files. Choosing Fixed Text means<br>that each individual element and attribute must have its Width property set to a value greater than 0 (zero), and the data to be processed must be formatted<br>accordingly. If enabled, these four fields can also be changed programmatically<br>from within C/AL code. </p>
<p class="calibre1">FileName: This can be filled with the predefined path and name of a specific<br>external text data file, to be either the source (for Import) or target (for Export) for the run of the XMLport, or this property can be set dynamically. Only one file can be opened at a time, but the file in use can be changed during the execution of the XMLport (not often done). </p>
<p class="calibre1">FieldDelimiter: This applies to Variable Text format external files only. It<br>defaults to double quote (&lt;”&gt;), the standard for so-called  <i class="calibre4">comma-delimited</i> text files. This property supplies the string that will be used as the starting delimiter for each data field in the text file. If this is Import, then the XMLport will look for this string, and then use the string following as data until the next</p>
<p class="calibre1">FieldDelimiter string is found, terminating the data string. If this is Export, </p>
<p class="calibre1">the XMLport will insert this string at the beginning and end of each data field<br>contents string. </p>
<p class="calibre1"><b class="calibre3">[ 421 ]</b></p>
<p class="calibre1"><a id="calibre_link-257"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">FieldSeparator: This applies to Variable Text format external files only. It<br>defaults to a comma &lt;,&gt;, the standard for so-called comma delimited text files. </p>
<p class="calibre1">This property supplies the string that will be used as the delimiter between each data field in the text file (looked for on Import or inserted on Export). See the help for this property for more information. </p>
<p class="calibre1">RecordSeparator: This applies to VariableText or FixedText format<br>external files only. This defines the string that will be used as the delimiter at the end of each data record in the text file. If this is Import, the XMLport will look for this string to mark the end of each data record. If this is Export, the XMLport will append this string at the end of each data record output. The default is</p>
<p class="calibre1">&lt;&lt;NewLine&gt;&gt;, which represents any combination of <b class="calibre3">CR</b> (short for <b class="calibre3">carriage</b> <b class="calibre3">return</b>-ASCII value 13) and <b class="calibre3">LF</b> (short for <b class="calibre3">line feed</b>-ASCII value 10) characters. </p>
<p class="calibre1">See the help for this property for more information. </p>
<p class="calibre1">TableSeparator: This applies to Variable Text or Fixed Text format<br>external files only. This defines the string that will be used as the delimiter at the end of each DataItem; for example, each text file. The default is</p>
<p class="calibre1">&lt;&lt;NewLine&gt;&lt;NewLine&gt;&gt;. See the help for this property for more information. </p>
<p class="calibre1">UseRequestForm: This determines whether a request page should be displayed<br>to allow the user choice of sort sequence, entry of filters, and other requested control information. The options are Yes and No. The default is &lt;Yes&gt;. An</p>
<p class="calibre1">XMLport request page only has the <b class="calibre3">OK</b> and <b class="calibre3">Cancel</b> options. </p>
<p class="calibre1">TransactionType: This property identifies the XMLport processing server<br>transaction type as Browse, Snapshot, UpdateNoLocks, or Update. This is an<br>advanced and seldom-used property. For more information, we can refer to the<br>help files and SQL Server documentation. </p>
<p class="calibre1">Permissions: This property provides report-specific setting of permissions, </p>
<p class="calibre1">which are rights to access data, subdivided into Read, Insert, Modify, and</p>
<p class="calibre1">Delete. This allows the developer to define permissions that override the user-</p>
<p class="calibre1">by-user permissions security setup. </p>
<p class="calibre1"><b class="calibre3">XMLport triggers</b></p>
<p class="calibre1">XMLport has a very limited set of triggers, which are as follows:</p>
<p class="calibre1">Documentation() is for documentation comments. </p>
<p class="calibre1">OnInitXMLport() is executed once, when the XMLport is loaded, before the<br>table views and filters have been set. </p>
<p class="calibre1"><b class="calibre3">[ 422 ]</b></p>
<p class="calibre1"><a id="calibre_link-258"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">OnPreXMLport() is executed once, after the table views and filters have been set. </p>
<p class="calibre1">Those can be reset here. </p>
<p class="calibre1">OnPostXMLport() is executed once, after all the data is processed, if the</p>
<p class="calibre1">XMLport completes normally. </p>
<p class="calibre1"><b class="calibre3">XMLport data lines</b></p>
<p class="calibre1">An XMLport can contain any number of data lines. The data lines are laid out in a strict hierarchical structure, with the elements and attributes mapping exactly, one for one, in the order of the data fields in the external text file, the XML document. </p>
<p class="calibre1">XMLports should not be run directly from a navigation pane action command (due to conflicts with Business Central UX standards), but can be run either from ribbon actions on a Role Center or other page or by means of an object containing the necessary AL code. </p>
<p class="calibre1">When running from another object (as opposed to running from an action menu entry), AL</p>
<p class="calibre1">code calls the XMLport to stream data either to or from an appropriately formatted file (XML document or other text format). This calling code is typically written in a codeunit, but can be placed in any object that can contain C/AL code. </p>
<p class="calibre1">The following example code executes an exporting XMLport and saves the resulting file from the Business Central service tier to the client machine:</p>
<p class="calibre1">XMLfile.Create(TEMPORARYPATH + ‘RadioShowExport.xml’); </p>
<p class="calibre1">XMLfile.CreateOutStream(OutStream); </p>
<p class="calibre1">XMLPORT.Export(50000, OutStream); </p>
<p class="calibre1">FromFileName := XMLfile.Name; </p>
<p class="calibre1">ToFileName := ‘RadioShowExport.xml’; </p>
<p class="calibre1">XMLfile.Close(); </p>
<p class="calibre1">//Need to call DOWNLOAD to move the xml file</p>
<p class="calibre1">//from the service tier to the client machine</p>
<p class="calibre1">Download(FromFileName, ‘Downloading File…’, ‘C:’, ‘Xml<br>file(*.xml)|*.xml’, ToFileName); </p>
<p class="calibre1">//Make sure to clean up the temporary file from the</p>
<p class="calibre1">//service tier</p>
<p class="calibre1">Erase(FromFileName); </p>
<p class="calibre1"><b class="calibre3">[ 423 ]</b></p>
<p class="calibre1"><a id="calibre_link-259"></a><img src="images/000362.png" alt="Image 415" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Two text variables (the FromFileName and ToFileName variables), a File variable, and an OutStream variable are required to support the preceding code. Take a look at the following screenshot:</p>
<p class="calibre1">Here, you can see the data variables defined. </p>
<p class="calibre1"><b class="calibre3">The XMLport line properties</b></p>
<p class="calibre1">Different XMLport line properties are active on a line depending on the value of the SourceType property. The first four properties listed are common to all three SourceType values (Text, Table, or Field), and the other properties specific to each are listed after the screenshots, showing all the properties for each SourceType:</p>
<p class="calibre1">Indentation: This indicates at what subordinate level in the hierarchy of the</p>
<p class="calibre1">XMLport this entry exists. Indentation 0 is the primary level, parent to all higher-numbered levels. Indentation 1 is a child of indentation 0, indentation 2 is a child of 1, and so forth. Only one indentation 0 is allowed in an XMLport, so often, we will want to define the level 0 line to be a simple text element line. This allows for the definition of multiple tables at indentation level 1. </p>
<p class="calibre1">NodeName: This defines the node name that will be used in the XML document to<br>identify the data associated with this position in the XML document. No spaces<br>are allowed in NodeName; we can use underscores, dashes, and periods, but no<br>other special characters. </p>
<p class="calibre1">NodeType: This defines if this data item is an element or an attribute. </p>
<p class="calibre1">SourceType: This defines the type of data this field corresponds to in the</p>
<p class="calibre1">Business Central database. The choices are Text, Table, and Field. Text means<br>that the value in the SourceField property will act as a global variable, and<br>typically, it must be dealt with by embedded C/AL code. Table means that the<br>value in the SourceField property will refer to a Business Central table. Field<br>means that the value in the SourceField property will refer to a Business</p>
<p class="calibre1">Central field within the parent table previously defined as an element. </p>
<p class="calibre1"><b class="calibre3">[ 424 ]</b></p>
<p class="calibre1"><a id="calibre_link-260"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">SourceType as text</b></p>
<p class="calibre1">A description of the text-specific properties is as follows:</p>
<p class="calibre1">TextType: This defines the Business Central data type as Text or BigText. Text<br>is the default. </p>
<p class="calibre1">VariableName: This contains the name of the global variable, which can be<br>referenced by C/AL code. </p>
<p class="calibre1">The Width, NamespacePrefix, MinOccurs, and MaxOccurs properties will be discussed later in this chapter. </p>
<p class="calibre1"><b class="calibre3">SourceType as table</b></p>
<p class="calibre1">The descriptions of the table-specific properties are as follows:</p>
<p class="calibre1">SourceTable: This defines the Business Central table being referenced. </p>
<p class="calibre1">VariableName: This defines the name to be used in C/AL code for the Business</p>
<p class="calibre1">Central table. It is the functional equivalent of the definition of a global variable. </p>
<p class="calibre1">SourceTableView: This enables the developer to define a view by choosing a<br>key and sort order or by applying filters on the table. </p>
<p class="calibre1">ReqFilterHeading and ReqFilterHeadingML: These fields allow for the<br>definition of the name of the request page filter definition tab that applies to this table. </p>
<p class="calibre1">CalcFields: This lists the FlowFields in the table that are to be calculated<br>automatically. </p>
<p class="calibre1">ReqFilterFields: This lists the fields that will initially display on the request page filter definition tab. </p>
<p class="calibre1">LinkTable: This allows for the linking of a field in a higher-level item to a key field in a lower-level item. If, for example, we were exporting all of the purchase orders for a vendor, we might link Buy-From Vendor No. in Purchase</p>
<p class="calibre1">Header to No. in a vendor record. LinkTable, in this case, would be vendor and</p>
<p class="calibre1">LinkField would be No.; therefore, LinkTable and LinkFields work<br>together. The use of the LinkTable and LinkFields operates the same as<br>applying a filter on the higher-level table data, so that only records relating to the defined lower-level table and field are processed. See the Help for more details. </p>
<p class="calibre1"><b class="calibre3">[ 425 ]</b></p>
<p class="calibre1"><a id="calibre_link-261"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">LinkTableForceInsert: This can be set to force insertion of the linked table<br>data and execution of the related OnAfterInitRecord() trigger. This property<br>is tied to the LinkTable and LinkFields properties. It also applies to Import. </p>
<p class="calibre1">LinkFields: This defines the fields involved in a table <b class="calibre3">+ Field</b> linkage. </p>
<p class="calibre1">Temporary: This defaults to No. If this property is set to Yes, it allows for the creation of a Temporary table in working storage. Data imported into this table<br>can then be evaluated, edited, and manipulated, before being written out to the<br>database. This Temporary table has the same capabilities and limitations as a</p>
<p class="calibre1">Temporary table defined as a global variable. </p>
<p class="calibre1">AutoSave: If set to Yes (the default), an imported record will automatically<br>be saved to the table. Either AutoUpdate or AutoReplace must also be set to</p>
<p class="calibre1">Yes. </p>
<p class="calibre1">AutoUpdate: If a record exists in the table with a matching primary key, all the data fields are initialized, and then all the data from the incoming record is<br>copied into the table record. </p>
<p class="calibre1">AutoReplace: If a record exists in the table with a matching primary key, the<br>populated data fields in the incoming record are copied into the table record; all the other fields in the target record are left undisturbed. This provides a means to update a table by importing records with a limited number of data fields filled in. </p>
<p class="calibre1">The Width, NamespacePrefix, MinOccurs, and MaxOccurs properties are discussed later in this chapter. </p>
<p class="calibre1"><b class="calibre3">SourceType as field</b></p>
<p class="calibre1">A description of the field-specific properties is as follows:</p>
<p class="calibre1">SourceField: This defines the data field being referenced. It can be a field in<br>any defined table. </p>
<p class="calibre1">FieldValidate: This only applies to Import. If this property is Yes, then<br>whenever the field is imported into the database, the OnValidate() trigger of<br>the field will be executed. </p>
<p class="calibre1">AutoCalcField: This applies to Export and FlowField data fields only. If this<br>property is set to Yes, the field will be calculated before it is retrieved from the database. Otherwise, a FlowField will export as an empty field. </p>
<p class="calibre1">The details of the Width, NamespacePrefix, MinOccurs, and MaxOccurs properties will be in the next section. </p>
<p class="calibre1"><b class="calibre3">[ 426 ]</b></p>
<p class="calibre1"><a id="calibre_link-262"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Element or attribute</b></p>
<p class="calibre1">An element data item can appear many times, but an attribute data item can appear no more than once; the occurrence control properties differ based on the NodeType. </p>
<p class="calibre1"><b class="calibre3">NodeType element data item</b></p>
<p class="calibre1">The element-specific properties are as follows:</p>
<p class="calibre1">Width: When the XMLport Format property is Fixed Text, then this field is<br>used to define the fixed width of this element’s field. </p>
<p class="calibre1">MinOccurs: This defines the minimum number of times this data item can occur<br>in the XML document. This property can be Zero or Once (the default). </p>
<p class="calibre1">MaxOccurs: This defines the maximum number of times this data item can occur<br>in the XML document. This property can be Once or Unbounded. Unbounded (the<br>default) means any number of times. </p>
<p class="calibre1">NamespacePrefix: When an XMLport has multiple namespaces, this property<br>allows you to select a specific one. </p>
<p class="calibre1"><b class="calibre3">NodeType attribute data item</b></p>
<p class="calibre1">The attribute-specific property is Occurrence: this is either Required (the default) or Optional, depending on the text file being imported. </p>
<p class="calibre1"><b class="calibre3">XMLport line triggers</b></p>
<p class="calibre1">There are different XMLport triggers, depending on whether the DataType is Text, Table, or Field. </p>
<p class="calibre1"><b class="calibre3">DataType as text</b></p>
<p class="calibre1">The triggers for having the DataType as Text are as follows:</p>
<p class="calibre1">Export::onBeforePassVariable(), for Export only: This trigger is typically<br>used for manipulation of the text variable</p>
<p class="calibre1">Import::OnAfterAssignVariable(), for Import only: This trigger gives us<br>access to the imported value in a text format</p>
<p class="calibre1"><b class="calibre3">[ 427 ]</b></p>
<p class="calibre1"><a id="calibre_link-263"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">DataType as Table</b></p>
<p class="calibre1">The triggers for having the DataType as Table are as follows:</p>
<p class="calibre1">Import::OnAfterInsertRecord(), for Import only: This trigger is typically<br>used when the data is being imported into temporary tables. This is where we<br>would put the C/AL code to build and insert records for the permanent database<br>tables. </p>
<p class="calibre1">Import::OnBeforeModifyRecord(), for Import only: When AutoSave is Yes, </p>
<p class="calibre1">this is used to update the imported data before saving it. </p>
<p class="calibre1">Import::OnAfterModifyRecord(), for Import only: When AutoSave is No, </p>
<p class="calibre1">this is used to update the data after updating. </p>
<p class="calibre1">Export::OnPreXMLItem(), for Export only: This trigger is typically used for<br>setting filters and initializing before finding and processing the first database record. </p>
<p class="calibre1">Export::OnAfterGetRecord(), for Export only: This trigger allows for access<br>to the data after the record is retrieved from the Business Central database. This trigger is typically used to allow manipulation of the table fields being exported. </p>
<p class="calibre1">Import::OnAfterInitRecord(), for Import only: This trigger is typically<br>used to check whether a record should be processed further or to manipulate the<br>data. </p>
<p class="calibre1">Import::OnBeforeInsertRecord(), for Import only: This is another place<br>where we can manipulate data before it is inserted into the target table. This<br>trigger is executed after the OnAfterInitRecord() trigger. </p>
<p class="calibre1"><b class="calibre3">DataType as Field</b></p>
<p class="calibre1">The triggers for having the DataType as Field are as follows:</p>
<p class="calibre1">Import::OnAfterAssignField(), for Import only: This trigger provides<br>access to the imported data value for evaluation or manipulation before<br>providing output to the database</p>
<p class="calibre1">Export::OnBeforePassField(), for Export only: This trigger provides access<br>to the data field value just before the data is exported</p>
<p class="calibre1"><b class="calibre3">[ 428 ]</b></p>
<p class="calibre1"><a id="calibre_link-264"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">XMLport Request Pages</b></p>
<p class="calibre1">XMLports can also have a Request Page to allow the user to enter Option control<br>information and filter the data being processed. The default filter fields that will appear on the Request Page are defined in the properties form for the XMLport line table. </p>
<p class="calibre1">Any desired options that are to be available to the user as a part of the Request Page must be defined in RequestOptionsPageDesigner. This Designer is accessed from the</p>
<p class="calibre1">XMLport Designer through <b class="calibre3">View</b> | <b class="calibre3">Request Page</b>. The definition of the contents and layout of the Request Options page are essentially done in the same way as other pages are done. </p>
<p class="calibre1">As with any other filter setup screen, the user has complete control of what fields are used for filtering and what filters are applied. </p>
<p class="calibre1"><b class="calibre3">Web services</b></p>
<p class="calibre1">Web services are an industry standard software interface that allow software applications to interoperate by using standard interface specifications along with standard<br>communications services and protocols. When Business Central publishes some web<br>services, those functions can be accessed and utilized by properly programmed software residing anywhere on the web. This software does not need to be directly compatible with AL, or even .NET; it just needs to obey web services conventions and have security access to the Business Central web services. </p>
<p class="calibre1">Some benefits of Business Central web services are as follows:</p>
<p class="calibre1">Very simple to publish, that is, to expose a web service to a consuming program<br>outside of Business Central</p>
<p class="calibre1">Provides managed access to Business Central data while respecting and<br>enforcing the Business Central rules, logic, and design that already exist</p>
<p class="calibre1">Uses Windows Authentication and respects Business Central data constraints</p>
<p class="calibre1">Supports <b class="calibre3">SSL</b> (<b class="calibre3">Secure Socket Layer</b>)</p>
<p class="calibre1">Supports both the SOAP interface (cannot access query objects) and the</p>
<p class="calibre1">OData(4)/REST interface (cannot access codeunit objects)</p>
<p class="calibre1"><b class="calibre3">[ 429 ]</b></p>
<p class="calibre1"><a id="calibre_link-398"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Disadvantages of Business Central web services include the following:</p>
<p class="calibre1">Allowing access to a system from the web requires a much higher level of<br>security. </p>
<p class="calibre1">The Business Central objects that are published generally need to be designed</p>
<p class="calibre1">(or, at least, customized) to properly interface with this very different user<br>interface. </p>
<p class="calibre1">Access from the web complicates the system administrator’s job of managing<br>loads on the system. </p>
<p class="calibre1">There are several factors that should be considered in judging the appropriateness of an application being considered for web services integration. Some of these are as follows: What is the degree to which the functionality of the standard RTC interface is<br>needed? A web services application should not try to replicate what would<br>normally be done with a full client, but should be used for limited, focused<br>functionality (remember, there is now a full-featured web client available for</p>
<p class="calibre1">Business Central). </p>
<p class="calibre1">What is the amount of data to be exchanged? Generally, web services are used<br>remotely. Even if they are used locally, there are additional levels of security handshaking and intersystem communications required. These involve<br>additional processing overhead. Web services should be used for low data<br>volume applications. </p>
<p class="calibre1">How public is the user set? For security reasons, the user set for direct connection to our Business Central system should generally be limited to known users, not<br>the general public. Web services should not be used to provide internet exposure to the customer’s Business Central system, but rather, for <b class="calibre3">intranet</b> access. </p>
<p class="calibre1">Because web services are intended for use by low-intensity users, there are separate license options available with lower costs per user than the full client license. This can make the cost of providing web services-based access quite reasonable, especially if by doing so, we increase the ability of our Business Central users to provide better service to their customers and to realize increased profits. </p>
<p class="calibre1"><b class="calibre3">[ 430 ]</b></p>
<p class="calibre1"><a id="calibre_link-265"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Exposing a web service</b></p>
<p class="calibre1">Three types of Business Central objects can be published as web services: pages, queries, and codeunits. The essential purposes are as follows:</p>
<p class="calibre1">Pages provide access to the associated primary table. Use card pages for table<br>access, unless there is a specific reason to use another page type. </p>
<p class="calibre1">Codeunits provide access to the functions contained within each codeunit. </p>
<p class="calibre1">Queries provide rapid, efficient access to data in a format that is especially<br>compatible with a variety of other Microsoft products, as well as products from<br>other vendors. </p>
<p class="calibre1">An XMLport can be exposed indirectly, as a codeunit parameter. This provides a very structured way of exposing Business Central data through a web service. (See AJ</p>
<p class="calibre1">Kauffmann’s blog series on XMLports in web services, </p>
<p class="calibre1">at <a href="http://kauffmann.nl/index.php/2011/01/15/how-to-use-xmlports-in-web-services-1/">http://kauffmann.nl/index.php/2011/01/15/how-to-use-xmlports-in-web-services</a></p>
<p class="calibre1"><a href="http://kauffmann.nl/index.php/2011/01/15/how-to-use-xmlports-in-web-services-1/">-1/.) There is an example later in this chapter.)</a></p>
<p class="calibre1">When a page has no special constraints, either via properties or permissions, there will normally be eleven methods available. They are as follows:</p>
<p class="calibre1">Create: This creates a single record (similar to a Business Central INSERT). </p>
<p class="calibre1">CreateMultiple: This creates a set of records (the passed argument must be an<br>array). </p>
<p class="calibre1">Read: This reads a single record (similar to a Business Central GET). </p>
<p class="calibre1">ReadMultiple: This reads a filtered set of records, paged. The page size is a<br>parameter. </p>
<p class="calibre1">Update: This updates a single record (similar to a Business Central MODIFY). </p>
<p class="calibre1">UpdateMultiple: This updates a set of records (the passed argument must be an<br>array). </p>
<p class="calibre1">Delete: This deletes a single record. </p>
<p class="calibre1">IsUpdated: This checks if the record has been updated since it was read. </p>
<p class="calibre1">ReadByRecID: This reads a record based on the record ID. </p>
<p class="calibre1">GetRecIDFromKey: This gets a record ID based on the record key. </p>
<p class="calibre1">Delete_&lt;PagePartName&gt; (PagePartRecordKey): This deletes a single record<br>that is exposed by a page part of TypePage, such as the <b class="calibre3">Sales Order</b> subform page part of the <b class="calibre3">Sales Order</b> page. </p>
<p class="calibre1"><b class="calibre3">[ 431 ]</b></p>
<p class="calibre1"><a id="calibre_link-266"></a><img src="images/000383.png" alt="Image 416" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Whatever constraints have been set in the page that we have published will be inherited by the associated web services. For example, if we publish a page that has the Editable property set to No, then only the Read, ReadMultiple, and IsUpdated methods will be available as web services. The other five methods will be suppressed by virtue of the Editable property which is equal to No. </p>
<p class="calibre1"><b class="calibre3">Publishing a web service</b></p>
<p class="calibre1">Publishing a web service is one of the easiest things we will ever do in Business Central. </p>
<p class="calibre1">However, as stated earlier, this doesn’t mean that we will be able to simply publish existing objects without creating versions specifically tailored for use with web services. However, for the moment, let’s just go through the basic publishing process. </p>
<p class="calibre1">The first column allows us to specify whether the object is a page, codeunit, or query. This is followed by the <b class="calibre3">OBJECT ID</b>, and then the <b class="calibre3">SERVICE NAME</b>. Finally, the <b class="calibre3">PUBLISHED</b></p>
<p class="calibre1">flag must be checked:</p>
<p class="calibre1">As you can see, at this point, the web services for that object are published. </p>
<p class="calibre1"><b class="calibre3">[ 432 ]</b></p>
<p class="calibre1"><a id="calibre_link-267"></a><img src="images/000404.png" alt="Image 417" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Enabling web services</b></p>
<p class="calibre1">Prior to using web services, we must enable them from the Business Central administration application. In Business Central administration, we can see the checkboxes for enabling them. We can either enable SOAP Services, or OData Services, or both, as shown in the following screenshot:</p>
<p class="calibre1">We have now enabled the services. </p>
<p class="calibre1"><b class="calibre3">Determining what was published</b></p>
<p class="calibre1">Once an object has been published, we may want to see exactly what is available as a web service. As web services are intended to be accessed from the web, in the address bar of our browser, we will enter the following (all as one string):</p>
<p class="calibre1">http://&lt;Server&gt;:&lt;WebServicePort&gt;/&lt;ServerInstance&gt;/WS/</p>
<p class="calibre1">&lt;CompanyName&gt;/services</p>
<p class="calibre1"><b class="calibre3">[ 433 ]</b></p>
<p class="calibre1"><a id="calibre_link-402"></a><img src="images/000425.png" alt="Image 418" class="calibre2" /></p>
<p class="calibre1"><img src="images/000446.png" alt="Image 419" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Some example URL addresses are as follows:</p>
<p class="calibre1">http://localhost:7047/DynamicsBusiness Central/WS/Services<br>http://Arthur:7047/DynamicsBusiness Central/WS/CRONUS International Ltd</p>
<p class="calibre1">/Services</p>
<p class="calibre1">The company name is optional and case-sensitive. </p>
<p class="calibre1">When the correct address string is entered, our browser will display a screen similar to the following image. This screenshot is in an XML format of a data structure called <b class="calibre3">WSDL</b></p>
<p class="calibre1">(short for <b class="calibre3">Web Services Description Language</b>):</p>
<p class="calibre1">In this case, we can see that we have two Business Central SOAP services<br>available: Codeunit/Radio_Show_Management and Page/Radio_Show_Card. </p>
<p class="calibre1">To see the methods (which are Business Central functions) that have been exposed as web services by publishing these two objects, we can enter other, similar URLs in our browser address bar. To see the web services exposed by our codeunit, we can change the URL used earlier to replace Services with Codeunit/Radio_Show_Management. We must also<br>include the company name in the URL that lists the methods WSDL. </p>
<p class="calibre1">To see the OData services, change the URL to one in the form, as follows:</p>
<p class="calibre1">http://&lt;Server&gt;:&lt;WebServicePort&gt;/&lt;ServerInstance&gt;/OData</p>
<p class="calibre1"><b class="calibre3">[ 434 ]</b></p>
<p class="calibre1"><a id="calibre_link-401"></a><img src="images/000012.png" alt="Image 420" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">From that entry in our browser, we get information about what’s available as OData. OData is structured like XML, but OData provides the full metadata (structural definition) of the associated data in the same file as the data. This allows OData to be consumed without the requirement of a lot of back and forth technical preplanning communication:</p>
<p class="calibre1">The actual consumption (meaning  <i class="calibre4">use</i>) of a web service is also fairly simple, but that process occurs outside of Business Central, in any of a wide variety of off-the-shelf or custom applications not a part of this book’s focus. Examples are readily available in the help, the MSDN library, the Business Central forums, and elsewhere. </p>
<p class="calibre1">Tools that can be used to consume Business Central web services include, among others, Microsoft Power BI, Microsoft Excel, Microsoft SharePoint, applications written in C#, other</p>
<p class="calibre1">.NET languages, open source PHP, and a myriad of other application development tools. </p>
<p class="calibre1">Remember, web services are a standard interface for dissimilar systems. </p>
<p class="calibre1">As with any other enhancement to the system functionality, serious thought needs to be given to the design of what data is to be exchanged and what functions within Business Central should be invoked for the application to work properly. In many cases, we will want to provide some simple routines to perform standard Business Central processing or validation tasks without exposing the full complexity of Business Central internals as web services. </p>
<p class="calibre1"><b class="calibre3">[ 435 ]</b></p>
<p class="calibre1"><a id="calibre_link-268"></a><img src="images/000032.png" alt="Image 421" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Perhaps we want to provide just two or three functions from a codeunit that contains many additional functions. Or, we may want to expose a function that is contained within a report object. In each of these instances, and others, it will be necessary to create a basic library of AL functions, perhaps in a codeunit that can be published as web services (generally recognized as a best practice). </p>
<p class="calibre1">The use of web services carries issues that must be dealt with in any<br>production environment. In addition to delivering the required<br>application functionality, there are security, access, and communications<br>issues that need to be addressed. It is recommended that a Business</p>
<p class="calibre1">Central web service not be directly exposed to external users, but Business</p>
<p class="calibre1">Central data may be secured by limiting access through the use of custom, </p>
<p class="calibre1">functionally limited, external software interfaces. While it’s outside the<br>scope of this text, proper attention to data security is critical to the<br>implementation of a good quality solution. </p>
<p class="calibre1"><b class="calibre3">XMLport &ndash; web services integration example for</b></p>
<p class="calibre1"><b class="calibre3">WDTU</b></p>
<p class="calibre1">WDTU subscribes to a service that compiles listenership data. This data is provided to subscribers in the form of XML files. The agency that provides the service has agreed to push that XML data directly to a web service exposed by our Business Central system. This approach will allow WDTU to have access to the latest listenership data as soon as it is released by the agency. </p>
<p class="calibre1">WDTU must provide access to the XMLport that fits the incoming XML file format. The handshaking response expected by the agency computer from our web service is a fixed XML file with one element (Station ID) and an attribute of the said element</p>
<p class="calibre1">(Frequency). </p>
<p class="calibre1"><b class="calibre3">[ 436 ]</b></p>
<p class="calibre1"><a id="calibre_link-399"></a><img src="images/000053.jpg" alt="Image 422" class="calibre2" /></p>
<p class="calibre1"><img src="images/000072.jpg" alt="Image 423" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">The first step is to build our XMLport. We do this by using the txmlport snippet from a new AL file in Visual Studio Code. Define the new XMLport lines, as shown in the following screenshot:</p>
<p class="calibre1">Set the Format/Evaluate property to XML Format/Evaluate. This allows Visual Studio to automatically understand the data types involved, such as integer, decimal, and so on. Set UseDefaultNamespace to Yes, and DefaultNamespace to urn:Microsoft-dynamicsnav/xmlports/x50000, which is the default format, or urn:Microsoft-dynamics-</p>
<p class="calibre1">nav/xmlports/RatingsImport. </p>
<p class="calibre1">Even though we are using the XMLport as an import-only object, make sure the Direction property stays at &lt;Both&gt;. When the value is set to either Import or Export, it is not possible to use the XMLport as a Var (by reference) parameter in the codeunit function, which we will expose as a web service. </p>
<p class="calibre1">The following is the XMLport 50100 properties screen, with those changes in place:</p>
<p class="calibre1"><b class="calibre3">[ 437 ]</b></p>
<p class="calibre1"><a id="calibre_link-506"></a><img src="images/000094.png" alt="Image 424" class="calibre2" /></p>
<p class="calibre1"><img src="images/000116.png" alt="Image 425" class="calibre2" /></p>
<p class="calibre1"><img src="images/000138.png" alt="Image 426" class="calibre2" /></p>
<p class="calibre1"><img src="images/000160.jpg" alt="Image 427" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Set the MaxOccurs property to Once, as shown in the following screenshot:</p>
<p class="calibre1">Set MinOccurs to Zero, and make sure MaxOccurs remains at the default value of</p>
<p class="calibre1">&lt;Unbounded&gt;, as shown in the following screenshot:</p>
<p class="calibre1">Now that we have our XMLport constructed, it’s time to build the codeunit that will be published as a web service. In the C/AL Locals screen, enter the single parameter, RatingsXML, type XmlPort, and a subtype of Ratings Import. Make sure the Var<br>column on the left is checked. The screen should then look like the following screenshot: Now, we will publish the codeunit we just created. </p>
<p class="calibre1">Open the client and navigate to <b class="calibre3">WEB SERVICES</b>. Fill in an <b class="calibre3">OBJECT TYPE</b> of Codeunit, an <b class="calibre3">OBJECT ID</b> of 50001, and a <b class="calibre3">SERVICE NAME</b> of WDTU Ratings, and check <b class="calibre3">PUBLISHED</b>:</p>
<p class="calibre1"><b class="calibre3">[ 438 ]</b></p>
<p class="calibre1"><a id="calibre_link-400"></a><img src="images/000182.jpg" alt="Image 428" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">Now, to test what we’ve done, we need to open a browser and enter a URL in the following format:</p>
<p class="calibre1">http://&lt;Server&gt;:&lt;SOAPWebServicePort&gt;/&lt;ServerInstance&gt;/WS/</p>
<p class="calibre1">&lt;CompanyName&gt;/services</p>
<p class="calibre1">More specifically, take the following URL as an example:</p>
<p class="calibre1">http://localhost:7047/BC130/WS/CRONUS/Codeunit/RatingWebService</p>
<p class="calibre1">For testing purposes, we could just click on the web icon on the right-hand end of our new entry in the web services screen, as shown in the preceding screenshot. The result in our browser screen should look like the following screenshot, showing that we can connect with our web service and that our XMLport contains all the fields for the data we plan to import:</p>
<p class="calibre1">With this, we conclude our discussion of web services. </p>
<p class="calibre1"><b class="calibre3">[ 439 ]</b></p>
<p class="calibre1"><a id="calibre_link-269"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1"><b class="calibre3">Summary</b></p>
<p class="calibre1">In this chapter, we reviewed some of the more advanced Business Central tools and techniques. By now, you should have a strong admiration for the power and flexibility of Business Central. Many of these subject areas will require more study and hands-on practice. We spent a lot of time on Role Center construction because that is the heart of the Role Tailored Experience. Much of what you learned about Role Center design and<br>construction can be applied across the board, in role tailoring other components. We went over XMLports and web services, and then showed how the two capabilities can be<br>combined to provide a simple but powerful method of interfacing with external systems. </p>
<p class="calibre1">By now, you should almost be ready to begin your own development project. In the next chapter, we will cover the debugger, extensibility (adding non-AL controls to pages), and some additional topics. </p>
<p class="calibre1"><b class="calibre3">Questions</b></p>
<p class="calibre1">1. Users cannot delete or modify database data through web services. True or false? </p>
<p class="calibre1">2. What source do the action items for the <b class="calibre3">Departments</b> button come from? Choose one of the following options:</p>
<p class="calibre1">Action Menu entries</p>
<p class="calibre1">Cue Group definitions</p>
<p class="calibre1">MenuSuite objects</p>
<p class="calibre1">Navigation Pane objects</p>
<p class="calibre1">3. Software external to Business Central that accesses Business Central web services must be .NET compatible. True or false? </p>
<p class="calibre1">4. Action Ribbons can be modified in which of the following ways? Choose three of the following options:</p>
<p class="calibre1">AL changes in the Action Designer</p>
<p class="calibre1">Dynamic AL code configuration</p>
<p class="calibre1">Implementer/administrator configuration</p>
<p class="calibre1">User personalization</p>
<p class="calibre1">Application of a profile template</p>
<p class="calibre1"><b class="calibre3">[ 440 ]</b></p>
<p class="calibre1"><a id="calibre_link-507"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">5. XMLports cannot contain AL code: all data manipulation must occur outside of<br>the XMLport object. True or false? </p>
<p class="calibre1">6. The default PromotedActionCategoriesML includes which of the following? </p>
<p class="calibre1">Choose two:</p>
<p class="calibre1">Page</p>
<p class="calibre1">Report</p>
<p class="calibre1">Standard</p>
<p class="calibre1">New</p>
<p class="calibre1">7. Web services are an industry-standard interface defined by the World Wide Web Consortium. True or false? </p>
<p class="calibre1">8. Role Centers can have several components. Choose two of the following:</p>
<p class="calibre1">Activity pane</p>
<p class="calibre1">Browser part</p>
<p class="calibre1">Cues</p>
<p class="calibre1">Report Review pane</p>
<p class="calibre1">9. Web services are a good tool for publishing Business Central to be used as a<br>public retail sales system on the web. True or false? </p>
<p class="calibre1">10. An action can appear in multiple places in a Role Center; for example, in the Home button of the Navigation Pane, in the Action Ribbon, and in a Cue Group. </p>
<p class="calibre1">True or false? </p>
<p class="calibre1">11. Which of the following object types can be published as web services? Choose two of the following options:</p>
<p class="calibre1">Reports</p>
<p class="calibre1">Queries</p>
<p class="calibre1">XMLports</p>
<p class="calibre1">Pages</p>
<p class="calibre1">12. A Cue can be a shortcut to a filtered list supported by a field in a Cue table. True or false? </p>
<p class="calibre1">13. New system parts can be created by a Business Central developer using AL tools. </p>
<p class="calibre1">True or false? </p>
<p class="calibre1">14. All new implementations should create new Role Centers based on the results of a detailed analysis of the intended users’ work roles, using only the standard</p>
<p class="calibre1">Role Centers as templates. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 441 ]</b></p>
<p class="calibre1"><a id="calibre_link-508"></a> <i class="calibre4">Advanced AL Development Tools</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 8</i></p>
<p class="calibre1">15. All web service data interfaces require the use of XML data files. True or false? </p>
<p class="calibre1">16. Role Center Cues can be tied to FlowFields, normal fields, or queries. True or false? </p>
<p class="calibre1">17. Actions in a ribbon are promoted so that they can be displayed in color. True or false? </p>
<p class="calibre1">18. Role Center components include which of the following options? Choose two:</p>
<p class="calibre1">Cues</p>
<p class="calibre1">Microsoft Office parts</p>
<p class="calibre1">Web services</p>
<p class="calibre1">Page parts</p>
<p class="calibre1">19. Once a Role Center layout has been defined by the developer, it cannot be<br>changed by the users. True or false? </p>
<p class="calibre1">20. In the client, XMLports can only be used to process XML formatted files, and cannot process other text file formats. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 442 ]</b></p>
<p class="calibre1"><a id="calibre_link-270"></a>9</p>
<p class="calibre1">Successful Conclusions</p>
<p class="calibre1"> <i class="calibre4">“The expected never happens; it is the unexpected always.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; John Maynard Keynes</i></p>
<p class="calibre1"> <i class="calibre4">“The most powerful designs are always the result of a continuous process of simplification</i> <i class="calibre4">and refinement.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Kevin Mullet</i></p>
<p class="calibre1">Each update of Business Central includes new features and capabilities. <b class="calibre3">Microsoft</b> <b class="calibre3">Dynamics 365 Business Central</b> is no exception. It is our responsibility to understand how to apply these new features, use them intelligently in our designs, and develop them with both their strengths and limitations in mind. Our goal in the end is not only to provide workmanlike results but, if possible, to delight our users with the quality of the experience and the ease to use of our products. </p>
<p class="calibre1">In this chapter, we will cover the following topics:</p>
<p class="calibre1">Reviewing Business Central objects that contain functions we can use directly or as templates in our solutions</p>
<p class="calibre1">Reviewing some of the Visual Studio Code tools that help us debug our solutions</p>
<p class="calibre1">Learning ways we can enhance our solutions using external controls that are<br>integrated into Business Central</p>
<p class="calibre1">Discussing design, development, and delivery issues that should be addressed in<br>our projects</p>
<p class="calibre1"><a id="calibre_link-271"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Creating new AL routines</b></p>
<p class="calibre1">Now that we have a good overall picture of how we enable users to access the tools we create, we are ready to start creating our own Business Central AL routines. It is important that you learn your way around the Business Central AL code in the standard product first. </p>
<p class="calibre1">You may recall the advice in a previous chapter that the new code we create should be visually and logically compatible with what already exists. If we think of our new code as a guest being hosted by the original system, we will be doing what any thoughtful guest does: fitting smoothly into the host’s environment. </p>
<p class="calibre1">An equally important aspect of becoming familiar with the existing code is to increase the likelihood; we can take advantage of the features and components of the standard product to address some of our application requirements. There are at least two types of existing Business Central AL code that we should make use of whenever appropriate. </p>
<p class="calibre1">One group is the callable functions that are used liberally throughout Business Central. </p>
<p class="calibre1">Once we know about these, we can use them in our logic whenever they fit. There is no documentation for most of these functions, so we must either learn about them here or do our homework and study Business Central code. The second group includes the many code snippets we can copy when we face a problem similar to something the Business Central developers have already addressed. </p>
<p class="calibre1">The code snippets differ from the callable functions in two ways. First, they are not structured as coherent and callable entities. Second, they are likely to serve as models, code that must be modified to fit the situation by changing variable names, adding or removing constraints, and so on. </p>
<p class="calibre1">In addition to the directly usable AL code, we should also make liberal use of the Business Central Design Patterns Repository, located at</p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/105.nav-design-patterns-repository.aspx">https://community.dynamics.com/nav/w/designpatterns/105.nav-design-patterns-rep</a></p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/105.nav-design-patterns-repository.aspx">ository.aspx</a>. </p>
<p class="calibre1">Business Central Design Patterns provide common definitions of how certain types of functions are implemented in Business Central. Some of the Pattern examples include the following:</p>
<p class="calibre1">Copy Document</p>
<p class="calibre1">Create Data from Templates</p>
<p class="calibre1">No. Series</p>
<p class="calibre1"><b class="calibre3">[ 444 ]</b></p>
<p class="calibre1"><a id="calibre_link-272"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Single-Record (Setup) Table</p>
<p class="calibre1">Master Data</p>
<p class="calibre1">There are many other patterns, and new pattern definitions are frequently added. </p>
<p class="calibre1"><b class="calibre3">Callable functions</b></p>
<p class="calibre1">Most of the callable functions in Business Central are designed to handle a very specific set of data or conditions and have no general-purpose use. For example, the routines to update Check Ledger entries during a posting process are likely to apply only to that specific function. If we are making modifications to a particular application area within Business Central, we may find functions that we can utilize, either as is or as models for our new functions. </p>
<p class="calibre1">There are also many functions within Business Central that are relatively general purpose. </p>
<p class="calibre1">They either act on data that is common in many different situations, such as dates and addresses, or they perform processing tasks that are common to many situations, such as providing access to an external file. We will review a few such functions in detail, then list a number of others worth studying. If nothing else, these functions are useful as guides for showing you how such functions are used in Business Central. The various parameters in these explanations are named to assist with your learning, and aren’t named the same as they are in the Business Central code (though all structures, data types, and other technical specifications match the Business Central code). </p>
<p class="calibre1">If we are using one of these functions, we must take care to clearly understand how it operates. In each case, we should study the function and test with it before assuming we adequately understand how it works. There is little or no documentation for most of these functions, so understanding their proper use is totally up to us. If we need customization, that must be done by making a copy of the target function and then modifying the copy. </p>
<p class="calibre1"><b class="calibre3">Codeunit 358 &ndash; DateFilterCalc</b></p>
<p class="calibre1">This codeunit is a good example of how well-designed and well-written code has long term utility. Except for code changes that are required by Business Central structural changes, this codeunit has changed very little since it originated in Business Central (Navision) V3.00</p>
<p class="calibre1">in 2001. That doesn’t mean it is out of date; it means it was well-thought out and complete from its beginning. </p>
<p class="calibre1"><b class="calibre3">[ 445 ]</b></p>
<p class="calibre1"><a id="calibre_link-315"></a><img src="images/000204.png" alt="Image 429" class="calibre2" /></p>
<p class="calibre1"><img src="images/000226.png" alt="Image 430" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Codeunit 358 contains two functions we can use in our code to create filters based on the <b class="calibre3">Accounting Period Calendar</b>. The first is CreateFiscalYearFilter. If we are calling this from an object that has codeunit 358 defined as a global variable named DateFilterCalc, our call would use the following syntax:</p>
<p class="calibre1">DateFilterCalc,CreateFiscalYearFilter</p>
<p class="calibre1">(Filter,Name,BaseDate,NextStep)</p>
<p class="calibre1">The calling parameters are Filter (text, length 30), Name (text, length 30), BaseDate (date), and NextStep (integer). </p>
<p class="calibre1">The second such function is CreateAccountingPeriodFilter, and has the following<br>syntax:</p>
<p class="calibre1">DateFilterCalc.CreateAccountingPeriodFilter</p>
<p class="calibre1">(Filter,Name,BaseDate,NextStep)</p>
<p class="calibre1">In the following code screenshot from page 151&mdash;Customer Statistics, we can see how Business Central calls these functions. Page 152&mdash;Vendor Statistics, page</p>
<p class="calibre1">223&mdash;Resource Statistics, and a number of other master table statistics pages also use this set of functions:</p>
<p class="calibre1">As shown in the following code screenshot, Business Central uses the filters stored in the CustDateFilter array to constrain the calculation of a series of FlowFields for the Customers Statistics page:</p>
<p class="calibre1"><b class="calibre3">[ 446 ]</b></p>
<p class="calibre1"><a id="calibre_link-273"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">When one of these functions is called, the Filter and Name parameters are updated within the function so that we can use them as return parameters, allowing the function to return a workable filter and a name for that filter. The filter is calculated from the BaseDate and NextStep we supply. </p>
<p class="calibre1">The returned filter is supplied back in the format of a range filter string, </p>
<p class="calibre1">‘startdate..enddate’ (for example, 01/01/16..12/31/16). If we call</p>
<p class="calibre1">CreateFiscalYearFilter, the Filter parameter will be for the range of a fiscal year, as defined by the system’s Accounting Period table. If we call</p>
<p class="calibre1">CreateAccountingPeriodFilter, the Filter parameter will be for the range of a fiscal period, as defined by the same table. </p>
<p class="calibre1">The dates of the Period or Year filter returned are tied to the BaseDate parameter, which can be any legal date. The NextStep parameter says which period or year to use, </p>
<p class="calibre1">depending on which function is called. A NextStep=0 says to use the period or year containing the BaseDate, NextStep=1 says to use the next period or year into the future, and NextStep=-2 says to use the period or year before last (go back two periods or years). </p>
<p class="calibre1">The Name value that’s returned is also derived from the Accounting Period table. If the call is to CreateAccountingPeriodFilter, then Name will contain the appropriate<br>accounting period name. If the call is to CreateFiscalYearFilter, then Name will contain ‘Fiscal Year yyyy’, where yyyy will be the four-digit numeric year. </p>
<p class="calibre1"><b class="calibre3">Codeunit 359 &ndash; Period Form Management</b></p>
<p class="calibre1">This codeunit contains three functions that can be used for date handling. These are FindDate, NextDate, and CreatePeriodFormat. </p>
<p class="calibre1"><b class="calibre3">FindDate function</b></p>
<p class="calibre1">The description of the FindDate function is as follows:</p>
<p class="calibre1">Calling parameters (SearchString (text, length 3), Calendar (date table), </p>
<p class="calibre1">PeriodType (option, integer))</p>
<p class="calibre1">Returns DateFound Boolean</p>
<p class="calibre1">The calling syntax for the FindDate function is as follows:</p>
<p class="calibre1">BooleanVariable := FindDate(SearchString,CalendarRec,PeriodType)</p>
<p class="calibre1"><b class="calibre3">[ 447 ]</b></p>
<p class="calibre1"><a id="calibre_link-274"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">This function is often used in pages to assist with date calculation. The purpose of this function is to find a date in the virtual Date table based on the parameters that are passed. </p>
<p class="calibre1">The search starts with an initial record in the Calendar table. If we pass in a record that has already been initialized by positioning the table at a date, that will be the base date; otherwise, the Work Date will be used. </p>
<p class="calibre1">The PeriodType is an options field with the option value choices of day, week, month, quarter, year, and accounting period. For ease of coding, we could call the function with the integer equivalent (0, 1, 2, 3, 4, 5), or set up our own equivalent Option variable. In general, it’s a much better practice to set up an Option variable because the Option strings make the code self-documenting. </p>
<p class="calibre1">The SearchString allows us to pass in a logical control string containing =, &gt;, &lt;, &lt;=, &gt;=, and so on. FindDate will find the first date, starting with the initialized Calendar date, which satisfies the SearchString logic instruction and fits the PeriodType defined. For example, if the PeriodType is day, and the date 01/25/16 is used along with the</p>
<p class="calibre1">SearchString of &gt;, then the date 01/26/16 will be returned in the Calendar. </p>
<p class="calibre1"><b class="calibre3">NextDate function</b></p>
<p class="calibre1">The description of the NextDate function is as follows:</p>
<p class="calibre1">Calling parameters (NextStep (integer), Calendar (the Date table), </p>
<p class="calibre1">PeriodType (Option, integer))</p>
<p class="calibre1">Returns Integer</p>
<p class="calibre1">The calling syntax for the NextDate function is as follows:</p>
<p class="calibre1">IntegerVariable := NextDate(NextStep,CalendarRec,PeriodType)</p>
<p class="calibre1">NextDate will find the next date record in the Calendar table that satisfies the calling parameters. The Calendar and PeriodType calling parameters for NextDate have the same definition as they do for the FindDate function. However, for this function to be really useful, the Calendar must be initialized before calling NextDate. Otherwise, the function will calculate the appropriate next date from day 0. The NextStep parameter allows us to define the number of periods of PeriodType to move, so as to obtain the desired next date. For example, if we start with a Calendar table positioned on 01/25/16, a PeriodType of quarter (that is 3), and a NextStep of 2, the NextDate will move forward two quarters and return with Calendar focused on Quarter, 7/1/16 to 9/30/16. </p>
<p class="calibre1"><b class="calibre3">[ 448 ]</b></p>
<p class="calibre1"><a id="calibre_link-275"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">CreatePeriodFormat function</b></p>
<p class="calibre1">The description of the CreatePeriodFormat function is as follows:</p>
<p class="calibre1">Calling parameters (PeriodType (Option, integer), Date (date))</p>
<p class="calibre1">Returns text, length 10</p>
<p class="calibre1">The calling syntax for the CreatePeriodFormat function is as follows:</p>
<p class="calibre1">FormattedDate := CreatePeriodFormat(PeriodType,DateData)</p>
<p class="calibre1">CreatePeriodFormat allows us to supply a date and specify which of its format options we want through the PeriodType. The function’s return value is a ten-character formatted text value, for example, mm/dd/yy or ww/yyyy, mon/yyyy, qtr/yyyy, or yyyy. </p>
<p class="calibre1"><b class="calibre3">Codeunit 365 &ndash; Format Address</b></p>
<p class="calibre1">The functions in the Format Address codeunit do the obvious&mdash;they format addresses in a variety of situations. The address data in any master record (Customer, Vendor, Sales Order Sell-to, Sales Order Ship-to, Employee, and so on) may contain embedded blank lines. For example, the Address 2 line may be empty. When we print out the address information on a document or report, it will look better if there are no blank lines. These functions take care of such tasks. </p>
<p class="calibre1">In addition, Business Central provides setup options for multiple formats of City&mdash;Post Code&mdash;County&mdash;Country combinations. The Format Address functions format addresses<br>according to what was chosen in the setup, or was defined in the Countries/Regions page for different Postal areas. </p>
<p class="calibre1">There are over 60 data-specific functions in the Format Address codeunit. Each data-specific function allows us to pass a record parameter for the record containing the raw address data, such as a Customer record, a Vendor Record, a Sales Order, and so on, plus a parameter of a one-dimensional text array with eight elements of length up to 90 characters. </p>
<p class="calibre1">Each function extracts the address data from its specific master record format and stores it in the array. The function then passes that data to a general-purpose function, which does the actual work of resequencing, according to the various setup rules, and compressing the data by removing blank lines. </p>
<p class="calibre1"><b class="calibre3">[ 449 ]</b></p>
<p class="calibre1"><a id="calibre_link-509"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">The following code examples are of the function call format for the functions of Company and the Sales Ship-to addresses. In each case, AddressArray is Text, Length 90, and one-dimensional with eight elements:</p>
<p class="calibre1">“Format Address”.Company(AddressArray,CompanyRec); </p>
<p class="calibre1">“Format Address”. SalesHeaderSellTo (AddressArray,SalesHeaderRec); </p>
<p class="calibre1">The function’s processed result is returned in the AddressArray parameter. </p>
<p class="calibre1">In addition to the data-specific functions in the Format Address codeunit, we can also directly utilize the more general-purpose functions contained there. If we add a new address structure as part of an enhancement, we may want to create our own data-specific address formatting function in our custom codeunit. However, we should design our function to call the general purpose functions that already exist (and are already debugged). </p>
<p class="calibre1">The primary general-purpose address formatting function (the one we are most likely to call directly) is FormatAddr. This is the function that does most of the work in this codeunit. The syntax for the FormatAddr function is as follows:</p>
<p class="calibre1">FormatAddr(AddressArray,Name,Name2,ContactName,Address1,Address2, </p>
<p class="calibre1">City,PostCode,County,CountryCode)</p>
<p class="calibre1">The calling parameters of AddressArray, Name, Name2, and ContactName are all text, length 90. Address1, Address2, City, and County are all text, length 50. PostCode and CountryCode are data type code, length 20, and length 10, respectively. </p>
<p class="calibre1">Our data is passed into the function in the individual Address fields. The results are passed back in the AddressArray parameter for us to use. </p>
<p class="calibre1">There are two other functions in the Format Address codeunit that are often called directly. They are FormatPostCodeCity and GeneratePostCodeCity. The</p>
<p class="calibre1">FormatPostCodeCity function serves the purpose of finding the applicable setup rule for PostCode, plus City plus County plus Country formatting. It then calls the</p>
<p class="calibre1">GeneratePostCodeCity function, which does the actual formatting. </p>
<p class="calibre1"><b class="calibre3">[ 450 ]</b></p>
<p class="calibre1"><a id="calibre_link-276"></a><img src="images/000248.png" alt="Image 431" class="calibre2" /></p>
<p class="calibre1"><img src="images/000270.png" alt="Image 432" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Codeunit 396 &ndash; NoSeriesManagement</b></p>
<p class="calibre1">Throughout Business Central, master records (for example Customer, Vendor, Item, and so on) and activity documents (Sales Order, Purchase Order, Warehouse Transfer Orders, and so on) are controlled by the unique identification number assigned to each one. This unique identification number is assigned through a call to a function within the</p>
<p class="calibre1">NoSeriesManagement codeunit. That function is InitSeries. The calling format for InitSeries is as follows:</p>
<p class="calibre1">NoSeriesManagement.InitSeries(WhichNumberSeriesToUse, </p>
<p class="calibre1">LastDataRecNumberSeriesCode, SeriesDateToApply, NumberToUse, </p>
<p class="calibre1">NumberSeriesUsed)</p>
<p class="calibre1">The WhichNumberSeriesToUse parameter is generally defined on a Numbers Tab in the Setup record for the applicable application area. LastDataRecNumberSeriesCode tells the function what Number Series was used for the previous record in this table. The</p>
<p class="calibre1">SeriesDateToApply parameter allows the function to assign ID numbers in a date-</p>
<p class="calibre1">dependent fashion. NumberToUse and the NumberSeriesUsed are return parameters. </p>
<p class="calibre1">The following screenshot shows an example for <b class="calibre3">Table 18 Customer</b>:</p>
<p class="calibre1">The following screenshot shows a second example for <b class="calibre3">Table 36 Sales Header</b>. In this case, the call to NoSeriesMgt has been placed in a local function:</p>
<p class="calibre1"><b class="calibre3">[ 451 ]</b></p>
<p class="calibre1"><a id="calibre_link-277"></a><img src="images/000291.png" alt="Image 433" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">With the exception of GetNextNo (used in assigning unique identifying numbers to each of a series of transactions) and, possibly, TestManual (used to test if manual numbering is allowed), we are not likely to use other functions in the NoSeriesManagement codeunit. </p>
<p class="calibre1">The other functions are principally used either by the InitSeries function or other Business Central routines, whose job is to maintain number series control information and data. </p>
<p class="calibre1">There is also a Business Central Pattern for describing the use of number series in Business Central. It is entitled No. Series<a href="https://community.dynamics.com/nav/w/designpatterns/74.no-series"> and can be found at https:/​/​community.​dynamics.​com/</a></p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/w/designpatterns/74.no-series">nav/​w/​designpatterns/​74.​no-​series</a>. </p>
<p class="calibre1"><b class="calibre3">Function models to review and use</b></p>
<p class="calibre1">It is very helpful when creating new code to have a model that works and that we can study (or clone). This is especially true in Business Central, where there is little or no development documentation available for many of the different functions we would like to use. One of the more challenging aspects of learning to develop in the Business Central environment is learning how to handle issues in the Business Central way. Learning the Business Central way is very beneficial because then our code works better, is easier to maintain, and easier to upgrade. There is no better place to learn the strengths and subtle features of the product than to study the code written by the developers who are part of the inner circle of Business Central creation. </p>
<p class="calibre1">If there is a choice, don’t add custom functions to the standard Business</p>
<p class="calibre1">Central codeunits. Well segregated customizations in clearly identified<br>custom objects make both maintenance and upgrades easier. When we<br>build functions modeled on Business Central functions, the new code<br>should be in a customer licensed codeunit. </p>
<p class="calibre1">The following is a list of objects that contain functions we may find useful to use in our code or as models. We find these useful to study how it’s done in Business Central (“it” </p>
<p class="calibre1">obviously varies, depending on the function’s purpose):</p>
<p class="calibre1"><b class="calibre3">Codeunit 1&mdash;Application Management</b>: This is a library of utility functions that’s widely used in the system</p>
<p class="calibre1"><b class="calibre3">Codeunits 11, 12, 13, 21, 22, 23, 80, 81, 82, 90, 91, and 92</b>: These are the Posting sequences for Sales, Purchases, General Ledger, and Item Ledger, and they<br>control the posting of journal data into the various ledgers</p>
<p class="calibre1"><b class="calibre3">Codeunit 228&mdash;Test Report-Print</b>: Functions for printing Test Reports for user review prior to Posting data</p>
<p class="calibre1"><b class="calibre3">[ 452 ]</b></p>
<p class="calibre1"><a id="calibre_link-278"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Codeunit 229&mdash;Print Documents</b>: Functions for printing document formatted<br>reports</p>
<p class="calibre1"><b class="calibre3">Codeunits 397 and 400&mdash;Mail</b>: Functions for interfacing with Outlook and SMTP</p>
<p class="calibre1">mail</p>
<p class="calibre1"><b class="calibre3">Codeunit 408&mdash;Dimension Management</b>: Don’t write your own; use these</p>
<p class="calibre1"><b class="calibre3">Codeunit 419&mdash;File Management</b>: Functions including BLOB tasks, file<br>uploading, and downloading between server and client systems</p>
<p class="calibre1"><b class="calibre3">Codeunits 802</b>: Online Map interfacing</p>
<p class="calibre1"><b class="calibre3">Codeunit 5054&mdash;Word Management</b>: Interfaces to Microsoft Word</p>
<p class="calibre1"><b class="calibre3">Codeunit 5063&mdash;Archive Management</b>: Storing copies of processed documents</p>
<p class="calibre1"><b class="calibre3">Codeunits 5300 through 5313</b>: More Outlook interfacing</p>
<p class="calibre1"><b class="calibre3">Codeunits 5813 through 5819</b>: Undo functions</p>
<p class="calibre1"><b class="calibre3">Codeunit 6224</b>: XML DOM Management for XML structure handling</p>
<p class="calibre1"><b class="calibre3">Table 330&mdash;Currency Exchange Rate</b>: Contains some of the key currency<br>conversion functions</p>
<p class="calibre1"><b class="calibre3">Table 370&mdash;Excel Buffer</b>: Excel interfacing</p>
<p class="calibre1"><b class="calibre3">Page 344&mdash;Navigate</b>: Home of the unique and powerful Navigate feature</p>
<p class="calibre1"><b class="calibre3">Management codeunits</b></p>
<p class="calibre1">There are over 150 codeunits with the word Management (or the abbreviation Mgt) as part of their description name (filter the codeunit names using *Management*|*Mgt* &ndash; don’t forget that such a filter is case-sensitive). Each of these codeunits contains functions whose purpose is the management of some specific aspect of Business Central data. Many are specific to a very narrow range of data. Some are more general because they contain functions we can reuse in another application area (for example, codeunit</p>
<p class="calibre1">396&mdash;NoSeriesManagement). </p>
<p class="calibre1">When we are working on an enhancement in a particular functional area, it is extremely important to check the Management codeunits that are utilized in that area. We may be able to use some existing standard functions directly. This will have the benefit of reducing the code we have to create and debug. Of course, when a new version is released, we will have to check to see if the functions on which we relied have changed in a way that affects our code. </p>
<p class="calibre1"><b class="calibre3">[ 453 ]</b></p>
<p class="calibre1"><a id="calibre_link-279"></a><img src="images/000354.png" alt="Image 434" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">If we can’t use the existing material as is, we may find functions we can use as models for tasks in the area of our enhancement. And, even if that is not true, by researching and studying the existing code, you will learn more about how data is structured and processed in the flow of the standard Business Central system. </p>
<p class="calibre1"><b class="calibre3">Multi-language system</b></p>
<p class="calibre1">The Business Central system is designed as a multi-language system, meaning it can interface with users in many languages. The base product is distributed with American English as the primary language, but each local version comes with one or more other languages ready for use. Because the system can be set up to operate from a single database, displaying user interfaces in several different languages, Business Central is particularly suitable for firms operating from a central system serving users in multiple countries. Business Central is used by businesses all over the world, operating in dozens of different languages. It is important to note that, when the application language is changed, it has no effect on the data in the database. The data is not multi-language unless we provide that functionality, by means of our own enhancements or data structure. </p>
<p class="calibre1">The basic elements that support the multi-language feature include the following: Multi-language captioning properties (for example, CaptionML) that support<br>definitions of alternative language captions for all the fields, action labels, titles, and so on</p>
<p class="calibre1">The Text Constants property, ConstantValueML, which is a supporting<br>definition of alternative language messages</p>
<p class="calibre1">For Business Central, Microsoft switched to translations using XLIFF files. </p>
<p class="calibre1">At the time of publishing this book there is no consensus on efficiently<br>managing these files. </p>
<p class="calibre1">Before embarking on an effort to create multi-language enabled modifications, review all the available documentation on this topic (search Help on the word language). It’s wise to do some small scale testing to ensure that you understand what is required, and that your approach will work (such testing is required for any significant enhancement). </p>
<p class="calibre1">More information on translations can be found at <a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-work-with-translation-files">https:/​/​docs.​microsoft.​com/​en-​us/</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-work-with-translation-files">dynamics365/​business-​central/​dev-​itpro/​developer/​devenv-​work-​with-​translation-</a></p>
<p class="calibre1"><a href="https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-work-with-translation-files">files. </a></p>
<p class="calibre1"><b class="calibre3">[ 454 ]</b></p>
<p class="calibre1"><a id="calibre_link-280"></a><img src="images/000375.png" alt="Image 435" class="calibre2" /></p>
<p class="calibre1"><img src="images/000396.png" alt="Image 436" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Multi-currency system</b></p>
<p class="calibre1">Business Central was one of the first ERP systems to fully implement a multi-currency system. Transactions can start in one currency and finish in another. For example, we can create an order in US dollars and accept payment for the invoice in Euros or Bitcoin or Yen. </p>
<p class="calibre1">For this reason, where there are money values, they are generally stored in the <b class="calibre3">local</b> <b class="calibre3">currency</b> (referenced as <b class="calibre3">LCY</b>), as defined in the setup. There is a set of currency conversion tools built into the applications, and there are standard (by practice) code structures to support and utilize those tools. Two examples of code segments from the Sales Line table illustrating the handling of money fields, are as follows:</p>
<p class="calibre1">In both cases, there’s a function call to ROUND and use of the currency-specific Currency. </p>
<p class="calibre1">“Amount Rounding Precision” control value, as shown in the following code snippet screenshot:</p>
<p class="calibre1">As we can see, before creating any modification that has money fields, we must familiarize ourselves with the Business Central currency conversion feature, the code that supports it, and the related setups. A good place to start is the AL code in table 37&mdash;Sales Line, table 39&mdash;Purchase Line, and table 330&mdash;Currency Exchange Rate. </p>
<p class="calibre1"><b class="calibre3">[ 455 ]</b></p>
<p class="calibre1"><a id="calibre_link-281"></a><img src="images/000417.png" alt="Image 437" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Navigate</b></p>
<p class="calibre1">Navigate is an underappreciated tool for both the user and the developer. Our focus here is on its value to the developer. Navigate (page 344) finds and displays the counts and types of all the associated entries for a particular posting transaction. The term that’s associated, in this case, is defined as those entries having the same Document Number and Posting Date. This is a handy tool for the developer as it can show the results of posting activity and provide the tools to drill into the detail of all those results. If we add new transactions and ledgers as part of an enhancement, our Navigate function should be enhanced to cover them, too. </p>
<p class="calibre1">Navigate can be called from the <b class="calibre3">Navigate</b> action, which appears in a number of places in the <b class="calibre3">Departments Tasks</b> menu and Role Center ribbons. From anywhere within Business Central, the easiest way to find Navigate is to type the word into the <b class="calibre3">Search</b> box (see the following screenshot):</p>
<p class="calibre1">If we invoke the <b class="calibre3">Navigate</b> page using the menu action item, we must enter the <b class="calibre3">Posting Date</b> and <b class="calibre3">Document Number</b> for the entries we wish to find. Alternatively, we can enter a <b class="calibre3">Business Contact Type</b> (Vendor or Customer), a <b class="calibre3">Business Contact No. </b> (Vendor No. </p>
<p class="calibre1">or Customer No.) and, optionally, an <b class="calibre3">External Document No</b>. There are occasions when this option is useful, but the <b class="calibre3">Posting Date</b> and <b class="calibre3">Document No</b>. option is more frequently useful. </p>
<p class="calibre1"><b class="calibre3">[ 456 ]</b></p>
<p class="calibre1"><a id="calibre_link-361"></a><img src="images/000438.jpg" alt="Image 438" class="calibre2" /></p>
<p class="calibre1"><img src="images/000004.png" alt="Image 439" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Instead of seeking out a <b class="calibre3">Navigate</b> page and entering the critical data fields, it is much easier to call Navigate from a <b class="calibre3">Navigate</b> action on a page showing data. In this case, we can just highlight a record and click on <b class="calibre3">Navigate</b> to search for all the related entries. In the following example, a Posted Invoice is highlighted:</p>
<p class="calibre1">After clicking the <b class="calibre3">Navigate</b> action, the page will pop up filled in, as shown in the following screenshot:</p>
<p class="calibre1"><b class="calibre3">[ 457 ]</b></p>
<p class="calibre1"><a id="calibre_link-282"></a><img src="images/000024.png" alt="Image 440" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Had we accessed the <b class="calibre3">Navigate</b> page through one of the menu entries we found through <b class="calibre3">Search</b>, we would have filled in the <b class="calibre3">Document No</b>. and <b class="calibre3">Posting Date</b> fields and clicked on <b class="calibre3">Find</b>. As we can see here, the <b class="calibre3">Navigate</b> page shows a list of related, posted entries (one of which will include the entry we highlighted when we invoked the Navigate function). If we highlight one of the lines in the <b class="calibre3">Related Entries</b> list, then click on the <b class="calibre3">Show Related Entries</b> icon at the top of the page, we will see an appropriately formatted display of the chosen entries. </p>
<p class="calibre1">If we highlight the <b class="calibre3">G/L Entry</b> table entries and click on <b class="calibre3">Show Related Entries</b>, we will see a result as shown in the following screenshot. Note that all the G/L Entry tables are displayed for the same <b class="calibre3">Posting Date</b> and <b class="calibre3">Document No. </b>, matching those specified at the top of the <b class="calibre3">Navigate</b> page:</p>
<p class="calibre1"><b class="calibre3">Modifying for Navigate</b></p>
<p class="calibre1">If our modification creates a new table that will contain posted data and the records contain both <b class="calibre3">Document No</b>. and <b class="calibre3">Posting Date</b> fields, we can include this new table in the <b class="calibre3">Navigate</b> function. </p>
<p class="calibre1">The AL Code for Navigate functionality based on <b class="calibre3">Posting Date</b> and <b class="calibre3">Document No</b>. is found in the FindRecords and FindExtRecords functions of page 344&mdash;<b class="calibre3">Navigate</b>. The following screenshot shows the segment of the Navigate CASE statement code for the CheckLedgerEntry table:</p>
<p class="calibre1"><b class="calibre3">[ 458 ]</b></p>
<p class="calibre1"><a id="calibre_link-283"></a><img src="images/000045.png" alt="Image 441" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">The code checks READPERMISSION. If that permission is enabled for this table, then the appropriate filtering is applied. Next, there is a call to the InsertIntoDocEntry function, which fills in the temporary table that is displayed in the <b class="calibre3">Navigate</b> page. If we wish to add a new table to the Navigate function, we must replicate this functionality for our new table. </p>
<p class="calibre1">In addition, we must add the code that will call up the appropriate page to display the records that Navigate finds. This code should be subscribing to the</p>
<p class="calibre1">OnAfterNavigateFindRecords event publisher of the <b class="calibre3">Navigate</b> page, modeling on the applicable section of code in this function (that is, choose the code set that best fits our new tables). Making a change like this, when appropriate, will not only provide a powerful tool for our users, but also provide a powerful tool for us as developers. </p>
<p class="calibre1"><b class="calibre3">Debugging in Business Central</b></p>
<p class="calibre1">In general, the processes and tools we use for debugging can serve multiple purposes. The most immediate purpose is always that of identifying the causes of errors and then resolving those errors. There are two categories of production errors, which may also occur during development, and <b class="calibre3">Business Central’s debugger</b> module is very well-suited to addressing both of these. The Business Central debugger smoothly integrates developing in the Development Environment and testing in the <b class="calibre3">Role Tailored Client</b> (<b class="calibre3">RTC</b>). </p>
<p class="calibre1">The first category is the type that causes an error condition that terminates processing. In this case, the immediate goal is to find the cause and fix it as quickly as possible. The debugger is an excellent tool for this purpose. The second category is the type that, while running to completion successfully, gives erroneous results. </p>
<p class="calibre1"><b class="calibre3">[ 459 ]</b></p>
<p class="calibre1"><a id="calibre_link-284"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">We often find that debugging techniques can be used to help us better understand how Business Central processes work. We may be working on the design of (or determination of the need for) a modification, or we may simply want to learn more about how a particular function is used or outcome is accomplished in the standard Business Central routines. It would be more appropriate to call these efforts analysis or self-education rather than debugging, even though the processes we use to dissect the code and view what it’s doing are very similar. In the course of these efforts, less sophisticated approaches are sometimes useful in understanding what’s going on. We’ll quickly review some of those alternate approaches before studying the use of the Business Central debugger. </p>
<p class="calibre1"><b class="calibre3">Dialog function debugging techniques</b></p>
<p class="calibre1">Sometimes, the simpler methods are more productive than the more sophisticated tools, because we can set up and test quickly, resolve the issue (or answer a question), and move on. All the simpler methods involve using one of the AL DIALOG functions, such as MESSAGE, CONFIRM, DIALOG, or ERROR. All of these have the advantage of working well in the RTC environment. However, we should remember that none of these techniques<br>conform to the Testing Best Practices in the Help topic:  <i class="calibre4">Testing the Application</i>. These should only be used when a quick one-time approach is needed, or when recommended testing practices simply won’t easily provide the information needed and one of these techniques will do so. </p>
<p class="calibre1"><b class="calibre3">Debugging with MESSAGE and CONFIRM</b></p>
<p class="calibre1">The simplest debug method is to insert MESSAGE statements at key points in our logic. This is very simple and, if structured properly, provides us with a simple trace of the code logic path. We can number our messages to differentiate them and display any data (in small amounts) as part of a message, like so:</p>
<p class="calibre1">MESSAGE(‘This is Test 4 for %1’,Customer.“No.”); </p>
<p class="calibre1">A big disadvantage is that MESSAGE statements do not display until processing either terminates or is interrupted for user interaction. Also, if you create a situation that generates hundreds of messages, you will find it quite painful to click through them individually at process termination. </p>
<p class="calibre1"><b class="calibre3">[ 460 ]</b></p>
<p class="calibre1"><a id="calibre_link-285"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">If we force a user interaction at some point, then our accumulated messages will appear prior to the interaction. The simplest way to force user interaction is to issue a CONFIRM</p>
<p class="calibre1">message in the format, as follows:</p>
<p class="calibre1">IF CONFIRM (‘Test 1’,TRUE) THEN; </p>
<p class="calibre1">If we want to do a simple trace but want every message to be displayed as it is generated (that is, have the tracking process move at a very measured pace), we could use CONFIRM</p>
<p class="calibre1">statements for all the messages. The operator must then respond to each one before our program will move on but, sometimes, that is what we want. However, if we make the mistake of creating the situation where hundreds of messages are generated, the operator will have to respond to each one individually in what could be a very time-consuming and inefficient process. </p>
<p class="calibre1"><b class="calibre3">Debugging with DIALOG</b></p>
<p class="calibre1">Another tool that is useful for progress tracking is the DIALOG function. DIALOG is usually set up to display a window with a small number of variable values. As processing progresses, the values are displayed in real time. The following are a few ways we can use this:</p>
<p class="calibre1">Simply tracking progress of processing through a volume of data. This is the<br>same reason we would provide a DIALOG display for the benefit of the user. The<br>act of displaying slows down processing somewhat, so we may want to update<br>the DIALOG display occasionally, not on every record. </p>
<p class="calibre1">Displaying indicators when processing reaches certain stages. This can be used as a very basic trace with the indicators showing the path taken, so we may gauge<br>the relative speed of progress through several steps. </p>
<p class="calibre1">We might have a six-step process to analyze. We could define six tracking<br>variables and display all of them in the DIALOG. We would initialize each<br>variable with values dependent on what we are tracking, such as A1, B2000, </p>
<p class="calibre1">C300000, and so on. At each process step, update and display the current state of one or all of the variables. This can be a very helpful guide for how our process is operating. To slow things down, we could put a SLEEP(100) or SLEEP(500)</p>
<p class="calibre1">after the DIALOG statement (the number is milliseconds of delay). </p>
<p class="calibre1"><b class="calibre3">[ 461 ]</b></p>
<p class="calibre1"><a id="calibre_link-286"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Debugging with text output</b></p>
<p class="calibre1">We can build a very handy debugging tool by outputting the values of critical variables or other informative indicators of progress, either to an external text file or to a table that’s been created for this purpose. We need to either do this in single user mode or make it multi-user by including the USER ID on every entry. </p>
<p class="calibre1">This technique allows us to run a considerable volume of test data through the system, tracking some important elements while collecting data on the variable values, progress through various sections of code, and so on. We can even timestamp our output records so that we can use this method to look for processing speed problems. </p>
<p class="calibre1">Following the test run, we can analyze the results of our test more quickly than if we were using displayed information. We can focus on just the items that appear most informative and ignore the rest. This type of debugging is fairly easy to set up and to refine, as we identify the variables or code segments of most interest. We can combine this approach with the following approach using the ERROR statement, if we output to an external text file, then close it before invoking the ERROR statement so that its contents are retained following the termination of the test run. </p>
<p class="calibre1"><b class="calibre3">Debugging with ERROR</b></p>
<p class="calibre1">One of the challenges of testing is maintaining repeatability. Quite often, we need to test several times using the same data, but the test changes the data. If we have a small database, we can always back up the database and start with a fresh copy each time. </p>
<p class="calibre1">However, that can be inefficient and, if the database is large, impractical. If we are using the built-in Business Central Test functions, we can roll back any database changes so the tests are totally repeatable. Another alternative is to conclude our test with an ERROR function to test and retest with exactly the same data. </p>
<p class="calibre1"><b class="calibre3">[ 462 ]</b></p>
<p class="calibre1"><a id="calibre_link-287"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">The ERROR function forces a runtime error status, which means the database is not updated (it is rolled back to the status at the beginning of the process). This works well when our debugging information is provided by using the debugger or any of the DIALOG functions we just mentioned prior to the execution of the ERROR function. If we are using MESSAGE to generate debugging information, we could execute a CONFIRM immediately prior to the ERROR statement and be assured that all of the messages are displayed. Obviously, this method won’t work well when our testing validation is dependent on checking results using Navigate or our test is a multi-step process, such as order entry, review, and posting. </p>
<p class="calibre1">In this latter case, only use of the built-in Test functions (creating test runner codeunits, and so on) will be adequate. However, in some situations, use of the ERROR function is a very handy technique for repeating a test with minimal effort. </p>
<p class="calibre1">When testing just the posting of an item, it often works well to place the test-concluding ERROR function just before the point in the applicable Posting codeunit where the process would otherwise be completed successfully. For the Rollback function to be effective, we must make sure there aren’t any COMMIT statements included in the range of the code being tested. </p>
<p class="calibre1"><b class="calibre3">The Business Central debugger</b></p>
<p class="calibre1">Debugging is the process of finding and correcting errors. Business Central uses the debugger from Visual Studio Code. The debugger can only be activated from Visual Studio Code. </p>
<p class="calibre1"><b class="calibre3">Activating the debugger</b></p>
<p class="calibre1">Activating the debugger from the Development Environment is a simple matter of clicking on <b class="calibre3">Debug</b> | <b class="calibre3">Start Debugging</b> (or  <i class="calibre4">Shift</i> +  <i class="calibre4">Ctrl</i> +  <i class="calibre4">F5</i>). The initial page that displays when the debugger is activated will look as follows (typically, with each session having a different <b class="calibre3">User ID</b>). </p>
<p class="calibre1"><b class="calibre3">[ 463 ]</b></p>
<p class="calibre1"><a id="calibre_link-288"></a><img src="images/000064.jpg" alt="Image 442" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">When we click on <b class="calibre3">Start Debugging</b>, an empty debugger page will open, awaiting the event that will cause a break in processing and the subsequent display of code detail (<b class="calibre3">Variables</b>), watched variables (<b class="calibre3">Watches</b>), and the <b class="calibre3">Call Stack</b>:</p>
<p class="calibre1"><b class="calibre3">Creating break events</b></p>
<p class="calibre1">Once the debugger is activated and attached to a session, a break event must occur to cause the debug trace and associated data display to begin. Break events include (but are not limited to) the following:</p>
<p class="calibre1">An error occurs that would cause object execution to be terminated</p>
<p class="calibre1">A previously set breakpoint is reached during processing</p>
<p class="calibre1">The record is read when the <b class="calibre3">Break on Record Write </b>break rule is active</p>
<p class="calibre1">The Pause icon is clicked in the popup of the debugger page</p>
<p class="calibre1"><b class="calibre3">[ 464 ]</b></p>
<p class="calibre1"><a id="calibre_link-289"></a><img src="images/000086.png" alt="Image 443" class="calibre2" /></p>
<p class="calibre1"><img src="images/000108.png" alt="Image 444" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Of the preceding events, the two most common methods of starting up a debug trace are the first two, an error, or reaching a previously set breakpoint. If, for example, an error condition is discovered in an operating object, the debugging process can be initiated by doing the following:</p>
<p class="calibre1">Activating the debugger</p>
<p class="calibre1">Running the process where the error occurs</p>
<p class="calibre1">When the error occurs, the page parts (<b class="calibre3">Variables</b>, <b class="calibre3">Watches</b>, and <b class="calibre3">Call Stack</b>) in the debug window will be populated, and we can proceed to investigate variable values, review code, and so forth. </p>
<p class="calibre1">Breakpoints are stopping points in an object that was set by the developer. Breakpoints can be set from Development Environment, in the <b class="calibre3">Debug</b> | <b class="calibre3">Toggle Breakpoint</b> option. </p>
<p class="calibre1">Active breakpoints are represented in code by a solid circle. An example is shown in the following code screenshot:</p>
<p class="calibre1"><b class="calibre3">The debugger window</b></p>
<p class="calibre1">When viewing AL code in a Designer, breakpoints can be set, disabled, or removed by pressing the  <i class="calibre4">F9</i> key. When viewing AL code in the Code window of the debugger, breakpoints can only be set or removed by pressing the  <i class="calibre4">F9</i> key or clicking on the Toggle icon. Other debugger breakpoint controls are shown in the following screenshot:</p>
<p class="calibre1">The following are the ribbon actions that you can use:</p>
<p class="calibre1"><b class="calibre3">Pause</b>: This breaks at the next statement</p>
<p class="calibre1"><b class="calibre3">Step Over</b>: This is designed to execute a function without stopping, then break <b class="calibre3">Step Into</b>: This is designed to trace into a function</p>
<p class="calibre1"><b class="calibre3">Step Out</b>: This is designed to complete the current function without stopping, and then break. </p>
<p class="calibre1"><b class="calibre3">[ 465 ]</b></p>
<p class="calibre1"><a id="calibre_link-290"></a><img src="images/000130.png" alt="Image 445" class="calibre2" /></p>
<p class="calibre1"><img src="images/000152.jpg" alt="Image 446" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Restart</b>: Stop current session and republish the extension</p>
<p class="calibre1"><b class="calibre3">Stop</b>: This stops the current activity but leaves the debugging session active <b class="calibre3">VARIABLES</b> displays the Debugger Variable List where we can examine the status of all variables that are in scope. Additional variables can be added to the Watch list here, as shown in the following screenshot:</p>
<p class="calibre1">Variables can be removed from the Watch list in the Debugger Watches<br>page. </p>
<p class="calibre1"><b class="calibre3">Visual Studio Code test-driven development</b></p>
<p class="calibre1">Business Central includes the enhanced AL Testability feature set, that’s designed to support AL test-driven development. <b class="calibre3">Test</b>-<b class="calibre3">driven development</b> is an approach where the application tests are defined prior to the development of the application code. In an ideal situation, the code supporting application tests is written prior to, or at least at the same time as, when the code implementing the target application function is written. </p>
<p class="calibre1"><b class="calibre3">[ 466 ]</b></p>
<p class="calibre1"><a id="calibre_link-369"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Advantages of test-driven development include the following:</p>
<p class="calibre1">Designing testing processes in conjunction with functional design</p>
<p class="calibre1">Finding bugs early</p>
<p class="calibre1">Preventing bugs reaching production</p>
<p class="calibre1">Enabling regression testing, which prevents changes from introducing new bugs<br>into previously validated routines</p>
<p class="calibre1">The AL Testability feature provides test-specific types of codeunits: test codeunits and test running codeunits. Test codeunits contain test methods, UI handlers, and AL code to support Test methods, including the AssertError function. Test runner codeunits are used to invoke Test codeunits for test execution management, automation, and integration. </p>
<p class="calibre1">Test runner codeunits have two special triggers, each of which run in separate transactions so that the test execution state and results can be tracked. The two triggers are as follows: OnBeforeTestRun: This is called before each test. It allows you to define, via a Boolean, whether or not the test should be executed. </p>
<p class="calibre1">OnAfterTestRun: This is called when each test completes and the test results are available. It allows the test results to be logged, or otherwise processed via AL</p>
<p class="calibre1">code. </p>
<p class="calibre1">Among the ultimate goals of the AL Testability feature are the following:</p>
<p class="calibre1">The ability to run suites of application tests both in automated mode and in<br>regression tests:</p>
<p class="calibre1"><b class="calibre3">Automated</b> means that a defined series of tests could be run and<br>the results recorded, all without user intervention</p>
<p class="calibre1"><b class="calibre3">Regression testing</b> means that the test can be run repeatedly as<br>part of a new testing pass to make sure that the features that were<br>previously tested are still in working order</p>
<p class="calibre1">The ability to design tests in an atomic way, matching the granularity of the<br>application code. In this way, the test functions can be focused and simplified. </p>
<p class="calibre1">This allows for relatively easy construction of a suite of tests and, in some cases, reuse of test codeunits (or at least reuse of the structure of previously created test codeunits). </p>
<p class="calibre1">The ability to develop and run the test and test runner codeunits within the<br>familiar Visual Studio Code environment. The code for developing these testing<br>codeunits is AL. </p>
<p class="calibre1"><b class="calibre3">[ 467 ]</b></p>
<p class="calibre1"><a id="calibre_link-362"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">The TestIsolation property of test runner codeunits allow tests to be run, then<br>all database changes are rolled back so that no changes are committed. After a<br>test series in this mode, the database is the same after the test as it was before the test. </p>
<p class="calibre1">Once the testing codeunits have been developed, the actual testing process<br>should be simple and fast in order to run and evaluate results. </p>
<p class="calibre1">Both positive and negative testing is supported. <b class="calibre3">Positive testing</b> looks for a specific result, a correct answer. <b class="calibre3">Negative testing</b> checks that errors are presented when expected, especially when data or parameters are out of range. The testing structure is designed to support the logging of test results, both failures and success, to tables for review, reporting, and analysis. </p>
<p class="calibre1">A function property defines functions within test codeunits to be Test, Handler, or Normal. Another function property, TestMethodType, allows the definition of a variety of Test Function types to be defined. TestMethodType property options include the following handlers, which are designed to handle user interface events without the need for a user to intervene:</p>
<p class="calibre1"><b class="calibre3">MessageHandler</b>: This handles the MESSAGE statement</p>
<p class="calibre1"><b class="calibre3">ConfirmHandler</b>: This handles CONFIRM dialogs</p>
<p class="calibre1"><b class="calibre3">StrMenuHandler</b>: This handles STRMENU menu dialogs</p>
<p class="calibre1"><b class="calibre3">PageHandler</b>: This handles pages that are not run modally</p>
<p class="calibre1"><b class="calibre3">ModalPageHandler</b>: This handles pages that are run modally</p>
<p class="calibre1"><b class="calibre3">ReportHandler</b>: This handles reports</p>
<p class="calibre1"><b class="calibre3">RequestPagetHandler</b>: This handles the Request Page of a specific Report</p>
<p class="calibre1"><b class="calibre3">FilterPageHandler</b>: This handles Filter Pages generated by a</p>
<p class="calibre1">FilterPageBuilder data type</p>
<p class="calibre1"><b class="calibre3">HyperlinkHandler</b>: This handles hyperlinks that are passed to the HYPERLINK</p>
<p class="calibre1">function</p>
<p class="calibre1"><b class="calibre3">SendNotificationHandler</b>: This handles the new Business Central Notifications <b class="calibre3">RecallNotificationHandler</b>: This handles the recall of the new Business Central Notifications</p>
<p class="calibre1"><b class="calibre3">[ 468 ]</b></p>
<p class="calibre1"><a id="calibre_link-291"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">The Visual Studio Code test-driven development approach should proceed as follows: 1. Define an application function specification</p>
<p class="calibre1">2. Define the application technical specification</p>
<p class="calibre1">3. Define the testing technical specification, including both Positive and Negative tests</p>
<p class="calibre1">4. Develop test and test running codeunits (frequently; only one or a few test<br>running codeunits will be required)</p>
<p class="calibre1">5. Develop Application objects</p>
<p class="calibre1">6. As soon as possible, run Application object tests by means of the test running codeunits, and log test results for historical and analytical purposes</p>
<p class="calibre1">7. Continue the development-testing cycle, updating the tests and the application as appropriate throughout the process</p>
<p class="calibre1">8. At the end of the successful completion of development and testing, retain all the test and test running codeunits for use in regression testing the next time the<br>application must be modified or upgraded</p>
<p class="calibre1">With the latest product media, Microsoft released a full set of approximately 16,000</p>
<p class="calibre1">regression tests that were written by Microsoft for Business Central 2017 using the Business Central Testability tools. These are the tests that the Business Central product developers used to validate their work. The number of tests that apply to a specific situation depends on the local version and specific features involved. Make sure your license is updated, too. </p>
<p class="calibre1">Included are the regression tests and various tools to manage and execute tests that have been built on top of the testability features that were released for Microsoft Dynamics Business Central. Also included is a coverage tool and guidance documentation to create our own tests and integrate those with the Microsoft provided tests. This allows us to do full regression testing for large modifications and ISV solutions. </p>
<p class="calibre1"><b class="calibre3">Other interfaces</b></p>
<p class="calibre1">Some Business Central systems must communicate with other software or even with<br>hardware. Sometimes, that communication is Inside-Out (that is, initiated by Business Central) and sometimes, it is Outside-In (that is, initiated by the outside connection). It’s not unusual for system-to-system communications to be a two-way street, a meeting of peers. </p>
<p class="calibre1">To supply, receive, or exchange information with other systems (hardware or software), we will need at least a basic understanding of the interface tools that are part of Business Central. </p>
<p class="calibre1"><b class="calibre3">[ 469 ]</b></p>
<p class="calibre1"><a id="calibre_link-292"></a><img src="images/000174.png" alt="Image 447" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Because of Business Central’s unique data structures and the critical<br>business logic embedded therein, it is very risky for an external system to<br>access Business Central data directly via SQL Server without using AL-</p>
<p class="calibre1">based routines as an intermediary. </p>
<p class="calibre1">Business Central has a number of methods of interfacing with the world outside its database. We will review those very briefly here. To learn more about these, we should begin by reviewing the applicable material in the online Developer and IT Pro Help material, plus any documentation available with the software distribution. We should also study sample code, especially that in the standard system, as represented by the <b class="calibre3">CRONUS</b></p>
<p class="calibre1"><b class="calibre3">Demonstration Database</b>. And, of course, we should take advantage of any other resources that are available, including the Business Central-oriented internet forums and blogs. </p>
<p class="calibre1"><b class="calibre3">Client Add-ins</b></p>
<p class="calibre1">The Business Central Client Add-in API (also known as Client Extensibility) provides the capability to extend the client through the integration of external non-Business Central controls. The Client Add-in API uses .NET interfaces as the binding mechanism between a control add-in and the Business Central framework. Different interfaces and base classes are available to use, or a custom interface can be created. Controls can be designed to raise events that call on the OnControlAddin trigger on the page field control that hosts the add-in. They can also add events and methods that can be called from within AL. </p>
<p class="calibre1">Contrary to the limitations on other integration options, Client add-ins can be graphical and appear on the client display as part of, or mingled with, native Business Central controls. </p>
<p class="calibre1">The following are a few simple examples of how Client add-ins might be used to extend client UI behavior:</p>
<p class="calibre1">A Business Central text control that looks normal but offers a special behavior, but when the user double-clicks on it, the field’s contents will display in a popup screen, accompanied by other related information or even a graphical display. </p>
<p class="calibre1">A dashboard made up of several dials or gauges showing the percentage of<br>chosen resources relative to target limits or goals. The dials are defined to<br>support click and drill into the underlying Business Central detail data. </p>
<p class="calibre1">An integrated sales call mapping function displays customer locations on a map<br>and creates a sequenced call list with pertinent sales data from the Business</p>
<p class="calibre1">Central database. </p>
<p class="calibre1"><b class="calibre3">[ 470 ]</b></p>
<p class="calibre1"><a id="calibre_link-293"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Interactive visualization of a workflow or flow of goods in a process, showing the number of entries at each stage, and supports filtering to display selected sets of entries. </p>
<p class="calibre1">Entry and storage of a written document signature on a touch screen. </p>
<p class="calibre1"><b class="calibre3">Client Add-in comments</b></p>
<p class="calibre1">To take advantage of the Client Add-in capabilities, we will need to develop minimal JavaScript programming skills. Care will have to be taken when designing add-ins that their user interface style complements, rather than clashes with, the UI standards of the Business Central client. </p>
<p class="calibre1">Client Add-ins are a major extension of the Dynamics Business Central system. This feature allows ISVs to create and sell libraries of new controls and new control-based micro-applications. It allows vertically focused partners to create versions of Business Central that are much more tailored to their specific industries. This feature allows for the integration of third-party products, software, and hardware, at an entirely new level. </p>
<p class="calibre1">The Client add-in feature is very powerful. If you learn how to use it, you will have another flexible tool in your kit, and your users will benefit from it. </p>
<p class="calibre1"><b class="calibre3">Business Central development projects &ndash;</b></p>
<p class="calibre1"><b class="calibre3">general guidance</b></p>
<p class="calibre1">Now that we understand the basic workings of the Business Central Visual Studio Code development environment and AL, we’ll review the process of software design for Business Central enhancements and modifications. </p>
<p class="calibre1">When we start a new project, the goals and constraints for the project must be defined. The degree to which we meet these will determine our success. Some examples are follows: What are the functional requirements and what flexibility exists within these? </p>
<p class="calibre1">What are the user interface standards? </p>
<p class="calibre1">What are the coding standards? </p>
<p class="calibre1">What are the calendar and financial budgets? </p>
<p class="calibre1">What existing capabilities within Business Central will be used? </p>
<p class="calibre1"><b class="calibre3">[ 471 ]</b></p>
<p class="calibre1"><a id="calibre_link-294"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Knowledge is key</b></p>
<p class="calibre1">Designing for Business Central requires more forethought and knowledge of the operating details of the application than was needed with traditional models of ERP systems. As we have seen, Business Central has unique data structure tools (SIFT and FlowFields), quite a number of Business Central-specific functions that make it easier to program business applications, and a software data structure (journal, ledger, and so on) that is inherently an accounting data structure. The learning curve to become an expert in the way Business Central works is not easy. Business Central has a unique structure, and the primary documentation from Microsoft is limited to the embedded Help, which improves with every release of the product. The Business Central books published by Packt can be of great help, as are the Business Central Development Team blogs, the blogs from various Business Central experts around the world, and the Business Central forums that were mentioned earlier. </p>
<p class="calibre1"><b class="calibre3">Data-focused design</b></p>
<p class="calibre1">Any new application design must begin with certain basic analysis and design tasks. This is just as applicable whether our design is for new functionality to be integrated into Business Central or is for an enhancement/expansion of existing Business Central capabilities. </p>
<p class="calibre1">First, determine what underlying data is required. What will it take to construct the information the users need to see? What level of detail and in what structural format must the data be stored so that it may be quickly and completely retrieved? Once we have defined the inputs that are required, we must identify the sources of this material. Some may be input manually, some may be forwarded from other systems, some may be derived from historical accumulations of data, and some will be derived from combinations of all these, and more. In any case, every component of the information needed must have a clearly defined point of origin, schedule of arrival, and format. </p>
<p class="calibre1"><b class="calibre3">Defining the required data views</b></p>
<p class="calibre1">Define how the data should be presented by addressing the following questions:</p>
<p class="calibre1">How does it need to be “sliced and diced”? </p>
<p class="calibre1">What levels of detail and summary are required? </p>
<p class="calibre1">What sequences and segmentations are required? </p>
<p class="calibre1"><b class="calibre3">[ 472 ]</b></p>
<p class="calibre1"><a id="calibre_link-295"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">What visual formats will be used? </p>
<p class="calibre1">What media will be used? </p>
<p class="calibre1">Will the users be local or remote? </p>
<p class="calibre1">Ultimately, many other issues also need to be considered in the full design, including user interface specifications, data and access security, accounting standards and controls, and so on. Because there are a wide variety of tools available to extract and manipulate Business Central data, we can start relatively simply and expand as appropriate later. The most important thing is to assure that we have all the critical data elements identified and then captured. </p>
<p class="calibre1"><b class="calibre3">Designing the data tables</b></p>
<p class="calibre1">Data table definition includes the data fields, the keys to control the sequence of data access and to ensure rapid processing, frequently used totals (which are likely to be set up as SumIndex fields), references to lookup tables for allowed values, and relationships to other primary data tables. We will not only need to do a good job of designing the primary tables, but also all those supporting tables containing lookup and setup data. When integrating a customization, we must consider the effects of the new components on the existing processing, as well as how the existing processing ties into our new work. These connections are often the finishing touch that makes the new functionality operate in a truly seamlessly integrated fashion with the original system. </p>
<p class="calibre1"><b class="calibre3">Designing the user data access interface</b></p>
<p class="calibre1">The following are some of the principle design issues that need to be considered: Design the pages and reports to be used to display or interrogate the data. </p>
<p class="calibre1">Define what keys are to be used or available to the users (though the SQL Server database supports sorting data without predefined Business Central AL keys). </p>
<p class="calibre1">Define what fields will be allowed to be visible, what the totaling fields are, how the totaling will be accomplished (for example, FlowFields or on-the-fly<br>processing), and what dynamic display options will be available. </p>
<p class="calibre1">Define what type of filtering will be needed. Some filtering needs may be beyond the ability of the built-in filtering function and may require auxiliary code<br>functions. </p>
<p class="calibre1"><b class="calibre3">[ 473 ]</b></p>
<p class="calibre1"><a id="calibre_link-296"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Determine whether external data analysis tools will be needed and will therefore need to be interfaced. </p>
<p class="calibre1">Design considerations at this stage often result in returning to the previous data structure definition stage to add additional data fields, keys, SIFT fields, or<br>references to other tables. </p>
<p class="calibre1"><b class="calibre3">Designing the data validation</b></p>
<p class="calibre1">Define exactly how the data must be validated before it is accepted upon entry into a table. </p>
<p class="calibre1">There are likely to be multiple levels of validation. There will be a minimum level, which defines the minimum set of information required before a new record is accepted. </p>
<p class="calibre1">Subsequent levels of validation may exist for particular subsets of data, which, in turn, are tied to specific optional uses of the table. For example, in the base Business Central system, if the manufacturing functionality is not being used, the manufacturing-related fields in the Item Master table do not need to be filled in. However, if they are filled in, they must satisfy certain validation criteria. </p>
<p class="calibre1">As we mentioned earlier, the sum total of all the validations that are applied to data when it is entered into a table may not be sufficient to completely validate the data. Depending on the use of the data, there may be additional validations being performed during processing, reporting, or inquiries. </p>
<p class="calibre1"><b class="calibre3">Data design review and revision</b></p>
<p class="calibre1">Perform these three steps (table design, user access, data validation) for the permanent data (Masters and Ledgers) and then for the transactions (Journals). Once all of the supporting tables and references have been defined for the permanent data tables, there are not likely to be many new definitions required for the Journal tables. If any significant new supporting tables or new table relationships are identified during the design of Journal tables, we should go back and reexamine the earlier definitions. Why? Because there is a high likelihood that this new requirement should have been defined for the permanent data and was overlooked. </p>
<p class="calibre1"><b class="calibre3">[ 474 ]</b></p>
<p class="calibre1"><a id="calibre_link-297"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Designing the Posting processes</b></p>
<p class="calibre1">First, define the final data validations, and then define and design all the ledger and auxiliary tables (for example, Registers, Posted Document tables, and so on). At this point, we are determining what the permanent content of the posted data will be. If we identify any new supporting table or table reference requirements at this point, we should go back to the first step to make sure that this requirement didn’t need to be in the design definition. </p>
<p class="calibre1">Whatever variations in data are permitted to be posted, they must be acceptable in the final, permanent instance of the data. Any information or relationships that are necessary in the final posted data must be ensured to be present before posting is allowed to proceed. </p>
<p class="calibre1">Part of the posting design is to determine whether data records will be accepted or rejected individually or in complete batches. If the latter, we must define what constitutes a batch; if the former, it is likely that the makeup of a posting batch will be flexible. </p>
<p class="calibre1"><b class="calibre3">Designing the supporting processes</b></p>
<p class="calibre1">Design the processes that are necessary to validate, process, extract, and format data for the desired output. In earlier steps, these processes can be defined as “black boxes” with specified inputs and required outputs, but without overdue regard for the details of the internal processes. This allows us to work on the several preceding definitions and design steps without being sidetracked into the inner workings of the output-related processes. </p>
<p class="calibre1">These processes are the cogs and gears of the functional application. They are necessary, but often not pretty. By leaving the design of these processes in the application design as late as possible, we increase the likelihood that we will be able to create common routines and standardize how similar tasks are handled across a variety of parent processes. At this point, we may identify opportunities or requirements for improvement in material that was defined in a previous design step. In that case, we should return to that step relative to the newly identified issue. In turn, we should also review the effect of such changes for each subsequent step’s area of focus. </p>
<p class="calibre1"><b class="calibre3">Double-check everything</b></p>
<p class="calibre1">Lastly, review all the defined reference, setup, and other control tables to make sure that the primary tables and all defined processes have all the information available when needed. This is a final design quality control step. </p>
<p class="calibre1"><b class="calibre3">[ 475 ]</b></p>
<p class="calibre1"><a id="calibre_link-298"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">It is important to realize that returning to a previous step to address a previously unidentified issue is not a failure of the process; it is a success. An appropriate quote that’s used in one form or another by construction people, the world over, is  <i class="calibre4">Measure twice, cut</i> <i class="calibre4">once</i>. It is much cheaper and more efficient (and less painful) to find and fix design issues during the design phase rather than after the system is in testing or, worse yet, in production. </p>
<p class="calibre1"><b class="calibre3">Designing for efficiency</b></p>
<p class="calibre1">Whenever we are designing a new modification, we will not only need to design to address the defined needs, but also to provide a solution that processes efficiently. An inefficient solution carries unnecessary ongoing costs. Many of the things that we can do to design an efficient solution are relatively simple:</p>
<p class="calibre1">Properly configure system and workstation software (often overlooked)</p>
<p class="calibre1">Make sure networks can handle the expected load (with capacity to spare)</p>
<p class="calibre1">Have enough server memory to avoid using virtual memory, since virtual<br>memory = disk</p>
<p class="calibre1">Most of all, do everything reasonable to minimize disk I/O</p>
<p class="calibre1"><b class="calibre3">Disk I/O</b></p>
<p class="calibre1">The slowest thing in any computer system is the disk I/O. Disk I/O almost always takes more time than any other system processing activity. When we begin concentrating our design efforts on efficiency, our focus first should be on minimizing disk I/O. </p>
<p class="calibre1">The most critical elements are the design of the keys, the number of keys, the design of the SIFT fields, the number of SIFT fields, the design of the filters, and the frequency of access of data (especially FlowFields). If our system will have five or ten users processing a few thousand order lines per day, and is not heavily modified, we probably won’t have much trouble. However, if we are installing a system with one or more of the following attributes (any of which can have a significant effect on the amount of disk I/O), we will need to be very careful with our design and implementation:</p>
<p class="calibre1">Large concurrent user count</p>
<p class="calibre1">High transaction volumes, especially in data being Posted</p>
<p class="calibre1">Large stored data volumes, especially resulting from customizations or setup<br>option choices</p>
<p class="calibre1"><b class="calibre3">[ 476 ]</b></p>
<p class="calibre1"><a id="calibre_link-299"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Significant modifications</p>
<p class="calibre1">Very complex business rules</p>
<p class="calibre1"><b class="calibre3">Locking</b></p>
<p class="calibre1">One important aspect of the design of an integrated system such as Business Central, that is often overlooked until it rears its ugly head after the system goes into production, is the issue of <b class="calibre3">locking</b>. Locking occurs when one process has control of a data element, record, or group of records (in other words, part or all of a table) for the purpose of updating the data within the range of the locked data and, at the same time, another process requests the use of some portion of that data but finds it to be locked by the first process. </p>
<p class="calibre1">If a deadlock occurs, there is a serious design flaw wherein each process has data locked that the other process needs, and neither process can proceed. One of our responsibilities as developers or implementers is to minimize locking problems and eliminate any deadlocks. </p>
<p class="calibre1">Locking interference between processes in an asynchronous processing environment is inevitable. There will always be points in the system where one process instance locks out another one momentarily. The secret to success is to minimize the frequency of these and the time length of each lock. Locking becomes a problem when the locks are held too long and the other locked out processes are unreasonably delayed. </p>
<p class="calibre1">You may be wondering, what is an unreasonable delay? For the most part, a delay becomes unreasonable when the users can tell that it’s happening. If the users see stopped processes or experience counter-intuitive processing time lengths (that is, a process that seems like it should take 10 seconds actually takes two minutes), then the delays will seem<br>unreasonable. Of course, the ultimate unreasonable delay is the one that does not allow the required work to get done in the available time. </p>
<p class="calibre1">The obvious question is, how can we avoid locking problems? The best solution is simply to speed up processing. That will reduce the number of lock conflicts that arise. Important recommendations for improving processing speed include the following:</p>
<p class="calibre1">Restricting the number of active keys, especially on the SQL Server</p>
<p class="calibre1">Restricting the number of active SIFT fields, eliminating them when feasible</p>
<p class="calibre1">Carefully reviewing the keys, not necessarily using the <b class="calibre3">factory default</b> options Making sure that all disk access code is SQL Server optimized</p>
<p class="calibre1"><b class="calibre3">[ 477 ]</b></p>
<p class="calibre1"><a id="calibre_link-300"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Some additional steps that can be taken to minimize locking problems are as follows: Always process tables in the same relative order</p>
<p class="calibre1">When a common set of tables will be accessed and updated, lock a standard<br>master table first (for example, when working on orders, always lock the Order</p>
<p class="calibre1">Header table first)</p>
<p class="calibre1">Shift long-running processes to off-hours or even separate databases</p>
<p class="calibre1">In special cases, the following techniques can be used (if done very, very carefully): Process data in small quantities (for example, process 10 records or one order, </p>
<p class="calibre1">then COMMIT, which releases the lock). This approach should be very cautiously<br>applied. </p>
<p class="calibre1">In long process loops, process a SLEEP command in combination with an<br>appropriate COMMIT command to allow other processes to gain control (see the<br>preceding caution). </p>
<p class="calibre1">Refer to the documentation with the system distribution in the Business Central forums. </p>
<p class="calibre1"><b class="calibre3">Updating and upgrading</b></p>
<p class="calibre1">You must be able to differentiate between updating a system and upgrading a system. In general, most of the Business Central development work we will do is modifying<br>individual Business Central systems to provide tailored functions for end user firms. Some of those modifications will be created by developers as part of an initial system configuration and implementation before the Business Central system is in production use. </p>
<p class="calibre1">Other such modifications will be targeted at a system that is in day-to-day production to bring the system up to date with changes in business process or external requirements. </p>
<p class="calibre1">We’ll refer to these system changes as updating. </p>
<p class="calibre1">Upgrading is when we implement a new version of the base AL application code<br>distributed by Microsoft and port all the previously existing modifications into that new version. First, we’ll discuss updating, and then we’ll discuss upgrading. </p>
<p class="calibre1"><b class="calibre3">[ 478 ]</b></p>
<p class="calibre1"><a id="calibre_link-301"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Design for updating</b></p>
<p class="calibre1">Any time we are updating a production system by applying modifications to it, a<br>considerable amount of care is required. Many of the disciplines that should be followed in such an instance are the same for a Business Central system as for any other production application system. However, some disciplines are specific to Business Central and the Visual Studio Code environment. </p>
<p class="calibre1">Increasing the importance of designing for ease of updating is Microsoft’s process of providing Business Central updates on a frequent basis so that systems can be kept more up to date with fixes and minor feature enhancements. Keeping up with these Microsoft-provided updates is especially important for multi-tenant systems running in the cloud, that is, systems serving multiple unrelated customers with the software and databases being resident on internet-based server systems. </p>
<p class="calibre1"><b class="calibre3">Customization project recommendations</b></p>
<p class="calibre1">Even though there are new tools to help us update our Business Central systems, we should still follow good practices in our modification designs and the processes of applying updates. Some of these recommendations may seem obvious. This would be a measure of our personal store of experience and our own common sense. Even so, it is surprising the number of projects that go sour because one (or many) of the following are not considered in the process of developing modifications:</p>
<p class="calibre1">One modification at a time</p>
<p class="calibre1">Design thoroughly before coding</p>
<p class="calibre1">Design the testing in parallel with the modification</p>
<p class="calibre1">Use the AL Testability feature extensively</p>
<p class="calibre1">Multi-stage testing:</p>
<p class="calibre1">Cronus for individual objects</p>
<p class="calibre1">Special test database for functional tests</p>
<p class="calibre1">Copy of production database for final testing as appropriate</p>
<p class="calibre1">Setups and implementation</p>
<p class="calibre1">Testing full features:</p>
<p class="calibre1">User interface tests</p>
<p class="calibre1">System load tests</p>
<p class="calibre1">User Training</p>
<p class="calibre1">Document and deliver in a predefined, organized manner</p>
<p class="calibre1">Follow up, wrap up, and move on</p>
<p class="calibre1"><b class="calibre3">[ 479 ]</b></p>
<p class="calibre1"><a id="calibre_link-302"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">One change at a time</b></p>
<p class="calibre1">It is important to make changes to objects in a very well-organized and tightly-controlled manner. In most situations, only one developer at a time will make changes to an object. If an object needs to be changed for multiple purposes, the first set of changes should be fully tested (at least through the development testing stage) before the object is released to be modified for a second purpose. </p>
<p class="calibre1">If the project is so large and complex or deadlines are so tight that this one modification at a time approach is not feasible, we should consider the use of software source management systems, such as the <b class="calibre3">Git</b> or <b class="calibre3">Team Foundation</b> systems, which can easily help you separate multi-modifications. </p>
<p class="calibre1">Similarly, we should only be working on one functional change at a time. As developers, we might be working on changes in two different systems in parallel, but we shouldn’t be working on multiple changes in a single system simultaneously. It’s challenging enough to keep all the aspects of a single modification to a system under control without having incomplete pieces of several tasks, all floating around in the same system. </p>
<p class="calibre1">If multiple changes need to be made simultaneously to a single system, one approach is to assign multiple developers, each with their own components to address. Another approach is for each developer to work on their own copy of the development database, with a project librarian assigned to resolve overlapping updates. We should learn from the past. In mainframe development environments, having multiple developers working on the same system at the same time was common. Coordination issues were addressed as a standard part of the project management process. Applicable techniques are well-documented in professional literature. Similar solutions still apply. </p>
<p class="calibre1"><b class="calibre3">Testing</b></p>
<p class="calibre1">As we all know, there is no substitute for complete and thorough testing. Fortunately, Business Central provides some very useful tools, such as the ones we previously discussed, to help us to be more efficient than we might be in some other environment. In addition to the built-in testing tools, there are also some testing techniques that are Business Central-specific. </p>
<p class="calibre1"><b class="calibre3">[ 480 ]</b></p>
<p class="calibre1"><a id="calibre_link-303"></a><img src="images/000218.png" alt="Image 448" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Database testing approaches</b></p>
<p class="calibre1">If the new modifications are not tied to previous modifications and specific customer data, then we may be able to use the <b class="calibre3">Cronus</b> database as a test platform. This works well when our target is a database that is not heavily modified in the area on which we are currently working. As the Cronus database is small, we will not get lost in large data volumes. Most of the master tables in Cronus are populated, so we don’t have to create and populate this information. Setups are done and generally contain reasonably generic information. </p>
<p class="calibre1">If we are operating with an unmodified version of Cronus, we have the advantage that our test is not affected by other preexisting modifications. The disadvantage, of course, is that we are not testing in a wholly realistic situation. Because the data volume in Cronus is so small, we are not likely to detect a potential performance problem. </p>
<p class="calibre1">Even when our modification is targeted at a highly modified system, where those other modifications will affect what we are doing, it’s often useful to test a version of our modification initially in Cronus. This may allow us to determine if our change has internal integrity before we move on to testing in the context of the fully modified copy of the production system. </p>
<p class="calibre1">If the target database for our modifications is an active customer database, then there is no substitute for doing complete and final testing in a copy of the production database using a copy of the customer’s license. This way, we will be testing the compatibility of our work with the production setup, the full set of existing modifications, and, of course, live data content and volumes. The only way to get a good feeling for possible performance issues is to test in a recent copy of the production database. </p>
<p class="calibre1">Final testing should always be done using the customer’s license. </p>
<p class="calibre1"><b class="calibre3">Testing in production</b></p>
<p class="calibre1">While it is always a good idea to thoroughly test before adding our changes to the production system, sometimes, we can safely do our testing inside the production environment. If the modifications consist of functions that do not change any data and can be tested without affecting any ongoing production activity, it may be feasible to test within the production system. </p>
<p class="calibre1"><b class="calibre3">[ 481 ]</b></p>
<p class="calibre1"><a id="calibre_link-304"></a><img src="images/000240.png" alt="Image 449" class="calibre2" /></p>
<p class="calibre1"><img src="images/000263.png" alt="Image 450" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Examples of modifications that may be able to be tested in the live production system can range from a simple inquiry page, a new analysis report, or when exporting data that is to be processed outside the system to a completely new subsystem that does not change any existing data. There are also situations where the only changes to the existing system are the addition of fields to existing tables. In such a case, we may be able to test just a part of the modification outside production, and then implement the table changes to complete the rest of the testing in the context of the production system. </p>
<p class="calibre1">Finally, we can use the Testing functions to control tests so that any changes to the database are rolled back at the conclusion of the testing. This approach allows for testing inside a production database with less fear of corrupting live data. </p>
<p class="calibre1">Make sure not to run any test codeunit on its own as test isolation is only<br>handled by the test runner codeunit. </p>
<p class="calibre1"><b class="calibre3">Using a testing database</b></p>
<p class="calibre1">From a testing point of view, the most realistic testing environment is a current copy of an actual production database. There are sometimes apparently good excuses as to why it is just too difficult to test using a copy of the actual production database. </p>
<p class="calibre1">Don’t give in to excuses&mdash;use a testing copy of the production database! </p>
<p class="calibre1">Remember, when we implement our modifications, they will receive the <b class="calibre3">test by fire</b> in the environment of production. We need to do everything within reason to assure success. Let’s review some of the potential problems involved in testing with a copy of the production database and how to cope with them:</p>
<p class="calibre1"><b class="calibre3">It’s too big</b>: This is not a good argument relative to disk space. Disk space is so inexpensive that we can almost always afford plenty of disk space for testing. We should also make every possible useful intermediate stage backup. Staying<br>organized and making lots of backups may be time-consuming, but when done<br>well and done correctly, it is less expensive to restore from a backup than to<br>recover from being disorganized or having to redo a major testing process. This<br>is one of the many places where appropriate use of the AL Testability tools can<br>be very helpful by allowing various approaches to repetitive testing. </p>
<p class="calibre1"><b class="calibre3">[ 482 ]</b></p>
<p class="calibre1"><a id="calibre_link-305"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">This is a meaningful argument if we are performing file processing of some of the larger files, for example, Item Ledger, Value Entry, and so on. However, Business Central’s filtering capabilities are so strong that we should relatively easily be able to carve out manageably sized test data groups with which to work. </p>
<p class="calibre1"><b class="calibre3">There’s no data that’s useful</b>: This might be true. However, it would be just as true for a test database, unless it were created expressly for this set of tests. By definition, whatever data is in a copy of the production database is what we will encounter when we eventually implement the enhancements that we are<br>working on. If we build useful test data within the context of a copy of the<br>production database, our tests will be much more realistic and, therefore, of<br>better quality. In addition, the act of building workable test data will help us define what will be needed to set up the production system to utilize the new<br>enhancements. </p>
<p class="calibre1"><b class="calibre3">Production data will get in the way</b>: This may be true. If it is especially true, then perhaps the database must be preprocessed in some way to begin testing, or<br>testing must begin with some other database, such as Cronus or a special testingonly mockup. As we stated earlier, all the issues that exist in the production<br>database must be dealt with when we put the enhancements into production. </p>
<p class="calibre1">Therefore, we should test in that environment. Overcoming such challenges will<br>prepare us to do a better job at the critical time of going live with the newly<br>modified objects. </p>
<p class="calibre1"><b class="calibre3">We need to test repeatedly from the same baseline</b> or <b class="calibre3">we must do regression</b> <b class="calibre3">testing</b>: These are both good points, but don’t have much to do with the type of database we’re using for testing. Both cases are addressed by properly managing<br>the setup of our test data and keeping incremental backups of our pretest and<br>post-test data at every step of the way. SQL Server tools can assist in this effort. </p>
<p class="calibre1">In addition, the AL Testability Tools are explicitly designed to support regression testing. </p>
<p class="calibre1">Remember, doing the testing job well is much less expensive than implementing a buggy modification and repairing the problems during production. </p>
<p class="calibre1"><b class="calibre3">Testing techniques</b></p>
<p class="calibre1">As experienced developers, we are already familiar with good testing practices. Even so, it never hurts to be reminded about some of the more critical habits to maintain. </p>
<p class="calibre1"><b class="calibre3">[ 483 ]</b></p>
<p class="calibre1"><a id="calibre_link-306"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Any modification greater than trivial should be tested in one way or another by at least two people. The people that are assigned should not be a part of the team that created the design or coded the modification. It would be best if one of the testers is an experienced user, because users seem to have a knack (for obvious reasons) of understanding how the modification operates compared to how the rest of the system acts in the course of day-today work. This helps us obtain meaningful feedback on the user interface before going into production. </p>
<p class="calibre1">One of the testing goals is to supply unexpected data and make sure that the modification can deal with it properly. Unfortunately, those who were involved in creating the design will have a very difficult time being creative in supplying the unexpected. Users often enter data that the designer or programmer didn’t expect. For that reason, testing by experienced users is beneficial. </p>
<p class="calibre1">The AL Testability Tools provide features to support testing how system functions deal with problem data. If possible, it would be good to have users help us define test data, and then use the Testability Tools to assure that the modifications properly handle the data. </p>
<p class="calibre1">After we cover the mainstream issues (whatever it is that the modification is intended to accomplish), we need to make sure our testing covers all boundary conditions. Boundary conditions are the data items that are exactly equal to the maximum, minimum, or other range limit. More specifically, boundaries are the points at which input data values change from valid to invalid. Boundary condition checking in the code is where programmer logic often goes astray. Testing at these points is very effective for uncovering data-related errors. </p>
<p class="calibre1"><b class="calibre3">Deliverables</b></p>
<p class="calibre1">Create useful documentation and keep good records of testing processes and results. </p>
<p class="calibre1">Testing scripts, both human-oriented and AL Testability Tool-based, should be retained for future reference. Document the purpose of the modifications from a business point of view. </p>
<p class="calibre1">Add a brief, but complete, technical explanation of what must be done from a functional design and coding point of view to accomplish the business purpose. Briefly record the testing that was done. The scope of the record keeping should be directly proportional to the business value of the modifications being made and the potential cost of not having good records. All investments are a form of insurance and preventive medicine. We hope they won’t be needed, but we have to allow for the possibility that they might be needed. </p>
<p class="calibre1"><b class="calibre3">[ 484 ]</b></p>
<p class="calibre1"><a id="calibre_link-307"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">More complex modifications should be delivered and installed by experienced<br>implementers&mdash;perhaps even by the developers themselves. Small Business Central<br>modifications may be transmitted electronically to the customer site for installation by a skilled super user. Any time this is done, all the proper and normal actions must occur, including those actions regarding backup before importing changes, user instructions (preferably written) on what to expect from the change, and written instructions on how to correctly apply the change. There must also be a plan and a clearly defined process to restore the system to its state prior to the change, in case the modification doesn’t work correctly. </p>
<p class="calibre1"><b class="calibre3">Finishing the project</b></p>
<p class="calibre1">Bring projects to conclusion, and don’t let them drag on through inaction and inattention &ndash;</p>
<p class="calibre1">open issues get forgotten and then don’t get addressed. Get it done, wrap it up, and then review what went well and what didn’t go well, both for remediation and for application to future projects. </p>
<p class="calibre1">Set up ongoing support services as appropriate and move on to the next project. With the flexibility of the Role Tailored Client allowing page layout changes by both super users (configuration) and users (personalization), the challenge of user support has increased. No longer can the support person expect to know what display the user is viewing today. </p>
<p class="calibre1">Consequently, support services will almost certainly require the capability of the support person to be able to view the user’s display. Without that, it will be much more difficult, time-consuming, and frustrating for the two-way support of personnel-user<br>communication to take place. If it doesn’t already exist, this capability will have to be added to the partner’s support organization toolset and practices. There may be communications and security issues that need to be addressed at both the support service and the user site. </p>
<p class="calibre1"><b class="calibre3">Plan for upgrading</b></p>
<p class="calibre1">The ability to upgrade a customized system is a very important feature of Business Central. </p>
<p class="calibre1">Most other complex business application systems are very difficult to customize at the database-structure and process-flow levels. Business Central readily offers this capability. </p>
<p class="calibre1">This is a significant difference between Business Central and the competitive products in the market. </p>
<p class="calibre1"><b class="calibre3">[ 485 ]</b></p>
<p class="calibre1"><a id="calibre_link-308"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">Complementing the ability to be customized is the ability to upgrade a customized Business Central system. While not a trivial task, at least it is possible with Business Central. In many other systems, the only reasonable path to an upgrade is often to discard the old version and reimplement with the new version, recreating all customizations. Not only is Business Central unusually accommodating to being upgraded, but with each new version of the system, Microsoft has enhanced the power and flexibility of the tools it provides to help us do upgrades. </p>
<p class="calibre1">We may say, why should a developer care about upgrades? There are at least two good reasons we should care about upgrades. First, because our design and the coding of our modifications can have a considerable impact on the amount of effort required to upgrade a system. Second, because as skilled developers doing Business Central customizations, we might well be asked to be involved in an upgrade project. Because the ability to upgrade is important, and because we are likely to be involved one way or another, we will review a number of factors that relate to upgrades. </p>
<p class="calibre1"><b class="calibre3">Benefits of upgrading</b></p>
<p class="calibre1">To ensure that we are on common ground about why upgrading is important to both the client and the Business Central partner, the following is a brief list of some of the benefits available from an upgrade:</p>
<p class="calibre1">Easier support of a more current version</p>
<p class="calibre1">Access to new features and capabilities</p>
<p class="calibre1">Continued access to fixes and regulatory updates</p>
<p class="calibre1">Improvements in speed, security, reliability, and user interface</p>
<p class="calibre1">Assured continuation of support availability</p>
<p class="calibre1">Compatibility with necessary infrastructure changes, such as new operating<br>system versions</p>
<p class="calibre1">Opportunity to do needed training, data cleaning, and process improvement</p>
<p class="calibre1">Opportunity to resolve old problems, to do postponed housekeeping, create a<br>known system reference point</p>
<p class="calibre1">This list is not complete, and not every benefit will be realized in any one situation. </p>
<p class="calibre1"><b class="calibre3">[ 486 ]</b></p>
<p class="calibre1"><a id="calibre_link-309"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Coding considerations</b></p>
<p class="calibre1">The most challenging and important part of an upgrade is porting code and data<br>modifications from the older version of a system to the new version. When the new version has major design or data structure changes in an area that we have customized, it is quite possible that our modification structure will have to be redesigned and, perhaps, even be recoded from scratch. </p>
<p class="calibre1">On the other hand, many times, the changes in the new product version of Business Central don’t affect much existing code, at least in terms of the base logic. If our modifications are done properly, it’s often not very difficult to port custom code from the older version into the new version. By applying what some refer to as low-impact coding techniques, we can make the upgrade job easier and, thereby, less costly. </p>
<p class="calibre1"><b class="calibre3">Low-impact coding</b></p>
<p class="calibre1">We have already discussed most of these practices in other chapters, but will review them here, in the context of coding to make it easier to upgrade. We won’t be able to follow each of these, but will have to choose the degree to which we can implement low-impact code and which of these approaches fit our situation (this list may not be all-inclusive): Separate and isolate new code</p>
<p class="calibre1">Create functions for significant amounts of new code that can be accessed using<br>single codeline function calls</p>
<p class="calibre1">Either add independent codeunits as repositories of modification functions or, if that is overkill, place the modification functions within the modified objects</p>
<p class="calibre1">Add new data fields; don’t change the usage of existing fields</p>
<p class="calibre1">When the functionality is new, add new tables rather than modifying existing<br>tables</p>
<p class="calibre1">For minor changes, modify the existing pages, or else copy and change the clone<br>pages</p>
<p class="calibre1">Copy, then modify the copies of reports and XMLports, rather than modifying<br>the original versions in place</p>
<p class="calibre1">Don’t change field names in objects; just change captions and labels, as necessary In any modification, we will have conflicting priorities regarding doing today’s job in the easiest and least expensive way versus doing the best we can do to plan for future maintenance, enhancements, updates, and upgrades. The right decision is never a black and white choice, but must be guided by subjective guidelines as to which choice is really in the customer’s best interest. </p>
<p class="calibre1"><b class="calibre3">[ 487 ]</b></p>
<p class="calibre1"><a id="calibre_link-310"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Supporting material</b></p>
<p class="calibre1">With every Business Central system distribution, there have been some reference guides. </p>
<p class="calibre1">These are minimal in Business Central. There are previously published guides available but, sometimes, we have to search for them. Some were distributed with previous versions of the product, but not with the latest version. Some are posted at various locations on <i class="calibre4">PartnerSource</i>, or another Microsoft website. Some may be available on one of the forums or on a blog. </p>
<p class="calibre1">Be a regular visitor to websites for more information and advice on AL, Business Central, </p>
<p class="calibre1"><a href="https://dynamicsuser.net/">and other related topics. The https:/​/​dynamicsuser.​net/​ and </a><a href="https://mibuso.com/">https:/​/​mibuso.​com/</a></p>
<p class="calibre1">websites are especially comprehensive and well attended. Other smaller or more<br>specialized sites also exist. Some of those that are available at the time of writing this book are as follows:</p>
<p class="calibre1"> <i class="calibre4">Microsoft Dynamics Business Central Team Blog</i><a href="https://community.dynamics.com/business/b/financials">: https:/​/​community.​dynamics. </a></p>
<p class="calibre1"><a href="https://community.dynamics.com/business/b/financials">com/​business/​b/​financials</a></p>
<p class="calibre1"> <i class="calibre4">Mark Brummel Blog</i><a href="https://markbrummel.blog/2018/11/25/blogging-the-gap/">: https:/​/​markbrummel.​blog/​2018/​11/​25/​blogging-​the-</a></p>
<p class="calibre1"><a href="https://markbrummel.blog/2018/11/25/blogging-the-gap/">gap/</a>​</p>
<p class="calibre1"><a href="https://community.dynamics.com/nav/b/katsonsnavblog">Dmitry Katson blog: https:/​/​community.​dynamics.​com/​nav/​b/​katsonsnavblog</a></p>
<p class="calibre1"><a href="https://saurav-nav.blogspot.com/">Saurav Dhyany: https:/​/​saurav-​nav.​blogspot.​com/​</a></p>
<p class="calibre1"><a href="http://www.dynamicsnavconsultant.com/">Alex Chow: http:/​/​www.​dynamicsnavconsultant.​com/</a>​</p>
<p class="calibre1"><a href="http://vjeko.com/">Vjekoslav Babic’s Blog: http://vjeko.com/</a></p>
<p class="calibre1"><a href="https://www.dynamics.is/">Gunnar Gestsson: https:/​/​www.​dynamics.​is/​</a></p>
<p class="calibre1"><a href="https://dynamicsuser.net/nav/b/vanvugt">Luc van Vugt’s blog: https://dynamicsuser.net/nav/b/vanvugt</a></p>
<p class="calibre1">There are also a number of other useful blogs available. Look for them and review them regularly. The good ideas that are posted by the members of the Business Central community in their blogs, and on the Business Central forums, are generously shared freely, and often. </p>
<p class="calibre1">Finally, there are a number of books that focus on various aspects of Dynamics that are Business Central, all of which have been published by  <i class="calibre4">Packt Publishing</i><a href="https://www.packtpub.com/"> (www.packtpub.com). </a></p>
<p class="calibre1">Even the books about older versions of Business Central have a lot of good information about developing with the Business Central tools and applying Business Central’s functionality in a wide variety of application environments. </p>
<p class="calibre1"><b class="calibre3">[ 488 ]</b></p>
<p class="calibre1"><a id="calibre_link-311"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1"><b class="calibre3">Summary</b></p>
<p class="calibre1">We have covered many topics in this book, with the goal of helping you become productive in AL development with Dynamics Business Central. Hopefully, you’ve found your time spent with us to be a good investment. From this point on, your assignments are to continue exploring and learning, enjoy working with Business Central, Visual Studio Code, and AL, and to treat others as you would have them treat you. </p>
<p class="calibre1"> <i class="calibre4">“We live in a world in which we need to share responsibility. It’s easy to say “It’s not my</i> <i class="calibre4">child, not my community, not my world, not my problem.” There are those who see the</i> <i class="calibre4">need and respond. Those people are my heroes.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Fred Rogers</i></p>
<p class="calibre1"> <i class="calibre4">“Be kind whenever possible. It is always possible.” </i></p>
<p class="calibre1"> <i class="calibre4">&ndash; Dalai Lama</i></p>
<p class="calibre1"><b class="calibre3">Questions</b></p>
<p class="calibre1">1. Which one of the following provides access to several libraries of functions for various purposes that are widely used throughout the NAV system? Choose one:</p>
<p class="calibre1">Codeunit 412&mdash;Common Dialog Management</p>
<p class="calibre1">Codeunit 408&mdash;Dimension Management</p>
<p class="calibre1">Codeunit 396&mdash;NoSeriesManagement</p>
<p class="calibre1">Codeunit 1&mdash;Application Management</p>
<p class="calibre1">2. The Help files for Business Central cannot be customized by partner or ISV</p>
<p class="calibre1">developers. True or false? </p>
<p class="calibre1">3. Which of the following are good coding practices? Choose three:</p>
<p class="calibre1">Careful naming</p>
<p class="calibre1">Good documentation</p>
<p class="calibre1">Liberal use of wildcards</p>
<p class="calibre1">Design for ease of upgrading</p>
<p class="calibre1">4. Custom AL code is not allowed to call functions that exist in the base Microsoft that was created for Business Central objects. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 489 ]</b></p>
<p class="calibre1"><a id="calibre_link-510"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">5. Business Central’s multi-language capability allows an installation to have<br>multiple languages active at one time. True or false? </p>
<p class="calibre1">6. Designing to minimize disk I/O in Business Central is not important because SQL</p>
<p class="calibre1">Server takes care of everything. True or false? </p>
<p class="calibre1">7. Which of the following defines the Client add-in feature? Choose one:</p>
<p class="calibre1">The ability to add a new client of your own design to Business Central</p>
<p class="calibre1">A tool to provide for extending the user interface behavior</p>
<p class="calibre1">A special calculator feature for the client</p>
<p class="calibre1">A new method for mapping Customers to Contacts</p>
<p class="calibre1">8. When planning a new Business Central development project, it is good to focus on the design of the data structure, required data accesses, validation, and<br>maintenance. True or false? </p>
<p class="calibre1">9. The Navigate feature can be used for which of the following? Choose three:</p>
<p class="calibre1">Auditing by a professional accountant</p>
<p class="calibre1">User analysis of data processing</p>
<p class="calibre1">Reversing posting errors</p>
<p class="calibre1">Debugging</p>
<p class="calibre1">10. Business Central modifications should always be delivered to customers in the form of text files. True or false? </p>
<p class="calibre1">11. Both source code changes and setting debugger breaks can only be done in the AL Editor. True or false? </p>
<p class="calibre1">12. You can enhance the Navigate function to include new tables that have been<br>added to the system as part of an enhancement. True or false? </p>
<p class="calibre1">13. The C/Side Testing tools allow the implementation of regression tests. True or false? </p>
<p class="calibre1">14. Client Add-ins must be written in what language? Choose one:</p>
<p class="calibre1">C#</p>
<p class="calibre1">VB.NET</p>
<p class="calibre1">JavaScript</p>
<p class="calibre1">AL.NET</p>
<p class="calibre1"><b class="calibre3">[ 490 ]</b></p>
<p class="calibre1"><a id="calibre_link-511"></a> <i class="calibre4">Successful Conclusions</i></p>
<p class="calibre1"> <i class="calibre4">Chapter 9</i></p>
<p class="calibre1">15. The Business Central debugger allows the value of Watched Variables to be<br>changed in the middle of a debugging session. True or false? </p>
<p class="calibre1">16. The Business Central debugger runs as a separate session. True or false? </p>
<p class="calibre1">17. The C/Side Testing tools support which of the following? Choose four:</p>
<p class="calibre1">Positive testing</p>
<p class="calibre1">Negative testing</p>
<p class="calibre1">Automated testing</p>
<p class="calibre1">C# test viewing</p>
<p class="calibre1">TestIsolation (rollback) testing</p>
<p class="calibre1">18. Business Central includes a flexible multi-currency feature that allows<br>transactions to begin in one currency and conclude in a different currency. True or false? </p>
<p class="calibre1">19. Business Central does not support linked SQL Server databases. True or false? </p>
<p class="calibre1">20. Simple debugging can be done without the use of the debugger. True or false? </p>
<p class="calibre1"><b class="calibre3">[ 491 ]</b></p>
<p class="calibre1"><a id="calibre_link-312"></a>Assessments</p>
<p class="calibre1"><b class="calibre3">Chapter 1</b></p>
<p class="calibre1">1. Manufacturing, Order processing, Planning, and General accounting</p>
<p class="calibre1">2. Tablet client, Document emailing, and Mandatory fields</p>
<p class="calibre1">3. True</p>
<p class="calibre1">4. Journal&mdash;Transaction entries, Ledger&mdash;History, Register&mdash;Audit<br>trail, Document&mdash;Invoice, Posting&mdash;Validation process</p>
<p class="calibre1">5. True</p>
<p class="calibre1">6. Customizable and C# IDE</p>
<p class="calibre1">7. Table, Page, Report, Codeunit, Query, XMLport, and MenuSuite</p>
<p class="calibre1">8. False</p>
<p class="calibre1">9. True</p>
<p class="calibre1">10. Role Center</p>
<p class="calibre1">11. False</p>
<p class="calibre1">12. Report layout</p>
<p class="calibre1">13. False</p>
<p class="calibre1">14. True, but through use of a temporary table</p>
<p class="calibre1">15. True</p>
<p class="calibre1">16. 50,000 - 60,000 and 50,000 - 99,999</p>
<p class="calibre1">17. False</p>
<p class="calibre1">18. False</p>
<p class="calibre1">19. Reusable code and a proven way to solve a common problem</p>
<p class="calibre1">20. False</p>
<p class="calibre1"><a id="calibre_link-512"></a> <i class="calibre4">Assessments</i></p>
<p class="calibre1"><b class="calibre3">Chapter 2</b></p>
<p class="calibre1">1. A Business Central table is the definition of data structure and a Business Central table should implement many of the business rules of a system</p>
<p class="calibre1">2. False</p>
<p class="calibre1">3. LinkedObject</p>
<p class="calibre1">4. False</p>
<p class="calibre1">5. OnInsert and OnRename</p>
<p class="calibre1">6. False</p>
<p class="calibre1">7. False</p>
<p class="calibre1">8. False&mdash;50,000-99,999</p>
<p class="calibre1">9. Customer, User, and Item Ledger Entry</p>
<p class="calibre1">10. True</p>
<p class="calibre1">11. False</p>
<p class="calibre1">12. Date and Integer</p>
<p class="calibre1">13. True</p>
<p class="calibre1">14. Read, Delete, and Modify</p>
<p class="calibre1">15. True</p>
<p class="calibre1">16. False&mdash;except with a very advanced technical method</p>
<p class="calibre1">17. False</p>
<p class="calibre1">18. False</p>
<p class="calibre1">19. SQL indexed views</p>
<p class="calibre1">20. False</p>
<p class="calibre1"><b class="calibre3">Chapter 3</b></p>
<p class="calibre1">1. False</p>
<p class="calibre1">2. In the primary key in the related table</p>
<p class="calibre1">3. Normal&mdash;1</p>
<p class="calibre1">4. GPS location</p>
<p class="calibre1">5. Median</p>
<p class="calibre1">6. True</p>
<p class="calibre1"><b class="calibre3">[ 493 ]</b></p>
<p class="calibre1"><a id="calibre_link-513"></a> <i class="calibre4">Assessments</i></p>
<p class="calibre1">7. False</p>
<p class="calibre1">8. CaptionML</p>
<p class="calibre1">9. OnValidate and OnLookup</p>
<p class="calibre1">10. Records, DateFormula, and Objects</p>
<p class="calibre1">11. False</p>
<p class="calibre1">12. False and false</p>
<p class="calibre1">13. True</p>
<p class="calibre1">14. True</p>
<p class="calibre1">15. True</p>
<p class="calibre1">16. False</p>
<p class="calibre1">17.  <i class="calibre4">W</i> for week and  <i class="calibre4">CM</i> for current month</p>
<p class="calibre1">18. False</p>
<p class="calibre1">19. False</p>
<p class="calibre1">20. Decimal and option</p>
<p class="calibre1">21. Question mark (?) and Asterisk (*)</p>
<p class="calibre1"><b class="calibre3">Chapter 4</b></p>
<p class="calibre1">1. False</p>
<p class="calibre1">2. Ribbon and navigation pane</p>
<p class="calibre1">3. False</p>
<p class="calibre1">4. False</p>
<p class="calibre1">5. Chart part and system part</p>
<p class="calibre1">6. False</p>
<p class="calibre1">7. False</p>
<p class="calibre1">8. Departments and home</p>
<p class="calibre1">9. True</p>
<p class="calibre1">10. True</p>
<p class="calibre1">11. True</p>
<p class="calibre1">12. Can affect FastTab displays and applies to decimal fields only</p>
<p class="calibre1">13. False</p>
<p class="calibre1">14. Card, Document, and List</p>
<p class="calibre1"><b class="calibre3">[ 494 ]</b></p>
<p class="calibre1"><a id="calibre_link-514"></a> <i class="calibre4">Assessments</i></p>
<p class="calibre1">15. False</p>
<p class="calibre1">16. Visible, HideValue, Editable</p>
<p class="calibre1">17. DelayedInput</p>
<p class="calibre1">18. False</p>
<p class="calibre1">19. False</p>
<p class="calibre1">20. True</p>
<p class="calibre1"><b class="calibre3">Chapter 5</b></p>
<p class="calibre1">1. DataItems, Request Page, and Database updating</p>
<p class="calibre1">2. False</p>
<p class="calibre1">3. False</p>
<p class="calibre1">4. Indentation</p>
<p class="calibre1">5. False</p>
<p class="calibre1">6. False</p>
<p class="calibre1">7. True</p>
<p class="calibre1">8. TopNumberOfRows and OrderBy</p>
<p class="calibre1">9. False</p>
<p class="calibre1">10. False</p>
<p class="calibre1">11. List, Document, and Invoice</p>
<p class="calibre1">12. True</p>
<p class="calibre1">13. False</p>
<p class="calibre1">14. False</p>
<p class="calibre1">15. True</p>
<p class="calibre1">16. Charts and cues</p>
<p class="calibre1">17. False</p>
<p class="calibre1">18. Data Show/Hide and Sorting by columns</p>
<p class="calibre1">19. True</p>
<p class="calibre1">20. True</p>
<p class="calibre1"><b class="calibre3">[ 495 ]</b></p>
<p class="calibre1"><a id="calibre_link-515"></a> <i class="calibre4">Assessments</i></p>
<p class="calibre1"><b class="calibre3">Chapter 6</b></p>
<p class="calibre1">1. False</p>
<p class="calibre1">2. Page</p>
<p class="calibre1">3. True</p>
<p class="calibre1">4. Var</p>
<p class="calibre1">5. False</p>
<p class="calibre1">6. True</p>
<p class="calibre1">7. False</p>
<p class="calibre1">8. False</p>
<p class="calibre1">9. False</p>
<p class="calibre1">10. True</p>
<p class="calibre1">11. Application management and Mail</p>
<p class="calibre1">12. True</p>
<p class="calibre1">13. True</p>
<p class="calibre1">14. ?, *, and @</p>
<p class="calibre1">15. True</p>
<p class="calibre1">16. False</p>
<p class="calibre1">17. False</p>
<p class="calibre1">18. * and /</p>
<p class="calibre1"><b class="calibre3">Chapter 7</b></p>
<p class="calibre1">1. DATE2DWY, CALCDATE, and DMY2DATE</p>
<p class="calibre1">2. True</p>
<p class="calibre1">3. CALCFIELDS and SETAUTOCALCFIELDS</p>
<p class="calibre1">4. SKIP</p>
<p class="calibre1">5. True</p>
<p class="calibre1">6. False</p>
<p class="calibre1">7. False</p>
<p class="calibre1">8. DO-UNTIL</p>
<p class="calibre1">9. False</p>
<p class="calibre1">10. True</p>
<p class="calibre1">11. MODIFY(TRUE)</p>
<p class="calibre1"><b class="calibre3">[ 496 ]</b></p>
<p class="calibre1"><a id="calibre_link-516"></a> <i class="calibre4">Assessments</i></p>
<p class="calibre1">12. False</p>
<p class="calibre1">13. False</p>
<p class="calibre1">14. A decimal variable</p>
<p class="calibre1">15. False</p>
<p class="calibre1">16. True</p>
<p class="calibre1">17. Find applicable functions and use entries as a template for function syntax and arguments</p>
<p class="calibre1">18. False</p>
<p class="calibre1">19. False</p>
<p class="calibre1">20. True</p>
<p class="calibre1"><b class="calibre3">Chapter 8</b></p>
<p class="calibre1">1. False</p>
<p class="calibre1">2. MenuSuite objects</p>
<p class="calibre1">3. False</p>
<p class="calibre1">4. AL changes in the Action Designer, implementer/administrator configuration, </p>
<p class="calibre1">and user personalization</p>
<p class="calibre1">5. False</p>
<p class="calibre1">6. Report and new</p>
<p class="calibre1">7. True</p>
<p class="calibre1">8. Activity pane and cues</p>
<p class="calibre1">9. False</p>
<p class="calibre1">10. True</p>
<p class="calibre1">11. Queries and pages</p>
<p class="calibre1">12. True</p>
<p class="calibre1">13. False</p>
<p class="calibre1">14. True</p>
<p class="calibre1">15. False</p>
<p class="calibre1">16. True</p>
<p class="calibre1">17. False</p>
<p class="calibre1">18. Cues and page parts</p>
<p class="calibre1">19. False</p>
<p class="calibre1">20. False</p>
<p class="calibre1"><b class="calibre3">[ 497 ]</b></p>
<p class="calibre1"><a id="calibre_link-517"></a> <i class="calibre4">Assessments</i></p>
<p class="calibre1"><b class="calibre3">Chapter 9</b></p>
<p class="calibre1">1. Codeunit 1&mdash;Application Management</p>
<p class="calibre1">2. False</p>
<p class="calibre1">3. Careful naming, good documentation, and design for ease of upgrading</p>
<p class="calibre1">4. False</p>
<p class="calibre1">5. True</p>
<p class="calibre1">6. False</p>
<p class="calibre1">7. A tool to provide for extending the user interface behavior</p>
<p class="calibre1">8. True</p>
<p class="calibre1">9. Auditing by a professional accountant, user analysis of data processing, and<br>debugging</p>
<p class="calibre1">10. False</p>
<p class="calibre1">11. True</p>
<p class="calibre1">12. True</p>
<p class="calibre1">13. True</p>
<p class="calibre1">14. JavaScript</p>
<p class="calibre1">15. False</p>
<p class="calibre1">16. True</p>
<p class="calibre1">17. Positive testing, negative testing, automated testing, and TestIsolation (rollback) testing</p>
<p class="calibre1">18. True</p>
<p class="calibre1">19. False</p>
<p class="calibre1">20. True</p>
<p class="calibre1"><b class="calibre3">[ 498 ]</b></p>
<p class="calibre1"><a id="calibre_link-313"></a><img src="images/000368.jpg" alt="Image 451" class="calibre2" /></p>
<p class="calibre1">Other Books You May Enjoy</p>
<p class="calibre1">If you enjoyed this book, you may be interested in these other books by Packt:</p>
<p class="calibre1"><b class="calibre3">Implementing Microsoft Dynamics 365 Business Central On-Premise - Fourth</b></p>
<p class="calibre1"><b class="calibre3">Edition</b></p>
<p class="calibre1">Roberto Stefanetti, Alex Chow</p>
<p class="calibre1">ISBN: 978-1-78913-393-6</p>
<p class="calibre1">Explore new features introduced in Microsoft Dynamics NAV 2018</p>
<p class="calibre1">Learn abstract techniques for data analysis, reporting, and debugging</p>
<p class="calibre1">Install, configure, and use additional tools for business intelligence, document management, and reporting</p>
<p class="calibre1">Discover Dynamics 365 Business Central and several other Microsoft services</p>
<p class="calibre1">Utilize different tools to develop applications for Business CentralExplore new<br>features introduced in Microsoft Dynamics NAV 2018</p>
<p class="calibre1">Migrate to Microsoft Dynamics NAV 2018 from previous versions</p>
<p class="calibre1"><a id="calibre_link-518"></a><img src="images/000389.jpg" alt="Image 452" class="calibre2" /></p>
<p class="calibre1"> <i class="calibre4">Other Books You May Enjoy</i></p>
<p class="calibre1"><b class="calibre3">Dynamics 365 Business Central Development Quick Start Guide</b></p>
<p class="calibre1">Stefano Demiliani, Duilio Tacconi</p>
<p class="calibre1">ISBN: 978-1-78934-746-3</p>
<p class="calibre1">Develop solutions for Dynamics 365 Business Central</p>
<p class="calibre1">Create a sandbox for extensions development (local or on cloud)</p>
<p class="calibre1">Use Docker with Dynamics 365 Business Central</p>
<p class="calibre1">Create extensions for Dynamics 365 Business Central</p>
<p class="calibre1">Handle dependencies, translations and reporting</p>
<p class="calibre1">Deploy extensions on-premise and to the cloud</p>
<p class="calibre1">Create serverless processes with Dynamics 365 Business Central</p>
<p class="calibre1">Understand source code management for AL</p>
<p class="calibre1"><b class="calibre3">[ 500 ]</b></p>
<p class="calibre1"><a id="calibre_link-519"></a> <i class="calibre4">Other Books You May Enjoy</i></p>
<p class="calibre1"><b class="calibre3">Leave a review - let other readers know what</b></p>
<p class="calibre1"><b class="calibre3">you think</b></p>
<p class="calibre1">Please share your thoughts on this book with others by leaving a review on the site that you bought it from. If you purchased the book from Amazon, please leave us an honest review on this book’s Amazon page. This is vital so that other potential readers can see and use your unbiased opinion to make purchasing decisions, we can understand what our<br>customers think about our products, and our authors can see your feedback on the title that they have worked with Packt to create. It will only take a few minutes of your time, but is valuable to other potential customers, our authors, and Packt. Thank you! </p>
<p class="calibre1"><b class="calibre3">[ 501 ]</b></p>
<p class="calibre1"><a id="calibre_link-314"></a>Index</p>
<p class="calibre1"><b class="calibre3">A</b></p>
<p class="calibre1">simple table, designing  <a href="#calibre_link-21">37</a></p>
<p class="calibre1">arithmetic operators</p>
<p class="calibre1">Accounting Period Calendar  <a href="#calibre_link-315">446</a></p>
<p class="calibre1"><a href="#calibre_link-175">   about  302</a></p>
<p class="calibre1">action controls, Role Center page<br>procedures  <a href="#calibre_link-175">302</a></p>
<p class="calibre1"><a href="#calibre_link-253">   Action Designer  414</a>, <a href="#calibre_link-254">415</a></p>
<p class="calibre1">arrays  <a href="#calibre_link-316">290</a></p>
<p class="calibre1">WDTU Role Center ribbon, creating  <a href="#calibre_link-254">415</a></p>
<p class="calibre1"><a href="#calibre_link-4">Assemble to Order (ATO)  16</a></p>
<p class="calibre1">AL procedures</p>
<p class="calibre1"><a href="#calibre_link-172">assignment  298</a></p>
<p class="calibre1">about  <a href="#calibre_link-178">305, </a><a href="#calibre_link-179">306</a></p>
<p class="calibre1"><a href="#calibre_link-101">Assisted Setup  180</a></p>
<p class="calibre1"><a href="#calibre_link-181">   CONFIRM procedure  309</a></p>
<p class="calibre1"><a href="#calibre_link-180">   ERROR procedure  307</a></p>
<p class="calibre1"><b class="calibre3">B</b></p>
<p class="calibre1">FIND procedures  <a href="#calibre_link-186">315</a></p>
<p class="calibre1">BEGIN-END compound statement  <a href="#calibre_link-188">319</a></p>
<p class="calibre1"><a href="#calibre_link-179">   MESSAGE procedure  306</a></p>
<p class="calibre1"><a href="#calibre_link-69">Binary Large OBjects (BLOBs)  119</a><a href="#calibre_link-317">, 142</a></p>
<p class="calibre1">Record procedures  <a href="#calibre_link-183">312</a></p>
<p class="calibre1"><a href="#calibre_link-143">black-box report logic  251</a></p>
<p class="calibre1"><a href="#calibre_link-182">   STRMENU procedure  310</a></p>
<p class="calibre1">Boolean operators</p>
<p class="calibre1">AL programming language  <a href="#calibre_link-13">25, </a><a href="#calibre_link-318">26</a></p>
<p class="calibre1"><a href="#calibre_link-176">   about  303</a></p>
<p class="calibre1">AL programming<br>procedures  <a href="#calibre_link-176">303</a></p>
<p class="calibre1">about  <a href="#calibre_link-167">292</a></p>
<p class="calibre1">BREAK function  <a href="#calibre_link-222">365</a></p>
<p class="calibre1">custom procedures  <a href="#calibre_link-169">294</a></p>
<p class="calibre1">Business Central Client Add-in<br>modifiable procedures  <a href="#calibre_link-168">293</a></p>
<p class="calibre1"><a href="#calibre_link-292">   about  470</a></p>
<p class="calibre1">non-modifiable procedures  <a href="#calibre_link-168">293</a></p>
<p class="calibre1">comments  <a href="#calibre_link-293">471</a></p>
<p class="calibre1">AL routines</p>
<p class="calibre1">Business Central debugger</p>
<p class="calibre1"><a href="#calibre_link-272">   callable functions  445</a></p>
<p class="calibre1"><a href="#calibre_link-287">   about  463</a></p>
<p class="calibre1">creating  <a href="#calibre_link-271">444</a></p>
<p class="calibre1"><a href="#calibre_link-287">   activating  463</a></p>
<p class="calibre1"><a href="#calibre_link-278">   management codeunits  453</a></p>
<p class="calibre1"><a href="#calibre_link-288">   break events, creating  464</a></p>
<p class="calibre1">AL syntax</p>
<p class="calibre1"><a href="#calibre_link-289">   debugger window  465</a></p>
<p class="calibre1">about  <a href="#calibre_link-171">297</a></p>
<p class="calibre1">Business Central development projects<br>assignment  <a href="#calibre_link-172">298</a></p>
<p class="calibre1">data-focused design  <a href="#calibre_link-294">472</a></p>
<p class="calibre1"><a href="#calibre_link-188">   conditional statements  319</a></p>
<p class="calibre1">general guidance  <a href="#calibre_link-293">471</a></p>
<p class="calibre1">expressions  <a href="#calibre_link-173">299</a></p>
<p class="calibre1">knowledge  <a href="#calibre_link-294">472</a></p>
<p class="calibre1">indenting code  <a href="#calibre_link-189">320</a></p>
<p class="calibre1">supporting processes, designing  <a href="#calibre_link-297">475</a></p>
<p class="calibre1">punctuation  <a href="#calibre_link-172">298</a></p>
<p class="calibre1">verifying  <a href="#calibre_link-297">475</a></p>
<p class="calibre1">API reference</p>
<p class="calibre1">Business Central functional terminology<br>reference  <a href="#calibre_link-79">135</a></p>
<p class="calibre1"><a href="#calibre_link-15">   batch  30</a></p>
<p class="calibre1">Application Language (AL)  <a href="#calibre_link-8">20</a></p>
<p class="calibre1">document  <a href="#calibre_link-15">30</a></p>
<p class="calibre1">application tables<br>journal  <a href="#calibre_link-15">30</a></p>
<p class="calibre1">about  <a href="#calibre_link-20">36</a></p>
<p class="calibre1">ledger  <a href="#calibre_link-15">30</a></p>
<p class="calibre1"><a href="#calibre_link-22">   simple table, creating  38, </a><a href="#calibre_link-319">39</a>, <a href="#calibre_link-320">40</a></p>
<p class="calibre1">posting  <a href="#calibre_link-15">30</a></p>
<p class="calibre1"><a id="calibre_link-520"></a>   register  <a href="#calibre_link-15">30</a></p>
<p class="calibre1"><a href="#calibre_link-150">   report building, phase 1  262, </a><a href="#calibre_link-321">264, </a><a href="#calibre_link-151">265</a></p>
<p class="calibre1">Business Central object and system elements</p>
<p class="calibre1"><a href="#calibre_link-151">   report building, phase 2  265, </a><a href="#calibre_link-322">267, </a><a href="#calibre_link-152">268</a></p>
<p class="calibre1"><a href="#calibre_link-14">   control  27</a></p>
<p class="calibre1"><a href="#calibre_link-152">   report building, phase 3  268, </a><a href="#calibre_link-323">270, </a><a href="#calibre_link-153">271</a></p>
<p class="calibre1">events  <a href="#calibre_link-324">28</a></p>
<p class="calibre1"><a href="#calibre_link-154">   request page  272</a><a href="#calibre_link-325">, 273</a></p>
<p class="calibre1">field  <a href="#calibre_link-14">27</a></p>
<p class="calibre1">request page option, adding  <a href="#calibre_link-155">274</a>, <a href="#calibre_link-326">275, </a><a href="#calibre_link-327">276</a></p>
<p class="calibre1">field numbers  <a href="#calibre_link-324">28</a></p>
<p class="calibre1">Business Central report types<br>language extension  <a href="#calibre_link-14">27</a></p>
<p class="calibre1"><a href="#calibre_link-137">   about  242</a></p>
<p class="calibre1"><a href="#calibre_link-324">   object numbers  28</a></p>
<p class="calibre1">document  <a href="#calibre_link-328">243</a></p>
<p class="calibre1"><a href="#calibre_link-14">   procedures  27</a></p>
<p class="calibre1">list  <a href="#calibre_link-137">242</a></p>
<p class="calibre1">properties  <a href="#calibre_link-14">27</a></p>
<p class="calibre1">posting  <a href="#calibre_link-329">245</a></p>
<p class="calibre1"><a href="#calibre_link-14">   record  27</a></p>
<p class="calibre1">report naming  <a href="#calibre_link-139">247</a></p>
<p class="calibre1"><a href="#calibre_link-14">   trigger  27</a></p>
<p class="calibre1">summarizing  <a href="#calibre_link-138">246</a></p>
<p class="calibre1"><a href="#calibre_link-330">   work date  29</a></p>
<p class="calibre1"><a href="#calibre_link-329">   test  245</a></p>
<p class="calibre1">Business Central object types</p>
<p class="calibre1"><a href="#calibre_link-331">   transaction  244</a></p>
<p class="calibre1">about  <a href="#calibre_link-33">59</a></p>
<p class="calibre1">Business Central service management (SM)</p>
<p class="calibre1">codeunits  <a href="#calibre_link-8">20</a></p>
<p class="calibre1">functionality  <a href="#calibre_link-6">18</a></p>
<p class="calibre1">control add-in  <a href="#calibre_link-8">20, </a><a href="#calibre_link-36">62</a></p>
<p class="calibre1"><a href="#calibre_link-15">Business Central UI  30, </a><a href="#calibre_link-332">31</a></p>
<p class="calibre1">page  <a href="#calibre_link-8">20</a></p>
<p class="calibre1">Business Central web client</p>
<p class="calibre1"><a href="#calibre_link-7">   page customization  19</a></p>
<p class="calibre1">page structure  <a href="#calibre_link-93">168, </a><a href="#calibre_link-333">169, </a><a href="#calibre_link-334">170</a></p>
<p class="calibre1"><a href="#calibre_link-7">   page extension  19, </a><a href="#calibre_link-33">59</a></p>
<p class="calibre1"><a href="#calibre_link-283">Business Central’s debugger module  459</a></p>
<p class="calibre1">profile  <a href="#calibre_link-8">20</a></p>
<p class="calibre1">Business Central</p>
<p class="calibre1"><a href="#calibre_link-35">   queries  61</a></p>
<p class="calibre1"><a href="#calibre_link-3">   about  14</a></p>
<p class="calibre1">query  <a href="#calibre_link-8">20</a></p>
<p class="calibre1"><a href="#calibre_link-271">   AL routines, creating  444</a></p>
<p class="calibre1"><a href="#calibre_link-8">   report  20</a></p>
<p class="calibre1"><a href="#calibre_link-5">   business intelligence (BI)  17</a></p>
<p class="calibre1"><a href="#calibre_link-8">   table  20</a></p>
<p class="calibre1">complex data type  <a href="#calibre_link-69">119</a></p>
<p class="calibre1">table extension  <a href="#calibre_link-7">19, </a><a href="#calibre_link-33">59</a></p>
<p class="calibre1">components  <a href="#calibre_link-335">15</a></p>
<p class="calibre1">XMLports  <a href="#calibre_link-8">20, </a><a href="#calibre_link-35">61</a></p>
<p class="calibre1"><a href="#calibre_link-69">   constant  119</a></p>
<p class="calibre1">Business Central process flow</p>
<p class="calibre1"><a href="#calibre_link-69">   data element  119</a></p>
<p class="calibre1">about  <a href="#calibre_link-244">397</a></p>
<p class="calibre1">data types  <a href="#calibre_link-69">119</a></p>
<p class="calibre1"><a href="#calibre_link-247">   data maintenance  401</a></p>
<p class="calibre1"><a href="#calibre_link-283">   debugging  459</a></p>
<p class="calibre1"><a href="#calibre_link-245">   data preparation  399</a></p>
<p class="calibre1">defining  <a href="#calibre_link-69">119</a></p>
<p class="calibre1">data, utilizing  <a href="#calibre_link-246">400</a></p>
<p class="calibre1"><a href="#calibre_link-7">   developer’s overview  19</a></p>
<p class="calibre1">diagrammatic representation  <a href="#calibre_link-336">398</a></p>
<p class="calibre1">development  <a href="#calibre_link-16">32</a></p>
<p class="calibre1"><a href="#calibre_link-245">   initial setup  399</a></p>
<p class="calibre1">development backups  <a href="#calibre_link-36">62</a></p>
<p class="calibre1">Journal batch, posting  <a href="#calibre_link-246">400</a></p>
<p class="calibre1">documentation  <a href="#calibre_link-36">62</a></p>
<p class="calibre1"><a href="#calibre_link-245">   Journal batch, testing  399</a></p>
<p class="calibre1"><a href="#calibre_link-4">   financial management  16</a></p>
<p class="calibre1">transaction entry  <a href="#calibre_link-245">399</a></p>
<p class="calibre1">fundamental data type  <a href="#calibre_link-69">119</a></p>
<p class="calibre1">Business Central report designers  <a href="#calibre_link-136">240</a></p>
<p class="calibre1"><a href="#calibre_link-6">   human resource management  18</a></p>
<p class="calibre1">Business Central report development<br>interfaces  <a href="#calibre_link-291">469</a></p>
<p class="calibre1">about  <a href="#calibre_link-149">261</a></p>
<p class="calibre1">manufacturing  <a href="#calibre_link-4">16</a></p>
<p class="calibre1"><a href="#calibre_link-156">   creative report plagiarism  277</a></p>
<p class="calibre1"><a href="#calibre_link-7">   project management  19</a></p>
<p class="calibre1">existing report, modifying with Report Designer or<br>queries  <a href="#calibre_link-131">230</a></p>
<p class="calibre1"><a href="#calibre_link-153">Word  271</a></p>
<p class="calibre1">relationship management (RM)  <a href="#calibre_link-6">18</a></p>
<p class="calibre1">experimentation, using  <a href="#calibre_link-150">262</a></p>
<p class="calibre1">role tailored User Interface (UI)  <a href="#calibre_link-335">15</a></p>
<p class="calibre1"><a href="#calibre_link-156">   processing-only reports  277</a></p>
<p class="calibre1">supply chain management  <a href="#calibre_link-5">17</a></p>
<p class="calibre1"><b class="calibre3">[ 503 ]</b></p>
<p class="calibre1"><a id="calibre_link-521"></a><a href="#calibre_link-69">   variable  119</a></p>
<p class="calibre1">complex data types<br>web services  <a href="#calibre_link-264">429</a></p>
<p class="calibre1"><a href="#calibre_link-78">   about  134</a></p>
<p class="calibre1">business intelligence (BI)  <a href="#calibre_link-5">17</a></p>
<p class="calibre1">data structure  <a href="#calibre_link-78">134</a></p>
<p class="calibre1"><a href="#calibre_link-80">   DateFormula  </a></p>
<p class="calibre1"><b class="calibre3">C</b></p>
<p class="calibre1"><a href="#calibre_link-80">136, </a><a href="#calibre_link-337">139, </a><a href="#calibre_link-81">141</a></p>
<p class="calibre1"><a href="#calibre_link-79">   DotNet  135</a></p>
<p class="calibre1">C/AL Coding<br>input/output data types  <a href="#calibre_link-79">135</a></p>
<p class="calibre1">reference  <a href="#calibre_link-74">128</a></p>
<p class="calibre1"><a href="#calibre_link-79">   objects  135</a></p>
<p class="calibre1">CALCDATE function  <a href="#calibre_link-209">350</a></p>
<p class="calibre1"><a href="#calibre_link-81">   other data types  141</a></p>
<p class="calibre1">CALCFIELDS function</p>
<p class="calibre1"><a href="#calibre_link-81">   references  141</a></p>
<p class="calibre1">about  <a href="#calibre_link-214">356</a></p>
<p class="calibre1"><a href="#calibre_link-79">   web services  135</a></p>
<p class="calibre1"><a href="#calibre_link-216">   versus, CALCSUMS function  358</a></p>
<p class="calibre1">conditional statements</p>
<p class="calibre1">CALCSUMS function  <a href="#calibre_link-215">357</a></p>
<p class="calibre1"><a href="#calibre_link-188">   about  319</a></p>
<p class="calibre1">callable functions</p>
<p class="calibre1"><a href="#calibre_link-188">   BEGIN-END compound statement  319</a></p>
<p class="calibre1">about  <a href="#calibre_link-272">445</a></p>
<p class="calibre1">IF-THEN-ELSE statement  <a href="#calibre_link-188">319</a></p>
<p class="calibre1"><a href="#calibre_link-272">   Codeunit 358  445</a></p>
<p class="calibre1">CONFIRM procedure  <a href="#calibre_link-181">309</a></p>
<p class="calibre1"><a href="#calibre_link-273">   codeunit 359  447</a></p>
<p class="calibre1"><a href="#calibre_link-284">CONFIRM statement  460</a></p>
<p class="calibre1"><a href="#calibre_link-276">   codeunit 396  451</a></p>
<p class="calibre1">ConfirmationDialog page  <a href="#calibre_link-100">179</a></p>
<p class="calibre1">Format Address codeunit  <a href="#calibre_link-275">449</a></p>
<p class="calibre1">content modifiable table</p>
<p class="calibre1"><a href="#calibre_link-277">   function models, for reviewing  452</a></p>
<p class="calibre1"><a href="#calibre_link-65">   about  112</a></p>
<p class="calibre1"><a href="#calibre_link-277">   function models, using  452</a></p>
<p class="calibre1"><a href="#calibre_link-65">   system table type  112</a></p>
<p class="calibre1">card page</p>
<p class="calibre1">Coordinated Universal Time (UTC)  <a href="#calibre_link-338">133</a></p>
<p class="calibre1">about  <a href="#calibre_link-96">175, </a><a href="#calibre_link-106">185</a></p>
<p class="calibre1">COPYFILTER function  <a href="#calibre_link-229">372</a></p>
<p class="calibre1">creating  <a href="#calibre_link-28">49</a>, <a href="#calibre_link-29">50</a></p>
<p class="calibre1">COPYFILTERS function  <a href="#calibre_link-229">372</a></p>
<p class="calibre1"><a href="#calibre_link-219">CASE-ELSE statement  361, </a><a href="#calibre_link-339">362</a></p>
<p class="calibre1">Cronus database  <a href="#calibre_link-303">481</a></p>
<p class="calibre1"><a href="#calibre_link-34">chunks  60</a></p>
<p class="calibre1"><a href="#calibre_link-16">Cronus demo database  32</a></p>
<p class="calibre1">CLEARMARKS function  <a href="#calibre_link-231">374</a></p>
<p class="calibre1">CRONUS Demonstration Database  <a href="#calibre_link-292">470</a></p>
<p class="calibre1">Client Add-ins  <a href="#calibre_link-292">470</a></p>
<p class="calibre1"><a href="#calibre_link-127">CRONUS demonstration system  223</a></p>
<p class="calibre1"><a href="#calibre_link-292">Client Extensibility  470</a></p>
<p class="calibre1"><a href="#calibre_link-207">CURRENTDATETIME function  347</a></p>
<p class="calibre1">closing date  <a href="#calibre_link-77">132</a></p>
<p class="calibre1">custom procedures, AL</p>
<p class="calibre1">codeunit 359</p>
<p class="calibre1"><a href="#calibre_link-169">   about  294</a></p>
<p class="calibre1"><a href="#calibre_link-275">   CreatePeriodFormat function  449</a></p>
<p class="calibre1"><a href="#calibre_link-170">   creating  295, </a><a href="#calibre_link-171">297</a></p>
<p class="calibre1">FindDate function  <a href="#calibre_link-273">447, </a><a href="#calibre_link-274">448</a></p>
<p class="calibre1"><a href="#calibre_link-274">   NextDate function  </a></p>
<p class="calibre1"><b class="calibre3">D</b></p>
<p class="calibre1"><a href="#calibre_link-274">448</a></p>
<p class="calibre1">Period Form Management  <a href="#calibre_link-273">447</a></p>
<p class="calibre1">data conversion and formatting functions<br>codeunit 365  <a href="#calibre_link-275">449</a></p>
<p class="calibre1"><a href="#calibre_link-210">   about  351</a></p>
<p class="calibre1">codeunit 396</p>
<p class="calibre1">EVALUATE  <a href="#calibre_link-213">354</a></p>
<p class="calibre1"><a href="#calibre_link-276">   NoSeriesManagement  451</a></p>
<p class="calibre1"><a href="#calibre_link-212">   FORMAT  353</a></p>
<p class="calibre1">column properties</p>
<p class="calibre1">ROUND  <a href="#calibre_link-211">352</a></p>
<p class="calibre1">about  <a href="#calibre_link-134">238</a></p>
<p class="calibre1">data structure</p>
<p class="calibre1"><a href="#calibre_link-135">   ColumnFilter  239</a></p>
<p class="calibre1"><a href="#calibre_link-78">   about  134</a></p>
<p class="calibre1">Method  <a href="#calibre_link-134">238</a></p>
<p class="calibre1">file  <a href="#calibre_link-78">134</a></p>
<p class="calibre1"><a href="#calibre_link-134">   ReverseSign  238</a></p>
<p class="calibre1">record  <a href="#calibre_link-78">134</a></p>
<p class="calibre1"><a href="#calibre_link-35">comma-delimited files  61</a></p>
<p class="calibre1">data types</p>
<p class="calibre1"><a href="#calibre_link-35">comma-separated value  61</a></p>
<p class="calibre1"><a href="#calibre_link-75">   about  129</a></p>
<p class="calibre1"><a href="#calibre_link-141">Common Language Specification (CLS)  249</a></p>
<p class="calibre1">complex data types  <a href="#calibre_link-78">134</a></p>
<p class="calibre1"><b class="calibre3">[ 504 ]</b></p>
<p class="calibre1"><a id="calibre_link-522"></a><a href="#calibre_link-75">   fundamental data types  129</a></p>
<p class="calibre1"><a href="#calibre_link-16">   about  32</a></p>
<p class="calibre1">usage  <a href="#calibre_link-82">143</a></p>
<p class="calibre1"><a href="#calibre_link-17">   application design  33</a></p>
<p class="calibre1">data-focused design<br>application tables  <a href="#calibre_link-20">36</a></p>
<p class="calibre1">about  <a href="#calibre_link-294">472</a></p>
<p class="calibre1">card page, creating  <a href="#calibre_link-28">49</a></p>
<p class="calibre1"><a href="#calibre_link-295">   data tables, designing  473</a></p>
<p class="calibre1"><a href="#calibre_link-16">   exercise scenario  32</a></p>
<p class="calibre1"><a href="#calibre_link-296">   data validation, designing  474</a></p>
<p class="calibre1"><a href="#calibre_link-18">   folder structure  34</a></p>
<p class="calibre1"><a href="#calibre_link-294">   data views, defining  472</a></p>
<p class="calibre1"><a href="#calibre_link-27">   list page, creating  45</a></p>
<p class="calibre1">reviewing  <a href="#calibre_link-296">474</a></p>
<p class="calibre1"><a href="#calibre_link-30">   list report, creating  51</a></p>
<p class="calibre1"><a href="#calibre_link-296">   revision  474</a></p>
<p class="calibre1"><a href="#calibre_link-23">   pages  41</a></p>
<p class="calibre1">user data access interface, designing  <a href="#calibre_link-295">473</a></p>
<p class="calibre1"><a href="#calibre_link-29">   sample data, creating  50</a></p>
<p class="calibre1">data/time data<br>symbol files  <a href="#calibre_link-19">35</a></p>
<p class="calibre1"><a href="#calibre_link-77">   types  132</a></p>
<p class="calibre1">Dialog function debugging techniques</p>
<p class="calibre1">DataItem properties<br>debugging, with DIALOG  <a href="#calibre_link-285">461</a></p>
<p class="calibre1">about  <a href="#calibre_link-134">238</a></p>
<p class="calibre1"><a href="#calibre_link-286">   debugging, with ERROR  462</a></p>
<p class="calibre1"><a href="#calibre_link-134">   DataItemTableFilter  238</a></p>
<p class="calibre1"><a href="#calibre_link-284">   debugging, with MESSAGE and CONFIRM  460</a></p>
<p class="calibre1"><a href="#calibre_link-134">   SqlJoinType  238</a></p>
<p class="calibre1">debugging, with text output  <a href="#calibre_link-286">462</a></p>
<p class="calibre1">date and time functions<br>disk I/O  <a href="#calibre_link-298">476</a></p>
<p class="calibre1">about  <a href="#calibre_link-206">346</a></p>
<p class="calibre1">DMY2DATE function  <a href="#calibre_link-208">349</a></p>
<p class="calibre1">CALCDATE  <a href="#calibre_link-209">350</a></p>
<p class="calibre1">document page</p>
<p class="calibre1"><a href="#calibre_link-207">   CURRENTDATETIME  347</a></p>
<p class="calibre1"><a href="#calibre_link-96">   about  175</a></p>
<p class="calibre1"><a href="#calibre_link-208">   DATE2DMY function  349</a></p>
<p class="calibre1">FastTabs  <a href="#calibre_link-97">176</a></p>
<p class="calibre1">DATE2DWY function  <a href="#calibre_link-208">349</a></p>
<p class="calibre1"><a href="#calibre_link-209">DWY2DATE function  350</a></p>
<p class="calibre1"><a href="#calibre_link-208">   DMY2DATE  349</a></p>
<p class="calibre1">Dynamics Business Central</p>
<p class="calibre1">DWY2DATE  <a href="#calibre_link-209">350</a></p>
<p class="calibre1">events, reference  <a href="#calibre_link-72">126</a></p>
<p class="calibre1"><a href="#calibre_link-206">   TIME  346</a></p>
<p class="calibre1"><a href="#calibre_link-126">   reference  222</a></p>
<p class="calibre1"><a href="#calibre_link-206">   TODAY  346</a></p>
<p class="calibre1">WORKDATE  <a href="#calibre_link-207">347</a>, <a href="#calibre_link-340">348</a></p>
<p class="calibre1"><b class="calibre3">E</b></p>
<p class="calibre1">date constant  <a href="#calibre_link-77">132</a></p>
<p class="calibre1">efficient solution</p>
<p class="calibre1"><a href="#calibre_link-208">DATE2DMY function  349</a></p>
<p class="calibre1"><a href="#calibre_link-298">   designing  476</a></p>
<p class="calibre1">DATE2DWY function  <a href="#calibre_link-208">349</a></p>
<p class="calibre1"><a href="#calibre_link-298">   disk I/O  476</a></p>
<p class="calibre1">debugging, in Business Central</p>
<p class="calibre1"><a href="#calibre_link-299">   locking  477</a></p>
<p class="calibre1">about  <a href="#calibre_link-283">459</a></p>
<p class="calibre1"><a href="#calibre_link-59">entry table type  102</a></p>
<p class="calibre1">Dialog function debugging techniques  <a href="#calibre_link-284">460</a></p>
<p class="calibre1">ERP system</p>
<p class="calibre1">Developer and IT-pro</p>
<p class="calibre1"><a href="#calibre_link-2">   about  13</a></p>
<p class="calibre1">reference link  <a href="#calibre_link-341">122</a></p>
<p class="calibre1"><a href="#calibre_link-3">   Business Central  14</a></p>
<p class="calibre1">developer’s overview, Business Central</p>
<p class="calibre1">ERROR function  <a href="#calibre_link-286">462</a></p>
<p class="calibre1">AL programming language  <a href="#calibre_link-13">25</a></p>
<p class="calibre1"><a href="#calibre_link-180">ERROR procedure  307</a></p>
<p class="calibre1"><a href="#calibre_link-15">   Business Central UI  30</a></p>
<p class="calibre1">EVALUATE function  <a href="#calibre_link-213">354</a></p>
<p class="calibre1"><a href="#calibre_link-15">   functional terminology  30</a></p>
<p class="calibre1"><a href="#calibre_link-177">Evaluation column  304</a></p>
<p class="calibre1"><a href="#calibre_link-14">   object and system elements  27</a></p>
<p class="calibre1"><a href="#calibre_link-222">EXIT function  365</a></p>
<p class="calibre1">object types  <a href="#calibre_link-7">19</a></p>
<p class="calibre1">EXPLORER</p>
<p class="calibre1">Visual Studio Code icons  <a href="#calibre_link-9">21</a></p>
<p class="calibre1"><a href="#calibre_link-160">   about  282</a></p>
<p class="calibre1">Visual Studio Code integrated development</p>
<p class="calibre1">AL naming conventions  <a href="#calibre_link-163">286</a></p>
<p class="calibre1"><a href="#calibre_link-8">environment  20</a></p>
<p class="calibre1"><a href="#calibre_link-162">   object designer navigation  285</a></p>
<p class="calibre1">development, Business Central<br>object, creating  <a href="#calibre_link-161">284</a>, <a href="#calibre_link-162">285</a></p>
<p class="calibre1"><b class="calibre3">[ 505 ]</b></p>
<p class="calibre1"><a id="calibre_link-523"></a>   variables  <a href="#calibre_link-164">287</a></p>
<p class="calibre1"><a href="#calibre_link-86">   about  153</a></p>
<p class="calibre1">expressions<br>experimenting with  <a href="#calibre_link-87">154</a>, <a href="#calibre_link-342">157</a>, <a href="#calibre_link-343">159, </a><a href="#calibre_link-344">160</a></p>
<p class="calibre1">about  <a href="#calibre_link-173">299</a></p>
<p class="calibre1">FIND procedures<br>operators  <a href="#calibre_link-174">300</a></p>
<p class="calibre1">[Which] parameter  <a href="#calibre_link-187">316</a></p>
<p class="calibre1"><a href="#calibre_link-186">   about  </a></p>
<p class="calibre1"><b class="calibre3">F</b></p>
<p class="calibre1"><a href="#calibre_link-186">315</a></p>
<p class="calibre1">SQL Server alternatives  <a href="#calibre_link-345">317</a></p>
<p class="calibre1">FactBox area<br>flow control</p>
<p class="calibre1"><a href="#calibre_link-104">   Card Parts  183, </a><a href="#calibre_link-105">184</a></p>
<p class="calibre1"><a href="#calibre_link-217">   about  359</a></p>
<p class="calibre1"><a href="#calibre_link-104">   List Parts  183</a>, <a href="#calibre_link-105">184</a></p>
<p class="calibre1"><a href="#calibre_link-222">   BREAK function  365</a></p>
<p class="calibre1">factory default options  <a href="#calibre_link-299">477</a></p>
<p class="calibre1"><a href="#calibre_link-219">   CASE-ELSE statement  361</a></p>
<p class="calibre1">field controls</p>
<p class="calibre1"><a href="#calibre_link-222">   EXIT function  365</a></p>
<p class="calibre1">properties  <a href="#calibre_link-117">207</a></p>
<p class="calibre1">FOR-DOWNTO  <a href="#calibre_link-218">360</a></p>
<p class="calibre1">field groups</p>
<p class="calibre1"><a href="#calibre_link-218">   FOR-TO  360</a></p>
<p class="calibre1">about  <a href="#calibre_link-46">79</a></p>
<p class="calibre1">QUIT function  <a href="#calibre_link-221">364</a></p>
<p class="calibre1"><a href="#calibre_link-47">   bricks  81</a></p>
<p class="calibre1">REPEAT-UNTIL  <a href="#calibre_link-217">359</a></p>
<p class="calibre1">field</p>
<p class="calibre1"><a href="#calibre_link-222">   SKIP function  365</a></p>
<p class="calibre1">about  <a href="#calibre_link-69">119</a></p>
<p class="calibre1">WHILE-DO  <a href="#calibre_link-218">360</a></p>
<p class="calibre1">data structure, examples  <a href="#calibre_link-72">126</a></p>
<p class="calibre1">WITH-DO statement  <a href="#calibre_link-220">363</a></p>
<p class="calibre1">events  <a href="#calibre_link-72">126</a></p>
<p class="calibre1">FlowField and SumIndexField functions</p>
<p class="calibre1"><a href="#calibre_link-74">   naming  128</a></p>
<p class="calibre1"><a href="#calibre_link-213">   about  354</a></p>
<p class="calibre1">numbering  <a href="#calibre_link-73">127</a></p>
<p class="calibre1">CALCFIELDS function  <a href="#calibre_link-214">356</a></p>
<p class="calibre1">properties  <a href="#calibre_link-70">120</a>, <a href="#calibre_link-341">122, </a><a href="#calibre_link-346">124</a></p>
<p class="calibre1"><a href="#calibre_link-215">   CALCSUMS function  357</a></p>
<p class="calibre1">triggers  <a href="#calibre_link-71">125</a></p>
<p class="calibre1"><a href="#calibre_link-215">   SETAUTOCALCFIELDS function  357</a></p>
<p class="calibre1">FieldClass property options</p>
<p class="calibre1">FlowFields  <a href="#calibre_link-103">182</a></p>
<p class="calibre1">about  <a href="#calibre_link-83">145</a></p>
<p class="calibre1">folder structure, Business Central</p>
<p class="calibre1">FlowField  <a href="#calibre_link-83">145, </a><a href="#calibre_link-347">146, </a><a href="#calibre_link-84">148</a>, <a href="#calibre_link-85">150</a>, <a href="#calibre_link-348">152</a></p>
<p class="calibre1"><a href="#calibre_link-18">   about  34</a></p>
<p class="calibre1"><a href="#calibre_link-84">   FlowFilter  148, </a><a href="#calibre_link-85">150</a>, <a href="#calibre_link-348">152</a></p>
<p class="calibre1"><a href="#calibre_link-19">   app.json  35</a></p>
<p class="calibre1"><a href="#calibre_link-83">   normal  145</a></p>
<p class="calibre1">launch.json  <a href="#calibre_link-18">34</a></p>
<p class="calibre1">FIELDERROR function  <a href="#calibre_link-204">343, </a><a href="#calibre_link-349">344</a></p>
<p class="calibre1">FOR-DOWNTO control  <a href="#calibre_link-219">361</a></p>
<p class="calibre1">filter controls</p>
<p class="calibre1"><a href="#calibre_link-218">FOR-TO control  360</a></p>
<p class="calibre1">accessing  <a href="#calibre_link-88">161</a>, <a href="#calibre_link-89">162</a></p>
<p class="calibre1"><a href="#calibre_link-212">FORMAT function  353</a></p>
<p class="calibre1">FILTERGROUP function  <a href="#calibre_link-230">373</a></p>
<p class="calibre1">fully modifiable table<br>filtering</p>
<p class="calibre1"><a href="#calibre_link-56">   about  99</a></p>
<p class="calibre1">about  <a href="#calibre_link-227">370</a></p>
<p class="calibre1">entry table type  <a href="#calibre_link-59">102</a></p>
<p class="calibre1">CLEARMARKS function  <a href="#calibre_link-231">374</a></p>
<p class="calibre1"><a href="#calibre_link-57">   journal table type  100</a></p>
<p class="calibre1">COPYFILTER function  <a href="#calibre_link-229">372</a></p>
<p class="calibre1">master data table type  <a href="#calibre_link-56">99</a></p>
<p class="calibre1">COPYFILTERS function  <a href="#calibre_link-229">372</a></p>
<p class="calibre1">posted document  <a href="#calibre_link-62">109</a></p>
<p class="calibre1">FILTERGROUP function  <a href="#calibre_link-230">373</a></p>
<p class="calibre1">register table type  <a href="#calibre_link-61">107</a></p>
<p class="calibre1"><a href="#calibre_link-229">   GETFILTER function  372</a></p>
<p class="calibre1">singleton table type  <a href="#calibre_link-63">110</a></p>
<p class="calibre1"><a href="#calibre_link-229">   GETFILTERS function  372</a></p>
<p class="calibre1"><a href="#calibre_link-60">   subsidiary table type  105, </a><a href="#calibre_link-61">107</a></p>
<p class="calibre1">MARK function  <a href="#calibre_link-231">374</a></p>
<p class="calibre1"><a href="#calibre_link-58">   template table type  101</a></p>
<p class="calibre1"><a href="#calibre_link-231">   MARKEDONLY function  374</a></p>
<p class="calibre1"><a href="#calibre_link-64">   temporary table type  111</a></p>
<p class="calibre1">RESET function  <a href="#calibre_link-232">375</a></p>
<p class="calibre1">fundamental data types</p>
<p class="calibre1">SETFILTER function  <a href="#calibre_link-228">371</a></p>
<p class="calibre1"><a href="#calibre_link-75">   about  129</a></p>
<p class="calibre1">filters<br>date/time data  <a href="#calibre_link-77">132</a></p>
<p class="calibre1"><b class="calibre3">[ 506 ]</b></p>
<p class="calibre1"><a id="calibre_link-524"></a>   numeric data  <a href="#calibre_link-75">129</a></p>
<p class="calibre1">journal table type  <a href="#calibre_link-57">100</a></p>
<p class="calibre1">string data  <a href="#calibre_link-76">131</a></p>
<p class="calibre1"><b class="calibre3">K</b></p>
<p class="calibre1"><b class="calibre3">G</b></p>
<p class="calibre1">Key Performance Indicators (KPIs)  <a href="#calibre_link-95">173</a></p>
<p class="calibre1">GET procedure  <a href="#calibre_link-185">314</a></p>
<p class="calibre1">GETFILTER function  <a href="#calibre_link-229">372</a></p>
<p class="calibre1"><b class="calibre3">L</b></p>
<p class="calibre1">GETFILTERS function  <a href="#calibre_link-229">372</a></p>
<p class="calibre1"><a href="#calibre_link-95">languages  173</a></p>
<p class="calibre1">Git  <a href="#calibre_link-302">480</a></p>
<p class="calibre1"><a href="#calibre_link-59">ledger entry  102</a></p>
<p class="calibre1">Globally Unique Identifier (GUID)  <a href="#calibre_link-82">143</a></p>
<p class="calibre1">list page</p>
<p class="calibre1"><a href="#calibre_link-206">GMT (Greenwich Mean Time)  346</a></p>
<p class="calibre1"><a href="#calibre_link-95">   about  173</a></p>
<p class="calibre1"><b class="calibre3">H</b></p>
<p class="calibre1"><a href="#calibre_link-27">   creating  45, </a><a href="#calibre_link-350">46</a>, <a href="#calibre_link-351">47</a>, <a href="#calibre_link-352">48</a></p>
<p class="calibre1">List Plus page  <a href="#calibre_link-98">177</a></p>
<p class="calibre1"><a href="#calibre_link-95">HeadlinePart page  173</a></p>
<p class="calibre1">list report</p>
<p class="calibre1"><a href="#calibre_link-30">   creating  </a></p>
<p class="calibre1"><b class="calibre3">I</b></p>
<p class="calibre1"><a href="#calibre_link-30">51, </a><a href="#calibre_link-353">52</a>, <a href="#calibre_link-31">53</a></p>
<p class="calibre1">layout, designing  <a href="#calibre_link-32">56, </a><a href="#calibre_link-354">57, </a><a href="#calibre_link-355">58</a>, <a href="#calibre_link-33">59</a></p>
<p class="calibre1">IF-THEN-ELSE statement  <a href="#calibre_link-188">319</a></p>
<p class="calibre1">layout, generating  <a href="#calibre_link-31">53, </a><a href="#calibre_link-356">54, </a><a href="#calibre_link-357">55</a></p>
<p class="calibre1">in-client designer</p>
<p class="calibre1"><a href="#calibre_link-280">local currency  455</a></p>
<p class="calibre1">about  <a href="#calibre_link-107">186</a></p>
<p class="calibre1">Local Currency (LCY)  <a href="#calibre_link-358">149</a></p>
<p class="calibre1"><a href="#calibre_link-108">   design mode  187</a>, <a href="#calibre_link-359">189</a>, <a href="#calibre_link-109">190</a></p>
<p class="calibre1"><a href="#calibre_link-299">locking  477</a></p>
<p class="calibre1"><a href="#calibre_link-324">Independent Software Vendor (ISV)  28, </a><a href="#calibre_link-41">69</a>, <a href="#calibre_link-91">166</a></p>
<p class="calibre1"><a href="#calibre_link-205">INIT function  </a></p>
<p class="calibre1"><b class="calibre3">M</b></p>
<p class="calibre1"><a href="#calibre_link-205">345</a></p>
<p class="calibre1">input and output functions</p>
<p class="calibre1"><a href="#calibre_link-4">Make to Order (MTO)  16</a></p>
<p class="calibre1">about  <a href="#calibre_link-223">366</a></p>
<p class="calibre1">Make to Stock (MTS)  <a href="#calibre_link-4">16</a></p>
<p class="calibre1"><a href="#calibre_link-225">   DELETE function  368</a></p>
<p class="calibre1"><a href="#calibre_link-278">Management codeunits  453</a></p>
<p class="calibre1"><a href="#calibre_link-227">   DELETEALL function  370</a></p>
<p class="calibre1"><a href="#calibre_link-231">MARK function  374</a></p>
<p class="calibre1"><a href="#calibre_link-224">   INSERT function  367</a></p>
<p class="calibre1">MARKEDONLY function  <a href="#calibre_link-231">374</a></p>
<p class="calibre1"><a href="#calibre_link-225">   MODIFY function  368</a></p>
<p class="calibre1">master data table type  <a href="#calibre_link-56">99</a></p>
<p class="calibre1"><a href="#calibre_link-226">   MODIFYALL function  369</a></p>
<p class="calibre1"><a href="#calibre_link-179">MESSAGE procedure  306</a></p>
<p class="calibre1">NEXT function  <a href="#calibre_link-223">366</a></p>
<p class="calibre1">MESSAGE statement  <a href="#calibre_link-284">460</a></p>
<p class="calibre1"><a href="#calibre_link-224">INSERT function  367</a></p>
<p class="calibre1">Microsoft Dynamics 365 Business Central  <a href="#calibre_link-270">443</a></p>
<p class="calibre1"><a href="#calibre_link-160">Integrated Development Environment (IDE)  282</a></p>
<p class="calibre1">modifiable procedures, AL</p>
<p class="calibre1">IntelliSense</p>
<p class="calibre1"><a href="#calibre_link-168">   about  293</a></p>
<p class="calibre1">about  <a href="#calibre_link-200">338</a></p>
<p class="calibre1"><a href="#calibre_link-168">   examples  293</a></p>
<p class="calibre1"><a href="#calibre_link-201">   uses  339</a></p>
<p class="calibre1">MODIFY function</p>
<p class="calibre1"><a href="#calibre_link-201">internal documentation  339</a>, <a href="#calibre_link-202">341</a></p>
<p class="calibre1"><a href="#calibre_link-225">   about  368</a></p>
<p class="calibre1">InterObject communication</p>
<p class="calibre1">Rec and xRec variables  <a href="#calibre_link-225">368</a></p>
<p class="calibre1">about  <a href="#calibre_link-232">375</a></p>
<p class="calibre1"><a href="#calibre_link-280">multi-currency system  455</a></p>
<p class="calibre1">communicating, through data  <a href="#calibre_link-232">375</a></p>
<p class="calibre1">multi-language system<br>communicating, through function parameters </p>
<p class="calibre1"><a href="#calibre_link-279">   about  454</a></p>
<p class="calibre1"><a href="#calibre_link-233">376</a></p>
<p class="calibre1"><a href="#calibre_link-279">   features  454</a></p>
<p class="calibre1">communication, via object calls  <a href="#calibre_link-233">376</a></p>
<p class="calibre1"><b class="calibre3">N</b></p>
<p class="calibre1"><b class="calibre3">J</b></p>
<p class="calibre1">NAV Design Patterns Repository</p>
<p class="calibre1">Journal entry  <a href="#calibre_link-106">185</a></p>
<p class="calibre1"><a href="#calibre_link-271">   reference link  444</a></p>
<p class="calibre1"><b class="calibre3">[ 507 ]</b></p>
<p class="calibre1"><a id="calibre_link-525"></a>NAV development projects</p>
<p class="calibre1"><a href="#calibre_link-110">   page triggers  191</a></p>
<p class="calibre1"><a href="#calibre_link-297">   Posting processes, designing  475</a></p>
<p class="calibre1">page controls</p>
<p class="calibre1">NAV RTC  <a href="#calibre_link-293">471</a></p>
<p class="calibre1"><a href="#calibre_link-114">   about  199</a>, <a href="#calibre_link-360">200</a></p>
<p class="calibre1">navigate page</p>
<p class="calibre1"><a href="#calibre_link-120">   bound pages  212</a></p>
<p class="calibre1">about  <a href="#calibre_link-101">180</a></p>
<p class="calibre1">types  <a href="#calibre_link-115">201</a></p>
<p class="calibre1"><a href="#calibre_link-102">   function  181</a></p>
<p class="calibre1"><a href="#calibre_link-120">   unbound pages  212</a></p>
<p class="calibre1">request page  <a href="#calibre_link-103">182</a></p>
<p class="calibre1">page design</p>
<p class="calibre1">Navigate</p>
<p class="calibre1"><a href="#calibre_link-92">   about  167</a></p>
<p class="calibre1">about  <a href="#calibre_link-281">456, </a><a href="#calibre_link-361">457</a></p>
<p class="calibre1"><a href="#calibre_link-94">   Business Central page structure  171</a></p>
<p class="calibre1"><a href="#calibre_link-282">   modifying for  458</a></p>
<p class="calibre1"><a href="#calibre_link-92">   guidelines  167</a></p>
<p class="calibre1"><a href="#calibre_link-165">Navision  288</a></p>
<p class="calibre1">page extension</p>
<p class="calibre1"><a href="#calibre_link-362">negative testing  468</a></p>
<p class="calibre1"><a href="#calibre_link-34">   codeunits  60</a></p>
<p class="calibre1">NEXT function  <a href="#calibre_link-223">366</a></p>
<p class="calibre1">page parts, Role Center page<br>non-modifiable procedures, AL</p>
<p class="calibre1"><a href="#calibre_link-250">   about  409</a></p>
<p class="calibre1">about  <a href="#calibre_link-168">293</a></p>
<p class="calibre1">page parts not visible  <a href="#calibre_link-251">411</a></p>
<p class="calibre1">examples  <a href="#calibre_link-168">293</a></p>
<p class="calibre1"><a href="#calibre_link-251">   page parts, for user data  411</a></p>
<p class="calibre1">numeric data<br>page parts</p>
<p class="calibre1"><a href="#calibre_link-363">   types  130</a></p>
<p class="calibre1"><a href="#calibre_link-103">   about  182</a></p>
<p class="calibre1">FactBox area  </p>
<p class="calibre1"><b class="calibre3">O</b></p>
<p class="calibre1"><a href="#calibre_link-104">183</a></p>
<p class="calibre1">page structure<br>operators<br>overview  <a href="#calibre_link-92">167</a></p>
<p class="calibre1">about  <a href="#calibre_link-174">300</a></p>
<p class="calibre1">pages learning</p>
<p class="calibre1"><a href="#calibre_link-175">   arithmetic operators  302</a></p>
<p class="calibre1"><a href="#calibre_link-126">   about  222</a></p>
<p class="calibre1"><a href="#calibre_link-176">   Boolean operators  303</a></p>
<p class="calibre1">creative plagiarism  <a href="#calibre_link-126">222</a>, <a href="#calibre_link-127">223</a></p>
<p class="calibre1">brackets  <a href="#calibre_link-364">301</a></p>
<p class="calibre1"><a href="#calibre_link-128">   experimentation  224, </a><a href="#calibre_link-365">225</a></p>
<p class="calibre1"><a href="#calibre_link-364">   parentheses  301</a></p>
<p class="calibre1"><a href="#calibre_link-127">   experimenting  223</a></p>
<p class="calibre1"><a href="#calibre_link-177">   precedence  304</a></p>
<p class="calibre1"><a href="#calibre_link-126">   patterns plagiarism  222, </a><a href="#calibre_link-127">223</a></p>
<p class="calibre1"><a href="#calibre_link-175">   range operator  302</a></p>
<p class="calibre1">pages, types</p>
<p class="calibre1"><a href="#calibre_link-176">   relational operators  303</a></p>
<p class="calibre1"><a href="#calibre_link-96">   card page  175</a></p>
<p class="calibre1">scope operator  <a href="#calibre_link-364">301</a></p>
<p class="calibre1"><a href="#calibre_link-105">   charts  184</a></p>
<p class="calibre1"><a href="#calibre_link-364">   symbols  301</a></p>
<p class="calibre1">ConfirmationDialog page  <a href="#calibre_link-100">179</a></p>
<p class="calibre1"><a href="#calibre_link-96">   document page  175</a></p>
<p class="calibre1"><b class="calibre3">P</b></p>
<p class="calibre1"><a href="#calibre_link-95">   HeadlinePart page  173</a></p>
<p class="calibre1">list page  </p>
<p class="calibre1">page actions</p>
<p class="calibre1"><a href="#calibre_link-95">173</a></p>
<p class="calibre1"><a href="#calibre_link-98">   List Plus page  </a></p>
<p class="calibre1">about  </p>
<p class="calibre1"><a href="#calibre_link-98">177</a></p>
<p class="calibre1"><a href="#calibre_link-121">214, </a><a href="#calibre_link-366">215, </a><a href="#calibre_link-367">216</a></p>
<p class="calibre1"><a href="#calibre_link-101">   navigate page  </a></p>
<p class="calibre1">action groups  </p>
<p class="calibre1"><a href="#calibre_link-101">180</a></p>
<p class="calibre1"><a href="#calibre_link-123">218</a>, <a href="#calibre_link-368">219, </a><a href="#calibre_link-124">220</a></p>
<p class="calibre1">page names  </p>
<p class="calibre1">navigation pane button actions  </p>
<p class="calibre1"><a href="#calibre_link-106">185, </a><a href="#calibre_link-107">186</a></p>
<p class="calibre1"><a href="#calibre_link-124">220</a></p>
<p class="calibre1"><a href="#calibre_link-103">   page parts  </a></p>
<p class="calibre1">properties  </p>
<p class="calibre1"><a href="#calibre_link-103">182</a></p>
<p class="calibre1"><a href="#calibre_link-368">219</a></p>
<p class="calibre1"><a href="#calibre_link-94">   Role Center page  </a></p>
<p class="calibre1">subtypes  </p>
<p class="calibre1"><a href="#calibre_link-94">171</a></p>
<p class="calibre1"><a href="#calibre_link-122">217</a></p>
<p class="calibre1"><a href="#calibre_link-100">   StandardDialog page  </a></p>
<p class="calibre1"><a href="#calibre_link-125">   summary  </a></p>
<p class="calibre1"><a href="#calibre_link-100">179</a></p>
<p class="calibre1"><a href="#calibre_link-125">221</a></p>
<p class="calibre1">worksheet (journal) page  </p>
<p class="calibre1"><a href="#calibre_link-122">   types  </a></p>
<p class="calibre1"><a href="#calibre_link-99">178</a></p>
<p class="calibre1"><a href="#calibre_link-122">217</a></p>
<p class="calibre1">pages<br>page components</p>
<p class="calibre1"><a href="#calibre_link-23">   about  </a></p>
<p class="calibre1">about  </p>
<p class="calibre1"><a href="#calibre_link-23">41</a></p>
<p class="calibre1"><a href="#calibre_link-109">190</a></p>
<p class="calibre1"><a href="#calibre_link-24">   card pages  </a></p>
<p class="calibre1">inheritance  </p>
<p class="calibre1"><a href="#calibre_link-24">42</a>, <a href="#calibre_link-25">43</a></p>
<p class="calibre1"><a href="#calibre_link-112">194</a></p>
<p class="calibre1"><a href="#calibre_link-25">   document pages  </a></p>
<p class="calibre1">page properties  </p>
<p class="calibre1"><a href="#calibre_link-25">43</a>, <a href="#calibre_link-26">44</a></p>
<p class="calibre1"><a href="#calibre_link-111">192, </a><a href="#calibre_link-112">194</a></p>
<p class="calibre1"><b class="calibre3">[ 508 ]</b></p>
<p class="calibre1"><a id="calibre_link-526"></a><a href="#calibre_link-26">   journal and worksheet pages  44</a></p>
<p class="calibre1">regression testing  <a href="#calibre_link-369">467</a></p>
<p class="calibre1">list pages  <a href="#calibre_link-24">42</a></p>
<p class="calibre1">relational operators<br>standard elements  <a href="#calibre_link-23">41</a></p>
<p class="calibre1"><a href="#calibre_link-176">   about  303</a></p>
<p class="calibre1"><a href="#calibre_link-94">   types  171</a></p>
<p class="calibre1">procedures  <a href="#calibre_link-176">303</a></p>
<p class="calibre1">positive testing  <a href="#calibre_link-362">468</a></p>
<p class="calibre1"><a href="#calibre_link-6">relationship management (RM)  18</a></p>
<p class="calibre1"><a href="#calibre_link-95">postcodes  173</a></p>
<p class="calibre1">REPEAT-UNTIL  <a href="#calibre_link-217">359</a></p>
<p class="calibre1">posting processes<br>report data flow<br>designing  <a href="#calibre_link-297">475</a></p>
<p class="calibre1"><a href="#calibre_link-143">   about  251</a>, <a href="#calibre_link-370">253</a></p>
<p class="calibre1"><a href="#calibre_link-177">precedence hierarchy  304</a></p>
<p class="calibre1">DataItem properties  <a href="#calibre_link-148">259</a></p>
<p class="calibre1">public service announcements (PSAs)  <a href="#calibre_link-17">33</a></p>
<p class="calibre1">DataItem triggers  <a href="#calibre_link-149">261</a></p>
<p class="calibre1"><a href="#calibre_link-172">punctuation  298</a></p>
<p class="calibre1">Microsoft Word properties  <a href="#calibre_link-145">256</a></p>
<p class="calibre1">report components  </p>
<p class="calibre1"><b class="calibre3">Q</b></p>
<p class="calibre1"><a href="#calibre_link-144">254</a></p>
<p class="calibre1"><a href="#calibre_link-144">   report properties  254, </a><a href="#calibre_link-371">255</a></p>
<p class="calibre1">queries</p>
<p class="calibre1"><a href="#calibre_link-146">   report triggers  257</a></p>
<p class="calibre1">about  <a href="#calibre_link-131">230</a></p>
<p class="calibre1">request page properties  <a href="#calibre_link-147">258</a></p>
<p class="calibre1">query component properties  <a href="#calibre_link-133">237</a></p>
<p class="calibre1">request page triggers  <a href="#calibre_link-147">258</a></p>
<p class="calibre1"><a href="#calibre_link-132">   simple query, building  231, </a><a href="#calibre_link-372">233</a>, <a href="#calibre_link-373">235</a>, <a href="#calibre_link-374">236</a></p>
<p class="calibre1">report<br>query component properties</p>
<p class="calibre1"><a href="#calibre_link-135">   about  239</a></p>
<p class="calibre1"><a href="#calibre_link-134">   column properties  238</a></p>
<p class="calibre1">code, adding to  <a href="#calibre_link-191">325</a></p>
<p class="calibre1"><a href="#calibre_link-134">   DataItem properties  238</a></p>
<p class="calibre1">lookup-related table data  <a href="#calibre_link-193">327</a>, <a href="#calibre_link-194">328</a></p>
<p class="calibre1"><a href="#calibre_link-133">   query properties  237</a></p>
<p class="calibre1">report body, laying out  <a href="#calibre_link-194">328</a></p>
<p class="calibre1">query properties<br>report heading, laying out  <a href="#calibre_link-192">326</a></p>
<p class="calibre1">about  <a href="#calibre_link-133">237</a></p>
<p class="calibre1"><a href="#calibre_link-192">   saving  326, </a><a href="#calibre_link-194">328</a></p>
<p class="calibre1"><a href="#calibre_link-133">   OrderBy  237</a></p>
<p class="calibre1"><a href="#calibre_link-192">   testing  326</a>, <a href="#calibre_link-194">328</a></p>
<p class="calibre1">ReadState  <a href="#calibre_link-133">237</a></p>
<p class="calibre1">Request Page</p>
<p class="calibre1"><a href="#calibre_link-133">   TopNumberOfRows  237</a></p>
<p class="calibre1">defining  <a href="#calibre_link-196">331</a></p>
<p class="calibre1">QUIT function  <a href="#calibre_link-221">364</a></p>
<p class="calibre1">processing code, finishing  <a href="#calibre_link-196">331</a>, <a href="#calibre_link-197">332</a></p>
<p class="calibre1"><a href="#calibre_link-232">RESET function  375</a></p>
<p class="calibre1"><b class="calibre3">R</b></p>
<p class="calibre1">Role Center pages</p>
<p class="calibre1"><a href="#calibre_link-94">   about  </a></p>
<p class="calibre1">rational normalization  </p>
<p class="calibre1"><a href="#calibre_link-94">171</a>, <a href="#calibre_link-247">401</a></p>
<p class="calibre1"><a href="#calibre_link-246">400</a></p>
<p class="calibre1">action menu  </p>
<p class="calibre1">RDLC Report</p>
<p class="calibre1"><a href="#calibre_link-375">413</a></p>
<p class="calibre1">action menus  </p>
<p class="calibre1"><a href="#calibre_link-139">   overview  </a></p>
<p class="calibre1"><a href="#calibre_link-252">412, </a><a href="#calibre_link-375">413</a></p>
<p class="calibre1"><a href="#calibre_link-139">247</a></p>
<p class="calibre1">navigation pane  </p>
<p class="calibre1"><a href="#calibre_link-141">   report data overview  </a></p>
<p class="calibre1"><a href="#calibre_link-252">412</a></p>
<p class="calibre1"><a href="#calibre_link-141">249</a></p>
<p class="calibre1"><a href="#calibre_link-250">   page parts  </a></p>
<p class="calibre1">report layout overview  </p>
<p class="calibre1"><a href="#calibre_link-250">409</a></p>
<p class="calibre1"><a href="#calibre_link-142">250</a></p>
<p class="calibre1">structure  </p>
<p class="calibre1"><a href="#calibre_link-140">   structure  </a></p>
<p class="calibre1"><a href="#calibre_link-247">401</a></p>
<p class="calibre1"><a href="#calibre_link-140">248</a></p>
<p class="calibre1"><a href="#calibre_link-250">   system part  </a></p>
<p class="calibre1">read-only table</p>
<p class="calibre1"><a href="#calibre_link-250">409</a></p>
<p class="calibre1">Role Center structure<br>about  <a href="#calibre_link-66">114</a></p>
<p class="calibre1"><a href="#calibre_link-376">   about  </a></p>
<p class="calibre1"><a href="#calibre_link-66">   virtual table type  </a></p>
<p class="calibre1"><a href="#calibre_link-376">403</a></p>
<p class="calibre1"><a href="#calibre_link-66">114</a></p>
<p class="calibre1"><a href="#calibre_link-249">   cue groups  </a></p>
<p class="calibre1">read-process-write loop  </p>
<p class="calibre1"><a href="#calibre_link-249">405</a>, <a href="#calibre_link-377">408</a></p>
<p class="calibre1"><a href="#calibre_link-136">240</a></p>
<p class="calibre1">cues  </p>
<p class="calibre1"><a href="#calibre_link-223">record level locking  </a></p>
<p class="calibre1"><a href="#calibre_link-249">405</a>, <a href="#calibre_link-378">406</a>, <a href="#calibre_link-377">408</a></p>
<p class="calibre1"><a href="#calibre_link-223">366</a></p>
<p class="calibre1">Role Center activities page  </p>
<p class="calibre1">record procedures</p>
<p class="calibre1"><a href="#calibre_link-249">405</a></p>
<p class="calibre1">Role Center headlines page  </p>
<p class="calibre1"><a href="#calibre_link-185">   GET procedure  </a></p>
<p class="calibre1"><a href="#calibre_link-248">404</a></p>
<p class="calibre1"><a href="#calibre_link-185">314</a></p>
<p class="calibre1"><a href="#calibre_link-335">Role Tailored Client (RTC)  </a></p>
<p class="calibre1">SETCURRENTKEY procedure  </p>
<p class="calibre1"><a href="#calibre_link-335">15</a>, <a href="#calibre_link-46">79</a>, <a href="#calibre_link-283">459</a></p>
<p class="calibre1"><a href="#calibre_link-183">312</a></p>
<p class="calibre1">ROUND function  </p>
<p class="calibre1"><a href="#calibre_link-184">   SETFILTER procedure  </a></p>
<p class="calibre1"><a href="#calibre_link-211">352</a></p>
<p class="calibre1"><a href="#calibre_link-184">313</a></p>
<p class="calibre1">SETRANGE procedure  <a href="#calibre_link-184">313</a></p>
<p class="calibre1"><b class="calibre3">[ 509 ]</b></p>
<p class="calibre1"><a id="calibre_link-527"></a><b class="calibre3">S</b></p>
<p class="calibre1">project, concluding  <a href="#calibre_link-307">485</a></p>
<p class="calibre1"><a href="#calibre_link-302">   testing  480</a></p>
<p class="calibre1">sample data</p>
<p class="calibre1"><a href="#calibre_link-304">   testing database, using  482</a></p>
<p class="calibre1">creating  <a href="#calibre_link-29">50</a>, <a href="#calibre_link-30">51</a></p>
<p class="calibre1"><a href="#calibre_link-305">   testing techniques  483</a></p>
<p class="calibre1"><a href="#calibre_link-52">secondary keys  95</a></p>
<p class="calibre1">testing, in production  <a href="#calibre_link-303">481</a></p>
<p class="calibre1">SETAUTOCALCFIELDS function  <a href="#calibre_link-215">357</a></p>
<p class="calibre1">system upgrade</p>
<p class="calibre1"><a href="#calibre_link-183">SETCURRENTKEY procedure  312</a></p>
<p class="calibre1"><a href="#calibre_link-300">   about  478</a></p>
<p class="calibre1"><a href="#calibre_link-228">SETFILTER function  371</a></p>
<p class="calibre1">benefits  <a href="#calibre_link-308">486</a></p>
<p class="calibre1">SETFILTER procedure  <a href="#calibre_link-184">313</a></p>
<p class="calibre1">considerations, for code  <a href="#calibre_link-309">487</a></p>
<p class="calibre1"><a href="#calibre_link-184">SETRANGE procedure  313</a></p>
<p class="calibre1">low-impact code, implementing  <a href="#calibre_link-309">487</a></p>
<p class="calibre1">simple coding modifications</p>
<p class="calibre1"><a href="#calibre_link-307">   planning  485</a></p>
<p class="calibre1">about  <a href="#calibre_link-190">321</a></p>
<p class="calibre1"><a href="#calibre_link-167">system-defined variables  292</a></p>
<p class="calibre1"><a href="#calibre_link-191">   code, adding to report  325</a></p>
<p class="calibre1"><a href="#calibre_link-197">   completed report, testing  332, </a><a href="#calibre_link-198">334</a></p>
<p class="calibre1"><b class="calibre3">T</b></p>
<p class="calibre1"><a href="#calibre_link-190">   field validation, adding to table  321, </a><a href="#calibre_link-379">322, </a><a href="#calibre_link-380">323</a>, T-SQL queries  <a href="#calibre_link-131">230</a></p>
<p class="calibre1"><a href="#calibre_link-191">325</a></p>
<p class="calibre1"><a href="#calibre_link-53">table relations  </a></p>
<p class="calibre1"><a href="#calibre_link-196">   Request Page, defining  </a></p>
<p class="calibre1"><a href="#calibre_link-53">96</a></p>
<p class="calibre1"><a href="#calibre_link-196">331</a></p>
<p class="calibre1">table</p>
<p class="calibre1"><a href="#calibre_link-195">   user entered report options, handling  329, </a><a href="#calibre_link-381">330</a></p>
<p class="calibre1">components  </p>
<p class="calibre1">singleton table design pattern</p>
<p class="calibre1"><a href="#calibre_link-40">68</a>, <a href="#calibre_link-41">69</a></p>
<p class="calibre1">content modifiable table  </p>
<p class="calibre1">reference  </p>
<p class="calibre1"><a href="#calibre_link-65">112</a></p>
<p class="calibre1"><a href="#calibre_link-63">110</a></p>
<p class="calibre1"><a href="#calibre_link-46">   field groups  </a></p>
<p class="calibre1"><a href="#calibre_link-222">SKIP function  </a></p>
<p class="calibre1"><a href="#calibre_link-46">79</a></p>
<p class="calibre1"><a href="#calibre_link-222">365</a></p>
<p class="calibre1">fully modifiable table  </p>
<p class="calibre1">source code management  </p>
<p class="calibre1"><a href="#calibre_link-56">99</a></p>
<p class="calibre1"><a href="#calibre_link-202">341</a></p>
<p class="calibre1"><a href="#calibre_link-44">   keys  </a></p>
<p class="calibre1">special working storage variables</p>
<p class="calibre1"><a href="#calibre_link-44">75</a>, <a href="#calibre_link-382">77</a></p>
<p class="calibre1"><a href="#calibre_link-41">   naming tables  </a></p>
<p class="calibre1"><a href="#calibre_link-316">   arrays  </a></p>
<p class="calibre1"><a href="#calibre_link-41">69</a></p>
<p class="calibre1"><a href="#calibre_link-316">290</a></p>
<p class="calibre1"><a href="#calibre_link-41">   numbering  </a></p>
<p class="calibre1">initialization  </p>
<p class="calibre1"><a href="#calibre_link-41">69</a></p>
<p class="calibre1"><a href="#calibre_link-383">291</a></p>
<p class="calibre1">overview  </p>
<p class="calibre1"><a href="#calibre_link-167">   system-defined variables  </a></p>
<p class="calibre1"><a href="#calibre_link-39">67, </a><a href="#calibre_link-40">68</a></p>
<p class="calibre1"><a href="#calibre_link-167">292</a></p>
<p class="calibre1"><a href="#calibre_link-42">   properties  </a></p>
<p class="calibre1"><a href="#calibre_link-166">   temporary tables  </a></p>
<p class="calibre1"><a href="#calibre_link-42">70, </a><a href="#calibre_link-384">71</a></p>
<p class="calibre1"><a href="#calibre_link-166">289</a></p>
<p class="calibre1">read-only table  </p>
<p class="calibre1"><a href="#calibre_link-132">SQL joins  </a></p>
<p class="calibre1"><a href="#calibre_link-66">114</a></p>
<p class="calibre1"><a href="#calibre_link-132">231</a></p>
<p class="calibre1"><a href="#calibre_link-45">   SumIndexFields  </a></p>
<p class="calibre1">SQL Server Report Builder (SSRB)  </p>
<p class="calibre1"><a href="#calibre_link-45">78</a></p>
<p class="calibre1"><a href="#calibre_link-200">338</a></p>
<p class="calibre1"><a href="#calibre_link-43">   triggers  </a></p>
<p class="calibre1"><a href="#calibre_link-100">StandardDialog page  </a></p>
<p class="calibre1"><a href="#calibre_link-43">73, </a><a href="#calibre_link-385">74</a></p>
<p class="calibre1"><a href="#calibre_link-100">179</a></p>
<p class="calibre1">types  </p>
<p class="calibre1">string data</p>
<p class="calibre1"><a href="#calibre_link-55">98</a></p>
<p class="calibre1"><a href="#calibre_link-302">Team Foundation systems  </a></p>
<p class="calibre1"><a href="#calibre_link-76">   types  </a></p>
<p class="calibre1"><a href="#calibre_link-302">480</a></p>
<p class="calibre1"><a href="#calibre_link-76">131</a></p>
<p class="calibre1"><a href="#calibre_link-58">template table type  </a></p>
<p class="calibre1">STRMENU procedure  </p>
<p class="calibre1"><a href="#calibre_link-58">101</a></p>
<p class="calibre1"><a href="#calibre_link-182">310</a></p>
<p class="calibre1"><a href="#calibre_link-64">temporary table type  </a></p>
<p class="calibre1"><a href="#calibre_link-382">SumIndexField Technology (SIFT)  </a></p>
<p class="calibre1"><a href="#calibre_link-64">111</a></p>
<p class="calibre1"><a href="#calibre_link-382">77</a></p>
<p class="calibre1">temporary tables  </p>
<p class="calibre1"><a href="#calibre_link-52">SumIndexFields  </a></p>
<p class="calibre1"><a href="#calibre_link-166">289</a></p>
<p class="calibre1"><a href="#calibre_link-52">95</a></p>
<p class="calibre1"><a href="#calibre_link-95">territories  </a></p>
<p class="calibre1">supply chain management (SCM)  </p>
<p class="calibre1"><a href="#calibre_link-95">173</a></p>
<p class="calibre1"><a href="#calibre_link-5">17</a></p>
<p class="calibre1"><a href="#calibre_link-304">test by fire  </a></p>
<p class="calibre1">supporting processes</p>
<p class="calibre1"><a href="#calibre_link-304">482</a></p>
<p class="calibre1">TESTFIELD function  </p>
<p class="calibre1">designing  </p>
<p class="calibre1"><a href="#calibre_link-203">342</a></p>
<p class="calibre1"><a href="#calibre_link-297">475</a></p>
<p class="calibre1"><a href="#calibre_link-206">TIME function  </a></p>
<p class="calibre1">system table type  </p>
<p class="calibre1"><a href="#calibre_link-206">346</a></p>
<p class="calibre1"><a href="#calibre_link-65">112</a></p>
<p class="calibre1">TODAY function  </p>
<p class="calibre1">system update</p>
<p class="calibre1"><a href="#calibre_link-206">346</a></p>
<p class="calibre1">types, page controls<br>about  <a href="#calibre_link-300">478</a></p>
<p class="calibre1">container controls  </p>
<p class="calibre1">c project recommendations  </p>
<p class="calibre1"><a href="#calibre_link-116">202</a></p>
<p class="calibre1"><a href="#calibre_link-301">479</a></p>
<p class="calibre1"><a href="#calibre_link-117">   field controls  </a></p>
<p class="calibre1"><a href="#calibre_link-302">   changes, handling  </a></p>
<p class="calibre1"><a href="#calibre_link-117">207</a>, <a href="#calibre_link-386">208</a>, <a href="#calibre_link-387">209</a></p>
<p class="calibre1"><a href="#calibre_link-302">480</a></p>
<p class="calibre1">group controls  </p>
<p class="calibre1"><a href="#calibre_link-303">   database testing approaches  </a></p>
<p class="calibre1"><a href="#calibre_link-116">202</a>, <a href="#calibre_link-388">203</a>, <a href="#calibre_link-389">204, </a><a href="#calibre_link-390">206</a></p>
<p class="calibre1"><a href="#calibre_link-303">481</a></p>
<p class="calibre1"><a href="#calibre_link-119">   page control triggers  </a></p>
<p class="calibre1">deliverables  </p>
<p class="calibre1"><a href="#calibre_link-119">211, </a><a href="#calibre_link-120">212</a></p>
<p class="calibre1"><a href="#calibre_link-306">484</a></p>
<p class="calibre1"><a href="#calibre_link-118">   page part controls  </a></p>
<p class="calibre1">designing  </p>
<p class="calibre1"><a href="#calibre_link-118">210, </a><a href="#calibre_link-119">211</a></p>
<p class="calibre1"><a href="#calibre_link-301">479</a></p>
<p class="calibre1"><b class="calibre3">[ 510 ]</b></p>
<p class="calibre1"><a id="calibre_link-528"></a><b class="calibre3">U</b></p>
<p class="calibre1">page enhancement  <a href="#calibre_link-120">212</a>, <a href="#calibre_link-391">213</a>, <a href="#calibre_link-121">214</a></p>
<p class="calibre1">WDTU application</p>
<p class="calibre1"><a href="#calibre_link-78">Universal Naming Convention (UNC)  134</a></p>
<p class="calibre1"><a href="#calibre_link-50">   activity-tracking tables, adding  89</a></p>
<p class="calibre1">user interface (UI)  <a href="#calibre_link-392">121</a></p>
<p class="calibre1">Business Central table, modifying  <a href="#calibre_link-54">97</a></p>
<p class="calibre1"><b class="calibre3">V</b></p>
<p class="calibre1">enhancing  <a href="#calibre_link-48">82</a></p>
<p class="calibre1">InitValue property, assigning  <a href="#calibre_link-50">89</a></p>
<p class="calibre1">validation functions</p>
<p class="calibre1"><a href="#calibre_link-52">   keys, examples  95</a></p>
<p class="calibre1">about  <a href="#calibre_link-203">342, </a><a href="#calibre_link-206">346</a></p>
<p class="calibre1"><a href="#calibre_link-52">   list pages  95</a></p>
<p class="calibre1">FIELDERROR  <a href="#calibre_link-204">343</a></p>
<p class="calibre1"><a href="#calibre_link-52">   SumIndexFields, examples  95</a></p>
<p class="calibre1"><a href="#calibre_link-205">   INIT  345</a></p>
<p class="calibre1"><a href="#calibre_link-49">   table relation property, assigning  87, </a><a href="#calibre_link-393">88</a></p>
<p class="calibre1">TESTFIELD  <a href="#calibre_link-203">342</a></p>
<p class="calibre1">table relations, examples  <a href="#calibre_link-52">95</a></p>
<p class="calibre1"><a href="#calibre_link-205">   VALIDATE  345</a></p>
<p class="calibre1"><a href="#calibre_link-51">   tables  91, </a><a href="#calibre_link-394">93</a></p>
<p class="calibre1">validation logic, WDTU application enhancement<br>tables, creating  <a href="#calibre_link-48">82</a>, <a href="#calibre_link-395">85</a></p>
<p class="calibre1"><a href="#calibre_link-236">   adding  380</a></p>
<p class="calibre1">tables, modifying  <a href="#calibre_link-48">82, </a><a href="#calibre_link-395">85</a></p>
<p class="calibre1"><a href="#calibre_link-236">   Playlist Header validation  380, </a><a href="#calibre_link-237">382</a></p>
<p class="calibre1">WDTU Radio Show application<br>variables<br>page enhancement  <a href="#calibre_link-113">195</a>, <a href="#calibre_link-396">196</a>, <a href="#calibre_link-397">198, </a><a href="#calibre_link-114">199</a></p>
<p class="calibre1">about  <a href="#calibre_link-164">287</a></p>
<p class="calibre1">WDTU Role Center ribbon</p>
<p class="calibre1">AL global variables  <a href="#calibre_link-165">288</a></p>
<p class="calibre1"><a href="#calibre_link-254">   creating  415, </a><a href="#calibre_link-255">417</a></p>
<p class="calibre1">AL local variables  <a href="#calibre_link-165">288</a></p>
<p class="calibre1">web services</p>
<p class="calibre1"><a href="#calibre_link-74">   naming  128</a></p>
<p class="calibre1"><a href="#calibre_link-264">   about  429</a></p>
<p class="calibre1">special working storage variables  <a href="#calibre_link-166">289</a></p>
<p class="calibre1">benefits  <a href="#calibre_link-264">429</a></p>
<p class="calibre1">virtual table type  <a href="#calibre_link-66">114</a></p>
<p class="calibre1"><a href="#calibre_link-398">   disadvantages  430</a></p>
<p class="calibre1">Visual Studio Code icons</p>
<p class="calibre1"><a href="#calibre_link-267">   enabling  433</a></p>
<p class="calibre1">DEBUG view  <a href="#calibre_link-12">24</a></p>
<p class="calibre1"><a href="#calibre_link-265">   exploring  431</a></p>
<p class="calibre1"><a href="#calibre_link-10">   EXPLORER view  22</a></p>
<p class="calibre1">integration example, for WDTU  <a href="#calibre_link-268">436, </a><a href="#calibre_link-399">437, </a><a href="#calibre_link-400">439</a></p>
<p class="calibre1">EXTENSIONS  <a href="#calibre_link-12">24</a></p>
<p class="calibre1">published object, determining  <a href="#calibre_link-267">433</a>, <a href="#calibre_link-401">435</a></p>
<p class="calibre1">SEARCH view  <a href="#calibre_link-10">22</a></p>
<p class="calibre1"><a href="#calibre_link-266">   publishing  432</a></p>
<p class="calibre1"><a href="#calibre_link-11">   SOURCE CONTROL  23</a></p>
<p class="calibre1">WHILE-DO control  <a href="#calibre_link-218">360</a></p>
<p class="calibre1">Visual Studio Code IDE  <a href="#calibre_link-8">20, </a><a href="#calibre_link-9">21</a></p>
<p class="calibre1"><a href="#calibre_link-220">WITH-DO statement  363, </a><a href="#calibre_link-221">364</a></p>
<p class="calibre1"><a href="#calibre_link-290">Visual Studio Code test-driven development  466</a></p>
<p class="calibre1"><a href="#calibre_link-207">WORKDATE function  347</a></p>
<p class="calibre1">Visual Studio Code<br>worksheet (journal) page  <a href="#calibre_link-99">178</a></p>
<p class="calibre1">about  <a href="#calibre_link-160">282</a></p>
<p class="calibre1"><a href="#calibre_link-402">WSDL (Web Services Description Language)  434</a></p>
<p class="calibre1">AL programming  <a href="#calibre_link-167">292</a></p>
<p class="calibre1"><a href="#calibre_link-160">   EXPLORER  282</a></p>
<p class="calibre1"><b class="calibre3">X</b></p>
<p class="calibre1"><b class="calibre3">W</b></p>
<p class="calibre1"><a href="#calibre_link-35">XML (eXtensible Markup Language)  61</a>, <a href="#calibre_link-255">417</a></p>
<p class="calibre1">XML-structured Report Definition Language Client-</p>
<p class="calibre1">WDTU application enhancement</p>
<p class="calibre1">Side (RDLC)  <a href="#calibre_link-403">241</a></p>
<p class="calibre1">FactBox page, creating  <a href="#calibre_link-240">390, </a><a href="#calibre_link-404">392</a></p>
<p class="calibre1">XMLport components</p>
<p class="calibre1"><a href="#calibre_link-239">   function, creating for FactBox  388, </a><a href="#calibre_link-405">389</a></p>
<p class="calibre1"><a href="#calibre_link-262">   attribute  427</a></p>
<p class="calibre1"><a href="#calibre_link-234">   performing  377</a></p>
<p class="calibre1"><a href="#calibre_link-262">   element  427</a></p>
<p class="calibre1"><a href="#calibre_link-238">   Playlist Line validations  385, </a><a href="#calibre_link-406">387</a>, <a href="#calibre_link-239">388</a></p>
<p class="calibre1"><a href="#calibre_link-262">   NodeType attribute data item  427</a></p>
<p class="calibre1">Playlist subpage, creating  <a href="#calibre_link-237">382, </a><a href="#calibre_link-407">384</a></p>
<p class="calibre1">NodeType element data item  <a href="#calibre_link-262">427</a></p>
<p class="calibre1">table fields, modifying  <a href="#calibre_link-235">378, </a><a href="#calibre_link-408">379</a></p>
<p class="calibre1">XMLport data lines  <a href="#calibre_link-258">423</a></p>
<p class="calibre1"><a href="#calibre_link-236">   validation logic, adding  380</a></p>
<p class="calibre1">XMLport line properties  <a href="#calibre_link-259">424</a></p>
<p class="calibre1">WDTU application pages</p>
<p class="calibre1">XMLport line triggers  <a href="#calibre_link-262">427</a></p>
<p class="calibre1"><b class="calibre3">[ 511 ]</b></p>
<p class="calibre1"><a id="calibre_link-529"></a>   XMLport properties  <a href="#calibre_link-256">419</a></p>
<p class="calibre1"><a href="#calibre_link-262">   about  427</a></p>
<p class="calibre1"><a href="#calibre_link-264">   XMLport Request Page  429</a></p>
<p class="calibre1">DataType as Field  <a href="#calibre_link-263">428</a></p>
<p class="calibre1">XMLport triggers  <a href="#calibre_link-257">422</a></p>
<p class="calibre1"><a href="#calibre_link-263">   DataType as Table  428</a></p>
<p class="calibre1">XMLport line properties</p>
<p class="calibre1"><a href="#calibre_link-262">   DataType as text  427</a></p>
<p class="calibre1"><a href="#calibre_link-259">   aout  424</a></p>
<p class="calibre1">XMLport properties  <a href="#calibre_link-409">420</a></p>
<p class="calibre1"><a href="#calibre_link-261">   SourceType as field  426</a></p>
<p class="calibre1"><a href="#calibre_link-264">XMLport Request Page  429</a></p>
<p class="calibre1">SourceType as table  <a href="#calibre_link-260">425</a></p>
<p class="calibre1">XMLports</p>
<p class="calibre1"><a href="#calibre_link-260">   SourceType as text  425</a></p>
<p class="calibre1"><a href="#calibre_link-255">   about  417</a></p>
<p class="calibre1">XMLport line triggers<br>components  <a href="#calibre_link-256">419</a></p>
<p class="calibre1"><a name="outline"></a></p><h1 class="calibre5">Document Outline</h1>
<ul class="calibre6">
<li class="calibre7"><a href="#calibre_link-410">Cover</a></li>
<li class="calibre7"><a href="#calibre_link-411">Title Page</a></li>
<li class="calibre7"><a href="#calibre_link-412">Copyright and Credits</a></li>
<li class="calibre7"><a href="#calibre_link-413">Packt Upsell</a></li>
<li class="calibre7"><a href="#calibre_link-414">Contributors</a></li>
<li class="calibre7"><a href="#calibre_link-415">Table of Contents</a></li>
<li class="calibre7"><a href="#calibre_link-1">Preface</a></li>
<li class="calibre7"><a href="#calibre_link-2">Chapter 1: Introduction to Business Central</a>
<ul class="calibre8">
<li class="calibre7"><a href="#calibre_link-3">Business Central &ndash; an ERP system</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-4">Financial management</a></li>
<li class="calibre7"><a href="#calibre_link-4">Manufacturing</a></li>
<li class="calibre7"><a href="#calibre_link-5">Supply chain management</a></li>
<li class="calibre7"><a href="#calibre_link-5">Business intelligence and reporting</a></li>
<li class="calibre7"><a href="#calibre_link-6">Relationship management</a></li>
<li class="calibre7"><a href="#calibre_link-6">Human resource management</a></li>
<li class="calibre7"><a href="#calibre_link-7">Project management</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-7">A developer’s overview of Business Central</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-7">Business Central object types</a></li>
<li class="calibre7"><a href="#calibre_link-8">The Visual Studio Code integrated development environment</a></li>
<li class="calibre7"><a href="#calibre_link-9">Visual Studio Code icons</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-10">Explorer</a></li>
<li class="calibre7"><a href="#calibre_link-10">Search</a></li>
<li class="calibre7"><a href="#calibre_link-11">Source control</a></li>
<li class="calibre7"><a href="#calibre_link-12">Debugger</a></li>
<li class="calibre7"><a href="#calibre_link-12">Extensions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-13">AL programming language</a></li>
<li class="calibre7"><a href="#calibre_link-14">Business Central object and system elements</a></li>
<li class="calibre7"><a href="#calibre_link-15">Business Central functional terminology</a></li>
<li class="calibre7"><a href="#calibre_link-15">User interface</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-16">Hands-on development in Business Central</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-16">Business Central development exercise scenario</a></li>
<li class="calibre7"><a href="#calibre_link-17">Getting started with application design</a></li>
<li class="calibre7"><a href="#calibre_link-18">Folder structure</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-18">launch.json</a></li>
<li class="calibre7"><a href="#calibre_link-19">app.json</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-19">Symbol files</a></li>
<li class="calibre7"><a href="#calibre_link-20">Application tables</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-21">Designing a simple table</a></li>
<li class="calibre7"><a href="#calibre_link-22">Creating a simple table</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-23">Pages</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-23">Standard elements of pages</a></li>
<li class="calibre7"><a href="#calibre_link-24">List pages</a></li>
<li class="calibre7"><a href="#calibre_link-24">Card pages</a></li>
<li class="calibre7"><a href="#calibre_link-25">Document pages</a></li>
<li class="calibre7"><a href="#calibre_link-26">Journal/worksheet pages</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-27">Creating a list page</a></li>
<li class="calibre7"><a href="#calibre_link-28">Creating a card page</a></li>
<li class="calibre7"><a href="#calibre_link-29">Creating some sample data</a></li>
<li class="calibre7"><a href="#calibre_link-30">Creating a list report</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-31">Generating the layout</a></li>
<li class="calibre7"><a href="#calibre_link-32">Designing the layout</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-33">Other Business Central object types</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-33">TableExtension and PageExtension</a></li>
<li class="calibre7"><a href="#calibre_link-34">Codeunits</a></li>
<li class="calibre7"><a href="#calibre_link-35">Queries</a></li>
<li class="calibre7"><a href="#calibre_link-35">XMLports</a></li>
<li class="calibre7"><a href="#calibre_link-36">Control add-ins</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-36">Development backups and documentation</a></li>
<li class="calibre7"><a href="#calibre_link-37">Summary</a></li>
<li class="calibre7"><a href="#calibre_link-37">Questions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-38">Chapter 2: Tables</a>
<ul class="calibre8">
<li class="calibre7"><a href="#calibre_link-39">An overview of tables</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-40">Components of a table</a></li>
<li class="calibre7"><a href="#calibre_link-41">Naming tables</a></li>
<li class="calibre7"><a href="#calibre_link-41">Table numbering</a></li>
<li class="calibre7"><a href="#calibre_link-42">Table properties</a></li>
<li class="calibre7"><a href="#calibre_link-43">Table triggers</a></li>
<li class="calibre7"><a href="#calibre_link-44">Keys</a></li>
<li class="calibre7"><a href="#calibre_link-45">SumIndexFields</a></li>
<li class="calibre7"><a href="#calibre_link-46">Field groups</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-47">Bricks</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-48">Enhancing our sample application</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-48">Creating and modifying tables</a></li>
<li class="calibre7"><a href="#calibre_link-49">Assigning a table relation property</a></li>
<li class="calibre7"><a href="#calibre_link-50">Assigning an InitValue property</a></li>
<li class="calibre7"><a href="#calibre_link-50">Adding a few activity-tracking tables</a></li>
<li class="calibre7"><a href="#calibre_link-51">New tables for our WDTU project</a></li>
<li class="calibre7"><a href="#calibre_link-52">New list pages for our WDTU project</a></li>
<li class="calibre7"><a href="#calibre_link-52">Keys, SumIndexFields, and table relations in our examples</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-52">Secondary keys and SumIndexFields</a></li>
<li class="calibre7"><a href="#calibre_link-53">Table relations</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-54">Modifying an original Business Central table</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-55">Types of table</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-56">Fully modifiable tables</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-56">Master data</a></li>
<li class="calibre7"><a href="#calibre_link-57">Journal</a></li>
<li class="calibre7"><a href="#calibre_link-58">Template</a></li>
<li class="calibre7"><a href="#calibre_link-59">Entry tables</a></li>
<li class="calibre7"><a href="#calibre_link-60">Subsidiary (supplementary) tables</a></li>
<li class="calibre7"><a href="#calibre_link-61">Register</a></li>
<li class="calibre7"><a href="#calibre_link-62">Posted document</a></li>
<li class="calibre7"><a href="#calibre_link-63">Singleton</a></li>
<li class="calibre7"><a href="#calibre_link-64">Temporary</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-65">Content modifiable tables</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-65">System table</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-66">Read-only tables</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-66">Virtual</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-67">Summary</a></li>
<li class="calibre7"><a href="#calibre_link-67">Questions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-68">Chapter 3: Data Types and Fields</a>
<ul class="calibre8">
<li class="calibre7"><a href="#calibre_link-69">Basic definitions in Business Central</a></li>
<li class="calibre7"><a href="#calibre_link-69">Fields</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-70">Field properties</a></li>
<li class="calibre7"><a href="#calibre_link-71">Field triggers</a></li>
<li class="calibre7"><a href="#calibre_link-72">Field events</a></li>
<li class="calibre7"><a href="#calibre_link-72">Data structure examples</a></li>
<li class="calibre7"><a href="#calibre_link-73">Field numbering</a></li>
<li class="calibre7"><a href="#calibre_link-74">Field and variable naming</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-75">Data types</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-75">Fundamental data types</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-75">Numeric data</a></li>
<li class="calibre7"><a href="#calibre_link-76">String data</a></li>
<li class="calibre7"><a href="#calibre_link-77">Date/Time data</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-78">Complex data types</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-78">Data structure</a></li>
<li class="calibre7"><a href="#calibre_link-79">Objects</a></li>
<li class="calibre7"><a href="#calibre_link-79">Web services</a></li>
<li class="calibre7"><a href="#calibre_link-79">DotNet</a></li>
<li class="calibre7"><a href="#calibre_link-79">Input/output</a></li>
<li class="calibre7"><a href="#calibre_link-80">DateFormula</a></li>
<li class="calibre7"><a href="#calibre_link-81">References and other data types</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-82">Data type usage</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-83">FieldClass property options</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-83">FieldClass &ndash; Normal</a></li>
<li class="calibre7"><a href="#calibre_link-83">FieldClass &ndash; FlowField</a></li>
<li class="calibre7"><a href="#calibre_link-84">FieldClass &ndash; FlowFilter</a></li>
<li class="calibre7"><a href="#calibre_link-85">FlowFields and FlowFilter for our application</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-86">Filtering</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-87">Experimenting with filters</a></li>
<li class="calibre7"><a href="#calibre_link-88">Accessing filter controls</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-89">Summary</a></li>
<li class="calibre7"><a href="#calibre_link-90">Questions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-91">Chapter 4: Pages - The Interactive Interface</a>
<ul class="calibre8">
<li class="calibre7"><a href="#calibre_link-92">Page design and structure overview</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-92">Page design guidelines</a></li>
<li class="calibre7"><a href="#calibre_link-93">Business Central page structure</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-94">Types of pages</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-94">Role Center page</a></li>
<li class="calibre7"><a href="#calibre_link-95">HeadlinePart page</a></li>
<li class="calibre7"><a href="#calibre_link-95">List page</a></li>
<li class="calibre7"><a href="#calibre_link-96">Card page</a></li>
<li class="calibre7"><a href="#calibre_link-96">Document page</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-97">FastTabs</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-98">List Plus page</a></li>
<li class="calibre7"><a href="#calibre_link-99">Worksheet (journal) page</a></li>
<li class="calibre7"><a href="#calibre_link-100">ConfirmationDialog page</a></li>
<li class="calibre7"><a href="#calibre_link-100">StandardDialog page</a></li>
<li class="calibre7"><a href="#calibre_link-101">Navigate page</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-102">Navigate function</a></li>
<li class="calibre7"><a href="#calibre_link-103">Request page</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-103">Page parts</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-104">FactBox area</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-104">Card Parts and List Parts</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-105">Charts</a></li>
<li class="calibre7"><a href="#calibre_link-106">Page names</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-107">In-client designer</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-108">Designer</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-109">Page components</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-110">Page triggers</a></li>
<li class="calibre7"><a href="#calibre_link-111">Page properties</a></li>
<li class="calibre7"><a href="#calibre_link-112">Inheritance</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-113">WDTU page enhancement &ndash; part 1</a></li>
<li class="calibre7"><a href="#calibre_link-114">Page controls</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-115">Control types</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-116">Container controls</a></li>
<li class="calibre7"><a href="#calibre_link-116">group controls</a></li>
<li class="calibre7"><a href="#calibre_link-117">Field controls</a></li>
<li class="calibre7"><a href="#calibre_link-118">Page part controls</a></li>
<li class="calibre7"><a href="#calibre_link-119">Page control triggers</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-120">Bound and unbound pages</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-120">WDTU page enhancement &ndash; part 2</a></li>
<li class="calibre7"><a href="#calibre_link-121">Page actions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-122">Page action types and subtypes</a></li>
<li class="calibre7"><a href="#calibre_link-123">Action groups</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-124">Navigation pane button actions</a></li>
<li class="calibre7"><a href="#calibre_link-125">Actions summary</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-126">Learning more</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-126">Patterns and creative plagiarism</a></li>
<li class="calibre7"><a href="#calibre_link-127">Experimenting on your own</a></li>
<li class="calibre7"><a href="#calibre_link-128">Experimentation</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-129">Summary</a></li>
<li class="calibre7"><a href="#calibre_link-129">Questions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-130">Chapter 5: Queries and Reports</a>
<ul class="calibre8">
<li class="calibre7"><a href="#calibre_link-131">Queries</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-132">Building a simple query</a></li>
<li class="calibre7"><a href="#calibre_link-133">Query and query component properties</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-133">Query properties</a></li>
<li class="calibre7"><a href="#calibre_link-134">DataItem properties</a></li>
<li class="calibre7"><a href="#calibre_link-134">Column properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-135">Reports</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-135">What is a report? </a></li>
<li class="calibre7"><a href="#calibre_link-136">Four Business Central report designers</a></li>
<li class="calibre7"><a href="#calibre_link-137">Business Central report types</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-138">Report types summarized</a></li>
<li class="calibre7"><a href="#calibre_link-139">Report naming</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-139">Report components &ndash; overview</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-140">Report structure</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-141">Report data overview</a></li>
<li class="calibre7"><a href="#calibre_link-142">Report layout overview</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-143">Report data flow</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-144">Report components &ndash; detail</a></li>
<li class="calibre7"><a href="#calibre_link-144">Report properties</a></li>
<li class="calibre7"><a href="#calibre_link-145">Microsoft Word &ndash; report properties</a></li>
<li class="calibre7"><a href="#calibre_link-146">Report triggers</a></li>
<li class="calibre7"><a href="#calibre_link-147">Request page properties</a></li>
<li class="calibre7"><a href="#calibre_link-147">Request page triggers</a></li>
<li class="calibre7"><a href="#calibre_link-148">DataItem properties</a></li>
<li class="calibre7"><a href="#calibre_link-149">DataItem triggers</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-149">Creating a report in Business Central</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-150">Learn by experimentation</a></li>
<li class="calibre7"><a href="#calibre_link-150">Report building &ndash; phase 1</a></li>
<li class="calibre7"><a href="#calibre_link-151">Report building &ndash; phase 2</a></li>
<li class="calibre7"><a href="#calibre_link-152">Report building &ndash; phase 3</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-153">Modifying an existing report with Report Designer or Word</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-154">Request page</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-155">Adding a request page option</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-156">Processing-only reports</a></li>
<li class="calibre7"><a href="#calibre_link-156">Creative report plagiarism and patterns</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-157">Summary</a></li>
<li class="calibre7"><a href="#calibre_link-158">Questions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-159">Chapter 6: Introduction to AL</a>
<ul class="calibre8">
<li class="calibre7"><a href="#calibre_link-160">Understanding Visual Studio Code</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-160">Explorer</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-161">Starting a new object</a></li>
<li class="calibre7"><a href="#calibre_link-162">Object designer navigation</a></li>
<li class="calibre7"><a href="#calibre_link-163">Some AL naming conventions</a></li>
<li class="calibre7"><a href="#calibre_link-164">Variables</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-165">AL Globals</a></li>
<li class="calibre7"><a href="#calibre_link-165">AL Locals</a></li>
<li class="calibre7"><a href="#calibre_link-166">Special working storage variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-167">AL programming</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-168">Non-modifiable procedures</a></li>
<li class="calibre7"><a href="#calibre_link-168">Modifiable procedures</a></li>
<li class="calibre7"><a href="#calibre_link-169">Custom procedures</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-170">Creating a procedure</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-171">AL syntax</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-172">Assignment and punctuation</a></li>
<li class="calibre7"><a href="#calibre_link-173">Expressions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-174">Operators</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-175">Arithmetic operators and procedures</a></li>
<li class="calibre7"><a href="#calibre_link-176">Boolean operators</a></li>
<li class="calibre7"><a href="#calibre_link-176">Relational operators and procedures</a></li>
<li class="calibre7"><a href="#calibre_link-177">Precedence of operators</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-178">Frequently used AL procedures</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-179">The MESSAGE procedure</a></li>
<li class="calibre7"><a href="#calibre_link-180">The ERROR procedure</a></li>
<li class="calibre7"><a href="#calibre_link-181">The CONFIRM procedure</a></li>
<li class="calibre7"><a href="#calibre_link-182">The STRMENU procedure</a></li>
<li class="calibre7"><a href="#calibre_link-183">Record procedures</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-183">The SETCURRENTKEY procedure</a></li>
<li class="calibre7"><a href="#calibre_link-184">The SETRANGE procedure</a></li>
<li class="calibre7"><a href="#calibre_link-184">The SETFILTER procedure</a></li>
<li class="calibre7"><a href="#calibre_link-185">The GET procedure</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-186">FIND procedures</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-187">FIND ([Which]) options and the SQL Server alternatives</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-188">Conditional statements</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-188">The BEGIN-END compound statement</a></li>
<li class="calibre7"><a href="#calibre_link-188">IF-THEN-ELSE statement</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-189">Indenting code</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-190">Some simple coding modifications</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-190">Adding field validation to a table</a></li>
<li class="calibre7"><a href="#calibre_link-191">Adding code to a report</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-192">Laying out the new Report Heading</a></li>
<li class="calibre7"><a href="#calibre_link-192">Saving and testing</a></li>
<li class="calibre7"><a href="#calibre_link-193">Lookup-related table data</a></li>
<li class="calibre7"><a href="#calibre_link-194">Laying out the new report Body</a></li>
<li class="calibre7"><a href="#calibre_link-194">Saving and testing</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-195">Handling user entered report options</a></li>
<li class="calibre7"><a href="#calibre_link-196">Defining the Request Page</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-196">Finishing the processing code</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-197">Testing the completed report</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-198">Summary</a></li>
<li class="calibre7"><a href="#calibre_link-198">Questions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-199">Chapter 7: Intermediate AL</a>
<ul class="calibre8">
<li class="calibre7"><a href="#calibre_link-200">IntelliSense</a></li>
<li class="calibre7"><a href="#calibre_link-201">Internal documentation</a></li>
<li class="calibre7"><a href="#calibre_link-202">Source code management</a></li>
<li class="calibre7"><a href="#calibre_link-203">Validation functions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-203">TESTFIELD</a></li>
<li class="calibre7"><a href="#calibre_link-204">FIELDERROR</a></li>
<li class="calibre7"><a href="#calibre_link-205">INIT</a></li>
<li class="calibre7"><a href="#calibre_link-205">VALIDATE</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-206">Date and time functions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-206">TODAY, TIME, and CURRENTDATETIME</a></li>
<li class="calibre7"><a href="#calibre_link-207">WORKDATE</a></li>
<li class="calibre7"><a href="#calibre_link-208">DATE2DMY function</a></li>
<li class="calibre7"><a href="#calibre_link-208">DATE2DWY function</a></li>
<li class="calibre7"><a href="#calibre_link-208">DMY2DATE and DWY2DATE functions</a></li>
<li class="calibre7"><a href="#calibre_link-209">CALCDATE</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-210">Data conversion and formatting functions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-211">ROUND</a></li>
<li class="calibre7"><a href="#calibre_link-212">FORMAT function</a></li>
<li class="calibre7"><a href="#calibre_link-213">EVALUATE function</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-213">FlowField and SumIndexField functions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-214">CALCFIELDS function</a></li>
<li class="calibre7"><a href="#calibre_link-215">SETAUTOCALCFIELDS function</a></li>
<li class="calibre7"><a href="#calibre_link-215">CALCSUMS function</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-216">Comparing CALCFIELDS and CALCSUMS</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-217">Flow control functions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-217">REPEAT-UNTIL</a></li>
<li class="calibre7"><a href="#calibre_link-218">WHILE-DO</a></li>
<li class="calibre7"><a href="#calibre_link-218">FOR-TO or FOR-DOWNTO</a></li>
<li class="calibre7"><a href="#calibre_link-219">CASE-ELSE statement</a></li>
<li class="calibre7"><a href="#calibre_link-220">WITH-DO statement</a></li>
<li class="calibre7"><a href="#calibre_link-221">QUIT, BREAK, EXIT, and SKIP functions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-221">QUIT function</a></li>
<li class="calibre7"><a href="#calibre_link-222">BREAK function</a></li>
<li class="calibre7"><a href="#calibre_link-222">EXIT function</a></li>
<li class="calibre7"><a href="#calibre_link-222">SKIP function</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-223">Input and output functions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-223">NEXT function with FIND or FINDSET</a></li>
<li class="calibre7"><a href="#calibre_link-224">INSERT function</a></li>
<li class="calibre7"><a href="#calibre_link-225">MODIFY function</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-225">Rec and xRec</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-225">DELETE function</a></li>
<li class="calibre7"><a href="#calibre_link-226">MODIFYALL function</a></li>
<li class="calibre7"><a href="#calibre_link-227">DELETEALL function</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-227">Filtering</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-228">The SETFILTER function</a></li>
<li class="calibre7"><a href="#calibre_link-229">The COPYFILTER and COPYFILTERS functions</a></li>
<li class="calibre7"><a href="#calibre_link-229">The GETFILTER and GETFILTERS functions</a></li>
<li class="calibre7"><a href="#calibre_link-230">The FILTERGROUP function</a></li>
<li class="calibre7"><a href="#calibre_link-231">The MARK function</a></li>
<li class="calibre7"><a href="#calibre_link-231">CLEARMARKS function</a></li>
<li class="calibre7"><a href="#calibre_link-231">The MARKEDONLY function</a></li>
<li class="calibre7"><a href="#calibre_link-232">The RESET function</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-232">InterObject communication</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-232">Communicating through data</a></li>
<li class="calibre7"><a href="#calibre_link-233">Communicating through function parameters</a></li>
<li class="calibre7"><a href="#calibre_link-233">Communication via object calls</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-234">Enhancing the WDTU application</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-235">Modifying table fields</a></li>
<li class="calibre7"><a href="#calibre_link-236">Adding validation logic</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-236">Playlist Header validation</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-237">Creating the Playlist subpage</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-238">Playlist Line validations</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-239">Creating a function for our FactBox</a></li>
<li class="calibre7"><a href="#calibre_link-240">Creating a FactBox page</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-241">Summary</a></li>
<li class="calibre7"><a href="#calibre_link-242">Questions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-243">Chapter 8: Advanced AL Development Tools</a>
<ul class="calibre8">
<li class="calibre7"><a href="#calibre_link-244">Business Central process flow</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-245">Initial setup and data preparation</a></li>
<li class="calibre7"><a href="#calibre_link-245">Transaction entry</a></li>
<li class="calibre7"><a href="#calibre_link-245">Testing and posting the Journal batch</a></li>
<li class="calibre7"><a href="#calibre_link-246">Utilizing and maintaining the data</a></li>
<li class="calibre7"><a href="#calibre_link-247">Data maintenance</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-247">Role Center pages</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-247">Role Center structure</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-248">Role Center headlines page</a></li>
<li class="calibre7"><a href="#calibre_link-249">Role Center activities page</a></li>
<li class="calibre7"><a href="#calibre_link-249">Cue groups and cues</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-250">System part</a></li>
<li class="calibre7"><a href="#calibre_link-250">Page parts</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-251">Page parts not visible</a></li>
<li class="calibre7"><a href="#calibre_link-251">Page parts for user data</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-252">Navigation pane and action menus</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-253">Action Designer</a></li>
<li class="calibre7"><a href="#calibre_link-254">Creating a WDTU Role Center ribbon</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-255">XMLports</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-256">XMLport components</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-256">XMLport properties</a></li>
<li class="calibre7"><a href="#calibre_link-257">XMLport triggers</a></li>
<li class="calibre7"><a href="#calibre_link-258">XMLport data lines</a></li>
<li class="calibre7"><a href="#calibre_link-259">The XMLport line properties</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-260">SourceType as text</a></li>
<li class="calibre7"><a href="#calibre_link-260">SourceType as table</a></li>
<li class="calibre7"><a href="#calibre_link-261">SourceType as field</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-262">Element or attribute</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-262">NodeType element data item</a></li>
<li class="calibre7"><a href="#calibre_link-262">NodeType attribute data item</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-262">XMLport line triggers</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-262">DataType as text</a></li>
<li class="calibre7"><a href="#calibre_link-263">DataType as Table</a></li>
<li class="calibre7"><a href="#calibre_link-263">DataType as Field</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-264">XMLport Request Pages</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-264">Web services</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-265">Exposing a web service</a></li>
<li class="calibre7"><a href="#calibre_link-266">Publishing a web service</a></li>
<li class="calibre7"><a href="#calibre_link-267">Enabling web services</a></li>
<li class="calibre7"><a href="#calibre_link-267">Determining what was published</a></li>
<li class="calibre7"><a href="#calibre_link-268">XMLport &ndash; web services integration example for WDTU</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-269">Summary</a></li>
<li class="calibre7"><a href="#calibre_link-269">Questions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-270">Chapter 9: Successful Conclusions</a>
<ul class="calibre8">
<li class="calibre7"><a href="#calibre_link-271">Creating new AL routines</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-272">Callable functions</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-272">Codeunit 358 &ndash; DateFilterCalc</a></li>
<li class="calibre7"><a href="#calibre_link-273">Codeunit 359 &ndash; Period Form Management</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-273">FindDate function</a></li>
<li class="calibre7"><a href="#calibre_link-274">NextDate function</a></li>
<li class="calibre7"><a href="#calibre_link-275">CreatePeriodFormat function</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-275">Codeunit 365 &ndash; Format Address</a></li>
<li class="calibre7"><a href="#calibre_link-276">Codeunit 396 &ndash; NoSeriesManagement</a></li>
<li class="calibre7"><a href="#calibre_link-277">Function models to review and use</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-278">Management codeunits</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-279">Multi-language system</a></li>
<li class="calibre7"><a href="#calibre_link-280">Multi-currency system</a></li>
<li class="calibre7"><a href="#calibre_link-281">Navigate</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-282">Modifying for Navigate</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-283">Debugging in Business Central</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-284">Dialog function debugging techniques</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-284">Debugging with MESSAGE and CONFIRM</a></li>
<li class="calibre7"><a href="#calibre_link-285">Debugging with DIALOG</a></li>
<li class="calibre7"><a href="#calibre_link-286">Debugging with text output</a></li>
<li class="calibre7"><a href="#calibre_link-286">Debugging with ERROR</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-287">The Business Central debugger</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-287">Activating the debugger</a></li>
<li class="calibre7"><a href="#calibre_link-288">Creating break events</a></li>
<li class="calibre7"><a href="#calibre_link-289">The debugger window</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-290">Visual Studio Code test-driven development</a></li>
<li class="calibre7"><a href="#calibre_link-291">Other interfaces</a></li>
<li class="calibre7"><a href="#calibre_link-292">Client Add-ins</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-293">Client Add-in comments</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-293">Business Central development projects &ndash; general guidance</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-294">Knowledge is key</a></li>
<li class="calibre7"><a href="#calibre_link-294">Data-focused design</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-294">Defining the required data views</a></li>
<li class="calibre7"><a href="#calibre_link-295">Designing the data tables</a></li>
<li class="calibre7"><a href="#calibre_link-295">Designing the user data access interface</a></li>
<li class="calibre7"><a href="#calibre_link-296">Designing the data validation</a></li>
<li class="calibre7"><a href="#calibre_link-296">Data design review and revision</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-297">Designing the Posting processes</a></li>
<li class="calibre7"><a href="#calibre_link-297">Designing the supporting processes</a></li>
<li class="calibre7"><a href="#calibre_link-297">Double-check everything</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-298">Designing for efficiency</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-298">Disk I/O</a></li>
<li class="calibre7"><a href="#calibre_link-299">Locking</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-300">Updating and upgrading</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-301">Design for updating</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-301">Customization project recommendations</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-302">One change at a time</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-302">Testing</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-303">Database testing approaches</a></li>
<li class="calibre7"><a href="#calibre_link-303">Testing in production</a></li>
<li class="calibre7"><a href="#calibre_link-304">Using a testing database</a></li>
<li class="calibre7"><a href="#calibre_link-305">Testing techniques</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-306">Deliverables</a></li>
<li class="calibre7"><a href="#calibre_link-307">Finishing the project</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-307">Plan for upgrading</a>
<ul class="calibre9">
<li class="calibre7"><a href="#calibre_link-308">Benefits of upgrading</a></li>
<li class="calibre7"><a href="#calibre_link-309">Coding considerations</a></li>
<li class="calibre7"><a href="#calibre_link-309">Low-impact coding</a></li>
</ul>
</li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-310">Supporting material</a></li>
<li class="calibre7"><a href="#calibre_link-311">Summary</a></li>
<li class="calibre7"><a href="#calibre_link-311">Questions</a></li>
</ul>
</li>
<li class="calibre7"><a href="#calibre_link-312">Appendix: Assessments</a></li>
<li class="calibre7"><a href="#calibre_link-313">Other Books You May Enjoy</a></li>
<li class="calibre7"><a href="#calibre_link-314">Index</a></li>
</ul><p class="calibre1"></p>


</div>

</body></html>